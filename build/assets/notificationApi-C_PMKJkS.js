import{c as s,i as d,d as u,q as f,g as c,k as w}from"./index-CUvv9ev0.js";const g=async({page:o=1,limit:t=20,api:n})=>{const{data:e}=await n.get(`/notification/getAllNotification?page=${o}&limit=${t}`);if(!e.ok)throw new Error(e.message);return{notifications:e.data.notifications,total:e.data.total,page:e.data.page,totalPages:e.data.totalPages,ok:e.ok,message:e.message}},y=async({api:o})=>{const{data:t}=await o.get("/notification/unread-count");if(!t.ok)throw new Error(t.message);return t.count},h=async({api:o})=>{const{data:t}=await o.patch("/notification/mark-all-read");if(!t.ok)throw new Error(t.message);return t},m=async({notificationId:o,api:t})=>{const{data:n}=await t.delete(`/notification/${o}`);if(!n.ok)throw new Error(n.message);return n},a=["owner","staff","CTO","worker"],k=(o=20)=>{const{role:t}=s(),n=c(t);return d({queryKey:["notifications","infinite",o],enabled:!!t&&!!n&&a.includes(t),initialPageParam:1,queryFn:async({pageParam:e=1})=>{if(!t||!a.includes(t))throw new Error("Not allowed to make this API call");if(!n)throw new Error("API instance not found for role");return console.log("ğŸ”” Fetching notifications page:",e),await g({page:e,limit:o,api:n})},getNextPageParam:e=>{console.log("ğŸ” Last page received:",e),console.log("ğŸ” Available properties:",Object.keys(e));const i=e.page,r=e.totalPages;console.log("ğŸ” Pagination calculation:",{currentPage:i,totalPages:r,notificationsCount:e.notifications.length,total:e.total,condition:`${i} < ${r}`,result:i<r});const l=i<r?i+1:void 0;return console.log("ğŸ” Next page will be:",l),l},retry:!1,refetchOnWindowFocus:!1,staleTime:1e3*60*2})},A=()=>{const{role:o}=s(),t=c(o);return w({queryKey:["notifications","unread-count"],queryFn:async()=>{if(!o||!a.includes(o))throw new Error("Not allowed to make this API call");if(!t)throw new Error("API instance not found for role");return await y({api:t})},enabled:!!o&&!!t&&a.includes(o)})},N=()=>{const{role:o}=s(),t=c(o);return u({mutationFn:async()=>{if(!o||!a.includes(o))throw new Error("Not allowed to make this API call");if(!t)throw new Error("API instance not found for role");return await h({api:t})},onSuccess:()=>{f.invalidateQueries({queryKey:["notifications"]})}})},P=()=>{const{role:o}=s(),t=c(o);return u({mutationFn:async({notificationId:n})=>{if(!o||!a.includes(o))throw new Error("Not allowed to make this API call");if(!t)throw new Error("API instance not found for role");return await m({notificationId:n,api:t})},onSuccess:()=>{f.invalidateQueries({queryKey:["notifications"]})}})};export{N as a,P as b,A as c,k as u};
