import{r as h,j as e,u as oe,d as xe,a as ue,O as pe}from"./index-CluF71pO.js";import{e as ge,f as fe,b as he}from"./HrApi-Dudrr1ev.js";import{r as ie}from"./constants-DELhKX7a.js";import{t as $}from"./toast-BSC5QTk1.js";import{B as X}from"./Button-HSHMZ35l.js";import"./roleCheck-C6Z-poLV.js";import"./useQuery-BSXZQ8G2.js";import"./useBaseQuery-CtUSRv5w.js";import"./useMutation-Deoeq1CZ.js";import"./useInfiniteQuery-DprQuZR6.js";const be=({organizationId:a,onSuccess:j})=>{var k,D,S,H,E,q,L,W,O,_,Q,R,l,g,f,y,P,T,F,M,z,Y,Z,ee,se,ae,te,re,ne,le;const u=ge(),[d,N]=h.useState("personal"),[c,p]=h.useState(null),[x,b]=h.useState([]),[t,v]=h.useState({organizationId:a,empId:null,employeeModel:null,empRole:"organization_staff",personalInfo:{empName:"",dateOfBirth:new Date,email:"",phoneNo:"",gender:"male",maritalStatus:"unmarried",address:{street:"",city:"",state:"",pincode:"",country:"India"},emergencyContact:{name:"",relationship:"",phone:""}},employment:{joinDate:new Date,designation:"",department:"",employmentType:"full_time",salary:{basic:0,hra:0,allowances:0,total:0},workLocation:""},documents:[],status:"active"}),w=s=>{var i;const o=[];return/^\d{10}$/.test(s.personalInfo.phoneNo)||o.push("Phone number must be exactly 10 digits."),(i=s.personalInfo.emergencyContact)!=null&&i.phone&&!/^\d{10}$/.test(s.personalInfo.emergencyContact.phone)&&o.push("Emergency contact phone must be exactly 10 digits."),s.personalInfo.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.personalInfo.email)&&o.push("Invalid email format."),s.personalInfo.empName.trim()||o.push("Employee name is required."),/^\d{6}$/.test(s.personalInfo.address.pincode)||o.push("Pincode must be exactly 6 digits."),o},n=(s,o,i,m)=>{v(C=>{var U,B,G;if(!C)return C;const r=JSON.parse(JSON.stringify(C));if(m){if(s==="personalInfo")(typeof r.personalInfo!="object"||r.personalInfo===null)&&(r.personalInfo={}),m in r.personalInfo||(r.personalInfo[m]={}),r.personalInfo[m][o]=i;else if(s==="employment"&&((typeof r.employment!="object"||r.employment===null)&&(r.employment={}),m in r.employment||(r.employment[m]={}),r.employment[m][o]=i,m==="salary")){const ce=o==="basic"?i:((U=r.employment.salary)==null?void 0:U.basic)||0,de=o==="hra"?i:((B=r.employment.salary)==null?void 0:B.hra)||0,me=o==="allowances"?i:((G=r.employment.salary)==null?void 0:G.allowances)||0;r.employment.salary||(r.employment.salary={}),r.employment.salary.total=Number(ce)+Number(de)+Number(me)}}else switch(s){case"empRole":r.empRole=i;break;case"status":r.status=i;break;case"personalInfo":(typeof r.personalInfo!="object"||r.personalInfo===null)&&(r.personalInfo={}),r.personalInfo={...r.personalInfo,[o]:i};break;case"employment":(typeof r.employment!="object"||r.employment===null)&&(r.employment={}),r.employment={...r.employment,[o]:i};break}return r})},A=(s,o)=>{var r;const i=(r=s.target.files)==null?void 0:r[0];if(!i)return;p(o);const m=URL.createObjectURL(i),C={type:o,fileName:i.name,fileUrl:m,uploadedAt:new Date};b(U=>[...U,C]),setTimeout(()=>{p(null),s.target.value=""},1e3)},I=s=>{b(o=>o.filter((i,m)=>m!==s))},K=async()=>{var s,o;try{const i=w(t);if(i.length>0){i.forEach(r=>{$({title:"Validation Error",description:r,variant:"destructive"})});return}const m=new FormData,C={...t,documents:[]};m.append("employeeData",JSON.stringify(C)),await Promise.all(x.map(async r=>{const B=await(await fetch(r.fileUrl)).blob(),G=new File([B],r.fileName,{type:B.type});m.append(r.type,G)})),await u.mutateAsync({formData:m}),$({title:"Success",description:"Employee created successfully"})}catch(i){$({title:"Error",description:((o=(s=i==null?void 0:i.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to create employee",variant:"destructive"})}},V=s=>s?new Date(s).toLocaleDateString("en-IN"):"N/A",J=s=>!s||s.total===0?"N/A":new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s.total);return e.jsx("div",{className:"max-h-full overflow-y-auto bg-gray-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{onClick:j,className:"bg-slate-50 hover:bg-slate-300 flex items-center justify-between w-8 h-8 border border-[#a6aab8] text-sm cursor-pointer rounded-md px-2",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 ml-3",children:"Create New Employee"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:K,disabled:u.isPending,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors text-sm font-medium",children:u.isPending?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save mr-2"}),"Create Employee"]})}),e.jsxs("button",{onClick:j,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium",children:[e.jsx("i",{className:"fas fa-times mr-2"}),"Cancel"]})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"personal",label:"Personal Info",icon:"fas fa-user"},{id:"employment",label:"Employment",icon:"fas fa-briefcase"},{id:"documents",label:"Documents",icon:"fas fa-file-alt"}].map(s=>e.jsxs("button",{onClick:()=>N(s.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${d===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("i",{className:`${s.icon} mr-2`}),s.label]},s.id))})}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(95vh-150px)] custom-scrollbar",children:[d==="personal"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",value:t.personalInfo.empName,onChange:s=>n("personalInfo","empName",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:t.personalInfo.email,onChange:s=>n("personalInfo","email",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),e.jsx("input",{type:"tel",maxLength:10,value:t.personalInfo.phoneNo,onChange:s=>n("personalInfo","phoneNo",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsxs("select",{value:t.personalInfo.gender,onChange:s=>n("personalInfo","gender",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",value:(k=t==null?void 0:t.personalInfo)!=null&&k.dateOfBirth?new Date(t.personalInfo.dateOfBirth).toISOString().split("T")[0]:"",onChange:s=>n("personalInfo","dateOfBirth",new Date(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marital Status"}),e.jsxs("select",{value:(D=t==null?void 0:t.personalInfo)==null?void 0:D.maritalStatus,onChange:s=>n("personalInfo","maritalStatus",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"unmarried",children:"UnMarried"}),e.jsx("option",{value:"married",children:"Married"}),e.jsx("option",{value:"divorced",children:"Divorced"}),e.jsx("option",{value:"widowed",children:"Widowed"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Address & Emergency Contact"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:"Address"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street"}),e.jsx("input",{type:"text",value:(H=(S=t==null?void 0:t.personalInfo)==null?void 0:S.address)==null?void 0:H.street,onChange:s=>n("personalInfo","street",s.target.value,"address"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:(q=(E=t.personalInfo)==null?void 0:E.address)==null?void 0:q.city,onChange:s=>n("personalInfo","city",s.target.value,"address"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),e.jsx("input",{type:"text",value:(W=(L=t.personalInfo)==null?void 0:L.address)==null?void 0:W.state,onChange:s=>n("personalInfo","state",s.target.value,"address"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pincode"}),e.jsx("input",{type:"text",maxLength:6,value:(_=(O=t.personalInfo)==null?void 0:O.address)==null?void 0:_.pincode,onChange:s=>{const o=s.target.value;/^\d*$/.test(o)&&n("personalInfo","pincode",s.target.value,"address")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsx("input",{type:"text",value:(R=(Q=t.personalInfo)==null?void 0:Q.address)==null?void 0:R.country,onChange:s=>n("personalInfo","country",s.target.value,"address"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"space-y-3 pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:"Emergency Contact"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",value:(g=(l=t==null?void 0:t.personalInfo)==null?void 0:l.emergencyContact)==null?void 0:g.name,onChange:s=>n("personalInfo","name",s.target.value,"emergencyContact"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Relationship"}),e.jsx("input",{type:"text",value:(y=(f=t.personalInfo)==null?void 0:f.emergencyContact)==null?void 0:y.relationship,onChange:s=>n("personalInfo","relationship",s.target.value,"emergencyContact"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",maxLength:10,value:(T=(P=t.personalInfo)==null?void 0:P.emergencyContact)==null?void 0:T.phone,onChange:s=>n("personalInfo","phone",s.target.value,"emergencyContact"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})]})}),d==="employment"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Job Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation *"}),e.jsx("input",{type:"text",value:(F=t.employment)==null?void 0:F.designation,onChange:s=>n("employment","designation",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs("select",{value:(M=t.employment)==null?void 0:M.department,onChange:s=>n("employment","department",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Department"}),(z=ie)==null?void 0:z.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),e.jsxs("select",{value:(Y=t.employment)==null?void 0:Y.employmentType,onChange:s=>n("employment","employmentType",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"full_time",children:"Full Time"}),e.jsx("option",{value:"part_time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"intern",children:"Intern"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Join Date"}),e.jsx("input",{type:"date",value:t.employment.joinDate?new Date(t.employment.joinDate).toISOString().split("T")[0]:"",onChange:s=>n("employment","joinDate",new Date(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Location"}),e.jsx("input",{type:"text",value:(Z=t.employment)==null?void 0:Z.workLocation,onChange:s=>n("employment","workLocation",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Status"}),e.jsxs("select",{value:t.status,onChange:s=>n("status","",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Salary Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Basic Salary"}),e.jsx("input",{type:"number",value:(se=(ee=t.employment)==null?void 0:ee.salary)==null?void 0:se.basic,onChange:s=>n("employment","basic",parseFloat(s.target.value)||0,"salary"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HRA"}),e.jsx("input",{type:"number",value:(te=(ae=t.employment)==null?void 0:ae.salary)==null?void 0:te.hra,onChange:s=>n("employment","hra",parseFloat(s.target.value)||0,"salary"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allowances"}),e.jsx("input",{type:"number",value:(ne=(re=t.employment)==null?void 0:re.salary)==null?void 0:ne.allowances,onChange:s=>n("employment","allowances",parseFloat(s.target.value)||0,"salary"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-200",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Salary"}),e.jsx("p",{className:"text-xl font-bold text-green-600 py-2",children:J((le=t.employment)==null?void 0:le.salary)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Role"}),e.jsxs("select",{value:t.empRole,onChange:s=>n("empRole","",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"organization_staff",children:"Organization Staff"}),e.jsx("option",{value:"nonorganization_staff",children:"Non-Organization Staff"})]})]})]})]})}),d==="documents"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Employee Documents"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Total Documents: ",x.length]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Upload Documents"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:["resume","aadhar","pan","passport","education","experience"].map(s=>e.jsx("div",{className:"text-center",children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,",onChange:o=>A(o,s),className:"hidden",disabled:c===s}),e.jsx("div",{className:`p-4 border-2 border-dashed rounded-lg transition-colors ${c===s?"border-blue-300 bg-blue-50":"border-gray-300 hover:border-blue-400 hover:bg-blue-50"}`,children:c===s?e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-blue-600 text-2xl mb-2"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Uploading..."})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-upload text-gray-400 text-2xl mb-2"}),e.jsx("p",{className:"text-xs text-gray-600 capitalize",children:s})]})})]})},s))})]}),e.jsx("div",{className:"space-y-4",children:x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map((s,o)=>{var i;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:e.jsx("i",{className:"fas fa-file-alt text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900 capitalize",children:((i=s.type)==null?void 0:i.replace("_"," "))||"Document"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.fileName||"Unknown file"})]})]}),e.jsx("button",{onClick:()=>I(o),className:"text-red-600 hover:text-red-800 transition-colors p-1",title:"Delete document",children:e.jsx("i",{className:"fas fa-trash text-sm"})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:["Uploaded: ",s.uploadedAt?V(s.uploadedAt):"N/A"]}),s.fileUrl&&e.jsxs("a",{href:s.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 font-medium",children:[e.jsx("i",{className:"fas fa-external-link-alt mr-1"}),"View"]})]})]},o)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"fas fa-file-alt text-gray-300 text-6xl mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Documents Uploaded"}),e.jsx("p",{className:"text-gray-600",children:"Upload documents using the section above."})]})})]})]})]})})},ye=a=>{switch(a){case"full_time":return"bg-blue-100 text-blue-800";case"part_time":return"bg-purple-100 text-purple-800";case"contract":return"bg-orange-100 text-orange-800";case"intern":return"bg-pink-100 text-pink-800";default:return"bg-gray-100 text-gray-800"}},je=a=>a?new Date(a).toLocaleDateString():"N/A",Ne=a=>a!=null&&a.total?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(a.total):"N/A",ve=({employee:a,getStatusColor:j,handleDeleteEmployee:u,deleteEmployeeMutation:d})=>{var c,p,x,b,t,v,w,n;const N=oe();return e.jsx("div",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-all duration-200 border border-gray-100 hover:border-blue-200 group",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:((c=a.personalInfo)==null?void 0:c.empName)||"N/A"})})}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${j(a.status)}`,children:a.status||"N/A"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("i",{className:"fas fa-briefcase text-gray-400 w-4"}),e.jsx("span",{className:"ml-2 text-gray-600",children:((p=a.employment)==null?void 0:p.designation)||"N/A"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("i",{className:"fas fa-building text-gray-400 w-4"}),e.jsx("span",{className:"ml-2 text-gray-600",children:((x=a.employment)==null?void 0:x.department)||"N/A"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("i",{className:"fas fa-envelope text-gray-400 w-4"}),e.jsx("span",{className:"ml-2 text-gray-600 truncate",children:((b=a.personalInfo)==null?void 0:b.email)||"N/A"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("i",{className:"fas fa-phone text-gray-400 w-4"}),e.jsx("span",{className:"ml-2 text-gray-600",children:((t=a.personalInfo)==null?void 0:t.phoneNo)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[((v=a.employment)==null?void 0:v.employmentType)&&e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${ye(a.employment.employmentType)}`,children:a.employment.employmentType.replace("_"," ")}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Salary"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:Ne((w=a.employment)==null?void 0:w.salary)})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Joined"}),e.jsx("span",{className:"text-gray-900 font-medium",children:je((n=a.employment)==null?void 0:n.joinDate)})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 flex gap-2",children:[e.jsxs("button",{onClick:()=>N(a._id),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"View Details"]}),e.jsx("button",{onClick:A=>{A.stopPropagation(),u(a._id)},className:"bg-red-600 text-white px-3 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm",disabled:d.isPending,children:d.isPending?e.jsx("i",{className:"fas fa-spinner fa-spin"}):e.jsx("i",{className:"fas fa-trash"})})]})]})})},we=a=>{switch(a){case"organization_staff":return"bg-blue-100 text-blue-800";case"nonorganization_staff":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Ce=({employee:a,handleDeleteEmployee:j,deleteEmployeeMutation:u})=>{var c,p,x,b,t;const d=oe(),N=v=>{switch(v){case"WorkerModel":return"Worker";case"CTOModel":return"CTO";case"UserModel":return"Admin";default:return"N/A"}};return e.jsx(e.Fragment,{children:e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((c=a.personalInfo)==null?void 0:c.empName)||"N/A"})})})}),e.jsxs("td",{className:"px-6 py-4 text-center",children:[e.jsx("div",{className:"text-sm text-gray-900",children:((p=a.personalInfo)==null?void 0:p.email)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500 ",children:((x=a.personalInfo)==null?void 0:x.phoneNo)||"N/A"})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"text-sm text-gray-900",children:(b=a.employment)!=null&&b.department||(a==null?void 0:a.employeeModel)==="StaffModel"?((t=a.employment)==null?void 0:t.department)||"N/A":N(a==null?void 0:a.employeeModel)})}),e.jsx("td",{className:"px-6 py-4 text-center ",children:e.jsx("div",{children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${we(a.empRole)}`,children:a!=null&&a.empRole?a.empRole==="organization_staff"?"Organization Staff":"Non-Organization Staff":"N/A"})})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(X,{variant:"secondary",onClick:()=>d(a._id),className:"text-blue-600 hover:text-blue-800 font-medium text-sm",children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"View"]}),e.jsxs(X,{variant:"danger",onClick:()=>j(a._id),className:"text-white  bg-red-600 font-medium text-sm",disabled:u.isPending,children:[u.isPending?e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}):e.jsx("i",{className:"fas fa-trash mr-1"}),"Delete"]})]})})]})})},Pe=()=>{var R;const{openMobileSidebar:a,isMobile:j}=xe(),{organizationId:u}=ue(),[d,N]=h.useState({}),[c,p]=h.useState(""),[x,b]=h.useState("list"),{data:t,fetchNextPage:v,hasNextPage:w,isFetchingNextPage:n,isLoading:A,error:I,refetch:K}=fe(u,d),[V,J]=h.useState(!1),k=he(),D=h.useMemo(()=>(t==null?void 0:t.pages.flatMap(l=>l.data))||[],[t]),S=h.useMemo(()=>c?D.filter(l=>{var g,f,y,P,T,F,M,z;return((f=(g=l.personalInfo)==null?void 0:g.empName)==null?void 0:f.toLowerCase().includes(c.toLowerCase()))||((P=(y=l.personalInfo)==null?void 0:y.email)==null?void 0:P.toLowerCase().includes(c.toLowerCase()))||((F=(T=l.personalInfo)==null?void 0:T.phoneNo)==null?void 0:F.includes(c))||((z=(M=l.employment)==null?void 0:M.designation)==null?void 0:z.toLowerCase().includes(c.toLowerCase()))}):D,[D,c]),H=()=>{w&&!n&&v()},E=async l=>{var g,f;if(window.confirm("Are you sure you want to delete this employee? This action cannot be undone."))try{await k.mutateAsync({empId:l}),$({title:"Success",description:"Document deleted successfully"})}catch(y){$({title:"Error",description:((f=(g=y==null?void 0:y.response)==null?void 0:g.data)==null?void 0:f.message)||"Failed to delete document",variant:"destructive"})}},q=l=>{switch(l){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"terminated":return"bg-red-100 text-red-800";case"on_leave":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},L=(l,g)=>{N(f=>({...f,[l]:g||void 0}))},W=()=>{N({})},O=Object.values(d).filter(Boolean).length;if(A)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading Employees"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the employee data..."})]})});if(I)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-red-500 text-6xl mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Employees"}),e.jsx("p",{className:"text-gray-600 mb-4",children:I==null?void 0:I.message}),e.jsxs("button",{onClick:()=>K(),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("i",{className:"fas fa-redo mr-2"}),"Try Again"]})]})});const _=location.pathname.split("/");return _[_.length-1]!=="hr"?e.jsx(pe,{context:{openMobileSidebar:a,isMobile:j}}):e.jsxs("div",{className:"min-h-full max-h-full overflow-y-auto bg-gray-50",children:[!V&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-users mr-3 text-blue-600"}),"Human Resources"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your organization's employees and their information"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search with Name or Email or Phno",value:c,onChange:l=>p(l.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full sm:w-80"})]}),e.jsx("div",{children:e.jsx(X,{onClick:()=>J(!0),children:"Create New Employee"})})]})]})})}),e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col xl:flex-row gap-6",children:[e.jsx("div",{className:"xl:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),O>0&&e.jsxs("button",{onClick:W,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",O,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Type"}),e.jsxs("select",{value:d.empRole||"",onChange:l=>L("empRole",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"organization_staff",children:"Organization Staff"}),e.jsx("option",{value:"nonorganization_staff",children:"Non-Organization Staff"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsxs("select",{value:(d==null?void 0:d.department)||"",onChange:l=>L("department",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Department"}),(R=ie)==null?void 0:R.map(l=>e.jsx("option",{value:l,children:l},l))]})]})]})]})}),e.jsx("div",{className:"flex-1  max-h-[74vh] overflow-y-auto",children:S.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[e.jsx("i",{className:"fas fa-users text-gray-300 text-6xl mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No employees found"}),e.jsx("p",{className:"text-gray-600",children:c||Object.keys(d).length>0?"Try adjusting your search or filters":"Start by adding your first employee"})]}):e.jsxs(e.Fragment,{children:[x==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-6",children:S.map(l=>e.jsx(ve,{employee:l,getStatusColor:q,handleDeleteEmployee:E,deleteEmployeeMutation:k},l._id))}):e.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:S.map(l=>e.jsx(Ce,{employee:l,handleDeleteEmployee:E,deleteEmployeeMutation:k},l._id))})]})})}),w&&e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:H,disabled:n,className:"bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:n?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Load More Employees"]})})})]})})]})})]}),V&&e.jsx(be,{organizationId:u,onSuccess:()=>J(!1)})]})};export{Pe as default};
