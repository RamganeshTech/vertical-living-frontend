import{u as U,a as O,r as u,b as W,j as e,B as w}from"./index-MXS_gbde.js";import{C as q}from"./Card-L4jLwmC3.js";import{I as _}from"./ImageGalleryMain-LKPoIxi9.js";import{d as J}from"./dateFormator-BGKi5rfZ.js";const g=({icon:d,title:a})=>e.jsxs("h3",{className:"text-sm font-bold text-gray-800 uppercase tracking-wide mb-3 pb-1 border-b border-gray-100 flex items-center gap-2",children:[e.jsx("i",{className:`fas ${d} text-blue-500`})," ",a]}),c=({children:d,required:a})=>e.jsxs("label",{className:"block text-[11px] font-bold text-gray-500 uppercase tracking-wider mb-1",children:[d," ",a&&e.jsx("span",{className:"text-red-500",children:"*"})]}),o=d=>e.jsx("input",{...d,className:`w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 bg-white disabled:bg-gray-50 disabled:text-gray-500 transition-all ${d.className}`}),P=d=>e.jsx("select",{...d,className:`w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 bg-white disabled:bg-gray-50 transition-all ${d.className}`,children:d.children}),Y=({mode:d,initialData:a,onSubmit:k,isSubmitting:I})=>{var F,S,B;const{organizationId:N}=U(),A=O(),[i,v]=u.useState(d),r=i==="view",{role:R,permission:y}=W(),H=R==="owner"||((F=y==null?void 0:y.customer)==null?void 0:F.edit),[l,C]=u.useState({organizationId:(a==null?void 0:a.organizationId)||N,projectId:(a==null?void 0:a.projectId)||null,clientId:(a==null?void 0:a.clientId)||null,firstName:"",companyName:"",email:"",phone:{work:"",mobile:""},language:"English",currency:"INR - Indian Rupee",pan:"",tan:"",gstin:"",bankAccNo:"",accHolderName:"",bankName:"",bankBranch:"",ifscCode:""}),[p,f]=u.useState([]),[x,z]=u.useState({});u.useEffect(()=>{a&&C(s=>{var n,m;return{...s,organizationId:a.organizationId||N,clientId:a.clientId||null,firstName:a.firstName||"",companyName:a.companyName||"",email:a.email||"",phone:{work:((n=a.phone)==null?void 0:n.work)||"",mobile:((m=a.phone)==null?void 0:m.mobile)||""},language:a.language||"English",currency:a.currency||"INR - Indian Rupee",pan:a.pan||"",tan:a.tan||"",gstin:a.gstin||"",bankAccNo:a.bankAccNo||"",accHolderName:a.accHolderName||"",bankName:a.bankName||"",bankBranch:a.bankBranch||"",ifscCode:a.ifscCode||""}})},[a,N]);const t=s=>{const{name:n,value:m}=s.target;C(h=>({...h,[n]:m}))},E=(s,n)=>{const m=n.replace(/[^0-9]/g,"");C(h=>({...h,phone:{...h.phone,[s]:m}}))},M=s=>{s.target.files&&f(Array.from(s.target.files))},$=s=>{f(n=>n.filter((m,h)=>h!==s))},T=()=>{i==="create"?A(-1):(v("view"),f([]))},G=()=>{var n;const s={};return(n=l.firstName)!=null&&n.trim()||(s.firstName="First name is required"),l.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email)&&(s.email="Invalid email format"),l.phone.mobile&&l.phone.mobile.length!==10&&(s["phone.mobile"]="Mobile number must be 10 digits"),z(s),Object.keys(s).length===0},L=async()=>{if(G())try{d==="create"?await k(l,p):(await k(l,p),v("view"),f([]))}catch(s){console.error("Submit error:",s)}},j=((S=a==null?void 0:a.documents)==null?void 0:S.filter(s=>s.type==="image"))||[],b=((B=a==null?void 0:a.documents)==null?void 0:B.filter(s=>s.type==="pdf"))||[];return e.jsxs("div",{className:"max-w-full overflow-y-auto mx-auto h-full flex flex-col pb-10 font-sans",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>A(-1),className:"bg-white hover:bg-gray-50 w-9 h-9 flex items-center justify-center border border-gray-200 rounded-full shadow-sm transition-colors",children:e.jsx("i",{className:"fas fa-arrow-left text-gray-600"})}),e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[e.jsx("span",{className:"bg-blue-100 text-blue-600 w-10 h-10 rounded-full flex items-center justify-center text-lg",children:e.jsx("i",{className:`fas ${i==="create"?"fa-user-plus":"fa-user-tie"}`})}),i==="create"?"Create Customer":"Customer Details"]})]}),e.jsxs("div",{className:"flex gap-3",children:[i==="view"&&H&&e.jsxs(w,{onClick:()=>v("update"),className:"bg-blue-600 text-white shadow-sm",children:[e.jsx("i",{className:"fas fa-edit mr-2"})," Edit Details"]}),i==="update"&&e.jsx(w,{onClick:T,variant:"outline",className:"bg-white",children:"Cancel Edit"}),!r&&e.jsx(w,{type:"button",onClick:L,disabled:I,className:"",children:I?e.jsx("i",{className:"fas fa-spinner fa-spin"}):e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-save mr-2"})," Save Changes"]})})]})]}),e.jsx(q,{className:"p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(g,{icon:"fa-info-circle",title:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx(c,{required:!0,children:"Customer Name"}),e.jsx(o,{name:"firstName",value:l.firstName,onChange:t,disabled:r,placeholder:"Full Name"}),x.firstName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.firstName})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(c,{children:"Company Name"}),e.jsx(o,{name:"companyName",value:l.companyName,onChange:t,disabled:r,placeholder:"Company"})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(c,{children:"Email Address"}),e.jsx(o,{type:"email",name:"email",value:l.email,onChange:t,disabled:r,placeholder:"email@example.com"}),x.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.email})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(c,{children:"Mobile Number"}),e.jsx(o,{value:l.phone.mobile,onChange:s=>E("mobile",s.target.value),disabled:r,maxLength:10,placeholder:"10 digits"}),x["phone.mobile"]&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x["phone.mobile"]})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(c,{children:"Work Phone"}),e.jsx(o,{value:l.phone.work,onChange:s=>E("work",s.target.value),disabled:r,maxLength:12,placeholder:"Landline / Alt"})]})]})]}),e.jsxs("div",{children:[e.jsx(g,{icon:"fa-file-invoice",title:"Statutory & Settings"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"PAN Number"}),e.jsx(o,{name:"pan",value:l.pan,onChange:t,disabled:r,placeholder:"PAN",className:"uppercase"})]}),e.jsxs("div",{children:[e.jsx(c,{children:"TAN Number"}),e.jsx(o,{name:"tan",value:l.tan,onChange:t,disabled:r,placeholder:"TAN",className:"uppercase"})]}),e.jsxs("div",{children:[e.jsx(c,{children:"GSTIN"}),e.jsx(o,{name:"gstin",value:l.gstin,onChange:t,disabled:r,placeholder:"GSTIN",className:"uppercase"})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Language"}),e.jsx(P,{name:"language",value:l.language,onChange:t,disabled:r,children:["English","Hindi","Tamil","Telugu","Malayalam","Kannada"].map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Currency"}),e.jsx(P,{name:"currency",value:l.currency,onChange:t,disabled:r,children:["INR - Indian Rupee","USD - US Dollar","EUR - Euro"].map(s=>e.jsx("option",{value:s,children:s},s))})]})]})]}),e.jsxs("div",{children:[e.jsx(g,{icon:"fa-university",title:"Banking Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(c,{children:"Bank Name"}),e.jsx(o,{name:"bankName",value:l.bankName,onChange:t,disabled:r})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(c,{children:"Branch"}),e.jsx(o,{name:"bankBranch",value:l.bankBranch,onChange:t,disabled:r})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(c,{children:"Account Number"}),e.jsx(o,{name:"bankAccNo",value:l.bankAccNo,onChange:t,disabled:r})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(c,{children:"IFSC Code"}),e.jsx(o,{name:"ifscCode",value:l.ifscCode,onChange:t,disabled:r,className:"uppercase"})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(c,{children:"Account Holder"}),e.jsx(o,{name:"accHolderName",value:l.accHolderName,onChange:t,disabled:r})]})]})]}),(j.length>0||b.length>0)&&e.jsxs("section",{children:[e.jsx(g,{icon:"fa-folder-open",title:"Attached Documents"}),j.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("i",{className:"fas fa-images text-purple-600"}),e.jsx("h4",{className:"font-semibold text-gray-800 text-xs uppercase",children:"Images"}),e.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1.5 rounded-full",children:j.length})]}),e.jsx(_,{imageFiles:j,height:120,minWidth:120,maxWidth:180})]}),b.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("i",{className:"fas fa-file-pdf text-red-600"}),e.jsx("h4",{className:"font-semibold text-gray-800 text-xs uppercase",children:"PDF Documents"}),e.jsx("span",{className:"text-[10px] bg-red-100 text-red-700 px-1.5 rounded-full",children:b.length})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:b.map((s,n)=>e.jsxs("div",{className:"flex items-center gap-3 bg-red-50 p-2 rounded border border-red-100 hover:shadow-sm transition-all",children:[e.jsx("div",{className:"w-8 h-8 bg-white rounded flex items-center justify-center text-red-500 border border-red-100",children:e.jsx("i",{className:"fas fa-file-pdf"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-900 truncate",children:s.originalName||`Document ${n+1}.pdf`}),e.jsx("p",{className:"text-[10px] text-gray-500",children:J(s.uploadedAt)})]}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium text-blue-600 hover:text-blue-800 px-1",children:"Open"})]},n))})]})]}),!r&&e.jsxs("section",{children:[e.jsx(g,{icon:"fa-cloud-upload-alt",title:i==="create"?"Upload Documents":"Add New Documents"}),e.jsxs("div",{className:"relative w-full h-24 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 transition-colors bg-gray-50 flex flex-col items-center justify-center group",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*,.pdf",onChange:M,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20"}),e.jsx("i",{className:"fas fa-cloud-upload-alt text-2xl text-gray-400 group-hover:text-blue-500 transition-colors mb-1"}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Click to upload files"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"PDF, PNG, JPG"})]}),p.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:p.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white border border-gray-200 rounded shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`fas ${s.type.includes("pdf")?"fa-file-pdf text-red-500":"fa-file-image text-blue-500"}`}),e.jsx("span",{className:"text-sm text-gray-700",children:s.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",(s.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx("button",{type:"button",onClick:()=>$(n),className:"text-red-500 hover:text-red-700 px-2",children:e.jsx("i",{className:"fas fa-times"})})]},n))})]})]})})]})};export{Y as C};
