import{u as B,d as T,af as $,a as z,k as E,j as e,M as G,O as Z,B as v,L as _,t as C}from"./index-BAM0eJUz.js";import{u as D,a as W,b as Y}from"./qualityCheckApi-P_RvVAR_.js";import{R as H}from"./ResetStageButton-DaUxSSZv.js";import{C as J}from"./Card-CdxfjEr-.js";import{A as K,S as U}from"./AssignStaff-Bt6qrEbL.js";import{S as V}from"./StageGuide-e28gQ0h1.js";import"./Input-1UBXZqEj.js";import"./getAllUsersApi-O0JEgRtZ.js";const ce=[{path:"adminwall",sectionName:"Admin Section"},{path:"workerwall",sectionName:"Worker Section"}];function re(){var h,g,f,p,b,j,N,w,y;const{projectId:l,organizationId:o}=B(),S=T(),{isMobile:m,openMobileSidebar:d}=$(),A=z();if(!l)return null;const{role:x,permission:i}=E(),L=x==="owner"||((h=i==null?void 0:i.qualitycheck)==null?void 0:h.create),M=x==="owner"||((g=i==null?void 0:i.qualitycheck)==null?void 0:g.edit),{data:s,isLoading:u,isError:O,error:n,refetch:r}=D(l),{mutateAsync:q,isPending:P}=W(),{mutateAsync:Q,isPending:R}=Y(),F=S.pathname.includes("/qualitycheckroom/"),I=async()=>{var t,c;try{await Q({projectId:l}),C({title:"Success",description:"Quality Check marked as complete."}),A("../cleaning"),r()}catch(a){C({title:"Error",description:((c=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:c.message)||a.message||"Failed to update completion status",variant:"destructive"})}};return u?e.jsx(G,{}):e.jsx("main",{className:"w-full h-full  overflow-y-auto custom-scrollbar",children:F?e.jsx(Z,{context:{isMobile:m,openMobileSidebar:d}}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-blue-600 flex items-center gap-2",children:[m&&e.jsx("button",{onClick:d,className:"mr-2 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsx("i",{className:"fas fa-check-double"}),"Quality Check Overview"]}),(L||M)&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"!w-[100%] sm:!w-[100%] lg:!w-[50%] xl:!w-[65%] flex flex-col sm:flex-row gap-2 justify-end",children:[e.jsxs(v,{isLoading:R,onClick:I,className:"bg-green-600 h-10 hover:bg-green-700 text-white w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-circle-check mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Mark as Complete"}),e.jsx("span",{className:"inline sm:hidden",children:"Complete"})]}),e.jsx(H,{projectId:l,stageNumber:12,stagePath:"qualitycheck",className:"w-full sm:w-auto"}),e.jsx(K,{stageName:"QualityCheckupModel",projectId:l,organizationId:o,currentAssignedStaff:(s==null?void 0:s.assignedTo)||null,className:"w-full sm:w-auto"})]})}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(V,{organizationId:o,stageName:"qualitycheck"})})]}),O?e.jsxs("div",{className:"max-w-xl mx-auto p-6 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 text-xl font-semibold mb-2",children:"⚠️ Oops! An Error Occurred"}),e.jsx("p",{className:"text-red-500 text-sm mb-4",children:((p=(f=n==null?void 0:n.response)==null?void 0:f.data)==null?void 0:p.message)||(n==null?void 0:n.message)||"Failed to load, please try again"}),e.jsx(v,{isLoading:u,onClick:()=>r(),className:"inline-flex items-center px-4 py-2 bg-red-600 text-white text-sm font-medium rounded hover:bg-red-700 transition",children:"Retry"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(J,{className:"p-4 mb-6 border-l-4 border-blue-600 bg-white shadow",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-700 text-sm font-medium mb-2",children:[e.jsx("i",{className:"fa-solid fa-clock text-blue-500 text-lg"}),e.jsx("span",{children:"Stage Timings"})]}),e.jsx(U,{stageName:"qualitycheck",completedAt:(b=s==null?void 0:s.timer)==null?void 0:b.completedAt,projectId:l,formId:s==null?void 0:s._id,deadLine:(j=s==null?void 0:s.timer)==null?void 0:j.deadLine,startedAt:(N=s==null?void 0:s.timer)==null?void 0:N.startedAt,refetchStageMutate:r,deadLineMutate:q,isPending:P})]}),e.jsx("h3",{className:"text-xl text-blue-600 font-semibold mb-2",children:"Rooms"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4 mb-10",children:((w=s==null?void 0:s.rooms)==null?void 0:w.length)>0?(y=s==null?void 0:s.rooms)==null?void 0:y.map(t=>{var c,a,k;return e.jsxs(_,{to:`qualitycheckroom/${(c=t.roomName)==null?void 0:c.replace(/([A-Z])/g," $1").trim()}`,className:"border-l-4 border-blue-600 p-4 rounded-xl bg-white shadow hover:shadow-lg transition cursor-pointer",children:[e.jsx("h3",{className:"text-md font-semibold text-blue-800 capitalize mb-1",children:(a=t==null?void 0:t.roomName)==null?void 0:a.replace(/([A-Z])/g," $1").trim()}),e.jsxs("p",{className:"text-xs text-gray-500",children:[((k=t==null?void 0:t.tasks)==null?void 0:k.length)||0," works completed"]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Click to view details"})]},t._id)}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"h-full flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center max-w-md mx-auto",children:[e.jsx("i",{className:"fas fa-door-open text-5xl sm:text-6xl text-blue-300 mb-4"}),e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-700 mb-2",children:"No Rooms Created Yet"}),e.jsx("p",{className:"text-gray-500",children:"Add rooms in client requirement stage"})]})})})})]})]})})}export{re as default,ce as wallSectionSop};
