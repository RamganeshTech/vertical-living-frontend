import{u as l}from"./useQuery-DyvuN1xf.js";import{u as s}from"./useMutation-DDHgQq3T.js";import{f as i,q as o,h as d}from"./index-CqEiDvr_.js";import{g as u}from"./roleCheck-BJ07f95N.js";const p=async({id:e,payload:r,api:t})=>{const{data:n}=await t.put(`/department/procurement/updateshop/${e}`,r);if(!n.ok)throw new Error(n.message);return n.data},w=async({id:e,payload:r,api:t})=>{const{data:n}=await t.put(`/department/procurement/updatedelivery/${e}`,r);if(!n.ok)throw new Error(n.message);return n.data},y=async({id:e,api:r})=>{const{data:t}=await r.delete(`/department/procurement/deleteprocurement/${e}`);if(!t.ok)throw new Error(t.message);return t.data},f=async({organizationId:e,projectId:r,api:t})=>{const n=new URLSearchParams;e&&n.append("organizationId",e),r&&n.append("projectId",r);const{data:a}=await t.get(`/department/procurement/getprocurementall?${n.toString()}`);if(!a.ok)throw new Error(a.message);return a.data},h=async({id:e})=>{const{data:r}=await d.get(`https://houseofram.in/api/department/procurement/getprocurementsingle/${e}`);if(!r.ok)throw new Error(r.message);return r.data},P=async({id:e,api:r})=>{const{data:t}=await r.patch(`/department/procurement/generatepdf/${e}`);if(!t.ok)throw new Error(t.message);return t.data},g=async(e,r,t)=>{const{data:n}=await t.delete(`/department/procurement/deletepdf/${e}/${r}`);if(!n.ok)throw new Error(n.message);return n.data},E=async({id:e,api:r})=>{const{data:t}=await r.post(`/department/procurement/synctopayments/${e}`);if(!t.ok)throw new Error(t.message);return t.data},q=async({orderId:e,api:r})=>{const{data:t}=await r.post(`/department/procurement/generatetoken/${e}`);if(!t.ok)throw new Error(t.message);return t.data},m="https://houseofram.in/api/department/procurement",$=async({orderId:e,token:r})=>{const{data:t}=await d.get(`${m}/public/get?token=${r}&orderId=${e}`);if(!t.ok)throw new Error(t.message);return t.data},k=async({orderId:e,itemId:r,token:t,payload:n})=>{const{data:a}=await d.put(`${m}/public/item/update?token=${t}&orderId=${e}&itemId=${r}`,n);if(!a.ok)throw new Error(a.message);return a.data},c=["owner","CTO","staff"],I=()=>{const{role:e}=i(),r=u(e);return s({mutationFn:async({id:t,payload:n})=>{if(!e||!c.includes(e))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await p({id:t,payload:n,api:r})},onSuccess:(t,{id:n})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",n]})}})},K=()=>{const{role:e}=i(),r=u(e);return s({mutationFn:async({id:t,payload:n})=>{if(!e||!c.includes(e))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await w({id:t,payload:n,api:r})},onSuccess:(t,{id:n})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",n]})}})},Q=()=>{const{role:e}=i(),r=u(e);return s({mutationFn:async({id:t})=>{if(!e||!c.includes(e))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await y({id:t,api:r})},onSuccess:()=>{o.invalidateQueries({queryKey:["procurement","details"]})}})},F=(e,r)=>{const{role:t}=i(),n=u(t);return l({queryKey:["procurement","details",e,r],queryFn:async()=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!n)throw new Error("API instance not found for role");return await f({organizationId:e,api:n,projectId:r.projectId})},enabled:!!e&&!!t&&!!n})},D=e=>l({queryKey:["procurement","single",e],queryFn:async()=>await h({id:e}),enabled:!!e,refetchOnMount:!0}),R=()=>{const e=["owner","staff","CTO"],{role:r}=i(),t=u(r);return s({mutationFn:async({id:n})=>{if(!r||!e.includes(r))throw new Error("not allowed to make this api call");if(!t)throw new Error("API instance missing");return await P({id:n,api:t})},onSuccess:(n,{id:a})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",a]})}})},G=()=>{const{role:e}=i(),r=u(e);return s({mutationFn:async({id:t,pdfId:n})=>{if(!e||!c.includes(e))throw new Error("Youre not allowed to delete pdf");if(!r)throw new Error("API instance not available");return await g(t,n,r)},onSuccess:(t,{id:n})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",n]})}})},L=()=>{const e=["owner","staff","CTO"],{role:r}=i(),t=u(r);return s({mutationFn:async({id:n})=>{if(!r||!e.includes(r))throw new Error("Unauthorized");if(!t)throw new Error("API instance not found for role");return await E({id:n,api:t})},onSuccess:()=>{o.invalidateQueries({queryKey:["bills"]})}})},N=()=>{const e=["owner","staff","CTO"],{role:r}=i(),t=u(r);return s({mutationFn:async({orderId:n})=>{if(!r||!e.includes(r))throw new Error("not allowed to make this api call");if(!t)throw new Error("API instance missing");return await q({orderId:n,api:t})},onSuccess:(n,{orderId:a})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",a]})}})},C=(e,r)=>l({queryKey:["procurement","public",e],queryFn:async()=>await $({token:e,orderId:r}),enabled:!!e,retry:!1}),O=()=>s({mutationFn:async({orderId:e,itemId:r,token:t,payload:n})=>await k({token:t,payload:n,orderId:e,itemId:r})});export{O as a,D as b,I as c,K as d,R as e,N as f,G as g,L as h,F as i,Q as j,C as u};
