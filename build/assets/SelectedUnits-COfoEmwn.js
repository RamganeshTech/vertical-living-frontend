import{c as S,d as k,f as I,j as e,B as f,C as F,n as B,o as M,p as A,t as c}from"./index-CbQCFZwb.js";import{B as O}from"./Badge-CDcVvLd4.js";import{u as E,b as G,c as L}from"./selectedModularUnitApi-DS8hOhLy.js";import{N as T}from"./constants-DR18zFkX.js";function R(){const{projectId:n}=S(),{isMobile:a,openMobileSidebar:d}=k(),g=I(),{data:l,isLoading:b,error:u,refetch:h}=E(n),{mutateAsync:v,isPending:j}=G(),{mutateAsync:y,isPending:x}=L(),w=async s=>{var t,i;try{await v({projectId:n,unitId:s}),c({title:"Success",description:"Unit removed successfully"}),h()}catch(o){c({title:"Error",description:((i=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to delete unit",variant:"destructive"})}},C=async()=>{var s,t;try{await y({projectId:n}),c({title:"Success",description:"Selection completed successfully"})}catch(i){c({title:"Error",description:((t=(s=i==null?void 0:i.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to complete selection",variant:"destructive"})}},m=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s),N=s=>s===null?"":s.replace(/([A-Z])/g," $1").replace(/^./,t=>t.toUpperCase()).trim(),r=(l==null?void 0:l.selectedUnits)||[],U=(l==null?void 0:l.totalCost)||0,p=r.length>0;return b?e.jsxs("div",{className:"h-screen flex flex-col bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-slate-200 px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[a&&e.jsx("button",{onClick:d,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-slate-900",children:"Selected Units"})]})})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-3xl text-slate-600 mb-4"}),e.jsx("p",{className:"text-slate-600 text-lg",children:"Loading selected units..."})]})})]}):u?e.jsxs("div",{className:"h-screen flex flex-col bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-slate-200 px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[a&&e.jsx("button",{onClick:d,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-slate-900",children:"Selected Units"})]})})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-3xl text-red-500 mb-4"}),e.jsx("p",{className:"text-red-600 text-lg mb-4",children:"Failed to load selected units"}),e.jsxs(f,{onClick:()=>h(),variant:"outline",children:[e.jsx("i",{className:"fas fa-refresh mr-2"}),"Try Again"]})]})})]}):e.jsxs("div",{className:"h-screen w-full flex flex-col bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx("div",{className:"bg-white w-full shadow-sm border-b border-slate-200 px-4 py-4 flex-shrink-0",children:e.jsxs("div",{className:"flex w-full items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[a&&e.jsx("button",{onClick:d,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsxs("div",{className:"flex gap-2 items-center flex-row-reverse w-70 justify-between sm:flex-row sm:justify-start",children:[e.jsxs("div",{onClick:()=>g(-1),className:"flex bg-gray-200  cursor-pointer rounded-full items-center gap-2 backdrop-blur-sm px-4 py-2 ",children:[e.jsx("i",{className:"fas fa-arrow-left text-sm"}),e.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-slate-900",children:"Selected Units"}),e.jsx("div",{className:"flex items-center space-x-4 mt-1",children:!a&&e.jsxs(O,{variant:"secondary",className:"text-xs px-2 py-1 ",children:[e.jsx("i",{className:"fas fa-cube mr-1"}),r.length," ",r.length===1?"Unit":"Units"]})})]})]})]}),e.jsxs("div",{className:"flex items-center  justify-between sm:justify-center space-x-4 w-full sm:w-fit",children:[e.jsxs("div",{className:"text-left sm:text-right",children:[e.jsx("p",{className:"text-sm text-slate-600",children:"Total Cost"}),e.jsx("p",{className:"text-xl md:text-2xl font-bold text-green-600",children:m(U)})]}),e.jsx(f,{isLoading:x,onClick:C,disabled:x||!p,className:"px-4 md:px-6 bg-green-600 hover:bg-green-700 text-white",children:x?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),a?"...":"Completing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-check-circle mr-2"}),a?"Generate":"Generate Bill"]})})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:e.jsx("div",{className:"p-4 md:p-6",children:e.jsx("div",{className:"max-w-full mx-auto",children:p?e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-4",children:r.map((s,t)=>e.jsxs(F,{className:"hover:shadow-lg transition-shadow duration-300 overflow-hidden",children:[e.jsxs("div",{className:"relative h-48 bg-gray-100",children:[e.jsx("img",{src:s.image||T,alt:N(s.category),className:"w-full h-full  "}),e.jsx(f,{isLoading:j,onClick:()=>w(s.unitId.toString()),disabled:j,variant:"ghost",size:"sm",className:"absolute top-2 right-2 bg-white/90 hover:bg-white text-red-500 hover:text-red-700 shadow-sm",children:e.jsx("i",{className:"fas fa-trash text-sm"})})]}),e.jsx(B,{className:"pb-2",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(M,{className:"text-base md:text-lg font-semibold text-slate-900 truncate",children:N(s==null?void 0:s.unitName)}),e.jsxs("p",{className:"text-xs text-slate-500 truncate",children:[e.jsx("i",{className:"fas fa-hashtag text-gray-500 text-xs "})," ",s==null?void 0:s.customId]})]})})}),e.jsx(A,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Quantity:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"fas fa-shopping-cart text-slate-400 text-xs"}),e.jsx("span",{className:"font-semibold text-slate-900",children:s.quantity})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Unit Cost:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"fas fa-rupee-sign text-slate-400 text-xs"}),e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:m(s.singleUnitCost)})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-slate-200",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Total:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"fas fa-calculator text-green-500 text-xs"}),e.jsx("span",{className:"font-bold text-green-600 text-sm",children:m(s.quantity*s.singleUnitCost)})]})]})]})})]},`${s.unitId}-${t}`))})}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-slate-100 rounded-full mb-6",children:e.jsx("i",{className:"fas fa-cube text-3xl text-slate-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"No Units Selected"}),e.jsx("p",{className:"text-slate-600 mb-6 max-w-md mx-auto",children:"You haven't selected any modular units yet. Start by adding units to your project."})]})})})})]})}export{R as default};
