import{b as A,r as o,j as e,e as S}from"./index-CVfwS1G2.js";import{e as P}from"./paymentConfirmationApi-3KSN5h-4.js";import{t as l}from"./toast-BSC5QTk1.js";import{B as f}from"./Button-BgglITRW.js";import{C as m}from"./constants-Dsaf8__L.js";import"./useQuery-BBoMICzh.js";import"./useMutation-DuqS-NT9.js";import"./roleCheck-DROzFqxW.js";const T=()=>{var u,p;const{projectId:c,token:d}=A(),[x,b]=o.useState(""),[i,g]=o.useState(!1),[y,j]=o.useState(!0),{mutateAsync:w,isPending:N,isError:v,error:a}=P();if(v)return e.jsxs("div",{className:"max-w-xl mx-auto p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center mb-6",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500 text-sm mb-4",children:((p=(u=a==null?void 0:a.response)==null?void 0:u.data)==null?void 0:p.message)||(a==null?void 0:a.message)||"Failed to load cost estimation data"}),e.jsx(f,{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]});const C=async()=>{var t,n,r,h;try{const{data:s}=await S.get(`https://houseofram.in/api/paymentconfirmation/getpaymentconfirmation/${c}`);b(((n=(t=s==null?void 0:s.data)==null?void 0:t.paymentClientConsent)==null?void 0:n.content)||"")}catch(s){l({title:"Error",description:((h=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:h.message)||"Unable to fetch consent form.",variant:"destructive"})}finally{j(!1)}},k=async()=>{var t,n;if(!(!c||!d))try{await w({projectId:c,token:d}),l({title:"Thank you!",description:"Your consent has been submitted successfully."})}catch(r){l({title:"Error",description:((n=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:n.message)||"Submission failed.",variant:"destructive"})}};return o.useEffect(()=>{C()},[]),e.jsxs("div",{className:"min-h-screen flex flex-col items-center bg-gray-50 pb-10 ",children:[e.jsx("header",{className:"w-full max-w-full mx-auto border-b border-gray-200 bg-white px-4 py-4 mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap justify-start border-black md:justify-start text-center md:text-left",children:[e.jsx("img",{src:m.COMPANY_LOGO,alt:"Company Logo",className:"h-14 w-14 rounded-md object-cover   border-gray-300"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-extrabold text-blue-700 leading-tight",children:m.COMPANY_NAME}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-gray-500 font-medium",children:"Secure Payment Consent Form"})]})]})}),e.jsxs("div",{className:"w-full bg-white p-4 max-w-3xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-5 bg-white max-h-[500px] rounded-md border-2 border-[#4e51543a] custom-scrollbar  overflow-y-auto ",children:y?e.jsx("p",{className:"text-gray-600",children:"Loading form content..."}):x?e.jsx("div",{className:"prose prose-sm sm:prose max-w-none",dangerouslySetInnerHTML:{__html:x}}):e.jsx("p",{className:"text-red-500 text-sm",children:"Content not found."})}),e.jsxs("div",{className:"px-5 py-4 bg-white flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("label",{className:"flex items-start gap-2 text-sm text-gray-700 cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",onChange:t=>g(t.target.checked),checked:i,className:"mt-1 w-4 h-4 accent-blue-600"}),"I confirm that I have read, understood, and accept the above terms."]}),e.jsxs(f,{disabled:!i,isLoading:N,onClick:k,className:`px-6 py-2 text-white ${i?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:[e.jsx("i",{className:"fa-solid fa-circle-check mr-2"}),"Submit Consent"]})]})]}),e.jsxs("footer",{className:"mt-10 w-full text-center text-sm text-gray-500 border-t border-black/70 px-4",children:[e.jsxs("div",{className:"mb-1 font-medium text-gray-600",children:["© ",new Date().getFullYear()," ",m.COMPANY_NAME]}),e.jsx("div",{className:"text-xs",children:"All rights reserved. For queries, contact our team."})]})]})};export{T as default};
