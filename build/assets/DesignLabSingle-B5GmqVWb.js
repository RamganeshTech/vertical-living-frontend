import{a as D,j as t}from"./index-Duiduteo.js";import{a as v,b}from"./designLabApi-BFjg_u4P.js";import{D as x}from"./DesignLabForm-CEY1Iz7y.js";import{t as m}from"./toast-BSC5QTk1.js";import L from"./MaterialOverviewLoading-TJ-ituV7.js";import"./useQuery-C2l_NFV4.js";import"./useMutation-BNs_TkNH.js";import"./useInfiniteQuery-BEsLEhdS.js";import"./roleCheck-CeVvsM7Q.js";import"./Button-DF5tm_KZ.js";import"./Skeleton-bh-hi-We.js";const M=()=>{const{id:i,organizationId:p}=D(),{data:s,isLoading:c,refetch:r}=v(i),{mutateAsync:l,isPending:u}=b(),g=async f=>{try{const{_id:n,createdAt:j,updatedAt:y,newRefFiles:I,referenceImages:h,...a}=f;a.components=a.components.map(o=>({...o,materials:o.materials.filter(e=>{var d;return((d=e.materialName)==null?void 0:d.trim())||e.rate!==""&&e.rate!==0}).map(e=>({...e,vendorId:e.vendorId===""?null:e.vendorId,image:e.image||null}))})),await l({id:i,updateData:a}),m({title:"Success",description:"Design updated successfully"}),r()}catch(n){m({title:"Error",description:n.message||"Failed to update design",variant:"destructive"})}};return c?t.jsx("div",{className:"",children:t.jsx(L,{})}):s?t.jsx(x,{mode:"edit",organizationId:p,initialData:s,onSubmit:g,isLoading:u,onReset:()=>r()}):t.jsx("div",{children:"Design not found"})};export{M as default};
