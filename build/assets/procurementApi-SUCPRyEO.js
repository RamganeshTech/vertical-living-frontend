import{b as m,f as s,h as c,s as a,i,c as l}from"./index-BAM0eJUz.js";import{u as w}from"./useInfiniteQuery-BGz0VllC.js";const y=async({id:e,payload:r,api:t})=>{const{data:n}=await t.put(`/department/procurement/updateshop/${e}`,r);if(!n.ok)throw new Error(n.message);return n.data},f=async({payload:e,api:r})=>{const{data:t}=await r.post("/department/procurement/create",e);if(!t.ok)throw new Error(t.message);return t.data},h=async({projectId:e,api:r})=>{const{data:t}=await r.get(`/department/procurement/getordermaterial/fromdeptnumbers/${e}`);if(!t.ok)throw new Error(t.message);return t.data},P=async({id:e,payload:r,api:t})=>{const{data:n}=await t.put(`/department/procurement/updatedelivery/${e}`,r);if(!n.ok)throw new Error(n.message);return n.data},g=async({id:e,api:r})=>{const{data:t}=await r.delete(`/department/procurement/deleteprocurement/${e}`);if(!t.ok)throw new Error(t.message);return t.data},E=async({organizationId:e,api:r,pageParam:t=1,filters:n})=>{const o=new URLSearchParams;o.append("organizationId",e),o.append("page",t.toString()),o.append("limit","10"),n&&(n.projectId&&o.append("projectId",n.projectId),n.search&&o.append("search",n.search),typeof n.isSyncWithPaymentsSection=="boolean"&&o.append("isSyncWithPaymentsSection",String(n.isSyncWithPaymentsSection)),typeof n.isConfirmedRate=="boolean"&&o.append("isConfirmedRate",String(n.isConfirmedRate)),n.minAmount!==void 0&&o.append("minAmount",String(n.minAmount)),n.maxAmount!==void 0&&o.append("maxAmount",String(n.maxAmount)),n.fromDate&&o.append("fromDate",n.fromDate),n.toDate&&o.append("toDate",n.toDate));const{data:d}=await r.get(`/department/procurement/getprocurementall?${o.toString()}`);if(!d.ok)throw new Error(d.message);return d.data},S=async({id:e})=>{const{data:r}=await l.get(`https://houseofram.in/api/department/procurement/getprocurementsingle/${e}`);if(!r.ok)throw new Error(r.message);return r.data},q=async({id:e,api:r})=>{const{data:t}=await r.patch(`/department/procurement/generatepdf/${e}`);if(!t.ok)throw new Error(t.message);return t.data},A=async(e,r,t)=>{const{data:n}=await t.delete(`/department/procurement/deletepdf/${e}/${r}`);if(!n.ok)throw new Error(n.message);return n.data},v=async(e,r)=>{const{data:t}=await r.post(`/department/procurement/synclogistics/${e}`);if(!t.ok)throw new Error(t.message);return t.data},$=async({id:e,api:r})=>{const{data:t}=await r.post(`/department/procurement/synctopayments/${e}`);if(!t.ok)throw new Error(t.message);return t.data},I=async({id:e,quoteId:r,api:t})=>{const{data:n}=await t.put(`/department/procurement/confirmquote/${e}/${r}`);if(!n.ok)throw new Error(n.message);return n.data},b=async({id:e,api:r})=>{const{data:t}=await r.post(`/department/procurement/cancelautomation/${e}`);if(!t.ok)throw new Error(t.message);return t.data},p="https://houseofram.in/api/department/procurement",K=async({orderId:e,token:r,quoteId:t})=>{const{data:n}=await l.get(`${p}/public/get?token=${r}&orderId=${e}&quoteId=${t}`);if(!n.ok)throw new Error(n.message);return n.data},Q=async({orderId:e,itemId:r,token:t,quoteId:n,rate:o})=>{const{data:d}=await l.put(`${p}/v1/public/item/update?token=${t}&orderId=${e}&itemId=${r}&quoteId=${n}`,{rate:o});if(!d.ok)throw new Error(d.message);return d.data},u=["owner","CTO","staff"],F=()=>{const{role:e}=s(),r=i(e);return c({mutationFn:async({id:t,payload:n})=>{if(!e||!u.includes(e))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await y({id:t,payload:n,api:r})},onSuccess:(t,{id:n})=>{a.invalidateQueries({queryKey:["procurement","details"]}),a.invalidateQueries({queryKey:["procurement","single",n]})}})},N=()=>{const{role:e}=s(),r=i(e);return c({mutationFn:async({id:t,payload:n})=>{if(!e||!u.includes(e))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await P({id:t,payload:n,api:r})},onSuccess:(t,{id:n})=>{a.invalidateQueries({queryKey:["procurement","details"]}),a.invalidateQueries({queryKey:["procurement","single",n]})}})},R=()=>{const{role:e}=s(),r=i(e);return c({mutationFn:async({payload:t})=>{if(!e||!u.includes(e))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await f({payload:t,api:r})},onSuccess:()=>{a.invalidateQueries({queryKey:["procurement","details"]})}})},C=e=>{const{role:r}=s(),t=i(r);return m({queryKey:["ordermaterial","refId",e],queryFn:async()=>{if(!r||!u.includes(r))throw new Error("Not allowed");if(!t)throw new Error("API instance not found for role");return await h({api:t,projectId:e})},enabled:!!e&&!!r&&!!t})},x=()=>{const{role:e}=s(),r=i(e);return c({mutationFn:async({id:t})=>{if(!e||!u.includes(e))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await g({id:t,api:r})},onSuccess:()=>{a.invalidateQueries({queryKey:["procurement","details"]})}})},O=(e,r)=>{const{role:t}=s(),n=i(t);return w({queryKey:["procurement","infinite",e,r],queryFn:async({pageParam:o=1})=>{if(!t||!u.includes(t))throw new Error("Not allowed");if(!n)throw new Error("API instance not found for role");return await E({organizationId:e,api:n,pageParam:o,filters:r})},getNextPageParam:o=>{if(o.hasNextPage)return o.currentPage+1},initialPageParam:1,enabled:!!e&&!!t&&!!n})},U=e=>m({queryKey:["procurement","single",e],queryFn:async()=>await S({id:e}),enabled:!!e,refetchOnMount:!0}),G=()=>{const e=["owner","staff","CTO"],{role:r}=s(),t=i(r);return c({mutationFn:async({id:n})=>{if(!r||!e.includes(r))throw new Error("not allowed to make this api call");if(!t)throw new Error("API instance missing");return await q({id:n,api:t})},onSuccess:(n,{id:o})=>{a.invalidateQueries({queryKey:["procurement","details"]}),a.invalidateQueries({queryKey:["procurement","single",o]})}})},L=()=>{const{role:e}=s(),r=i(e);return c({mutationFn:async({id:t,pdfId:n})=>{if(!e||!u.includes(e))throw new Error("Youre not allowed to delete pdf");if(!r)throw new Error("API instance not available");return await A(t,n,r)},onSuccess:(t,{id:n})=>{a.invalidateQueries({queryKey:["procurement","details"]}),a.invalidateQueries({queryKey:["procurement","single",n]})}})},T=()=>{const{role:e}=s(),r=i(e);return c({mutationFn:async({id:t})=>{if(!e||!u.includes(e))throw new Error("Youre not allowed to delete pdf");if(!r)throw new Error("API instance not available");return await v(t,r)},onSuccess:()=>{a.invalidateQueries({queryKey:["procurement","details"]}),a.invalidateQueries({queryKey:["logistics","shipments"]})}})},_=()=>{const e=["owner","staff","CTO"],{role:r}=s(),t=i(r);return c({mutationFn:async({id:n})=>{if(!r||!e.includes(r))throw new Error("Unauthorized");if(!t)throw new Error("API instance not found for role");return await $({id:n,api:t})},onSuccess:()=>{a.invalidateQueries({queryKey:["bills"]})}})},M=()=>{const{role:e}=s(),r=i(e);return c({mutationFn:async({id:t,quoteId:n})=>{if(!e||!u.includes(e))throw new Error("Access Denied: Unauthorized role");if(!r)throw new Error("API instance not found for current role");return await I({id:t,quoteId:n,api:r})},onSuccess:(t,{id:n})=>{a.invalidateQueries({queryKey:["procurement","details"]}),a.invalidateQueries({queryKey:["procurement","single",n]})}})},W=()=>{const e=["owner","staff","CTO"],{role:r}=s(),t=i(r);return c({mutationFn:async({id:n})=>{if(!r||!e.includes(r))throw new Error("Unauthorized");if(!t)throw new Error("API instance not found for role");return await b({id:n,api:t})},onSuccess:()=>{a.invalidateQueries({queryKey:["bills"]})}})},j=(e,r,t)=>m({queryKey:["procurement","public",e],queryFn:async()=>await K({token:e,orderId:r,quoteId:t}),enabled:!!e,retry:!1}),z=()=>c({mutationFn:async({orderId:e,itemId:r,token:t,quoteId:n,rate:o})=>await Q({token:t,rate:o,orderId:e,itemId:r,quoteId:n})});export{M as a,C as b,R as c,j as d,z as e,F as f,N as g,G as h,L as i,_ as j,T as k,W as l,O as m,x as n,U as u};
