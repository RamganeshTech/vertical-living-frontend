import{u as W,e as I,f as R,a as D,b as z,j as e,O as B,Y as F}from"./index-BZjlY-2Z.js";import{u as G,a as E,b as Y}from"./workScheduleApi-BCUV1kYi.js";import{t as v}from"./toast-BSC5QTk1.js";import{B as k}from"./Button-BGBzZFjk.js";import{A as _,S as $}from"./AssignStaff-DHSDCnbr.js";import{C as q}from"./Card-CmzT6E3j.js";import H from"./MaterialOverviewLoading-C38kMtqM.js";import{S as J}from"./StageGuide-BGPpzdDF.js";import"./roleCheck-DuKNZHKs.js";import"./useQuery-Coz1VCY2.js";import"./useMutation-BRRIqsxx.js";import"./Input-BDSEJtPI.js";import"./getAllUsersApi-CczUwJt9.js";import"./Skeleton-BnQtABYA.js";const oe=()=>{var u,f,g,h,p,b,j;const{projectId:l,organizationId:n}=W(),o=I(),{isMobile:y,openMobileSidebar:S}=R(),C=D(),{data:s,isLoading:c,refetch:i,error:t}=G(l),{mutateAsync:L,isPending:M}=E(),{mutateAsync:A,isPending:O}=Y(),P=o.pathname.includes("/workschedule")||o.pathname.includes("/dailyschedule"),T=async()=>{var w,N;try{await A({projectId:l}),v({description:"Completion status updated successfully.",title:"Success"}),C("../technicalconsultant"),i()}catch(r){v({title:"Error",description:((N=(w=r==null?void 0:r.response)==null?void 0:w.data)==null?void 0:N.message)||r.message||"Failed to update completion.",variant:"destructive"})}},{role:d,permission:a}=z(),m=d==="owner"||((u=a==null?void 0:a.workschedule)==null?void 0:u.create),x=d==="owner"||((f=a==null?void 0:a.workschedule)==null?void 0:f.create);return P?e.jsx("main",{className:"w-full h-full",children:e.jsx(B,{})}):c?e.jsx(H,{}):e.jsxs("main",{className:"w-full h-full",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-blue-600 flex items-center",children:[y&&e.jsx("button",{onClick:S,className:"mr-3 p-2 rounded-md border border-gray-200 hover:bg-gray-100",title:"Open menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsx("i",{className:"fas fa-digging mr-2"})," Work Schedule Overview"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[(m||x)&&e.jsxs(k,{isLoading:O,onClick:T,className:"bg-green-600 h-10 hover:bg-green-700 text-white w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-circle-check mr-2"}),"Mark as Complete"]}),(m||x)&&e.jsx(_,{className:"w-full sm:w-auto",stageName:"WorkMainStageScheduleModel",projectId:l,organizationId:n,currentAssignedStaff:(s==null?void 0:s.assignedTo)||null}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(J,{organizationId:n,stageName:"workschedule"})})]})]}),t?e.jsxs("div",{className:"max-w-xl mx-auto p-6 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 text-xl font-semibold mb-2",children:"⚠️ An Error Occurred"}),e.jsx("p",{className:"text-red-500 text-sm mb-4",children:((h=(g=t==null?void 0:t.response)==null?void 0:g.data)==null?void 0:h.message)||(t==null?void 0:t.message)||"Couldn't load data."}),e.jsx(k,{isLoading:c,onClick:()=>i(),className:"bg-red-600 text-white hover:bg-red-700 px-4 py-2",children:"Retry"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(q,{className:"p-4 mb-6 w-full border-l-4 border-blue-600 shadow bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-700 text-sm font-medium mb-2",children:[e.jsx("i",{className:"fa-solid fa-clock text-blue-500 text-lg"}),e.jsx("span",{children:"Stage Timings"})]}),e.jsx($,{stageName:"worktasks",completedAt:(p=s==null?void 0:s.timer)==null?void 0:p.completedAt,projectId:l,formId:s==null?void 0:s._id,deadLine:(b=s==null?void 0:s.timer)==null?void 0:b.deadLine,startedAt:(j=s==null?void 0:s.timer)==null?void 0:j.startedAt,refetchStageMutate:i,deadLineMutate:L,isPending:M})]}),e.jsx("div",{className:"w-full mb-8",children:e.jsx(F,{to:`dailyschedule/${s==null?void 0:s.dailyScheduleId}`,className:"w-full block bg-gradient-to-r from-slate-50 to-gray-50 hover:from-slate-100 hover:to-gray-100 border border-gray-200 hover:border-gray-300 rounded-lg transition-all duration-200 shadow-sm hover:shadow-md group",children:e.jsxs("div",{className:"flex items-center justify-between p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"flex-shrink-0 w-16 h-16 bg-blue-600 rounded-xl flex items-center justify-center group-hover:bg-blue-700 transition-colors",children:e.jsx("i",{className:"fas fa-calendar-check text-white text-2xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-900 mb-2 group-hover:text-blue-700 transition-colors",children:"Daily Task Planner"}),e.jsx("p",{className:"text-gray-600 text-sm md:text-base leading-relaxed",children:"Organize and track your daily activities with comprehensive progress reports and task management."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:[e.jsx("i",{className:"fas fa-tasks text-xs"}),"Task Tracking"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[e.jsx("i",{className:"fas fa-chart-line text-xs"}),"Progress Reports"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-700 text-xs font-medium rounded-full",children:[e.jsx("i",{className:"fas fa-calendar-alt text-xs"}),"Date Planning"]})]})]})]}),e.jsx("div",{className:"flex-shrink-0 ml-4",children:e.jsx("i",{className:"fas fa-arrow-right text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all text-xl"})})]})})})]})]})};export{oe as default};
