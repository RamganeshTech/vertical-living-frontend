import{u as O,p as T,r as W,b as U,j as e,B as r,I as _,aw as d,t as n}from"./index-hYGmCEO1.js";import{C as I,b as L,d as S,a as k}from"./Card-ChYAICVg.js";import{B as D}from"./Badge-V8H1e5s5.js";import{A as H,a as K}from"./Avatar-BR4q_n48.js";import{L as Y}from"./Label-hkBviWcw.js";import{j as q,k as J,l as Q}from"./orgApi-n1OGZxBG.js";import{S as V}from"./StageGuide-BKWoPeLK.js";function re(){var N,y,w,C;const{projectId:m,organizationId:x}=O(),{openMobileSidebar:A,isMobile:R}=T(),[c,g]=W.useState(""),[E,p]=W.useState(!1),{data:i,isLoading:F}=q(m||""),h=J(),b=Q(),{role:o,permission:t}=U(),G=o==="owner"||((N=t==null?void 0:t.inviteworker)==null?void 0:N.delete),$=o==="owner"||((y=t==null?void 0:t.inviteworker)==null?void 0:y.list),f=o==="owner"||((w=t==null?void 0:t.inviteworker)==null?void 0:w.create),u=o==="owner"||((C=t==null?void 0:t.inviteworker)==null?void 0:C.edit),j=async()=>{var s,l;try{const a=await h.mutateAsync({projectId:m||"",role:"worker",organizationId:x});g((a==null?void 0:a.inviteLink)||a),n({title:"Success",description:"Worker invitation link generated successfully"})}catch(a){n({title:"Error",description:((l=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:l.message)||(a==null?void 0:a.message)||"Failed to generate invitation link",variant:"destructive"})}},v=async()=>{try{await navigator.clipboard.writeText(c),p(!0),n({title:"Success",description:"Link copied to clipboard"}),setTimeout(()=>p(!1),2e3)}catch{n({title:"Error",description:"Failed to copy link",variant:"destructive"})}},B=()=>{const s=`You're invited to work with us Click this link to join: ${c}`,l=`https://wa.me/?text=${encodeURIComponent(s)}`;window.open(l,"_blank")},P=async(s,l)=>{if(window.confirm(`Are you sure you want to remove ${l} from this project?`))try{await b.mutateAsync({workerId:s,orgId:x,projectId:m||""}),n({title:"Success",description:`${l} has been removed from the project`})}catch(a){n({title:"Error",description:a.message||"Failed to remove worker",variant:"destructive"})}},z=s=>s?s.split(" ").map(l=>l[0]).join("").toUpperCase():"WK",M=s=>({carpenter:"bg-amber-100 text-amber-800 border-amber-200",plumber:"bg-blue-100 text-blue-800 border-blue-200",electrician:"bg-yellow-100 text-yellow-800 border-yellow-200",painter:"bg-green-100 text-green-800 border-green-200",mason:"bg-gray-100 text-gray-800 border-gray-200",welder:"bg-red-100 text-red-800 border-red-200"})[s.toLowerCase()]||"bg-purple-100 text-purple-800 border-purple-200";return e.jsxs("div",{className:"max-h-full h-full  sm:overflow-y-hidden custom-scrollbar",children:[e.jsx("div",{className:"bg-white ",children:e.jsx("div",{className:"max-w-full mx-auto  py-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 min-w-0 flex-1",children:[R&&e.jsx("button",{onClick:A,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars "})}),e.jsx("div",{className:"hidden sm:block w-px bg-gray-300 flex-shrink-0"}),e.jsx("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:e.jsx("div",{className:"min-w-0 flex-1",children:e.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-blue-600 truncate",children:[e.jsx("i",{className:"fas fa-user-plus mr-1"}),"Invite Workers"]})})})]}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(V,{organizationId:x,stageName:"inviteworker"})})]})})}),e.jsx("div",{className:"max-w-full !h-[100%]  overflow-y-auto custom-scrollbar mx-auto p-2",children:e.jsxs("div",{className:"grid grid-cols-1 h-full lg:grid-cols-3 gap-6 lg:gap-8 w-full ",children:[e.jsx("div",{className:"lg:col-span-1 h-fit space-y-6",children:e.jsxs(I,{className:"bg-white backdrop-blur-sm rounded-2xl shadow-md border-l-4 border-green-600 ",children:[e.jsx(L,{children:e.jsxs(S,{className:"text-gray-800 flex items-center text-lg",children:[e.jsx("i",{className:"fas fa-user-plus mr-2 text-green-600"}),"Invite Workers"]})}),e.jsx(k,{className:"space-y-4",children:c?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"text-gray-700 font-medium",children:"Invitation Link"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(_,{value:c,readOnly:!0,className:"border-green-200 bg-green-50 text-sm flex-1 min-w-0"}),e.jsx(r,{onClick:v,variant:"outline",size:"icon",className:"border-green-200 text-green-600 hover:bg-green-50 rounded-xl flex-shrink-0",children:e.jsx("i",{className:`fas ${E?"fa-check":"fa-copy"}`})})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs(r,{onClick:v,variant:"outline",className:"w-full border-green-200 text-green-600 hover:bg-green-50 rounded-xl",children:[e.jsx("i",{className:"fas fa-copy mr-2"}),"Copy Link"]}),e.jsxs(r,{onClick:B,className:"w-full bg-green-600 hover:bg-green-700 text-white rounded-xl",children:[e.jsx("i",{className:"fab fa-whatsapp mr-2"}),"Share on WhatsApp"]}),(f||u)&&e.jsxs(r,{onClick:()=>{g("")},variant:"outline",className:"w-full border-blue-200 text-blue-600 hover:bg-blue-50 rounded-xl",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Generate Another"]})]})]}):e.jsx(e.Fragment,{children:(f||u)&&e.jsxs(r,{onClick:j,isLoading:h.isPending,className:"w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-xl",children:[e.jsx("i",{className:"fas fa-link mr-2"}),h.isPending?"Generating...":"Generate Invitation Link"]})})})]})}),$&&e.jsx("div",{className:"lg:col-span-2 sm:max-h-[43%] lg:!max-h-[90%] rounded-2xl border-l-4 border-orange-600  overflow-y-auto custom-scrollbar",children:e.jsxs(I,{className:"bg-white/70 backdrop-blur-sm border-0  !shadow-none",children:[e.jsx(L,{children:e.jsx(S,{className:"text-gray-800 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-hard-hat mr-2 text-orange-600"}),e.jsxs("span",{className:"text-lg",children:["Project Workers (",(i==null?void 0:i.length)||0,")"]})]})})}),e.jsx(k,{children:F?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsxs("div",{className:"flex items-center space-x-4 p-4 border border-blue-100 rounded-xl",children:[e.jsx(d,{className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(d,{className:"h-4 w-32"}),e.jsx(d,{className:"h-3 w-48"})]}),e.jsx(d,{className:"h-8 w-20"})]},s))}):i&&i.length>0?e.jsx("div",{className:"space-y-4  ",children:i.map(s=>e.jsxs("div",{className:"flex flex-col shadow-md sm:flex-row sm:items-center sm:justify-between p-4 border border-blue-100 rounded-xl hover:bg-blue-50/50 transition-all duration-200 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 min-w-0 flex-1",children:[e.jsx(H,{className:"w-12 h-12 border-2 border-blue-200 flex-shrink-0",children:e.jsx(K,{className:"bg-gradient-to-br from-orange-500 to-red-600 text-white font-semibold",children:z(s==null?void 0:s.workerName)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800 truncate",children:(s==null?void 0:s.workerName)||(s==null?void 0:s.name)}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 text-sm text-gray-600 gap-1 sm:gap-0",children:[s.email&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("i",{className:"fas fa-envelope text-xs"}),e.jsx("span",{className:"truncate",children:s.email})]}),s.phoneNo&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("i",{className:"fas fa-phone text-xs"}),e.jsx("span",{children:s.phoneNo})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs(D,{className:`text-xs ${M((s==null?void 0:s.specifiedRole)||(s==null?void 0:s.role)||"worker")}`,children:[e.jsx("i",{className:"fas fa-tools mr-1"}),(s==null?void 0:s.specifiedRole)||(s==null?void 0:s.role)||"Worker"]})})]})]}),G&&e.jsxs(r,{onClick:()=>P(s._id,(s==null?void 0:s.workerName)||(s==null?void 0:s.name)),variant:"danger",size:"sm",className:"text-red-600 border-red-200 hover:bg-red-50 rounded-xl w-full sm:w-auto",isLoading:b.isPending,children:[e.jsx("i",{className:"fas fa-user-minus mr-1"}),"Remove"]})]},s._id))}):e.jsxs("div",{className:"text-center py-12 min-h-[100vh]",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-100 to-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fas fa-hard-hat text-orange-500 text-2xl"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Workers Assigned"}),e.jsx("p",{className:"text-gray-600 mb-6 text-sm sm:text-base",children:"Start building your team by inviting skilled workers to this project"}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center mb-6"}),(f||u)&&e.jsxs(r,{onClick:()=>{j()},className:"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 text-white rounded-xl",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Invite First Worker"]})]})})]})})]})})]})}export{re as default};
