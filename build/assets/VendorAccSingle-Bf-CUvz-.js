import{b as P,u as A,r as u,j as e}from"./index-CDrefmTi.js";import{t as r}from"./toast-BSC5QTk1.js";import{B as c}from"./Button-DSSReI3J.js";import{C as U}from"./Card-CdzBsyOK.js";import{d as B}from"./dateFormator-BGKi5rfZ.js";import M from"./MaterialOverviewLoading-CjkM061A.js";import{c as S,d as T,e as G}from"./vendorAccApi-CSf9YslD.js";import{V as I}from"./VendorAccountForm-DPSh-z_Y.js";import"./Skeleton-DmrIRWoj.js";import"./useQuery-Dbv1d8R2.js";import"./useMutation-DXlA4CUQ.js";import"./useInfiniteQuery-CfZbtSpd.js";import"./roleCheck-CvMnicJf.js";const Z=()=>{var p,j,g;const{id:n}=P(),m=A(),[N,d]=u.useState(!1),[i,y]=u.useState("main"),{data:a,isLoading:v,isError:k,error:o,refetch:h}=S(n),b=T(),x=G(),[l,f]=u.useState([]),w=async s=>{try{await b.mutateAsync({vendorId:n,payload:s}),r({title:"Success",description:"Vendor updated successfully"}),d(!1),h()}catch(t){throw r({title:"Error",description:t.message||"Failed to update vendor"}),t}},D=async()=>{if(l.length===0){r({title:"Warning",description:"Please select at least one file to upload"});return}try{const s=new FormData;l.forEach(t=>{s.append("files",t)}),await x.mutateAsync({id:n,formData:s}),r({title:"Success",description:"Documents uploaded successfully"}),f([]),h()}catch(s){r({title:"Error",description:s.message||"Failed to upload documents"})}},F=s=>{s.target.files&&f(Array.from(s.target.files))},C=s=>{f(t=>t.filter((L,E)=>E!==s))};if(v)return e.jsx(M,{});if(k)return e.jsxs("div",{className:"max-w-xl mx-auto mt-8 p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2 text-xl",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500 mb-4",children:(o==null?void 0:o.message)||"Failed to load vendor"}),e.jsx(c,{onClick:()=>m(-1),children:"Go Back"})]});if(!a)return e.jsxs("div",{className:"max-w-xl mx-auto mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-yellow-600 font-semibold mb-2 text-xl",children:"Vendor Not Found"}),e.jsx(c,{onClick:()=>m(-1),children:"Go Back"})]});const V=[{id:"main",label:"Main Information",icon:"fa-user"},{id:"other",label:"Other Details",icon:"fa-info-circle"},{id:"documents",label:"Documents",icon:"fa-file-upload"}];return N?e.jsx(I,{mode:"update",initialData:a,setIsEditing:d,onSubmit:w,isSubmitting:b.isPending}):e.jsxs("div",{className:"max-w-full mx-auto max-h-full overflow-y-auto",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>m(-1),className:"bg-blue-50 hover:bg-slate-300 flex items-center justify-between w-8 h-8 border border-[#a6aab8] text-sm cursor-pointer rounded-md px-2 ",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("div",{children:e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-user mr-3 text-blue-600"}),a.firstName]})}),e.jsxs(c,{onClick:()=>d(!0),children:[e.jsx("i",{className:"fas fa-edit mr-2"}),"Edit Vendor"]})]})]}),e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:V.map(s=>e.jsxs("button",{onClick:()=>y(s.id),className:`
                                    py-4 px-1 cursor-pointer border-b-2 font-medium text-sm flex items-center gap-2
                                    ${i===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                                `,children:[e.jsx("i",{className:`fas ${s.icon}`}),s.label]},s.id))})})}),e.jsx(U,{children:e.jsxs("div",{className:"p-6",children:[i==="main"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-user mr-2 text-blue-600"}),"Main Information"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vendor Type"}),e.jsxs("p",{className:"text-gray-900 flex items-center",children:[e.jsx("i",{className:`fas ${a.vendorType==="business"?"fa-building":"fa-user"} mr-2 text-blue-600`}),a.vendorType==="business"?"Business":"Individual"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),e.jsx("p",{className:"text-gray-900",children:a.firstName||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),e.jsx("p",{className:"text-gray-900",children:a.lastName||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name"}),e.jsx("p",{className:"text-gray-900",children:a.companyName||"-"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-envelope mr-2 text-gray-400"}),"Email"]}),e.jsx("p",{className:"text-gray-900",children:a.email||"-"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-mobile-alt mr-2 text-gray-400"}),"Mobile Number"]}),e.jsx("p",{className:"text-gray-900",children:((p=a.phone)==null?void 0:p.mobile)||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-phone mr-2 text-gray-400"}),"Work Number"]}),e.jsx("p",{className:"text-gray-900",children:((j=a.phone)==null?void 0:j.work)||"-"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-language mr-2 text-gray-400"}),"Vendor Language"]}),e.jsx("p",{className:"text-gray-900",children:a.vendorLanguage||"-"})]})]}),i==="other"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-info-circle mr-2 text-blue-600"}),"Other Details"]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-id-card mr-2 text-gray-400"}),"PAN Number"]}),e.jsx("p",{className:"text-gray-900",children:a.pan||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-dollar-sign mr-2 text-gray-400"}),"Currency"]}),e.jsx("p",{className:"text-gray-900",children:a.currency||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-receipt mr-2 text-gray-400"}),"Accounts Receivable"]}),e.jsx("p",{className:"text-gray-900",children:a.accountsReceivable||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-wallet mr-2 text-gray-400"}),"Opening Balance"]}),e.jsxs("p",{className:"text-gray-900",children:[((g=a.currency)==null?void 0:g.split("-")[0].trim())||"INR"," ",a.openingBalance||0]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-calendar-check mr-2 text-gray-400"}),"Payment Terms"]}),e.jsx("p",{className:"text-gray-900",children:a.paymentTerms||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-portal-enter mr-2 text-gray-400"}),"Vendor Portal Access"]}),e.jsx("p",{className:"text-gray-900",children:a.enablePortal?e.jsxs("span",{className:"text-green-600",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),"Enabled"]}):e.jsxs("span",{className:"text-red-600",children:[e.jsx("i",{className:"fas fa-times-circle mr-1"}),"Disabled"]})})]})]}),i==="documents"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-file-upload mr-2 text-blue-600"}),"Documents"]})}),a.documents&&a.documents.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:["Uploaded Documents (",a.documents.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.documents.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("i",{className:`fas ${s.type==="pdf"?"fa-file-pdf text-red-500":"fa-file-image text-blue-500"} text-2xl`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.originalName||"Document"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.type.toUpperCase()," • ",B(s==null?void 0:s.uploadedAt)]})]})]}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:e.jsx("i",{className:"fas fa-external-link-alt"})})]},t))})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Upload New Documents"}),e.jsxs("div",{className:"border-2 border-gray-300 rounded-lg p-6 text-center hover:border-blue-500 transition-colors cursor-pointer",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*,.pdf",onChange:F,className:"hidden",id:"file-upload-view"}),e.jsxs("label",{htmlFor:"file-upload-view",className:"cursor-pointer",children:[e.jsx("i",{className:"fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2 block"}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Click to upload"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, PNG, JPG, JPEG (MAX. 10MB per file)"})]})]}),l.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["New Files to Upload (",l.length,")"]}),e.jsx("div",{className:"space-y-2",children:l.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("i",{className:`fas ${s.type.includes("pdf")?"fa-file-pdf text-red-500":"fa-file-image text-blue-500"} text-xl`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(s.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>C(t),className:"text-red-500 hover:text-red-700",children:e.jsx("i",{className:"fas fa-times"})})]},t))}),e.jsx(c,{onClick:D,disabled:x.isPending,className:"mt-4 w-full",children:x.isPending?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Uploading Documents..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-upload mr-2"}),"Upload Documents"]})})]})]}),(!a.documents||a.documents.length===0)&&l.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"fas fa-folder-open text-4xl mb-3 block"}),e.jsx("p",{children:"No documents uploaded yet"}),e.jsx("p",{className:"text-xs mt-1",children:"Upload documents using the form above"})]})]})]})})]})};export{Z as default};
