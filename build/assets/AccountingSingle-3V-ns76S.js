import{u as C,b as D,r as h,j as e}from"./index-4xXsHyrq.js";import{C as w,c as S}from"./Card-CJaK8Drj.js";import{B as m}from"./Button-BmD7QJLN.js";import{I as o}from"./Input-Dg780vof.js";import{b as I,c as k}from"./accountingApi-DHbRr4CS.js";import{t as j}from"./toast-BSC5QTk1.js";import E from"./MaterialOverviewLoading-CX4w9Avf.js";import"./useQuery-CnKlDwE3.js";import"./useMutation-DAR9sTyS.js";import"./roleCheck-DDX7kp9U.js";import"./Skeleton-CZeX8ICI.js";const q=()=>{var x,u,p,g;const{id:d}=C(),{data:t,isLoading:f}=I(d),{mutateAsync:v}=k(),y=D(),[n,r]=h.useState(t||{}),[l,c]=h.useState(!1),N=async()=>{var s,a;try{await v({id:d,payload:n}),j({title:"success",description:"shipment has generated"}),c(!1)}catch(i){j({title:"Error",description:((a=(s=i==null?void 0:i.response)==null?void 0:s.data)==null?void 0:a.message)||"Operation Failed",variant:"destructive"})}},b=()=>{var s,a;t&&r({transactionType:t.transactionType,fromDept:t.fromDept,totalAmount:{amount:((s=t.totalAmount)==null?void 0:s.amount)??0,taxAmount:((a=t.totalAmount)==null?void 0:a.taxAmount)??0},upiId:t==null?void 0:t.upiId,status:t.status,dueDate:t.dueDate?new Date(t.dueDate).toISOString().split("T")[0]:"",notes:t.notes??""})},A=()=>{l||b(),c(s=>!s)};return f?e.jsx("p",{className:"p-6",children:e.jsx(E,{})}):e.jsxs("div",{className:"p-4 max-h-full overflow-y-auto max-w-full space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 pb-4",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("div",{onClick:()=>y(-1),className:"bg-blue-50 hover:bg-slate-300 flex items-center justify-center w-8 h-8 border border-[#a6aab8] text-sm cursor-pointer rounded-md",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-blue-800",children:["Transaction: ",(t==null?void 0:t.transactionNumber)??"N/A"]})]}),!l&&e.jsxs(m,{size:"md",variant:"primary",onClick:A,children:[e.jsx("i",{className:"fas fa-edit mr-1"}),l?"Cancel":"Edit"]})]}),e.jsx(w,{children:e.jsxs(S,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Amount"}),l?e.jsx(o,{value:(x=n==null?void 0:n.totalAmount)==null?void 0:x.amount,type:"number",onChange:s=>{const a=+s.target.value;a>=0&&r(i=>({...i,totalAmount:{...i.totalAmount,amount:a||0}}))}}):e.jsxs("p",{className:"text-lg text-gray-900 font-medium",children:["₹ ",(u=t==null?void 0:t.totalAmount)==null?void 0:u.amount]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Tax"}),l?e.jsx(o,{value:(p=n==null?void 0:n.totalAmount)==null?void 0:p.taxAmount,type:"number",onChange:s=>{const a=+s.target.value;a>=0&&r(i=>({...i,totalAmount:{...i.totalAmount,taxAmount:a||0}}))}}):e.jsxs("p",{className:"text-lg text-gray-900 font-medium",children:["₹ ",(g=t==null?void 0:t.totalAmount)==null?void 0:g.taxAmount]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Upi ID"}),l?e.jsx(o,{value:n.upiId,type:"text",onChange:s=>r(a=>({...a,upiId:s.target.value}))}):e.jsx("p",{className:"text-lg text-gray-800",children:(t==null?void 0:t.upiId)||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Status"}),l?e.jsxs("select",{value:n.status,onChange:s=>r(a=>({...a,status:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}):e.jsx("p",{className:"text-sm font-medium text-blue-700 capitalize",children:t.status})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Due Date"}),l?e.jsx(o,{value:n==null?void 0:n.dueDate,type:"date",onChange:s=>r(a=>({...a,dueDate:s.target.value}))}):e.jsx("p",{className:"text-sm text-gray-800",children:t!=null&&t.dueDate?new Date(t==null?void 0:t.dueDate).toLocaleDateString():"-"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Notes"}),l?e.jsx("textarea",{className:"w-full px-3 py-2 border rounded-lg",value:n.notes||"",onChange:s=>r(a=>({...a,notes:s.target.value}))}):e.jsx("p",{className:"text-sm text-gray-800",children:t.notes||"-"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block font-medium text-gray-700",children:"From Department"}),e.jsx("span",{className:"text-gray-800 capitalize",children:(t==null?void 0:t.fromDept)||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block font-medium text-gray-700",children:"Paid At"}),e.jsx("span",{className:"text-gray-800",children:t!=null&&t.paidAt?new Date(t==null?void 0:t.paidAt).toLocaleString():"-"})]})]}),l&&e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(m,{onClick:N,children:[e.jsx("i",{className:"fas fa-save mr-1"})," Save Changes"]}),e.jsxs(m,{variant:"secondary",onClick:()=>c(!1),children:[e.jsx("i",{className:"fas fa-save mr-1"}),"  Cancel"]})]})]})})]})};export{q as default};
