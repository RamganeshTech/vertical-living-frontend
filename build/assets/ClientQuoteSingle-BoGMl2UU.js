import{u as T,a as A,r as n,R as E,j as e}from"./index-DbiIFs0V.js";import{B}from"./Button-CYhE1wjW.js";import C from"./MaterialOverviewLoading-BI6MuFHQ.js";import{t as d}from"./toast-BSC5QTk1.js";import{C as R}from"./ClientFurnitures-FI4XLcXo.js";import{a as L,b as M}from"./clientQuoteApi-DO94x1QE.js";import{L as P}from"./Label-DTqELkF7.js";import{S as k,a as Q,b as F,c as I,d as _}from"./Select-CQ1pbiEu.js";import"./Skeleton-CKd90k2j.js";import"./constants-CQazHsZc.js";import"./roleCheck-Daj0VMmM.js";import"./useQuery-BZZcyQnK.js";import"./useMutation-YUV1wh1S.js";const Z=10,q=()=>{var f;const{organizationId:m,quoteId:u}=T(),g=A(),{data:s,isLoading:h}=L(m,u),{mutateAsync:j,isPending:p}=M(),i=n.useRef([]),[c,y]=n.useState(!0),[x,N]=n.useState("type 1"),[o,b]=n.useState([]),[l,S]=n.useState((s==null?void 0:s.grandTotal)||0);n.useEffect(()=>{S(s==null?void 0:s.grandTotal)},[s]);const v=async()=>{var r,t;try{if(!m||!u||!s){d({title:"Missing info",description:"Please ensure quote and all details are not missing",variant:"destructive"});return}if(!confirm("Are you sure want to send this quotation to payment?"))return;await j({organizationId:m,id:u}),d({title:"success",description:"Quote Selected and stored in the payment stage"})}catch(a){d({title:"Error",description:((t=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:t.message)??"Operation failed"})}},w=async()=>{var r,t;try{y(a=>!a)}catch(a){d({title:"Error",description:((t=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:t.message)??"Operation failed"})}};return n.useEffect(()=>{if(!(s!=null&&s.furnitures))return;const r=s.furnitures.map(t=>({furnitureName:t.furnitureName,coreMaterials:t.coreMaterials||[],fittingsAndAccessories:t.fittingsAndAccessories||[],glues:t.glues||[],nonBrandMaterials:t.nonBrandMaterials||[],totals:{core:t.coreMaterialsTotal||0,fittings:t.fittingsAndAccessoriesTotal||0,glues:t.gluesTotal||0,nbms:t.nonBrandMaterialsTotal||0,furnitureTotal:t.furnitureTotal||0},plywoodBrand:"",laminateBrand:""}));b(r)},[s]),i.current.length!==o.length&&(i.current=o.map((r,t)=>i.current[t]??E.createRef())),n.useEffect(()=>{console.log("furnitureRefs Array",i),i.current=o.map((r,t)=>i.current[t]??n.createRef())},[o]),e.jsxs("div",{className:"p-2 max-h-full overflow-y-auto",children:[e.jsxs("header",{className:"bg-white border-b border-gray-200 pb-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("button",{onClick:()=>g(-1),className:"flex cursor-pointer items-center justify-center w-8 h-8 bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md transition-colors flex-shrink-0",children:e.jsx("i",{className:"fas fa-arrow-left text-gray-600 text-sm"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900 truncate",children:((f=s==null?void 0:s.projectId)==null?void 0:f.projectName)||"Project"}),e.jsx("p",{className:"text-md text-gray-500",children:s!=null&&s.quoteNo?`Quote: #${s==null?void 0:s.quoteNo}`:""})]})]}),e.jsxs("div",{className:"flex gap-2 justify-between  items-center",children:[e.jsxs("div",{className:"px-4 text-center",children:[e.jsx("p",{className:"text-md text-gray-600",children:"Total Cost"}),e.jsxs("p",{className:"text-md font-bold text-green-600",children:["₹",l==null?void 0:l.toLocaleString("en-in")]})]}),e.jsx(B,{onClick:v,disabled:p,className:"flex-shrink-0 px-4 ",children:p?"Sending...":"Select Quote"}),e.jsxs("div",{className:"flex gap-2 w-fit px-4 justify-center",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:w,className:"sr-only",id:"blurinput"}),e.jsx("div",{className:`w-11 h-6 rounded-full cursor-pointer transition-colors ${c?"bg-gray-200":"bg-blue-600"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow transform transition-transform ${c?"translate-x-0":"translate-x-5"} mt-0.5 ml-0.5`})})]}),e.jsx(P,{htmlFor:"blurinput",className:" cursor-pointer flex flex-4/2",children:"Show Stats"})]}),e.jsx("div",{className:"w-full",children:e.jsxs(k,{onValueChange:r=>{let t="type 1";r==="template 1"?t="type 1":r==="template 2"?t="type 2":r==="template 3"&&(t="type 3"),N(t)},children:[e.jsx(Q,{className:"w-full",children:e.jsx(F,{placeholder:"Select Template Type",selectedValue:x})}),e.jsx(I,{children:["template 1","template 2","template 3"].map(r=>e.jsx(_,{value:r.toString(),children:r},r))})]})})]})]}),e.jsx("div",{className:" grid grid-cols-4 gap-2"})]}),h?e.jsx(C,{}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-6",children:[o.map((r,t)=>e.jsx(R,{index:t,data:r,ref:i.current[t],templateType:x,isBlurred:c},t)),e.jsx("div",{className:"mt-10 text-right",children:e.jsxs("div",{className:"inline-block bg-green-50 border border-green-200 rounded-md px-6 py-4",children:[e.jsx("p",{className:"text-md font-medium text-gray-700 mb-1",children:"Total Estimate"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["₹",l==null?void 0:l.toLocaleString("en-in")]})]})})]})})]})};export{Z as DEFAULT_LAMINATE_RATE_PER_SQFT,q as default};
