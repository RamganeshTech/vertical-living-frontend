import{c as _,d as F,f as A,r as o,j as e,O as M,B as t,h as O,I as N,C as R,o as T,p as U,s as B,v as H,t as K}from"./index-C8ZngCsk.js";import{u as G,a as V,b as $,c as q}from"./commonOrderHistoryMaterialApi-CP8XcuVt.js";const X=()=>{const{organizationId:f}=_(),{openMobileSidebar:C,isMobile:v}=F(),y=A(),[c,d]=o.useState(""),[j,r]=o.useState(!1),[n,m]=o.useState(null),[x,l]=o.useState(""),{data:i,isLoading:w,error:P,refetch:h}=G(f),{mutateAsync:b,isPending:k}=V(),{mutateAsync:E,isPending:S}=$(),{mutateAsync:D,isPending:z}=q(),g=location.pathname.split("/");if(g[g.length-1]!=="commonorder")return e.jsx(M,{context:{openMobileSidebar:C,isMobile:v}});const p=async()=>{c.trim()||K({title:"Error",description:"Project Name is mandatory",variant:"destructive"});try{await b({organizationId:f,payload:{projectName:c}}),d(""),r(!1),await h()}catch(s){console.error(s)}},I=async s=>{if(window.confirm("Are you sure?"))try{await E({id:s}),await h()}catch(a){console.error(a)}},L=async()=>{if(!(!x.trim()||!n))try{await D({id:n,payload:{projectName:x}}),m(null),l(""),await h()}catch(s){console.error(s)}};return e.jsxs("div",{className:"max-w-full mx-auto p-2 space-y-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("h1",{className:"text-2xl font-bold text-blue-600",children:[e.jsx("i",{className:"fas fa-layer-group mr-2"}),"Common Projects"]}),!j&&e.jsxs(t,{variant:"primary",onClick:()=>r(!0),children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Create New Project"]})]}),j&&e.jsx("div",{onClick:()=>r(!1),className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{onClick:s=>s.stopPropagation(),className:"flex rounded-2xl bg-white flex-col p-6 gap-3 max-w-lg items-start",children:[e.jsx(O,{className:"text-2xl",children:"Create Project"}),e.jsx(N,{placeholder:"Enter project name",value:c,onChange:s=>d(s.target.value),autoFocus:!0,onKeyDown:s=>{s.key==="Enter"&&p()}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{variant:"primary",onClick:p,isLoading:k,children:[e.jsx("i",{className:"fas fa-save mr-2"}),"Save"]}),e.jsx(t,{variant:"ghost",onClick:()=>{r(!1),d("")},children:"Cancel"})]})]})}),w&&e.jsx("p",{children:"Loading projects..."}),P&&e.jsx("p",{className:"text-red-500",children:"Something went wrong while loading projects."}),(i==null?void 0:i.length)===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center text-gray-500",children:[e.jsx("i",{className:"fas fa-folder-open text-5xl text-blue-300 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold",children:"No Projects Found"}),e.jsx("p",{children:"Create a project to start managing materials more efficiently."})]}),e.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3",children:i==null?void 0:i.map(s=>{var u;return e.jsx("div",{className:"transition-transform hover:scale-[1.02] cursor-pointer",children:e.jsxs(R,{className:"shadow-md hover:shadow-lg border-l-4 border-blue-600",children:[e.jsx(T,{children:n===s._id?e.jsx(N,{value:x,onChange:a=>{l(a.target.value)},autoFocus:!0,onKeyDown:a=>{a.key},placeholder:"Edit project name"}):e.jsxs(U,{className:"line-clamp-1",children:[e.jsx("i",{className:"fas fa-project-diagram mr-2 text-blue-500"}),s.projectName||"Untitled"]})}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsx("i",{className:"fas fa-tasks mr-1 text-gray-400"}),"Order Units:"," ",e.jsx("span",{className:"font-medium text-blue-600",children:(u=s==null?void 0:s.selectedUnits)==null?void 0:u.length})]}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:n===s._id?e.jsxs(e.Fragment,{children:[e.jsxs(t,{size:"sm",variant:"primary",onClick:a=>{a.stopPropagation(),L()},isLoading:z,children:[e.jsx("i",{className:"fas fa-check mr-1"}),"Save"]}),e.jsx(t,{size:"sm",variant:"ghost",onClick:a=>{a.stopPropagation(),m(null),l("")},children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{size:"sm",variant:"outline",onClick:a=>{a.stopPropagation(),m(s._id),l(s.projectName||"")},children:[e.jsx("i",{className:"fas fa-edit mr-1 text-blue-500"}),"Edit"]}),e.jsxs(t,{size:"sm",variant:"danger",onClick:a=>{a.stopPropagation(),I(s._id)},isLoading:S,className:"hover:text-white",children:[e.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Delete"]}),e.jsxs(t,{size:"sm",variant:"secondary",onClick:a=>{a.stopPropagation(),y(`${s._id}`)},children:[e.jsx("i",{className:"fas fa-eye mr-1 text-blue-600"}),"View"]})]})})]})]})},s._id)})})]})};export{X as default};
