import{u as w}from"./useQuery-BHdcKCtG.js";import{g as i,h as c}from"./index-DmIvND9E.js";import{u as d}from"./useMutation-CAeBxy3I.js";import{u as g}from"./useInfiniteQuery-iAVIpWnU.js";import{g as u}from"./roleCheck-DZRqXPrB.js";const l="/designlab",f=async({organizationId:t,formData:n,api:e})=>{const{data:r}=await e.post(`${l}/create/${t}`,n,{headers:{"Content-Type":"multipart/form-data"}});if(!r.ok)throw new Error(r.message);return r.data},y=async({organizationId:t,pageParam:n=1,filters:e,api:r})=>{const a={organizationId:t,page:n,limit:10,...e},{data:o}=await r.get(`${l}/getall`,{params:a});if(!o.ok)throw new Error(o.message);return o.data},m=async({id:t,api:n})=>{const{data:e}=await n.get(`${l}/getsingle/${t}`);if(!e.ok)throw new Error(e.message);return e.data},p=async({id:t,formData:n,api:e})=>{const{data:r}=await e.put(`${l}/updatedesignnew/${t}`,n,{headers:{"Content-Type":"multipart/form-data"}});if(!r.ok)throw new Error(r.message);return r.data},h=async({id:t,api:n})=>{const{data:e}=await n.delete(`${l}/deletedesign/${t}`);if(!e.ok)throw new Error(e.message);return e.data},s=["owner","staff","CTO"],I=()=>{const{role:t}=i(),n=u(t),e=c();return d({mutationFn:async({organizationId:r,formData:a})=>{if(!t||!s.includes(t))throw new Error("Not allowed to make this API call");if(!n)throw new Error("API instance not found for role");return await f({organizationId:r,formData:a,api:n})},onSuccess:(r,{organizationId:a})=>{e.invalidateQueries({queryKey:["designLabs",a]})}})},q=({organizationId:t,filters:n})=>{const{role:e}=i(),r=u(e);return g({queryKey:["designLabs",t,n],queryFn:async({pageParam:a=1})=>{if(!e||!s.includes(e))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await y({organizationId:t,pageParam:a,filters:n,api:r})},initialPageParam:1,getNextPageParam:a=>a.pagination.hasNextPage?a.pagination.nextPage:void 0,enabled:!!t&&!!e&&s.includes(e)})},D=t=>{const{role:n}=i(),e=u(n);return w({queryKey:["designLab",t],queryFn:async()=>{if(!n||!s.includes(n))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await m({id:t,api:e})},enabled:!!t&&!!n&&s.includes(n)})},k=()=>{const{role:t}=i(),n=u(t),e=c(),r=["owner","staff","CTO"];return d({mutationFn:async({id:a,formData:o})=>{if(!t||!r.includes(t))throw new Error("Not allowed to make this API call");if(!n)throw new Error("API instance not found for role");return await p({id:a,formData:o,api:n})},onSuccess:(a,o)=>{e.invalidateQueries({queryKey:["designLab",o.id]}),a!=null&&a.organizationId&&e.invalidateQueries({queryKey:["designLabs",a.organizationId]}),e.invalidateQueries({queryKey:["designLabs"]})},onError:a=>{console.error("Failed to update design lab:",a)}})},C=()=>{const{role:t}=i(),n=u(t),e=c();return d({mutationFn:async r=>{if(!t||!s.includes(t))throw new Error("Not allowed to make this API call");if(!n)throw new Error("API instance not found for role");return await h({id:r,api:n})},onSuccess:()=>{e.invalidateQueries({queryKey:["designLabs"]})}})};export{D as a,k as b,q as c,C as d,I as u};
