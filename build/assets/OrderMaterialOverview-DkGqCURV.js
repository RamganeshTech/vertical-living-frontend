import{u as Pe,f as Ee,a as Le,r as b,j as e,B as p,I as j,t as m}from"./index-DCvjwNGU.js";import{C as ae,c as Ae}from"./Card-D6Sc2MI-.js";import{A as Me,S as qe}from"./AssignStaff-BckChmVR.js";import{R as Ue}from"./ResetStageButton-yyHG6Jc9.js";import{S as Oe}from"./ShareDocumentWhatsapp-ClvcSIIS.js";import Re from"./MaterialOverviewLoading-DwCp8CV2.js";import{N as Ge}from"./constants-B0HHjZgX.js";import{u as Te,a as He,b as Be,c as ze,d as Ve,e as Fe,f as Ke,g as Qe,h as Ye,i as $e}from"./orderMaterialHistoryApi-BxKnnuq3.js";import{d as We}from"./downloadFile-D54BbfBR.js";import"./getAllUsersApi-CQ55Q7DU.js";import"./documentationApi-DRaFe_FG.js";import"./requirementFormApi-CIZP8QFV.js";import"./Skeleton-C14joy6B.js";const te=["nos","pieces","litre","kg","mm","cm","meter","feet","inch","sqft","sqmm","packet","roll","sheet"],os=()=>{var H,B,z,V,F,K,Q,Y,$,W,J,X,Z,ee,se;const{projectId:x,organizationId:re}=Pe(),{isMobile:le,openMobileSidebar:ie}=Ee(),ne=Le(),{data:a,isLoading:O,isError:A,error:C,refetch:y}=Te(x),{mutateAsync:de,isPending:R}=He(),{mutateAsync:ce}=Be(),{mutateAsync:oe,isPending:G}=ze(),{mutateAsync:me}=Ve(),{mutateAsync:xe,isPending:ue}=Fe(),{mutateAsync:he,isPending:pe}=Ke(),{mutateAsync:ge}=Qe(),{mutateAsync:fe,isPending:be}=Ye(),{mutateAsync:Ne}=$e(),[je,M]=b.useState(!1),[i,S]=b.useState({}),[ve,P]=b.useState(!1),[o,_]=b.useState({}),[E,ye]=b.useState(null),[d,g]=b.useState(null),[N,L]=b.useState({}),I=b.useRef(null),we=async()=>{var s,n;try{await he({projectId:x}),m({description:"Completion status updated successfully",title:"Success"}),ne("../materialarrival")}catch(t){m({title:"Error",description:((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.message)||t.message||"Failed to update completion status",variant:"destructive"})}},Se=async()=>{var s,n;try{if(i!=null&&i.phoneNumber&&!/^\d{10}$/.test(i==null?void 0:i.phoneNumber.trim()))throw new Error("Phone number should contain exactly 10 digit numbers");await ge({projectId:x,updates:i}),M(!1),m({title:"Success",description:"Delivery Details Updated"}),y()}catch(t){m({variant:"destructive",title:"Error",description:((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.message)||(t==null?void 0:t.message)||"Update failed"})}},_e=async()=>{var s,n;try{if(o.phoneNumber&&!/^\d{10}$/.test(o.phoneNumber.trim()))throw new Error("Phone number should contain exactly 10 digit numbers");await Ne({projectId:x,updates:o}),m({title:"Success",description:"Shop Details Updated"}),P(!1),y()}catch(t){m({variant:"destructive",title:"Error",description:((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.message)||(t==null?void 0:t.message)||"Update failed"})}},Ie=async s=>{var n,t;try{await fe({projectId:x,pdfId:s}),m({title:"Success",description:"PDF deleted"}),P(!1),y()}catch(c){m({variant:"destructive",title:"Error",description:((t=(n=c==null?void 0:c.response)==null?void 0:n.data)==null?void 0:t.message)||(c==null?void 0:c.message)||"failed to delete"})}},q=(a==null?void 0:a.selectedUnits)||[],ke=(a==null?void 0:a.totalCost)||0,T=q.length>0;b.useEffect(()=>{d&&I.current&&(I.current.focus(),I.current.select())},[d]);const k=async(s,n,t,c)=>{var u,h,D;try{const f=q.find(l=>l._id===s),v=(u=f==null?void 0:f.subItems)==null?void 0:u.find(l=>l._id===n);if(!v)return;const r={projectId:x,unitId:s,subItemId:n,subItemName:t==="name"?c:v.subItemName,quantity:t==="quantity"?Number(c)?Number(c):1:v.quantity,unit:t==="unit"?c:v.unit};await me(r),m({title:"Success",description:"Item updated successfully"})}catch(f){m({title:"Error",description:((D=(h=f==null?void 0:f.response)==null?void 0:h.data)==null?void 0:D.message)||"Failed to update item",variant:"destructive"})}},U=async(s,n)=>{var c,u;const t=n;if(!t&&!(t!=null&&t.name.trim()))return m({title:"Error",description:"Material Name is mandatory",variant:"destructive"});try{await ce({projectId:x,unitId:s,subItemName:t.name,quantity:t.quantity??1,unit:t.unit}),L(h=>({...h,[s]:{name:"",quantity:1,unit:""}})),m({title:"Success",description:"Item created successfully"})}catch(h){m({title:"Error",description:((u=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:u.message)||"Failed to create item",variant:"destructive"})}},De=async(s,n)=>{var t,c;try{await oe({projectId:x,unitId:s,subItemId:n}),m({title:"Success",description:"Item deleted successfully"})}catch(u){m({title:"Error",description:((c=(t=u==null?void 0:u.response)==null?void 0:t.data)==null?void 0:c.message)||"Failed to delete item",variant:"destructive"})}},Ce=async()=>{var s,n;try{await de({projectId:x}),m({title:"Success",description:"Pdf Generated successfully"}),y()}catch(t){m({title:"Error",description:((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.message)||(t==null?void 0:t.message)||"Failed to generate link",variant:"destructive"})}};return O?e.jsx(Re,{}):e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4",children:[e.jsxs("h2",{className:"text-2xl sm:text-2xl lg:text-2xl xl:text-3xl font-semibold text-blue-600 flex items-center",children:[le&&e.jsx("button",{onClick:ie,className:"mr-3 p-2 rounded-md border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsx("i",{className:"fa-solid fa-cart-shopping mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Ordering Material"}),e.jsx("span",{className:"sm:hidden",children:"Order Material"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsxs(p,{isLoading:pe,onClick:we,className:"bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto whitespace-nowrap",children:[e.jsx("i",{className:"fa-solid fa-circle-check mr-2"}),"Mark as Complete"]}),e.jsx(Ue,{projectId:x,stageNumber:8,stagePath:"orderingmaterial"}),!C&&e.jsx(Oe,{projectId:x,stageNumber:"8",className:"w-full sm:w-fit",isStageCompleted:a==null?void 0:a.status}),e.jsx(Me,{stageName:"OrderMaterialHistoryModel",projectId:x,organizationId:re,currentAssignedStaff:(a==null?void 0:a.assignedTo)||null})]})]}),A&&e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-xl p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500 text-sm mb-4",children:((B=(H=C==null?void 0:C.response)==null?void 0:H.data)==null?void 0:B.message)||"Failed to load ordering material"}),e.jsx(p,{isLoading:O,onClick:()=>y(),className:"bg-red-600 text-white hover:bg-red-700",children:"Retry"})]})}),!A&&e.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto space-y-4 sm:space-y-6",children:[e.jsxs(ae,{className:"p-4 w-full shadow border-l-4 border-blue-600 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-700 text-sm font-medium mb-2",children:[e.jsx("i",{className:"fa-solid fa-clock text-blue-500 text-lg"}),e.jsx("span",{children:"Stage Timings"})]}),e.jsx(qe,{completedAt:(z=a==null?void 0:a.timer)==null?void 0:z.completedAt,stageName:"orderingmaterial",formId:a==null?void 0:a._id,projectId:x,deadLine:(V=a==null?void 0:a.timer)==null?void 0:V.deadLine,startedAt:(F=a==null?void 0:a.timer)==null?void 0:F.startedAt,refetchStageMutate:y,deadLineMutate:xe,isPending:ue})]}),!A&&e.jsxs("section",{className:"bg-white rounded-3xl shadow-[0_10px_40px_-15px_rgba(0,0,0,0.1)] overflow-hidden",children:[e.jsxs("div",{className:"border-l-4 border-blue-600 rounded-lg p-4 shadow-sm relative bg-white",children:[e.jsxs("h2",{className:"text-base sm:text-lg font-bold mb-3 text-blue-700 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-store"}),"Shop Details"]}),ve?e.jsxs("div",{className:"space-y-3",children:[e.jsx(j,{placeholder:"Shop Name",value:(o==null?void 0:o.shopName)||"",onChange:s=>_({...o,shopName:s.target.value}),className:"w-full"}),e.jsx(j,{placeholder:"Contact Person",value:(o==null?void 0:o.contactPerson)||"",onChange:s=>_({...o,contactPerson:s.target.value}),className:"w-full"}),e.jsx(j,{placeholder:"Phone Number",value:(o==null?void 0:o.phoneNumber)||"",type:"tel",maxLength:10,onChange:s=>_({...o,phoneNumber:s.target.value}),className:"w-full"}),e.jsx(j,{placeholder:"Address",value:(o==null?void 0:o.address)||"",onChange:s=>_({...o,address:s.target.value}),className:"w-full"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-3",children:[e.jsxs(p,{onClick:_e,className:"w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-save mr-2"}),"Save"]}),e.jsxs(p,{variant:"outline",onClick:()=>P(!1),className:"w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-times mr-2"}),"Cancel"]})]})]}):e.jsxs("div",{className:"space-y-2 text-sm sm:text-base",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Shop Name:"})," ",((K=a==null?void 0:a.shopDetails)==null?void 0:K.shopName)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact Person:"})," ",((Q=a==null?void 0:a.shopDetails)==null?void 0:Q.contactPerson)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",((Y=a==null?void 0:a.shopDetails)==null?void 0:Y.phoneNumber)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",(($=a==null?void 0:a.shopDetails)==null?void 0:$.address)||"-"]}),e.jsxs("button",{onClick:()=>{_(a==null?void 0:a.shopDetails),P(!0)},className:"absolute top-3 right-4 text-blue-600 text-xs sm:text-sm underline hover:text-blue-800",children:[e.jsx("i",{className:"fa-solid fa-edit mr-1"}),"Edit"]})]})]}),e.jsxs("div",{className:"border-l-4 mt-4 border-blue-600 rounded-lg p-4 shadow-sm relative bg-white",children:[e.jsxs("h2",{className:"text-base sm:text-lg font-bold mb-3 text-blue-700 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-truck"}),"Delivery Location"]}),je?e.jsxs("div",{className:"space-y-3",children:[e.jsx(j,{placeholder:"Site Name",value:(i==null?void 0:i.siteName)||"",onChange:s=>S({...i,siteName:s.target.value}),className:"w-full"}),e.jsx(j,{placeholder:"Site Supervisor",value:(i==null?void 0:i.siteSupervisor)||"",onChange:s=>S({...i,siteSupervisor:s.target.value}),className:"w-full"}),e.jsx(j,{placeholder:"Phone Number",type:"tel",maxLength:10,value:(i==null?void 0:i.phoneNumber)||"",onChange:s=>S({...i,phoneNumber:s.target.value}),className:"w-full"}),e.jsx(j,{placeholder:"Address",value:(i==null?void 0:i.address)||"",onChange:s=>S({...i,address:s.target.value}),className:"w-full"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-3",children:[e.jsxs(p,{onClick:Se,className:"w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-save mr-2"}),"Save"]}),e.jsxs(p,{variant:"outline",onClick:()=>M(!1),className:"w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-times mr-2"}),"Cancel"]})]})]}):e.jsxs("div",{className:"space-y-2 text-sm sm:text-base",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Site Name:"})," ",((W=a==null?void 0:a.deliveryLocationDetails)==null?void 0:W.siteName)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Supervisor:"})," ",((J=a==null?void 0:a.deliveryLocationDetails)==null?void 0:J.siteSupervisor)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",((X=a==null?void 0:a.deliveryLocationDetails)==null?void 0:X.phoneNumber)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((Z=a==null?void 0:a.deliveryLocationDetails)==null?void 0:Z.address)||"-"]}),e.jsxs("button",{onClick:()=>{S(a==null?void 0:a.deliveryLocationDetails),M(!0)},className:"absolute top-3 right-4 text-blue-600 text-xs sm:text-sm underline hover:text-blue-800",children:[e.jsx("i",{className:"fa-solid fa-edit mr-1"}),"Edit"]})]})]}),e.jsxs("div",{className:"p-6 border-b mt-4 border-gray-100 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 h-full w-1.5 bg-blue-600 "}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 pl-3",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Your Orders"})}),T&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Total:"}),e.jsxs("span",{className:"text-xl font-bold text-blue-600",children:["₹",ke.toFixed(2)]})]})]})]}),e.jsx("div",{className:"py-2 overflow-y-auto custom-scrollbar ",children:T?e.jsx("div",{className:"grid gap-5",children:q.map((s,n)=>{var t,c,u,h,D,f,v;return e.jsxs("div",{className:"group relative p-5 bg-white rounded-xl border border-gray-100 hover:border-blue-100 transition-all shadow-[0_3px_10px_rgba(0,0,0,0.02)] hover:shadow-[0_6px_20px_rgba(0,0,0,0.04)]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-5",children:[e.jsxs("div",{className:"relative w-full md:w-32 h-32 bg-gray-50 rounded-lg overflow-hidden",children:[e.jsx("img",{src:(s==null?void 0:s.image)||Ge,alt:s.customId||"Product image",className:"w-full h-full object-contain p-3"}),e.jsxs("div",{className:"absolute top-2 right-2 bg-blue-600 text-white text-xs font-bold px-2.5 py-1 rounded-full shadow-sm",children:["×",s.quantity]})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1.5",children:s.unitName}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("span",{className:"flex cursor-pointer gap-1 items-center px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[" Total Sub Items : ",e.jsx("span",{className:"",children:((t=s==null?void 0:s.subItems)==null?void 0:t.length)||0})]}),e.jsxs("button",{onClick:()=>ye(E===s._id?null:s._id),className:"flex cursor-pointer items-center gap-2 px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[e.jsxs("span",{className:"hidden sm:inline",children:[E===s._id?"Hide":"Show"," Sub Items"]}),e.jsx("i",{className:`fa ${E===s._id?"fa-chevron-up":"fa-chevron-down"} transition-transform`})]})]})]}),e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:s.category||"Generic"})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Unit Price"}),e.jsxs("p",{className:"font-medium",children:["₹",s.singleUnitCost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Quantity"}),e.jsx("p",{className:"font-medium",children:s.quantity})]}),(s==null?void 0:s.dimention)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Dimentions"}),e.jsxs("p",{className:"font-medium",children:["Height: ",((c=s==null?void 0:s.dimention)==null?void 0:c.height)||0,"mm"]}),e.jsxs("p",{className:"font-medium",children:["depth: ",((u=s==null?void 0:s.dimention)==null?void 0:u.depth)||0,"mm"]}),e.jsxs("p",{className:"font-medium",children:["width: ",((h=s==null?void 0:s.dimention)==null?void 0:h.width)||0,"mm"]})]})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Item Total"}),e.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["₹",(s.singleUnitCost*s.quantity).toFixed(2)]})]})})]})]}),E===s._id&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("i",{className:"fa-solid fa-list text-blue-600"}),e.jsx("h4",{className:"font-semibold text-gray-800",children:"Sub Items"}),e.jsx("span",{className:"text-sm text-gray-500",children:"(Click to edit, changes save by clicking Enter)"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-17 gap-0 bg-gray-100 border-b border-gray-200",children:[e.jsx("div",{className:"col-span-3 px-4 py-3 text-sm font-medium text-gray-700 border-r border-gray-200",children:"Ref ID"}),e.jsx("div",{className:"col-span-8 px-4 py-3 text-sm font-medium text-gray-700 border-r border-gray-200",children:"Material Name"}),e.jsx("div",{className:"col-span-2 px-4 py-3 text-sm font-medium text-gray-700 border-r border-gray-200",children:"Quantity"}),e.jsx("div",{className:"col-span-3 px-4 py-3 text-sm font-medium text-gray-700 border-r border-gray-200",children:"Unit"}),e.jsx("div",{className:"col-span-1 px-4 py-3 text-sm font-medium text-gray-700",children:"Action"})]}),s.subItems&&s.subItems.length>0&&s.subItems.map(r=>e.jsxs("div",{className:"grid grid-cols-17 gap-0 border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("div",{className:"col-span-3 border-r border-gray-200",children:e.jsx("div",{className:"w-full px-4 py-3 border-none outline-none focus:bg-blue-50",children:(r==null?void 0:r.refId)||"N/A"})}),e.jsx("div",{className:"col-span-8 border-r border-gray-200",children:(d==null?void 0:d.subItemId)===r._id&&(d==null?void 0:d.field)==="name"?e.jsx("input",{ref:I,type:"text",defaultValue:r.subItemName,className:"w-full px-4 py-3 border-none outline-none focus:bg-blue-50",onBlur:l=>{k(s._id,r._id,"name",l.target.value),g(null)},onKeyDown:l=>{if(l.key==="Enter"){const w=l.target.value;k(s._id,r._id,"name",w),g(null)}l.key==="Escape"&&g(null)}}):e.jsx("div",{className:"px-4 py-3 cursor-pointer hover:bg-blue-50 transition-colors",onClick:()=>g({subItemId:r._id,field:"name"}),children:r.subItemName})}),e.jsx("div",{className:"col-span-2 border-r border-gray-200",children:(d==null?void 0:d.subItemId)===r._id&&(d==null?void 0:d.field)==="quantity"?e.jsx("input",{ref:I,type:"number",defaultValue:r.quantity,min:"0",className:"w-full px-4 py-3 border-none outline-none focus:bg-blue-50",onBlur:l=>{k(s._id,r._id,"quantity",l.target.value),g(null)},onKeyDown:l=>{l.key==="Enter"&&(k(s._id,r._id,"quantity",l.currentTarget.value),g(null)),l.key==="Escape"&&g(null)}}):e.jsx("div",{className:"px-4 py-3 cursor-pointer hover:bg-blue-50 transition-colors",onClick:()=>g({subItemId:r._id,field:"quantity"}),children:r.quantity})}),e.jsx("div",{className:"col-span-3 border-r border-gray-200",children:(d==null?void 0:d.subItemId)===r._id&&(d==null?void 0:d.field)==="unit"?e.jsx("div",{className:"p-2 relative z-50",children:e.jsxs("select",{defaultValue:r.unit,onChange:l=>{k(s._id,r._id,"unit",l.target.value),g(null)},className:"w-full relative z-[50] px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Selected unit"}),te.map(l=>e.jsx("option",{value:l,children:l},l))]})}):e.jsx("div",{className:"px-4 py-3 cursor-pointer hover:bg-blue-50 transition-colors",onClick:()=>g({subItemId:r._id,field:"unit"}),children:r.unit})}),e.jsx("div",{className:"col-span-1 flex items-center justify-center",children:e.jsx(p,{variant:"danger",onClick:()=>De(s._id,r._id),disabled:G,isLoading:G,className:"p-2 bg-red-600 text-white  hover:bg-red-50 rounded transition-colors disabled:opacity-50",title:"Delete item",children:e.jsx("i",{className:"fa fa-trash text-sm"})})})]},r._id)),e.jsxs("div",{className:"grid grid-cols-17 gap-0 bg-green-50 border-b border-gray-100",children:[e.jsx("div",{className:"col-span-3 border-r border-gray-200",children:e.jsx("div",{className:"w-full px-4 py-3 border-none outline-none focus:bg-blue-50",children:"Ref Id"})}),e.jsx("div",{className:"col-span-8 border-r border-gray-200",children:e.jsx("input",{type:"text",placeholder:"Enter matterial name...",value:((D=N[s._id])==null?void 0:D.name)||"",onChange:r=>{L(l=>({...l,[s._id]:{...l[s._id],name:r.target.value}}))},onBlur:()=>{var r,l,w;(l=(r=N[s._id])==null?void 0:r.name)!=null&&l.trim()&&((w=N[s._id])!=null&&w.unit)&&U(s._id,N)},onKeyDown:r=>{r.key==="Enter"&&U(s._id,N)},className:"w-full px-4 py-3 bg-transparent border-none outline-none placeholder-gray-400"})}),e.jsx("div",{className:"col-span-2 border-r border-gray-200",children:e.jsx("input",{type:"number",placeholder:"Qty",min:"0",value:((f=N[s._id])==null?void 0:f.quantity)||1,onChange:r=>{L(l=>({...l,[s._id]:{...l[s._id],quantity:Number(r.target.value)||1}}))},className:"w-full px-4 py-3 bg-transparent border-none outline-none placeholder-gray-400"})}),e.jsx("div",{className:"col-span-3 border-r border-gray-200",children:e.jsx("div",{className:"p-2",children:e.jsxs("select",{value:((v=N[s._id])==null?void 0:v.unit)||"",onChange:async r=>{const l={...N[s._id],unit:r.target.value};L(w=>({...w,[s._id]:l})),await U(s._id,l)},className:"w-full relative z-[50] px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-sm",children:[e.jsx("option",{value:"",children:"Selected unit"}),te.map(r=>e.jsx("option",{value:r,children:r},r))]})})})]}),(!s.subItems||s.subItems.length===0)&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"fa-solid fa-inbox text-2xl mb-2"}),e.jsx("p",{className:"text-sm",children:"No sub-items yet. Start typing in the row above to add items."})]})]})]})]},s._id||n)})}):e.jsxs("div",{className:"py-16 text-center",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-blue-50 rounded-full flex items-center justify-center mb-5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"No Order History"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto mb-6",children:"Your completed orders will appear here"})]})})]}),e.jsx("section",{className:"mt-4",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Export Order Material"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generate a PDF document of your order materials"})]}),e.jsx(p,{onClick:Ce,disabled:R,className:"min-w-[140px] bg-blue-600 hover:bg-blue-700 text-white font-medium",size:"lg",children:R?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-file-pdf"}),"Generate PDF"]})})]}),a!=null&&a.generatedLink&&((ee=a==null?void 0:a.generatedLink)==null?void 0:ee.length)>0?(se=a==null?void 0:a.generatedLink)==null?void 0:se.map(s=>e.jsx(ae,{className:"border-green-200 bg-green-50",children:e.jsx(Ae,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"fas fa-check-circle text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-1",children:s.pdfName}),e.jsxs("span",{className:"text-sm",children:["Pdf Reference Id: ",s.refUniquePdf||"N/A"]}),e.jsx("p",{className:"text-sm text-green-700",children:"Your order material PDF is ready to view or download"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsxs(p,{variant:"outline",onClick:()=>window.open(s.url,"_blank"),className:"border-green-300 text-blue-700 hover:bg-blue-100 hover:border-blue-400",children:[e.jsx("i",{className:"fas mr-2 fa-external-link-alt"}),"View in New Tab"]}),e.jsx(p,{variant:"secondary",onClick:()=>We({src:s.url,alt:"order material"}),className:"border-blue-300 text-blue-700 hover:bg-blue-100 hover:border-blue-400",children:"Download PDF"}),e.jsx(p,{variant:"danger",isLoading:be,onClick:()=>Ie(s._id),className:"border-red-300 bg-red-600 text-white hover:bg-red-600 hover:border-red-400",children:"Delete PDF"})]})]})})},s._id)):e.jsx(e.Fragment,{children:e.jsx("div",{children:"No PDF Generated"})})]})})})]})]})};export{os as default};
