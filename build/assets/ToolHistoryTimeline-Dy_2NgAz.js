import{r as i,j as e}from"./index-BAM0eJUz.js";import{a as j}from"./toolOtpApi-CWL7ydhf.js";import{d as N,f as b}from"./dateFormator-BGKi5rfZ.js";import{I as y}from"./ImageGalleryMain-B3g6b13d.js";const E=({toolId:p,organizationId:g})=>{const c=i.useRef(null),{data:r,fetchNextPage:d,hasNextPage:t,isFetchingNextPage:l,status:n,error:f}=j(p,{organizationId:g}),x=i.useCallback(a=>{const[s]=a;s.isIntersecting&&t&&!l&&d()},[d,t,l]);return i.useEffect(()=>{const a=c.current;if(!a)return;const s=new IntersectionObserver(x,{threshold:.1});return s.observe(a),()=>s.disconnect()},[x]),n==="pending"?e.jsxs("div",{className:"p-10 text-center",children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin"})," Loading..."]}):n==="error"?e.jsxs("div",{className:"p-4 text-red-500 text-center",children:["Error: ",f.message]}):e.jsxs("section",{className:"mt-6 border border-gray-200 rounded-lg bg-white overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 p-4 border-b",children:e.jsx("h3",{className:"text-md font-bold text-gray-700",children:"Tool Log History"})}),e.jsxs("div",{className:"p-5",children:[e.jsx("div",{className:"relative border-l-2 border-blue-100 ml-4 pb-4",children:r==null?void 0:r.pages.map(a=>a.data.filter(s=>s!==null).map((s,h)=>{var m,o;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-8 ml-8 relative group",children:[e.jsx("span",{className:`absolute -left-[41px] top-0 w-9 h-9 rounded-full flex items-center justify-center border-4 border-white shadow-sm text-white z-10 transition-transform group-hover:scale-110 ${s.eventType==="ISSUE"?"bg-emerald-500 ring-2 ring-emerald-100":"bg-amber-600 ring-2 ring-amber-100"}`,children:e.jsx("i",{className:`fa-solid ${s.eventType==="ISSUE"?"fa-arrow-up-from-bracket":"fa-arrow-down-to-bracket"} text-[12px]`})}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-[10px] tracking-widest font-black px-3 py-1 rounded-lg uppercase shadow-sm border ${s.eventType==="ISSUE"?"bg-emerald-50 border-emerald-200 text-ambemeralder-700":"bg-amber-50 border-amber-200 text-amber-700"}`,children:s.eventType}),e.jsxs("div",{className:"flex items-center gap-3 text-[11px] font-bold text-gray-900",children:[e.jsxs("span",{className:"flex items-center gap-1.5 bg-white-100 px-2 py-1 rounded-md",children:[e.jsx("i",{className:"fa-regular fa-calendar-days"})," ",N(s.date)]}),e.jsxs("span",{className:"flex items-center gap-1.5 bg-white-100 px-2 py-1 rounded-md",children:[e.jsx("i",{className:"fa-regular fa-clock"})," ",b(s.date)]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-100 p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[11px] uppercase font-medium text-gray-400 tracking-tighter",children:"Worker"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-user-gear text-[10px] text-gray-500"})}),e.jsx("span",{className:"text-sm font-bold text-gray-800 truncate",children:s.workerName})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[11px] uppercase font-medium text-gray-400 tracking-tighter",children:"Project"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-location-dot text-blue-400 text-[10px]"}),e.jsx("span",{className:"text-sm font-medium text-gray-800 truncate",children:s.projectId||"N/A"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[11px] uppercase font-medium text-gray-400 tracking-tighter",children:"Storage"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-warehouse text-purple-400 text-[10px]"}),e.jsx("span",{className:"text-sm font-medium text-gray-800 truncate",children:s.eventType==="RETURN"?s.roomData||"Main Room":"-"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 border-l border-gray-50 pl-2",children:[e.jsx("span",{className:"text-[11px] uppercase font-medium text-gray-400 tracking-tighter",children:"Staff (Handled By)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-user-shield text-gray-800 text-[10px]"}),e.jsx("span",{className:"text-sm font-medium text-gray-800 truncate",children:s.staffName||"System"})]})]}),s.eventType==="RETURN"&&e.jsxs("div",{className:"flex flex-col gap-1 border-l border-gray-50 pl-2",children:[e.jsx("span",{className:"text-[11px] uppercase font-medium text-gray-400 tracking-tighter",children:"Condition"}),e.jsx("div",{className:"flex items-center gap-2",children:s.eventType==="RETURN"?e.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded ${s.status==="damaged"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:(m=s.status)==null?void 0:m.toUpperCase()}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-user-shield text-gray-800 text-[10px]"}),e.jsx("span",{className:"text-sm font-medium text-gray-800 truncate",children:s.staffName||"System"})]})})]}),s.photos&&s.photos.length>0&&e.jsxs("div",{className:"mt-3 ml-2 flex flex-col gap-2",children:[e.jsxs("span",{className:"text-[11px] uppercase font-medium text-gray-400 flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-camera"})," Damage Evidence (",s.photos.length,")"]}),e.jsx(y,{imageFiles:(o=s.photos)==null?void 0:o.map(u=>u.photo),height:60,minWidth:100,maxWidth:200})]})]})]},`${s.date}-${h}`)})}))}),e.jsx("div",{ref:c,className:"h-10 flex justify-center items-center py-4",children:l?e.jsxs("div",{className:"text-blue-500 text-xs font-medium",children:[e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin mr-2"})," Fetching records..."]}):t?e.jsx("div",{className:"text-gray-400 text-[10px] uppercase tracking-wider",children:"Scroll for more"}):e.jsx("div",{className:"text-gray-400 text-[10px] uppercase tracking-wider",children:"No more records"})})]})]})};export{E as T};
