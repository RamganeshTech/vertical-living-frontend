import{b as p,f as c,h as l,s as i,i as u,c as w}from"./index-BAM0eJUz.js";const h=async({projectId:t,organizationId:e,payload:n,projectName:s,api:r})=>{const{data:o}=await r.post(`/department/logistics/shipment/create/${t}/${e}/${s}`,n);if(!o.ok)throw new Error(o.message);return o.data},m=async({projectId:t,organizationId:e,shipmentId:n,payload:s,api:r})=>{const{data:o}=await r.put(`/department/logistics/shipment/update/${t}/${e}/${n}`,s);if(!o.ok)throw new Error(o.message);return o.data},g=async({shipmentId:t,organizationId:e,api:n})=>{const{data:s}=await n.delete(`/department/logistics/shipment/delete/${e}/${t}`);if(!s.ok)throw new Error(s.message);return s.message},y=async({api:t,organizationId:e,status:n,projectId:s,scheduledDate:r})=>{const o=new URLSearchParams({organizationId:e});n&&o.append("status",n),s&&o.append("projectId",s),r&&o.append("scheduledDate",r);const{data:a}=await t.get(`/department/logistics/shipment/getshipment?${o.toString()}`);if(!a.ok)throw new Error(a.message);return a==null?void 0:a.data},f=async({api:t,shipmentId:e})=>{const{data:n}=await t.get(`/department/logistics/shipment/getsingle/${e}`);if(!n.ok)throw new Error(n.message);return n==null?void 0:n.data},S=async({shipmentId:t,latitude:e,longitude:n})=>{const s=await w.post(`https://houseofram.in/api/department/logistics/shipment/${t}/update-location`,{latitude:e,longitude:n});if(!s.data.ok)throw new Error(s.data.message);return s.data},d=["owner","CTO","staff"],v=()=>{const{role:t}=c(),e=u(t);return l({mutationFn:async({projectId:n,organizationId:s,payload:r,projectName:o})=>{if(!t||!d.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found for role");return await h({projectId:n,organizationId:s,payload:r,projectName:o,api:e})},onSuccess:()=>{i.invalidateQueries({queryKey:["logistics","shipments"]})}})},F=()=>{const{role:t}=c(),e=u(t);return l({mutationFn:async({projectId:n,organizationId:s,shipmentId:r,payload:o})=>{if(!t||!d.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found for role");return await m({projectId:n,organizationId:s,shipmentId:r,payload:o,api:e})},onSuccess:()=>{i.invalidateQueries({queryKey:["logistics","shipments"]})}})},I=()=>{const{role:t}=c(),e=u(t);return l({mutationFn:async({organizationId:n,shipmentId:s})=>{if(!t||!d.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found for role");return await g({shipmentId:s,organizationId:n,api:e})},onSuccess:()=>{i.invalidateQueries({queryKey:["logistics","shipments"]})}})},K=(t,e)=>{const{role:n}=c(),s=u(n);return p({queryKey:["logistics","shipments",e],queryFn:async()=>{if(!n||!d.includes(n))throw new Error("Not allowed");if(!s)throw new Error("API instance not found for role");return await y({api:s,organizationId:t,status:e==null?void 0:e.status,projectId:e==null?void 0:e.projectId,scheduledDate:e==null?void 0:e.scheduledDate})},retry:!1,enabled:!!t})},b=t=>{const{role:e}=c(),n=u(e);return p({queryKey:["logistics","single"],queryFn:async()=>{if(!e||!d.includes(e))throw new Error("Not allowed");if(!n)throw new Error("API instance not found for role");return await f({api:n,shipmentId:t})},retry:!1,enabled:!!t})},k=()=>{const{role:t}=c(),e=u(t);return l({mutationFn:async({organizationId:n,projectId:s,fromDept:r,totalCost:o,upiId:a})=>{if(!t||!d.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found for role");return await E({organizationId:n,projectId:s,fromDept:r,totalCost:o,api:e,upiId:a})},onSuccess:()=>{i.invalidateQueries({queryKey:["logistics","shipments"]})}})},E=async({api:t,organizationId:e,projectId:n,fromDept:s,totalCost:r,upiId:o})=>{const{data:a}=await t.post(`/department/logistics/syncaccounting/${e}/${n}`,{totalCost:r,fromDept:s,upiId:o});return a},A=()=>l({mutationFn:async({shipmentId:t,latitude:e,longitude:n})=>(console.log("latitude",e),console.log("longitude",n),await S({shipmentId:t,latitude:e,longitude:n})),onSuccess:(t,e)=>{i.invalidateQueries({queryKey:["logistics","active-shipments"]}),i.invalidateQueries({queryKey:["logistics","driver-tracking-id",e.shipmentId]}),i.invalidateQueries({queryKey:["logistics","single"]})}}),$=async({id:t})=>{const e=await w.get(`https://houseofram.in/api/department/logistics/shipment/getpublicbyId/${t}`);if(!e.data.ok)throw new Error(e.data.message);return e.data.data},P=t=>p({queryKey:["logistics","driver-tracking-id",t],queryFn:()=>$({id:t}),enabled:!!t,refetchOnWindowFocus:!0});export{A as a,I as b,K as c,v as d,F as e,b as f,k as g,P as u};
