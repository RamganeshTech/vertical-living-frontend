import{u as y,b as h,q as g,g as f,E as P,r as S,j as e,B as p,t as u}from"./index-D5hl8ps7.js";import{l as z}from"./loadScript-B3Gdq1pJ.js";import{p as C}from"./constants-FaVgBbKC.js";const _=async({newPlanType:o,api:s})=>(await s.post("/subscriptionpayment/choosesubscriptionmode",{newPlanType:o})).data.data,k=async({razorpay_order_id:o,razorpay_payment_id:s,razorpay_signature:r,api:i})=>(await i.post("/subscriptionpayment/verify",{razorpay_order_id:o,razorpay_payment_id:s,razorpay_signature:r})).data.data,E=()=>{const o=["owner"],{role:s}=y(),r=f(s);return h({mutationFn:async({newPlanType:i})=>{if(!s||!o.includes(s))throw new Error("Not allowed");if(!r)throw new Error("API instance missing");return await _({newPlanType:i,api:r})},onSuccess:()=>{g.invalidateQueries({queryKey:["organization-subscription"]})}})},F=()=>{const o=["owner"],{role:s}=y(),r=f(s);return h({mutationFn:async({razorpay_order_id:i,razorpay_payment_id:n,razorpay_signature:l})=>{if(!s||!o.includes(s))throw new Error("Not allowed");if(!r)throw new Error("API instance missing");return await k({razorpay_order_id:i,razorpay_payment_id:n,razorpay_signature:l,api:r})},onSuccess:()=>{g.invalidateQueries({queryKey:["organization-subscription"]})}})},$=({openMobileSidebar:o,isMobile:s})=>{const r=P(),[i,n]=S.useState(null),l=r.pathname.split("/").includes("organizations"),{mutateAsync:w,isPending:b}=E(),{mutateAsync:j,isPending:d}=F(),v=async t=>{var c,m;try{n(t);const a=await w({newPlanType:t});if(a!=null&&a.orderId){if(!await z("https://checkout.razorpay.com/v1/checkout.js")){u({title:"Error",description:"Razorpay failed to load",variant:"destructive"});return}const N={key:"rzp_test_Lc5DxL3uS4I6F9",amount:a.amount,currency:a.currency,name:"Vertical Living",description:"Subscription Payment",order_id:a.orderId,handler:async function(x){await j({razorpay_order_id:x.razorpay_order_id,razorpay_payment_id:x.razorpay_payment_id,razorpay_signature:x.razorpay_signature}),u({title:"Success",description:"Subscription payment verified."})},theme:{color:"#0A71F2"}};new window.Razorpay(N).open()}else u({title:"Plan Changed",description:"You have switched your plan successfully."})}catch(a){u({title:"Error",description:((m=(c=a==null?void 0:a.response)==null?void 0:c.data)==null?void 0:m.message)||a.message||"Failed to switch plan",variant:"destructive"})}finally{n(null)}};return e.jsxs("div",{className:"min-h-full bg-gray-100  flex flex-col items-center",children:[e.jsx(e.Fragment,{children:l&&s?e.jsxs("div",{className:"w-full flex items-center justify-center mb-2 py-2 px-2 bg-white",children:[e.jsx("button",{onClick:o,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsx("div",{className:"w-full",children:e.jsx("h1",{className:"text-2xl md:text-4xl font-extrabold text-gray-800",children:"Upgrade Plan"})})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"max-w-4xl w-full text-center py-5",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-[#2f303a] mb-2",children:l?"Upgrade your Plan":"Choose Plan"}),e.jsx("p",{className:"text-md text-gray-500",children:"Choose a subscription plan to match your needs"})]})})}),e.jsx("div",{className:" px-4 py-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 w-full max-w-6xl",children:C.map(t=>e.jsxs("div",{className:`group border-t-[6px] ${t.color} rounded-xl bg-white shadow-md p-6 flex flex-col justify-between transition hover:shadow-xl`,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:`text-2xl font-bold ${t.planNameColor}`,children:t.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Billed every 30 days"})]}),e.jsxs("div",{className:"text-center my-5",children:[e.jsx("h3",{className:`${t.price?"text-3xl":"text-xl"} font-extrabold text-gray-800`,children:t.price?`₹ ${t.price}`:"Coming Soon"}),e.jsx("p",{className:"text-sm text-gray-400",children:"/ month"})]}),e.jsx("ul",{className:"text-sm text-gray-700 mt-2 mb-5 space-y-2",children:t.features.length>0?t.features.map((c,m)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("i",{className:`fa-solid ${c.includes("✔")?"fa-check text-green-600 mt-1":"fa-xmark text-red-400 mt-1"}`}),e.jsx("span",{children:c.replace("✔","").replace("✘","")})]},m)):e.jsx("div",{className:"text-sm text-gray-500 text-center",children:"Features Coming Soon"})}),t.price?e.jsx(p,{isLoading:d||b,onClick:()=>v(t.key),disabled:i===t.key||d,className:`w-full py-2 mt-auto text-white rounded-md font-medium ${i===t.key||d?"bg-gray-400 !cursor-not-allowed":t.btnColor} transition`,children:i===t.key||d?"Processing...":"Choose Plan"}):e.jsx(p,{disabled:!0,className:"w-full py-2 mt-auto text-white rounded-md font-medium bg-gray-400 hover:!bg-gray-400 !cursor-not-allowed",children:"Coming Soon"})]},t.key))})]})};export{$ as default};
