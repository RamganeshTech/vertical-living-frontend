import{b as I,r as q,j as e,R as ee,d as se}from"./index-e8sHY52i.js";import{a as le,b as ne,c as ie,d as re,e as te,f as ae,g as ce,h as oe,i as de,j as ue}from"./requirementFormApi-BRPAEs88.js";import{c as B}from"./Card-DGP_bFuc.js";import{B as k}from"./Button-45UYJ-Fj.js";import{I as b}from"./Input-BH7aLFkl.js";import{L as a}from"./Label-BjppT9Cq.js";import{T as V}from"./TextArea-DSE9nRDG.js";import{S as P,a as L,b as F,c as R,d as i}from"./Select-DYPt_yQW.js";import{t as p}from"./toast-BSC5QTk1.js";import{A as me,S as he}from"./AssignStaff-DLV2QBAB.js";import{R as xe}from"./StageFileUploader-P4QzLncm.js";import{u as ge}from"./roleCheck-DbhaipVR.js";import{R as pe}from"./ResetStageButton-CRxBbJsE.js";import je from"./MaterialOverviewLoading-Dup0y_YN.js";import{S as fe}from"./ShareDocumentWhatsapp-wLKTdZ9m.js";import"./useQuery-CqjHwNP0.js";import"./useMutation-BqjQ-Xv_.js";import"./getAllUsersApi-CSaJikjA.js";import"./downloadFile-MOPhhG62.js";import"./Skeleton-C9CSd2lw.js";import"./documentationApi-C447Be6X.js";const be=({data:s,setVisibleSection:f})=>{var r,l,t;const{projectId:m}=I(),[n,g]=q.useState({layoutType:(s==null?void 0:s.layoutType)||"",measurements:(s==null?void 0:s.measurements)||{top:0,left:0,right:0},kitchenPackage:(s==null?void 0:s.kitchenPackage)||"",graniteCountertop:(s==null?void 0:s.graniteCountertop)||!1,numberOfShelves:(s==null?void 0:s.numberOfShelves)||0,notes:(s==null?void 0:s.notes)||""}),{mutateAsync:v,isPending:C}=le(),c=o=>{const u=o.target,{name:d,type:h,value:T}=u;let O=T;if(h==="checkbox")O=u.checked;else if(h==="number"){const w=parseFloat(T);O=isNaN(w)?0:Math.max(0,w)}["top","left","right"].includes(d)?g(w=>({...w,measurements:{...w==null?void 0:w.measurements,[d]:O}})):g(w=>({...w,[d]:O}))},x=(o,u)=>{g(d=>({...d,[o]:u}))},S=async()=>{var o,u;try{if(!m)return;await v({projectId:m,updateData:n}),p({title:"Success",description:"Kitchen data updated successfully"})}catch(d){p({title:"Error",description:((u=(o=d==null?void 0:d.response)==null?void 0:o.data)==null?void 0:u.message)||(d==null?void 0:d.message)||"Failed to generate invitation link",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 bg-white rounded-2xl p-6 shadow border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-800",children:"Kitchen Requirements"}),e.jsxs("button",{onClick:()=>f(null),className:"text-blue-500 text-sm underline",children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-1"}),e.jsx("span",{children:"Back"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Layout Type"}),e.jsxs(P,{onValueChange:o=>x("layoutType",o),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select layout",selectedValue:n.layoutType||""})}),e.jsxs(R,{children:[e.jsx(i,{value:"",children:"Select Layout"}),e.jsx(i,{value:"L-shaped",children:"L-shaped"}),e.jsx(i,{value:"Straight",children:"Straight"}),e.jsx(i,{value:"U-shaped",children:"U-shaped"}),e.jsx(i,{value:"Parallel",children:"Parallel"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Kitchen Package"}),e.jsxs(P,{onValueChange:o=>x("kitchenPackage",o),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select package",selectedValue:n.kitchenPackage||""})}),e.jsxs(R,{children:[e.jsx(i,{value:"",children:"Select Package"}),e.jsx(i,{value:"Essentials",children:"Essentials"}),e.jsx(i,{value:"Premium",children:"Premium"}),e.jsx(i,{value:"Luxury",children:"Luxury"}),e.jsx(i,{value:"Build Your Own Package",children:"Build Your Own Package"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"graniteCountertop",checked:n.graniteCountertop??void 0,onChange:c}),e.jsx(a,{children:"Granite Countertop"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Shelves"}),e.jsx(b,{type:"number",name:"numberOfShelves",value:n.numberOfShelves||"",onChange:c,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Measurement - Top (in feet)"}),e.jsx(b,{type:"number",name:"top",value:((r=n.measurements)==null?void 0:r.top)||"",onChange:c,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Measurement - Left (in feet)"}),e.jsx(b,{type:"number",name:"left",value:((l=n.measurements)==null?void 0:l.left)||"",onChange:c,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Measurement - Right (in feet)"}),e.jsx(b,{type:"number",name:"right",value:((t=n.measurements)==null?void 0:t.right)||"",onChange:c,min:0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{children:"Additional Notes"}),e.jsx(V,{name:"notes",value:n.notes||"",onChange:c,placeholder:"Add any specific requirements or comments",rows:3,className:"w-full"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(k,{onClick:S,isLoading:C,className:"bg-blue-600 text-white w-full md:w-auto",children:"Save Kitchen Requirements"})})]})},ve=({data:s,setVisibleSection:f})=>{const{projectId:m}=I(),[n,g]=q.useState({seatingStyle:(s==null?void 0:s.seatingStyle)||"",tvUnitDesignRequired:(s==null?void 0:s.tvUnitDesignRequired)||!1,falseCeilingRequired:(s==null?void 0:s.falseCeilingRequired)||!1,wallDecorStyle:(s==null?void 0:s.wallDecorStyle)||"",numberOfFans:(s==null?void 0:s.numberOfFans)||0,numberOfLights:(s==null?void 0:s.numberOfLights)||0,livingHallPackage:(s==null?void 0:s.livingHallPackage)||"",notes:(s==null?void 0:s.notes)||""}),{mutateAsync:v,isPending:C}=ne(),c=r=>{const l=r.target,{name:t,type:o,value:u}=l;let d=u;if(o==="checkbox")d=l.checked;else if(o==="number"){const h=parseFloat(u);d=isNaN(h)?0:Math.max(0,h)}g(h=>({...h,[t]:d}))},x=(r,l)=>{g(t=>({...t,[r]:l}))},S=async()=>{var r,l;try{if(!m)return;await v({projectId:m,updateData:n}),p({title:"Success",description:"Living Hall data updated successfully"})}catch(t){p({title:"Error",description:((l=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:l.message)||(t==null?void 0:t.message)||"Failed to generate invitation link",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 bg-white rounded-2xl p-6 shadow border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-800",children:"Living Hall Requirements"}),e.jsxs("button",{onClick:()=>f(null),className:"text-blue-500 text-sm underline",children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-1"}),e.jsx("span",{children:"Back"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Seating Style"}),e.jsxs(P,{onValueChange:r=>x("seatingStyle",r),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select seating style",selectedValue:n.seatingStyle||""})}),e.jsxs(R,{children:[e.jsx(i,{value:"",children:"Select seating style"}),e.jsx(i,{value:"Sofa Set",children:"Sofa Set"}),e.jsx(i,{value:"L-Shaped Sofa",children:"L-Shaped Sofa"}),e.jsx(i,{value:"Recliner Chairs",children:"Recliner Chairs"}),e.jsx(i,{value:"Floor Seating",children:"Floor Seating"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Wall Decor Style"}),e.jsxs(P,{onValueChange:r=>x("wallDecorStyle",r),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select wall decoration",selectedValue:n.wallDecorStyle||""})}),e.jsxs(R,{children:[e.jsx(i,{value:"",children:"Select wall decoration"}),e.jsx(i,{value:"Paint",children:"Paint"}),e.jsx(i,{value:"Wallpaper",children:"Wallpaper"}),e.jsx(i,{value:"Wood Paneling",children:"Wood Paneling"}),e.jsx(i,{value:"Stone Cladding",children:"Stone Cladding"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Fans"}),e.jsx(b,{type:"number",name:"numberOfFans",value:n.numberOfFans||"",onChange:c,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Lights"}),e.jsx(b,{type:"number",name:"numberOfLights",value:n.numberOfLights||"",onChange:c,min:0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"tvUnitDesignRequired",checked:n.tvUnitDesignRequired||void 0,onChange:c}),e.jsx(a,{children:"TV Unit Design Required"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"falseCeilingRequired",checked:n.falseCeilingRequired||void 0,onChange:c}),e.jsx(a,{children:"False Ceiling Required"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Package"}),e.jsxs(P,{onValueChange:r=>x("livingHallPackage",r),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select package",selectedValue:n.livingHallPackage||""})}),e.jsxs(R,{children:[e.jsx(i,{value:"",children:"Select package"}),e.jsx(i,{value:"Essentials",children:"Essentials"}),e.jsx(i,{value:"Premium",children:"Premium"}),e.jsx(i,{value:"Luxury",children:"Luxury"}),e.jsx(i,{value:"Build Your Own Package",children:"Build Your Own Package"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{children:"Additional Notes"}),e.jsx(V,{name:"notes",value:n.notes||"",onChange:c,placeholder:"Add any specific requirements or comments",rows:3,className:"w-full"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(k,{onClick:S,isLoading:C,className:"bg-blue-600 text-white w-full md:w-auto",children:"Save Living Hall Requirements"})})]})},ye=({data:s,setVisibleSection:f})=>{const{projectId:m}=I(),[n,g]=q.useState({numberOfBedrooms:(s==null?void 0:s.numberOfBedrooms)||0,bedType:(s==null?void 0:s.bedType)||"",wardrobeIncluded:(s==null?void 0:s.wardrobeIncluded)||!1,falseCeilingRequired:(s==null?void 0:s.falseCeilingRequired)||!1,tvUnitRequired:(s==null?void 0:s.tvUnitRequired)||!1,studyTableRequired:(s==null?void 0:s.studyTableRequired)||!1,bedroomPackage:(s==null?void 0:s.bedroomPackage)||"",notes:(s==null?void 0:s.notes)||""}),{mutateAsync:v,isPending:C}=ie(),c=r=>{const l=r.target,{name:t,type:o,value:u}=l;let d=u;if(o==="checkbox")d=l.checked;else if(o==="number"){const h=parseFloat(u);d=isNaN(h)?0:Math.max(0,h)}g(h=>({...h,[t]:d}))},x=(r,l)=>{g(t=>({...t,[r]:l}))},S=async()=>{var r,l;try{if(!m)return;await v({projectId:m,updateData:n}),p({title:"Success",description:"bedroom data updated successfully"})}catch(t){p({title:"Error",description:((l=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:l.message)||(t==null?void 0:t.message)||"Failed to generate invitation link",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 bg-white rounded-2xl p-6 shadow border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-800",children:"Bedroom Requirements"}),e.jsxs("button",{onClick:()=>f(null),className:"text-blue-500 text-sm underline",children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-1"}),e.jsx("span",{children:"Back"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Number of Bedrooms"}),e.jsx(b,{type:"number",name:"numberOfBedrooms",value:n.numberOfBedrooms??"",onChange:c,min:1})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Bed Type"}),e.jsxs(P,{onValueChange:r=>x("bedType",r),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select bed type",selectedValue:n.bedType||""})}),e.jsxs(R,{children:[e.jsx(i,{value:"",children:"Select bed type"}),e.jsx(i,{value:"Single",children:"Single"}),e.jsx(i,{value:"Double",children:"Double"}),e.jsx(i,{value:"Queen",children:"Queen"}),e.jsx(i,{value:"King",children:"King"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"wardrobeIncluded",checked:n.wardrobeIncluded??void 0,onChange:c}),e.jsx(a,{children:"Wardrobe Included"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"falseCeilingRequired",checked:n.falseCeilingRequired??void 0,onChange:c}),e.jsx(a,{children:"False Ceiling Required"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"tvUnitRequired",checked:n.tvUnitRequired??void 0,onChange:c}),e.jsx(a,{children:"TV Unit Required"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"studyTableRequired",checked:n.studyTableRequired??void 0,onChange:c}),e.jsx(a,{children:"Study Table Required"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Package"}),e.jsxs(P,{onValueChange:r=>x("bedroomPackage",r),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select package",selectedValue:n.bedroomPackage||""})}),e.jsxs(R,{children:[e.jsx(i,{value:"",children:"Select package"}),e.jsx(i,{value:"Essentials",children:"Essentials"}),e.jsx(i,{value:"Premium",children:"Premium"}),e.jsx(i,{value:"Luxury",children:"Luxury"}),e.jsx(i,{value:"Build Your Own Package",children:"Build Your Own Package"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{children:"Additional Notes"}),e.jsx(V,{name:"notes",value:n.notes||"",onChange:c,placeholder:"Add any specific requirements or comments",rows:3,className:"w-full"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(k,{onClick:S,isLoading:C,className:"bg-blue-600 text-white w-full md:w-auto",children:"Save Bedroom Requirements"})})]})},we=({data:s,setVisibleSection:f})=>{const{projectId:m}=I(),[n,g]=q.useState({wardrobeType:(s==null?void 0:s.wardrobeType)||"",lengthInFeet:(s==null?void 0:s.lengthInFeet)||0,heightInFeet:(s==null?void 0:s.heightInFeet)||0,mirrorIncluded:(s==null?void 0:s.mirrorIncluded)||!1,wardrobePackage:(s==null?void 0:s.wardrobePackage)||"",numberOfShelves:(s==null?void 0:s.numberOfShelves)||0,numberOfDrawers:(s==null?void 0:s.numberOfDrawers)||0,notes:(s==null?void 0:s.notes)||""}),{mutateAsync:v,isPending:C}=re(),c=r=>{const l=r.target,{name:t,type:o,value:u}=l;let d=u;if(o==="checkbox")d=l.checked;else if(o==="number"){const h=parseFloat(u);d=isNaN(h)?0:Math.max(0,h)}g(h=>({...h,[t]:d}))},x=(r,l)=>{g(t=>({...t,[r]:l}))},S=async()=>{var r,l;try{if(!m)return;await v({projectId:m,updateData:n}),p({title:"Success",description:"Wardrobe data updated successfully"})}catch(t){p({title:"Error",description:((l=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:l.message)||(t==null?void 0:t.message)||"Failed to generate invitation link",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 bg-white rounded-2xl p-6 shadow border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-800",children:"Wardrobe Requirements"}),e.jsxs("button",{onClick:()=>f(null),className:"text-blue-500 text-sm underline",children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-1"}),e.jsx("span",{children:"Back"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Wardrobe Type"}),e.jsxs(P,{onValueChange:r=>x("wardrobeType",r),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select wardrobe type",selectedValue:n.wardrobeType||""})}),e.jsxs(R,{children:[e.jsx(i,{value:"",children:"Select Type"}),e.jsx(i,{value:"Sliding",children:"Sliding"}),e.jsx(i,{value:"Openable",children:"Openable"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Length (in feet)"}),e.jsx(b,{type:"number",name:"lengthInFeet",value:n.lengthInFeet||0,onChange:c,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Height (in feet)"}),e.jsx(b,{type:"number",name:"heightInFeet",value:n.heightInFeet||0,onChange:c,min:0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"mirrorIncluded",checked:n.mirrorIncluded??void 0,onChange:c}),e.jsx(a,{children:"Mirror Included"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Shelves"}),e.jsx(b,{type:"number",name:"numberOfShelves",value:n.numberOfShelves||"",onChange:c,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Drawers"}),e.jsx(b,{type:"number",name:"numberOfDrawers",value:n.numberOfDrawers||"",onChange:c,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Package"}),e.jsxs(P,{onValueChange:r=>x("wardrobePackage",r),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select package",selectedValue:n.wardrobePackage||""})}),e.jsxs(R,{children:[e.jsx(i,{value:"",children:"Select package"}),e.jsx(i,{value:"Essentials",children:"Essentials"}),e.jsx(i,{value:"Premium",children:"Premium"}),e.jsx(i,{value:"Luxury",children:"Luxury"}),e.jsx(i,{value:"Build Your Own Package",children:"Build Your Own Package"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{children:"Additional Notes"}),e.jsx(V,{name:"notes",value:n.notes||"",onChange:c,placeholder:"Add any specific requirements or comments",rows:3,className:"w-full"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(k,{onClick:S,isLoading:C,className:"bg-blue-600 text-white w-full md:w-auto",children:"Save Wardrobe Requirements"})})]})},Ne=({client:s})=>e.jsxs(B,{className:"p-4 bg-white shadow border-l-4 border-blue-500",children:[e.jsxs("h2",{className:"text-lg font-semibold text-blue-700 mb-4",children:[e.jsx("i",{className:"fa-solid fa-user-tie mr-2"})," Client Info"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx(A,{label:"Name",value:s==null?void 0:s.clientName,icon:"fa-user"}),e.jsx(A,{label:"Email",value:s==null?void 0:s.email,icon:"fa-envelope"}),e.jsx(A,{label:"WhatsApp",value:s==null?void 0:s.whatsapp,icon:"fa-phone"}),e.jsx(A,{label:"Location",value:s==null?void 0:s.location,icon:"fa-location-dot"})]})]}),A=({label:s,value:f,icon:m})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`fa-solid ${m} text-gray-600`}),e.jsxs("strong",{children:[s,":"]})," ",f||"N/A"]}),ke=q.memo(Ne),Se=({sections:s,setVisibleSection:f})=>e.jsx("section",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:s.map(({key:m,label:n,icon:g})=>e.jsx("div",{className:"bg-white border-l-4 border-blue-600 rounded-xl shadow-md hover:shadow-lg transition cursor-pointer group",onClick:()=>f(m),children:e.jsxs("div",{className:"flex items-center justify-between p-5 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 text-blue-600 p-3 rounded-full text-xl",children:e.jsx("i",{className:g})}),e.jsx("span",{className:"text-sm font-medium text-gray-800 group-hover:text-blue-700",children:n})]}),e.jsx("i",{className:"fa-solid fa-chevron-right text-blue-400 group-hover:text-blue-600"})]})},m))}),Ce=ee.memo(Se),Y=[{Component:ye,icon:"fa-solid fa-bed",label:"Bedroom Section",key:"bedroom"},{Component:be,icon:"fa-solid fa-kitchen-set",label:"Kitchen Section",key:"kitchen"},{Component:ve,icon:"fa-solid fa-house",label:"Living Hall Section",key:"livingHall"},{Component:we,icon:"fa-solid fa-shirt",label:"Wardrobe Section",key:"wardrobe"}];function _e(){var E,M,W,H,K;const{projectId:s,organizationId:f}=I(),{role:m}=ge(),{isMobile:n,openMobileSidebar:g}=se(),[v,C]=q.useState(""),[c,x]=q.useState(!1),[S,r]=q.useState(null),{data:l,isLoading:t,error:o,refetch:u}=te({projectId:s}),{mutateAsync:d,isPending:h}=ae(),{mutateAsync:T,isPending:O}=ce(),{mutateAsync:w,isPending:D}=oe(),{mutateAsync:G,isPending:$}=de(),{mutateAsync:_,isPending:z}=ue();if(t)return e.jsx(je,{});const Q=async()=>{var y,j;if(window.confirm("Are you sure want to mark it as completed?"))try{O||(await T({formId:l._id,projectId:s}),p({title:"Success",description:"completion updated successfully"}))}catch(N){p({title:"Error",description:((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||"Failed to update to complete the form",variant:"destructive"})}},J=async y=>{try{const j=["owner","staff","CTO"];if(!m)throw new Error("Not Authorized");if(!j.includes(m))throw new Error("Dont have the access");await navigator.clipboard.writeText(y),x(!0),p({title:"Success",description:"Link copied to clipboard"}),setTimeout(()=>x(!1),4e3)}catch(j){p({title:"Error",description:j.message||"Failed to copy link",variant:"destructive"})}},X=async()=>{var y,j;try{const N=await d({projectId:s});C(N.inviteLink||N),p({title:"Success",description:"Invitation link generated successfully"})}catch(N){p({title:"Error",description:((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||N.message||"Failed to generate invitation link",variant:"destructive"})}},U=async()=>{try{await navigator.clipboard.writeText(v),x(!0),p({title:"Success",description:"Link copied to clipboard"}),setTimeout(()=>x(!1),2e3)}catch{p({title:"Error",description:"Failed to copy link",variant:"destructive"})}},Z=()=>{const y=`You're requested to fill the form, Click this link to fill the form: ${v}`,j=`https://wa.me/?text=${encodeURIComponent(y)}`;window.open(j,"_blank")};return e.jsx("div",{className:"h-full w-full overflow-y-auto ",children:S?e.jsx("div",{className:"min-h-screen",children:Y.map(({Component:y,key:j})=>S===j&&e.jsx("div",{className:"pt-6",children:e.jsx(y,{data:l==null?void 0:l[j],isEditable:l==null?void 0:l.isEditable,setVisibleSection:r})},j))}):e.jsxs("div",{className:"h-full w-full space-y-4",children:[e.jsxs("div",{className:"flex flex-col w-full sm:flex-row justify-between sm:items-center items-start gap-4",children:[e.jsx("div",{className:"",children:e.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-blue-600 flex items-center",children:[n&&e.jsx("button",{onClick:g,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})})," ",e.jsx("i",{className:"fa-solid fa-pencil mr-2"})," Client Requirement"]})}),e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2  !w-[100%] sm:!w-[50%] lg:!w-[60%] justify-end lg:justify-end",children:[e.jsxs(k,{isLoading:O,onClick:Q,className:"bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-circle-check mr-2"}),"Mark as Complete"]}),e.jsx(pe,{projectId:s,stageNumber:1,stagePath:"requirementform",className:"sm:!max-w-[20%] w-full"}),!o&&e.jsx(fe,{projectId:s,stageNumber:"1",className:"w-full sm:w-fit",isStageCompleted:l==null?void 0:l.status}),e.jsx(me,{stageName:"RequirementFormModel",projectId:s,organizationId:f,currentAssignedStaff:(l==null?void 0:l.assignedTo)||null,className:"w-full sm:w-auto"})]})]}),o&&e.jsxs("div",{className:"max-w-xl sm:min-w-[80%]  mx-auto mt-4 p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2 text-xl sm:text-3xl",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500  mb-4 text-lg sm:text-xl",children:((M=(E=o==null?void 0:o.response)==null?void 0:E.data)==null?void 0:M.message)||"Failed to load data"}),e.jsx(k,{onClick:()=>u(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]}),!o&&e.jsxs("main",{className:"h-[calc(100vh-90px)] overflow-y-auto custom-scrollbar space-y-6",children:[e.jsxs(B,{className:"p-4 w-full shadow border-l-4 border-blue-600 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-700 text-sm font-medium mb-2",children:[e.jsx("i",{className:"fa-solid fa-clock text-blue-500 text-lg"}),e.jsx("span",{children:"Stage Timings"})]}),e.jsx(he,{startedAt:(W=l==null?void 0:l.timer)==null?void 0:W.startedAt,projectId:s,stageName:"requirementform",refetchStageMutate:u,completedAt:(H=l==null?void 0:l.timer)==null?void 0:H.completedAt,deadLine:(K=l==null?void 0:l.timer)==null?void 0:K.deadLine,formId:l==null?void 0:l._id,deadLineMutate:w,isPending:D})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx(ke,{client:l==null?void 0:l.clientData}),e.jsx(B,{className:"p-4 shadow border-l-4 border-blue-500 bg-white",children:e.jsx(xe,{formId:l==null?void 0:l._id,existingUploads:l==null?void 0:l.uploads,onUploadComplete:u,uploadFilesMutate:G,uploadPending:$,projectId:s,refetch:u,onDeleteUpload:_,deleteFilePending:z})})]}),e.jsx(Ce,{sections:Y,setVisibleSection:r}),e.jsx("div",{className:"pb-6",children:l!=null&&l.shareToken?e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{children:"Form Link"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[e.jsx(b,{value:l==null?void 0:l.shareToken,readOnly:!0,className:"bg-blue-50 text-blue-800 flex-1"}),e.jsx(k,{onClick:()=>J(l==null?void 0:l.shareToken),className:"w-full sm:w-auto",children:e.jsx("i",{className:`fas ${c?"fa-check":"fa-copy"}`})})]})]}):e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-2xl shadow-lg space-y-4",children:[e.jsxs("h2",{className:"text-lg sm:text-xl font-bold text-blue-900 flex items-center",children:[e.jsx("i",{className:"fas fa-link mr-2"})," Generate Form Link"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Request to fill the form by generating a link."}),v?e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{children:"Form Link"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[e.jsx(b,{value:v,readOnly:!0,className:"bg-blue-50 text-blue-800 flex-1"}),e.jsx(k,{onClick:U,className:"w-full sm:w-auto",children:e.jsx("i",{className:`fas ${c?"fa-check":"fa-copy"}`})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(k,{onClick:Z,className:"w-full sm:w-auto bg-green-600 text-white",children:[e.jsx("i",{className:"fab fa-whatsapp mr-2"})," Share on WhatsApp"]}),e.jsxs(k,{onClick:U,className:"w-full sm:w-auto border border-blue-400 text-blue-700",children:[e.jsx("i",{className:"fas fa-copy mr-2"})," Copy"]})]})]}):e.jsxs(k,{onClick:X,isLoading:h,className:"w-full bg-blue-600 text-white py-2.5 sm:py-3",children:[e.jsx("i",{className:"fas fa-link mr-2"})," Generate Form Link"]})]})})]})]})})}export{_e as default};
