import{c as N,e as v,a,j as t}from"./index-ftjmZ4WH.js";import T from"./MaterialOverviewLoading-D7Qp4omS.js";import{a as w}from"./paymentQuoteApi-CP-Dbkyy.js";import{B as y}from"./Button-BhpUbe89.js";import{C as B}from"./ClientFurnitures-CFwmIG3D.js";import"./Skeleton-DF3ynh9X.js";import"./useQuery-DmDT-v30.js";import"./roleCheck-BuedAs3v.js";import"./constants-BQ9tBty9.js";const Q=()=>{var d,c;const{projectId:m,id:x}=N(),u=v();let{data:i,isLoading:f,isError:p,error:r,refetch:g}=w(m,x);const e=i==null?void 0:i.quoteId,h=a.useRef([]),[o,j]=a.useState([]),[l,b]=a.useState((e==null?void 0:e.grandTotal)||0);return a.useEffect(()=>{e!=null&&e.grandTotal&&b(e.grandTotal)},[e==null?void 0:e.grandTotal]),a.useEffect(()=>{if(!(e!=null&&e.furnitures))return;const n=e.furnitures.map(s=>({furnitureName:s.furnitureName,coreMaterials:s.coreMaterials||[],fittingsAndAccessories:s.fittingsAndAccessories||[],glues:s.glues||[],nonBrandMaterials:s.nonBrandMaterials||[],totals:{core:s.coreMaterialsTotal||0,fittings:s.fittingsAndAccessoriesTotal||0,glues:s.gluesTotal||0,nbms:s.nonBrandMaterialsTotal||0,furnitureTotal:s.furnitureTotal||0},plywoodBrand:"",laminateBrand:""}));j(n)},[e]),f?t.jsx(T,{}):p?t.jsxs("div",{className:"max-w-xl mx-auto p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center mb-6",children:[t.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"⚠️ Error Occurred"}),t.jsx("p",{className:"text-red-500 text-sm mb-4",children:((c=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:c.message)||(r==null?void 0:r.message)||"Failed to load payment confirmation data"}),t.jsx(y,{onClick:()=>g(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]}):(console.log("quotes",e),t.jsxs("div",{className:"mt-2 max-h-full overflow-y-auto",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx("div",{onClick:()=>u(-1),className:"bg-blue-50 hover:bg-slate-300 flex items-center justify-between w-8 h-8 border border-[#a6aab8] text-sm cursor-pointer rounded-md px-2 ",children:t.jsx("i",{className:"fas fa-arrow-left"})}),t.jsxs("h1",{className:"text-2xl text-blue-600 font-semibold",children:["Quote Details - ",e==null?void 0:e.quoteNo]})]}),t.jsxs("div",{className:"px-4 text-center flex gap-2 text-[20px]",children:[t.jsx("p",{className:"text-md text-gray-600",children:"Total Cost"}),t.jsxs("p",{className:"text-md font-bold text-green-600",children:["₹",l==null?void 0:l.toLocaleString("en-in")]})]})]}),t.jsx("div",{children:o==null?void 0:o.map((n,s)=>t.jsx(B,{data:n,index:s,isBlurred:!1,ref:h.current[s]},n._id))})]}))};export{Q as default};
