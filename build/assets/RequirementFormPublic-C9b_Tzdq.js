import{b as E,r as h,j as e}from"./index-ImEMNTCY.js";import{f as I}from"./requirementFormApi-Dbxo_g3V.js";import{B as p}from"./Button-DA5f_eiE.js";import{I as c}from"./Input-BgP4Xp1N.js";import{L as m}from"./Label-Cji2EFXP.js";import{t as N}from"./toast-BSC5QTk1.js";import"./useQuery-C1eLZ9CZ.js";import"./useMutation-Dbtyr3lY.js";import"./roleCheck-CTzQsMpA.js";const V=()=>{var g,v;const{token:w,projectId:x}=E(),[i,y]=h.useState({clientData:{clientName:null,email:null,whatsapp:null,location:null}}),[d,f]=h.useState({}),[l,j]=h.useState(0),{mutateAsync:C,isPending:D,isSuccess:S,isError:F,error:r}=I(),o=s=>{let{name:a,value:t}=s.target;a==="whatsapp"&&(t=t.replace(/[^0-9]/g,"")),y(n=>({...n,clientData:{...n.clientData,[a]:t}}))},q=s=>{let a={};const{clientName:t,email:n,whatsapp:u}=s.clientData;return(!t||t.trim()==="")&&(a.clientName="Client name is required"),n&&(n.includes("@")||(a.email="should contain @")),!u||u.trim()===""?a.whatsapp="WhatsApp number is required":u.trim().length!==10&&(a.whatsapp="Number should be 10 digits long"),a},k=async()=>{var s,a;try{if(f({}),!x)return;const t=q(i);if(Object.keys(t).length){f(t);return}await C({projectId:x,payload:i,token:w}),N({title:"Success",description:"form data submitted successfully"})}catch(t){N({title:"Error",description:((a=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:a.message)||(t==null?void 0:t.message)||"Failed to save the data",variant:"destructive"})}},b=[{label:"Client Info",content:e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-blue-800 mb-4",children:"Client Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Client Name"}),e.jsx(c,{name:"clientName",value:i.clientData.clientName??"",onChange:o,required:!0,error:d.clientName||""})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Email"}),e.jsx(c,{type:"email",name:"email",value:i.clientData.email??"",onChange:o,required:!0,error:d.email||""})]}),e.jsxs("div",{children:[e.jsx(m,{children:"WhatsApp Number"}),e.jsx(c,{name:"whatsapp",type:"text",inputMode:"numeric",pattern:"[0-9]{10}",value:i.clientData.whatsapp??"",onChange:o,required:!0,error:d.whatsapp||"",maxLength:10})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Location"}),e.jsx(c,{name:"location",value:i.clientData.location??"",onChange:o})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(p,{variant:"primary",size:"lg",onClick:k,isLoading:D,children:"Submit Requirement Form"})}),S&&e.jsx("p",{className:"text-green-600 mt-4",children:"Form submitted successfully!"}),F&&e.jsx("p",{className:"text-red-600 mt-4",children:((v=(g=r==null?void 0:r.response)==null?void 0:g.data)==null?void 0:v.message)||r.message||"Form Submission Failed"})]})}];return e.jsx("div",{className:"space-y-8  max-h-[100vh] overflow-y-auto custom-scrollbar bg-gradient-to-br from-blue-50 via-white to-blue-100 !p-6 h-full w-full",children:e.jsxs("div",{className:"max-w-5xl max-h-full mx-auto space-y-5",children:[e.jsx("h1",{className:"text-3xl font-bold text-center text-blue-800",children:"Client Detail Form"}),e.jsx("div",{className:"max-w-5xl  mx-auto",children:b[l].content}),e.jsxs("div",{className:`flex ${l>0?"justify-between":"justify-end"} mt-2`,children:[l>0&&e.jsx(p,{variant:"secondary",onClick:()=>j(s=>s-1),children:"Previous"}),l<b.length-1&&e.jsx(p,{variant:"primary",onClick:()=>j(s=>s+1),children:"Skip & Continue"})]})]})})};export{V as default};
