import{a as Q,b as S,j as e,u as F,r as C,e as P,O as _}from"./index-BYTWf4fI.js";import{B as k}from"./Button-aRmNljle.js";import{d as E,e as D}from"./quoteVariantApi-D3H6mz2H.js";import L from"./MaterialOverviewLoading-DkmRHaSw.js";import{u as O}from"./projectApi-DD4NsQCs.js";import{C as B,a as G}from"./Card-ClDlfbss.js";import{t as I}from"./toast-BSC5QTk1.js";import{d as V,f as z}from"./dateFormator-BGKi5rfZ.js";import{S as M}from"./StageGuide-CqeeYR2U.js";import"./useQuery-DFVFWtWl.js";import"./useMutation-sTZCeqmg.js";import"./roleCheck-DhBlwT6t.js";import"./Skeleton-Bc8D3KPj.js";const R=({quote:s,organizationId:r})=>{var l,h,i,f,j;const c=Q(),{role:n,permission:a}=S(),N=n==="owner"||((l=a==null?void 0:a.materialquote)==null?void 0:l.list),o=n==="owner"||((h=a==null?void 0:a.materialquote)==null?void 0:h.delete),b=n==="owner"||((i=a==null?void 0:a.materialquote)==null?void 0:i.edit),{mutateAsync:y,isPending:u}=E(),d=async v=>{var g,m;try{await y({id:v,organizationId:r}),I({title:"Success",description:"Items deleted successfully"})}catch(p){I({title:"Error",description:((m=(g=p==null?void 0:p.response)==null?void 0:g.data)==null?void 0:m.message)??"Operation failed"})}};return e.jsx(B,{className:"w-full border-l-4 border-blue-600 shadow-md bg-white hover:shadow-lg transition-all",children:e.jsxs(G,{className:"p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"my-1",children:[e.jsxs("h3",{className:"text-base font-bold text-blue-700 leading-[8px] ",children:["Project: ",e.jsx("span",{className:"text-black",children:((f=s==null?void 0:s.projectId)==null?void 0:f.projectName)||"Project"})]}),e.jsxs("span",{className:"text-[12px] font-semibold text-gray-500",children:["Quote No: ",e.jsx("span",{className:"text-black",children:s.quoteNo||"N/A"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 ",children:["Created on: ",V(s.createdAt)," - ",z(s.createdAt)]})]}),e.jsx("i",{className:"fas fa-file-alt text-gray-400 text-xl"})]}),e.jsxs("p",{className:"text-sm text-gray-500 italic",children:[e.jsx("strong",{children:"Furnitures: "})," ",((j=s.furnitures)==null?void 0:j.length)||0]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[(N||b)&&e.jsxs(k,{size:"sm",variant:"secondary",onClick:()=>c(`single/${s._id}`),children:[e.jsx("i",{className:"fas fa-eye mr-1"})," View"]}),o&&e.jsxs(k,{size:"sm",isLoading:u,variant:"danger",className:"bg-red-600 text-white",onClick:()=>d(s._id),children:[e.jsx("i",{className:"fas fa-trash mr-1"})," Delete"]})]})]})})},se=()=>{var A;const{organizationId:s}=F(),[r,c]=C.useState({projectId:"",projectName:"",createdAt:""}),{role:n,permission:a}=S(),N=n==="owner"||((A=a==null?void 0:a.materialquote)==null?void 0:A.list),[o,b]=C.useState(""),[y,u]=C.useState(""),{data:d}=O(s),l=d==null?void 0:d.map(t=>({_id:t._id,projectName:t.projectName})),h=Q(),{data:i,isLoading:f}=D(s,{createdAt:r.createdAt,projectId:r.projectId,quoteNo:y}),j=P(),v=()=>{h("../internalquote")},g=()=>{c({projectId:"",projectName:"",createdAt:""})},m=Object.values(r).filter(Boolean).length;return j.pathname.includes("single")?e.jsx(_,{}):e.jsxs("div",{className:"p-2 max-h-full overflow-y-auto  min-h-full",children:[e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("i",{className:"fas fa-file-invoice text-4xl text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Quote Variant generator"})]}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(M,{organizationId:s,stageName:"materialquote"})})]}),e.jsxs("main",{className:"flex gap-2 !max-h-[87%]",children:[e.jsx("div",{className:"xl:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),m>0&&e.jsxs("button",{onClick:g,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",m,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search By Quote No"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search and Press Enter",value:o,autoFocus:!0,onChange:t=>b(t.target.value),onKeyDown:t=>{t.key==="Enter"&&u(o)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx(k,{onClick:()=>u(o),className:"bg-blue-600 text-white px-4 py-2 rounded",children:e.jsx("i",{className:"fas fa-search",children:" "})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Created Date"}),e.jsx("input",{type:"date",onChange:t=>c(x=>({...x,createdAt:t.target.value})),value:r.createdAt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Project"}),e.jsx("select",{value:(r==null?void 0:r.projectId)||"",onChange:t=>{const x=l==null?void 0:l.find(w=>w._id===t.target.value);x&&c(w=>({...w,projectId:x._id,projectName:x.projectName}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:l==null?void 0:l.map(t=>e.jsx("option",{value:t._id,children:t.projectName},t._id))})]})]})]})}),N&&e.jsx("section",{className:"w-full max-h-full  gap-2  overflow-y-auto  min-h-full",children:f?e.jsx("p",{children:e.jsx(L,{})}):i!=null&&i.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(t=>e.jsx(e.Fragment,{children:e.jsx(R,{quote:t,organizationId:s},t._id)}))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center text-gray-700",children:[e.jsx("i",{className:"fas fa-file-circle-exclamation text-gray-300 text-7xl mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"No Quotes Found"}),e.jsxs("p",{className:"text-base text-gray-500 leading-relaxed max-w-md",children:["You haven't generated any quote variants yet.",e.jsx("br",{}),"Please create a quote from the",e.jsx("span",{className:"font-semibold text-blue-600 cursor-pointer",onClick:v,children:" Internal Quote "}),"section to view brand-wise breakdowns here."]})]})})]})]})};export{se as default};
