import{u as E}from"./useQuery-BZZcyQnK.js";import{u as N}from"./useMutation-YUV1wh1S.js";import{u as A}from"./useInfiniteQuery-Cvw7XQ4x.js";import{e as h,q as y}from"./index-DbiIFs0V.js";import{g}from"./roleCheck-Daj0VMmM.js";const P=async(e,r,t,n,s,l)=>{const i=new FormData;Object.keys(r).forEach(a=>{const o=r[a];o!=null&&(Array.isArray(o)?i.append(a,JSON.stringify(o)):i.append(a,o))}),t.forEach(a=>{i.append("productImages",a)}),n.forEach(a=>{i.append("2dImages",a)}),s.forEach(a=>{i.append("3dImages",a)});const{data:d}=await l.post(`/modularunitnew/create/${e}`,i,{headers:{"Content-Type":"multipart/form-data"}});if(!d.ok)throw new Error(d.message);return d.data},I=async(e,r,t,n,s,l,i,d,a)=>{const o=new FormData,{dimention:u,attributes:w,...f}=r;Object.keys(f).forEach(c=>{const m=f[c];m!=null&&m!==""&&o.append(c,String(m))}),u&&(o.append("height",String(u.height||0)),o.append("width",String(u.width||0)),o.append("depth",String(u.depth||0))),w&&w.length>0?o.append("attributes",JSON.stringify(w)):o.append("attributes",JSON.stringify([])),o.append("replaceProductImages",String(l)),o.append("replace2dImages",String(i)),o.append("replace3dImages",String(d)),t.forEach(c=>{o.append("productImages",c)}),n.forEach(c=>{o.append("2dImages",c)}),s.forEach(c=>{o.append("3dImages",c)});const{data:p}=await a.put(`/modularunitnew/update/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}});if(!p.ok)throw new Error(p.message);return p.data},S=async(e,r)=>{const{data:t}=await r.delete(`/modularunitnew/delete/${e}`);if(!t.ok)throw new Error(t.message);return t.data},U=async(e,r)=>{const{data:t}=await r.get(`/modularunitnew/getunits/${e}`);if(!t.ok)throw new Error(t.message);return t.data},O=async(e,r)=>{const t=new URLSearchParams;t.append("page",String(e.page)),t.append("limit",String(e.limit)),e.category&&t.append("category",e.category),e.minPrice&&t.append("minPrice",String(e.minPrice)),e.maxPrice&&t.append("maxPrice",String(e.maxPrice)),e.search&&t.append("search",e.search),e.sortBy&&t.append("sortBy",e.sortBy),e.sortOrder&&t.append("sortOrder",e.sortOrder);const{data:n}=await r.get(`/modularunitnew/getallunits/${e.organizationId}?${t.toString()}`);if(!n.ok)throw new Error(n.message);return n.data},b=()=>{const{role:e}=h(),r=g(e),t=["owner","staff","CTO"];return N({mutationFn:async({organizationId:n,formValues:s,productImages:l=[],images2d:i=[],images3d:d=[]})=>{if(!e)throw new Error("Not Authorized");if(!t.includes(e))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await P(n,s,l,i,d,r)},onSuccess:(n,{organizationId:s})=>{y.invalidateQueries({queryKey:["modularUnitsNew",s]})}})},F=()=>{const{role:e}=h(),r=g(e),t=["owner","staff","CTO"];return N({mutationFn:async({unitId:n,formValues:s,productImages:l=[],images2d:i=[],images3d:d=[],replaceProductImages:a=!1,replace2dImages:o=!1,replace3dImages:u=!1})=>{if(!e)throw new Error("Not Authorized");if(!t.includes(e))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await I(n,s,l,i,d,a,o,u,r)},onSuccess:n=>{y.invalidateQueries({queryKey:["modularUnitsNew"]}),y.invalidateQueries({queryKey:["modularUnitNew",n._id]})}})},R=()=>{const{role:e}=h(),r=g(e),t=["owner","staff","CTO"];return N({mutationFn:async({unitId:n})=>{if(!e)throw new Error("Not Authorized");if(!t.includes(e))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await S(n,r)},onSuccess:()=>{y.invalidateQueries({queryKey:["modularUnitsNew"]})}})},T=e=>{const{role:r}=h(),t=g(r),n=["owner","staff","CTO","client"];return E({queryKey:["modularUnitNew",e],queryFn:async()=>{if(!r)throw new Error("Not Authorized");if(!n.includes(r))throw new Error("Not allowed to make this API call");if(!t)throw new Error("API instance not found for role");return await U(e,t)},enabled:!!e&&!!r&&!!t,staleTime:5*60*1e3})},K=({organizationId:e,limit:r=10,category:t,minPrice:n,maxPrice:s,search:l,sortBy:i="createdAt",sortOrder:d="desc"})=>{const{role:a}=h(),o=g(a),u=["owner","staff","CTO","client"];return A({queryKey:["modularUnitsNew",e,{category:t,minPrice:n,maxPrice:s,search:l,sortBy:i,sortOrder:d}],queryFn:async({pageParam:w=1})=>{if(!a)throw new Error("Not Authorized");if(!u.includes(a))throw new Error("Not allowed to make this API call");if(!o)throw new Error("API instance not found for role");return await O({organizationId:e,page:w,limit:r,category:t,minPrice:n,maxPrice:s,search:l,sortBy:i,sortOrder:d},o)},getNextPageParam:w=>{const{currentPage:f,totalPages:p}=w.pagination;return f<p?f+1:void 0},initialPageParam:1,enabled:!!e&&!!a&&!!o,retry:!1})};export{R as a,b,F as c,T as d,K as u};
