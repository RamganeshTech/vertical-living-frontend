import{j as e,I as F,B as g,a as k,u as O,r as h,O as L,M as z,t as j,b as D}from"./index-hYGmCEO1.js";import{u as G,a as U}from"./internalQuoteNewVersionApi-DY7A3rEq.js";import{u as Q}from"./projectApi-Gwage_AH.js";import{f as $,e as B}from"./quoteVariantApi-DvPnd4Sz.js";import{C as R,a as V}from"./Card-ChYAICVg.js";import{d as T,f as Y}from"./dateFormator-BGKi5rfZ.js";import{S as I}from"./SearchSelectNew-DgVrwo5b.js";import{L as H}from"./Label-hkBviWcw.js";const J=({isEditing:a,formData:l,projectsData:c,setModalOpen:n,setFormData:o,handleSubmit:d})=>e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 w-full max-w-md shadow-2xl animate-in zoom-in-95",children:[e.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-edit text-blue-600"}),a?"Update Quote Details":"Create New Quote"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:"Quote Name"}),e.jsx(F,{className:"w-full p-3 bg-white border rounded-xl outline-none focus:ring-2 focus:ring-blue-500",value:l.mainQuoteName,onChange:s=>o({...l,mainQuoteName:s.target.value}),placeholder:"e.g. Phase 1 Glasswork"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:"Category"}),e.jsx(I,{options:["commercial","residential"].map(s=>({value:s,label:s})),placeholder:"Select Quote Type...",value:l.quoteCategory||"",onValueChange:s=>o(m=>({...m,quoteCategory:s}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"text-[10px] uppercase font-black text-gray-400",children:"Project"}),e.jsx(I,{options:c.map(s=>({value:s._id,label:s.projectName})),placeholder:"Select Project...",value:l.projectId||"",onValueChange:s=>o(m=>({...m,projectId:s}))})]})]}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsx(g,{variant:"outline",className:"flex-1",onClick:()=>n(!1),children:"Cancel"}),e.jsx(g,{className:"flex-1 bg-blue-600",onClick:d,children:a?"Update":"Generate Quote"})]})]})}),re=()=>{const a=k(),{organizationId:l}=O(),[c,n]=h.useState({projectId:"",projectName:"",createdAt:""}),[o,d]=h.useState(!1),[s,m]=h.useState(!1),[N,b]=h.useState(null),[r,y]=h.useState({mainQuoteName:"",quoteCategory:"commercial",projectId:""}),{data:u}=Q(l),i=u==null?void 0:u.map(t=>({_id:t._id,projectName:t.projectName})),{data:x,isLoading:S}=$(l,{createdAt:c.createdAt,projectId:c.projectId,quoteNo:""}),p=x==null?void 0:x.filter(t=>!t.furnitures.length),A=()=>{n({projectId:"",projectName:"",createdAt:""})},C=Object.values(c).filter(Boolean).length,P=G(),_=U(),{data:M=[]}=Q(l),E=async()=>{if(!r.mainQuoteName||!r.projectId||!r.quoteCategory)return j({title:"Error",description:"Please fill all fields",variant:"destructive"});try{if(s&&N)await _.mutateAsync({organizationId:l,projectId:r.projectId,id:N,mainQuoteName:r.mainQuoteName,quoteCategory:r.quoteCategory}),j({title:"Success",description:"Quote updated successfully"});else{const t=await P.mutateAsync({organizationId:l,projectId:r.projectId,mainQuoteName:r.mainQuoteName,quoteCategory:r.quoteCategory});console.log("response",t),a(`create/${t._id}/${t.quoteCategory}`)}d(!1),w()}catch(t){j({title:"Error",description:t.message,variant:"destructive"})}},w=()=>{y({mainQuoteName:"",quoteCategory:"",projectId:""}),m(!1),b(null)};return location.pathname.includes("create")||location.pathname.includes("single")?e.jsx(L,{}):e.jsxs("div",{className:"p-2 h-full w-full",children:[e.jsxs("header",{className:"flex mb-3 flex-col md:flex-row md:items-center md:justify-between gap-4 py-1 border-b-1 border-[#818283]",children:[e.jsx("div",{children:e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-file mr-3 text-blue-600"}),"Internal Quote Entry ",e.jsx("span",{className:"text-[20px] text-blue-600 ml-4",children:"(In Development)"})]})}),e.jsx("div",{className:"flex gap-6 items-center",children:e.jsxs(g,{className:"flex items-center",onClick:()=>{w(),d(!0)},children:[e.jsx("i",{className:"fas fa-add mr-1"})," Create"]})})]}),o&&e.jsx(J,{isEditing:s,formData:r,projectsData:M,setModalOpen:d,setFormData:y,handleSubmit:E}),e.jsxs("main",{className:"flex gap-2 !max-h-[80vh]",children:[e.jsx("div",{className:"xl:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),C>0&&e.jsxs("button",{onClick:A,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",C,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Created Date"}),e.jsx("input",{type:"date",onChange:t=>n(f=>({...f,createdAt:t.target.value})),value:c.createdAt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Project"}),e.jsx("select",{value:(c==null?void 0:c.projectId)||"",onChange:t=>{const f=i==null?void 0:i.find(v=>v._id===t.target.value);f&&n(v=>({...v,projectId:f._id,projectName:f.projectName}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:i==null?void 0:i.map(t=>e.jsx("option",{value:t._id,children:t.projectName},t._id))})]})]})]})}),e.jsx("section",{className:"w-full max-h-full  gap-2  overflow-y-auto  min-h-full",children:S?e.jsx("p",{children:e.jsx(z,{})}):p!=null&&p.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p==null?void 0:p.map(t=>e.jsx(e.Fragment,{children:e.jsx(K,{quote:t,organizationId:l},t._id)}))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center text-gray-700",children:[e.jsx("i",{className:"fas fa-file-circle-exclamation text-gray-300 text-7xl mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"No Quotes Found"}),e.jsxs("p",{className:"text-base text-gray-500 leading-relaxed max-w-md",children:["You haven't generated any quote variants yet.",e.jsx("br",{}),"Please create a quote by clicking the + Product section to view brand-wise breakdowns here."]})]})})]})]})},K=({quote:a,organizationId:l})=>{var b,r;const{mutateAsync:c,isPending:n}=B(),o=k(),{role:d,permission:s}=D(),m=d==="owner"||((b=s==null?void 0:s.internalquote)==null?void 0:b.delete),N=async y=>{var u,i;try{await c({id:y,organizationId:l}),j({title:"Success",description:"Items deleted successfully"})}catch(x){j({title:"Error",description:((i=(u=x==null?void 0:x.response)==null?void 0:u.data)==null?void 0:i.message)??"Operation failed"})}};return e.jsx(R,{className:"w-full border-l-4 border-blue-600 shadow-md bg-white hover:shadow-lg transition-all",children:e.jsxs(V,{className:"p-5 space-y-4",children:[" ",e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-3",children:[" ",e.jsxs("div",{className:"space-y-1.5",children:[" ",e.jsx("h3",{className:"text-lg font-black text-slate-900 tracking-tight leading-tight uppercase",children:(a==null?void 0:a.mainQuote.mainQuoteName)||"Untitled Quote"}),e.jsxs("div",{className:"space-y-0.5",children:[" ",e.jsxs("h3",{className:"text-[12px] font-bold text-blue-700 leading-normal",children:["Project: ",e.jsx("span",{className:"text-black font-semibold",children:((r=a==null?void 0:a.projectId)==null?void 0:r.projectName)||"Project"})]}),e.jsxs("p",{className:"text-[12px] font-semibold text-gray-500 leading-normal",children:["Quote No: ",e.jsx("span",{className:"text-black",children:a.quoteNo||"N/A"})]})]})]}),e.jsx("div",{className:"pt-1",children:e.jsxs("p",{className:"text-[11px] text-gray-400 font-medium flex items-center gap-1",children:[e.jsx("i",{className:"far fa-clock text-[10px]"}),"Created on: ",T(a.createdAt)," â€” ",Y(a.createdAt)]})})]}),e.jsx("div",{className:"pt-1",children:e.jsx("i",{className:"fas fa-file-alt text-gray-300 text-xl"})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t border-gray-50",children:[e.jsxs(g,{size:"sm",isLoading:n,variant:"secondary",className:"h-8 px-4 text-[11px] font-bold uppercase tracking-wider",onClick:()=>o(`single/${a._id}/${a==null?void 0:a.quoteCategory}`),children:[e.jsx("i",{className:"fas fa-eye mr-1.5"})," View"]}),m&&e.jsxs(g,{size:"sm",isLoading:n,variant:"danger",className:"h-8 px-4 text-[11px] font-bold uppercase tracking-wider bg-red-600 text-white",onClick:()=>N(a._id),children:[e.jsx("i",{className:"fas fa-trash mr-1.5"})," Delete"]})]})]})})};export{re as default};
