import{a as K,b as Q,c as X,r as p,j as e}from"./index-By5P0A7l.js";import{C as Y}from"./Card-CFqBlVQz.js";import{B as S}from"./Button-DLUK8O0t.js";import{I as $}from"./ImageGalleryMain-D80ZvsH6.js";import{d as Z}from"./dateFormator-BGKi5rfZ.js";const g=({icon:o,title:l})=>e.jsxs("h3",{className:"text-sm font-bold text-gray-800 uppercase tracking-wide mb-4 pb-2 border-b border-gray-100 flex items-center gap-2",children:[e.jsx("i",{className:`fas ${o} text-blue-500`})," ",l]}),n=({children:o,required:l})=>e.jsxs("label",{className:"block text-[11px] font-bold text-gray-500 uppercase tracking-wider mb-1",children:[o," ",l&&e.jsx("span",{className:"text-red-500",children:"*"})]}),t=o=>e.jsx("input",{...o,className:`w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 bg-white disabled:bg-gray-50 disabled:text-gray-500 transition-all ${o.className}`}),I=o=>e.jsx("select",{...o,className:`w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 bg-white disabled:bg-gray-50 transition-all ${o.className}`,children:o.children}),D=["electronics","hardware","services","consumables","furniture","others"],ee=["proprietorship","partnership","private_limited","llp","individual"],de=({mode:o,initialData:l,onSubmit:A,isSubmitting:B})=>{var T,M,P,L;const{organizationId:v}=K(),V=Q(),{role:z,permission:y}=X(),G=z==="owner"||((T=y==null?void 0:y.vendor)==null?void 0:T.edit),[m,C]=p.useState(o),r=m==="view",[a,u]=p.useState({organizationId:v,clientId:(l==null?void 0:l.clientId)||null,firstName:"",companyName:"",shopDisplayName:"",vendorCategory:"",shopFullAddress:"",email:"",phone:{work:"",mobile:""},language:"English",pan:"",tan:"",gstin:"",msmeNo:"",cin:"",businessStructure:"",bankAccNo:"",accHolderName:"",bankName:"",upiId:"",bankBranch:"",ifscCode:"",mapUrl:"",openingBalance:0,paymentTerms:"Due on Receipt",location:{latitude:0,longitude:0}}),[b,j]=p.useState([]),[w,k]=p.useState([]),[h,H]=p.useState({});p.useEffect(()=>{l&&u(s=>{var c,x,i,R;return{...s,organizationId:l.organizationId||v,clientId:l.clientId||null,firstName:l.firstName||"",companyName:l.companyName||"",shopDisplayName:l.shopDisplayName||"",vendorCategory:l.vendorCategory||"",shopFullAddress:l.shopFullAddress||"",email:l.email||"",phone:{work:((c=l.phone)==null?void 0:c.work)||"",mobile:((x=l.phone)==null?void 0:x.mobile)||""},language:l.language||"English",pan:l.pan||"",tan:l.tan||"",gstin:l.gstin||"",msmeNo:l.msmeNo||"",cin:l.cin||"",businessStructure:l.businessStructure||"",bankAccNo:l.bankAccNo||"",accHolderName:l.accHolderName||"",bankName:l.bankName||"",upiId:l.upiId||"",bankBranch:l.bankBranch||"",ifscCode:l.ifscCode||"",mapUrl:l.mapUrl||"",openingBalance:l.openingBalance||0,paymentTerms:l.paymentTerms||"Due on Receipt",location:{latitude:((i=l==null?void 0:l.location)==null?void 0:i.latitude)||0,longitude:((R=l==null?void 0:l.location)==null?void 0:R.longitude)||0}}})},[l,v]);const d=s=>{const{name:c,value:x}=s.target;u(i=>({...i,[c]:x}))},F=(s,c)=>{const x=c.replace(/[^0-9]/g,"");u(i=>({...i,phone:{...i.phone,[s]:x}}))},O=s=>{s.target.files&&j(Array.from(s.target.files))},_=s=>{j(c=>c.filter((x,i)=>i!==s))},W=s=>{s.target.files&&k(Array.from(s.target.files))},q=()=>{var c;const s={};return(c=a.firstName)!=null&&c.trim()||(s.firstName="Vendor name is required"),a.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)&&(s.email="Invalid email"),a.phone.mobile&&a.phone.mobile.length!==10&&(s["phone.mobile"]="Must be 10 digits"),H(s),Object.keys(s).length===0},J=async()=>{q()&&(m==="create"?await A(a,b,w):(await A(a,b,w),C("view"),j([]),k([])))},f=((M=l==null?void 0:l.documents)==null?void 0:M.filter(s=>s.type==="image"))||[],N=((P=l==null?void 0:l.documents)==null?void 0:P.filter(s=>s.type==="pdf"))||[],E=[...((L=l==null?void 0:l.shopImages)==null?void 0:L.filter(s=>s.type==="image"))||[],...w.map(s=>({type:"image",url:URL.createObjectURL(s),originalName:s.name}))],U=()=>a.location.latitude&&a.location.longitude?`https://maps.google.com/maps?q=${a.location.latitude},${a.location.longitude}&hl=en&z=14&output=embed`:null;return e.jsxs("div",{className:"max-w-full overflow-y-auto mx-auto h-full flex flex-col pb-10 font-sans",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>V(-1),className:"bg-white hover:bg-gray-50 w-9 h-9 flex items-center justify-center border border-gray-200 rounded-full shadow-sm transition-colors",children:e.jsx("i",{className:"fas fa-arrow-left text-gray-600"})}),e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[e.jsx("span",{className:"bg-blue-100 text-blue-600 w-10 h-10 rounded-full flex items-center justify-center text-lg",children:e.jsx("i",{className:`fas ${m==="create"?"fa-plus":"fa-store"}`})}),m==="create"?"Create Vendor":"Vendor Details"]})]}),e.jsxs("div",{className:"flex gap-3",children:[m==="view"&&G&&e.jsxs(S,{onClick:()=>C("update"),className:"bg-blue-600 text-white shadow-sm",children:[e.jsx("i",{className:"fas fa-edit mr-2"})," Edit Details"]}),m==="update"&&e.jsx(S,{onClick:()=>{C("view"),k([]),j([])},variant:"outline",className:"bg-white",children:"Cancel Edit"}),!r&&e.jsx(S,{type:"button",onClick:J,disabled:B,className:"bg-green-600 text-white hover:bg-green-700",children:B?e.jsx("i",{className:"fas fa-spinner fa-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save mr-2"})," Save Changes"]})})]})]}),e.jsx(Y,{className:"p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-6 space-y-6",children:[e.jsx(g,{icon:"fa-info-circle",title:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-5",children:[e.jsxs("div",{children:[e.jsx(n,{required:!0,children:"Vendor Name"}),e.jsx(t,{name:"firstName",value:a.firstName,onChange:d,disabled:r,placeholder:"E.g. John Doe"}),h.firstName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.firstName})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Company Name"}),e.jsx(t,{name:"companyName",value:a.companyName,onChange:d,disabled:r,placeholder:"Legal Company Name"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Shop / Display Name"}),e.jsx(t,{name:"shopDisplayName",value:a.shopDisplayName,onChange:d,disabled:r,placeholder:"Name on Board"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Vendor Category"}),e.jsxs(I,{name:"vendorCategory",value:a.vendorCategory,onChange:d,disabled:r,children:[e.jsx("option",{value:"",children:"Select Category..."}),D.map(s=>e.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))]})]})]})]}),e.jsxs("div",{className:"lg:col-span-6 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 pb-2 border-b border-gray-100",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-800 uppercase tracking-wide flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-images text-blue-500"})," Shop Images"]}),!r&&e.jsx("div",{className:"relative",children:e.jsxs("label",{className:"cursor-pointer inline-flex items-center px-3 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-full hover:bg-blue-100 transition-colors",children:[e.jsx("i",{className:"fas fa-plus mr-1.5"})," Add Image",e.jsx("input",{type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:W})]})})]}),e.jsx("div",{className:`flex-1 rounded-lg border\r
                             border-gray-200  flex flex-col items-center  min-h-[170px]`,children:E.length>0?e.jsx("div",{className:"w-full max-h-[280px] overflow-y-auto",children:e.jsx($,{imageFiles:E,height:150,minWidth:150,maxWidth:200,className:"!p-0 !py-0"})}):e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx("i",{className:"fas fa-store-alt text-4xl mb-2 opacity-20"}),e.jsx("p",{className:"text-xs",children:"No shop images uploaded"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-6 space-y-6",children:[e.jsx(g,{icon:"fa-map-marker-alt",title:"Contact & Location"}),e.jsxs("div",{children:[e.jsx(n,{children:"Shop Full Address"}),e.jsx("textarea",{name:"shopFullAddress",value:a.shopFullAddress,onChange:d,disabled:r,rows:2,placeholder:"Enter full address including pincode",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 bg-white disabled:bg-gray-50 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Email Address"}),e.jsx(t,{type:"email",name:"email",value:a.email,onChange:d,disabled:r,placeholder:"email@example.com"}),h.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.email})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Google Map Link"}),e.jsxs("div",{className:"relative",children:[e.jsx(t,{value:a.mapUrl||"",onChange:s=>u(c=>({...c,mapUrl:s.target.value})),disabled:r,placeholder:"https://maps.app.goo.gl...",className:"pr-16"}),a.mapUrl&&e.jsx("a",{href:a.mapUrl,target:"_blank",rel:"noreferrer",className:"absolute right-1 top-1 bottom-1 px-2 flex items-center text-xs bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Open"})]})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Mobile Number"}),e.jsx(t,{value:a.phone.mobile,onChange:s=>F("mobile",s.target.value),disabled:r,maxLength:10,placeholder:"10 Digit Mobile"}),h["phone.mobile"]&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:h["phone.mobile"]})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Work / Landline"}),e.jsx(t,{value:a.phone.work,onChange:s=>F("work",s.target.value),disabled:r,maxLength:12,placeholder:"STD + Number"})]})]})]}),e.jsxs("div",{className:"lg:col-span-6 flex flex-col",children:[e.jsxs("div",{className:"flex items-center mb-4 pb-2 border-b border-gray-100 h-[38px]",children:[" ",e.jsx("h3",{className:"text-sm font-bold text-gray-800 uppercase tracking-wide",children:"Map Preview"})]}),e.jsx("div",{className:"flex-1 bg-gray-100 rounded-lg overflow-hidden border border-gray-200 relative min-h-[200px]",children:U()?e.jsx("iframe",{title:"map",width:"100%",height:"100%",frameBorder:"0",src:U(),className:"w-full h-full"}):e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-gray-400",children:[e.jsx("i",{className:"fas fa-map-marked-alt text-4xl mb-2 opacity-20"}),e.jsx("p",{className:"text-xs text-center px-6",children:a.mapUrl?"Save to generate preview":"Paste Map URL to see preview"})]})})]})]}),e.jsxs("div",{children:[e.jsx(g,{icon:"fa-file-invoice",title:"Tax & Statutory Details"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"GSTIN"}),e.jsx(t,{name:"gstin",value:a.gstin,onChange:d,disabled:r,placeholder:"GSTIN",className:"uppercase"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"PAN Number"}),e.jsx(t,{name:"pan",value:a.pan,onChange:d,disabled:r,placeholder:"PAN",className:"uppercase"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"TAN Number"}),e.jsx(t,{name:"tan",value:a.tan,onChange:d,disabled:r,placeholder:"TAN",className:"uppercase"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"MSME No"}),e.jsx(t,{name:"msmeNo",value:a.msmeNo,onChange:d,disabled:r,placeholder:"Udyam"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"CIN (Pvt Ltd)"}),e.jsx(t,{name:"cin",value:a.cin,onChange:d,disabled:r,placeholder:"CIN"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Business Structure"}),e.jsxs(I,{name:"businessStructure",value:a.businessStructure,onChange:d,disabled:r,children:[e.jsx("option",{value:"",children:"Select..."}),ee.map(s=>e.jsx("option",{value:s,children:s.replace("_"," ").toUpperCase()},s))]})]})]})]}),e.jsxs("div",{children:[e.jsx(g,{icon:"fa-university",title:"Banking & Financials"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[e.jsx(n,{children:"Bank Name"}),e.jsx(t,{name:"bankName",value:a.bankName,onChange:d,disabled:r})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[e.jsx(n,{children:"Account Holder"}),e.jsx(t,{name:"accHolderName",value:a.accHolderName,onChange:d,disabled:r})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Account Number"}),e.jsx(t,{name:"bankAccNo",value:a.bankAccNo,onChange:d,disabled:r})]}),e.jsxs("div",{children:[e.jsx(n,{children:"IFSC Code"}),e.jsx(t,{name:"ifscCode",value:a.ifscCode,onChange:d,disabled:r,className:"uppercase"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Branch"}),e.jsx(t,{name:"bankBranch",value:a.bankBranch,onChange:d,disabled:r})]}),e.jsxs("div",{children:[e.jsx(n,{children:"UPI ID"}),e.jsx(t,{name:"upiId",value:a.upiId,onChange:d,disabled:r})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Payment Terms"}),e.jsx(I,{name:"paymentTerms",value:a.paymentTerms,onChange:d,disabled:r,children:["Due on Receipt","Net 7 days","Net 15 days","Net 30 days","50% Advance"].map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Opening Balance"}),e.jsx(t,{type:"number",name:"openingBalance",value:a.openingBalance,onChange:d,disabled:r})]})]})]}),(f.length>0||N.length>0)&&e.jsxs("section",{children:[e.jsx(g,{icon:"fa-folder-open",title:"Attached Documents"}),f.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("i",{className:"fas fa-images text-purple-600"}),e.jsx("h4",{className:"font-semibold text-gray-800 text-sm",children:"Images"}),e.jsx("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full",children:f.length})]}),e.jsx($,{imageFiles:f,height:150,minWidth:150,maxWidth:200})]}),N.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("i",{className:"fas fa-file-pdf text-red-600"}),e.jsx("h4",{className:"font-semibold text-gray-800 text-sm",children:"PDF Documents"}),e.jsx("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded-full",children:N.length})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:N.map((s,c)=>e.jsxs("div",{className:"flex items-center gap-3 bg-red-50 p-3 rounded-lg border border-red-100 hover:shadow-sm transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center text-red-500 text-lg border border-red-100",children:e.jsx("i",{className:"fas fa-file-pdf"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-900 truncate",children:s.originalName||`Document ${c+1}.pdf`}),e.jsx("p",{className:"text-[10px] text-gray-500",children:Z(s.uploadedAt)})]}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium text-blue-600 hover:text-blue-800",children:"Open"})]},c))})]})]}),!r&&e.jsxs("section",{children:[e.jsx(g,{icon:"fa-cloud-upload-alt",title:m==="create"?"Upload Documents":"Add New Documents"}),e.jsxs("div",{className:"relative w-full h-28 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 transition-colors bg-gray-50 flex flex-col items-center justify-center group",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*,.pdf",onChange:O,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20"}),e.jsx("i",{className:"fas fa-cloud-upload-alt text-2xl text-gray-400 group-hover:text-blue-500 transition-colors mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Click to upload files"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"PDF, PNG, JPG"})]}),b.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:b.map((s,c)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white border border-gray-200 rounded shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`fas ${s.type.includes("pdf")?"fa-file-pdf text-red-500":"fa-file-image text-blue-500"}`}),e.jsx("span",{className:"text-sm text-gray-700",children:s.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",(s.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx("button",{type:"button",onClick:()=>_(c),className:"text-red-500 hover:text-red-700 px-2",children:e.jsx("i",{className:"fas fa-times"})})]},c))})]})]})})]})};export{de as V};
