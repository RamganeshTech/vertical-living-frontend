import{k as g,q as b,j as e,B as v,r as j,b as se,d as ae,t as x}from"./index-N5JcrWW5.js";import{u as re}from"./useQuery-sYFIGfif.js";import{u as m,g as h}from"./roleCheck-B8-FOucE.js";import{c as $}from"./Card-uunZ-W1T.js";import{A as ne,S as le}from"./AssignStaff-CNWI0pu4.js";import{R as oe}from"./StageFileUploader-CiUKya3V.js";import{e as ie}from"./constants-GxzOlS2B.js";import{R as de}from"./ResetStageButton-ISumC15J.js";import ce from"./MaterialOverviewLoading-Dy329Vxv.js";import{S as ue}from"./ShareDocumentWhatsapp-BxyNQVx9.js";import"./getAllUsersApi-OD8cj1NK.js";import"./downloadFile-qiQjrd04.js";import"./Skeleton-Buq8V7lI.js";import"./documentationApi-CwJtnogm.js";const me=async({projectId:t,siteDetails:a,api:s})=>{const{data:r}=await s.post(`/sitemeasurement/createmeasurement/${t}`,{siteDetails:a});if(!r.ok)throw new Error(r.message);return r.data},he=async({projectId:t,room:a,api:s})=>{const{data:r}=await s.post(`/sitemeasurement/createroom/${t}`,{room:a});if(!r.ok)throw new Error(r.message);return r.data},xe=async({projectId:t,api:a})=>{const{data:s}=await a.get(`/sitemeasurement/getmeasurement/${t}`);if(!s.ok)throw new Error(s.message);return s.data},ge=async({projectId:t,api:a,payload:s})=>{const{data:r}=await a.put(`/sitemeasurement/updatecommonmeasurement/${t}`,s);if(!r.ok)throw new Error(r.message);return r.data},pe=async({projectId:t,api:a,roomId:s,room:r})=>{const{data:n}=await a.put(`/sitemeasurement/updateroommeasurement/${t}/${s}`,{room:r});if(!n.ok)throw new Error(n.message);return n.data},fe=async({projectId:t,api:a})=>{const{data:s}=await a.put(`/sitemeasurement/completionstatus/${t}`);if(!s.ok)throw new Error(s.message);return s.data},be=async({projectId:t,roomId:a,api:s})=>{const{data:r}=await s.patch(`/sitemeasurement/deleteroom/${t}/${a}`);if(!r.ok)throw new Error(r.message);return r.data},we=async({projectId:t,api:a})=>{const{data:s}=await a.put(`/sitemeasurement/deletesitemeasurement/${t}`);if(!s.ok)throw new Error(s.message);return s.data},ye=async({formId:t,projectId:a,deadLine:s,api:r})=>{const{data:n}=await r.put(`/sitemeasurement/deadline/${a}/${t}`,{deadLine:s});if(!n.ok)throw new Error(n.message);return n.data},je=async({formId:t,files:a,api:s,projectId:r})=>{const n=new FormData;return a.forEach(p=>n.append("file",p)),(await s.post(`/sitemeasurement/upload/multiple/${r}/${t}`,n,{headers:{"Content-Type":"multipart/form-data"}})).data},Ne=async(t,a,s)=>{const{data:r}=await s.patch(`/sitemeasurement/${t}/deleteuploadedfile/${a}`);if(!r.ok)throw new Error(r.message);return r.data},ve=()=>{const{role:t}=m(),a=h(t),s=["owner","staff","CTO","client"];return g({mutationFn:async({projectId:r,fileId:n})=>{if(!t||!s.includes(t))throw new Error("not allowed to make this api call");if(!a)throw new Error("API instance not found for role");return await Ne(r,n,a)},onSuccess:(r,{projectId:n})=>{b.invalidateQueries({queryKey:["siteMeasurement",n]})}})},Se=({projectId:t})=>{const a=["owner","staff","CTO","client"],{role:s}=m(),r=h(s);return re({queryKey:["siteMeasurement"],queryFn:async()=>{if(!s||!a.includes(s))throw new Error("not allowed to make this api call");if(!r)throw new Error("API instance not found for role");return await xe({projectId:t,api:r})},retry:!1,refetchOnWindowFocus:!1,staleTime:1e3*60*5})},Fe=()=>{const t=["owner","staff","CTO","client"],{role:a}=m(),s=h(a);return g({mutationFn:async({projectId:r,siteDetails:n})=>{if(!a||!t.includes(a))throw new Error("not allowed to make this api call");if(!s)throw new Error("API instance not found for role");return await me({projectId:r,api:s,siteDetails:n})},onSuccess:()=>{b.invalidateQueries({queryKey:["siteMeasurement"]})}})},ke=()=>{const t=["owner","staff","CTO","client"],{role:a}=m(),s=h(a);return g({mutationFn:async({projectId:r,room:n})=>{if(!a||!t.includes(a))throw new Error("not allowed to make this api call");if(!s)throw new Error("API instance not found for role");return await he({projectId:r,api:s,room:n})},onSuccess:()=>{b.invalidateQueries({queryKey:["siteMeasurement"]})}})},Ce=()=>{const t=["owner","staff","CTO","client"],{role:a}=m(),s=h(a);return g({mutationFn:async({projectId:r,payload:n})=>{if(!a||!t.includes(a))throw new Error("not allowed to make this api call");if(!s)throw new Error("API instance not found for role");return await ge({projectId:r,api:s,payload:n})},onSuccess:()=>{b.invalidateQueries({queryKey:["siteMeasurement"]})}})},Ee=()=>{const t=["owner","staff","CTO","client"],{role:a}=m(),s=h(a);return g({mutationFn:async({projectId:r,roomId:n,room:l})=>{if(!a||!t.includes(a))throw new Error("not allowed to make this api call");if(!s)throw new Error("API instance not found for role");return await pe({projectId:r,api:s,roomId:n,room:l})},onSuccess:()=>{b.invalidateQueries({queryKey:["siteMeasurement"]})}})},Ae=()=>{const t=["owner","staff","CTO","client"],{role:a}=m(),s=h(a);return g({mutationFn:async({projectId:r})=>{if(!a||!t.includes(a))throw new Error("not allowed to make this api call");if(!s)throw new Error("API instance not found for role");return await fe({projectId:r,api:s})},onSuccess:()=>{b.invalidateQueries({queryKey:["siteMeasurement"]})}})},Re=()=>{const t=["owner","staff","CTO","client"],{role:a}=m(),s=h(a);return g({mutationFn:async({projectId:r,roomId:n})=>{if(!a||!t.includes(a))throw new Error("not allowed to make this api call");if(!s)throw new Error("API instance not found for role");return await be({projectId:r,api:s,roomId:n})},onSuccess:()=>{b.invalidateQueries({queryKey:["siteMeasurement"]})}})},Me=()=>{const t=["owner","staff","CTO","client"],{role:a}=m(),s=h(a);return g({mutationFn:async({projectId:r})=>{if(!a||!t.includes(a))throw new Error("not allowed to make this api call");if(!s)throw new Error("API instance not found for role");return await we({projectId:r,api:s})},onSuccess:()=>{b.invalidateQueries({queryKey:["siteMeasurement"]})}})},Pe=()=>{const t=["owner","staff","CTO"],{role:a}=m(),s=h(a);return g({mutationFn:async({formId:r,projectId:n,deadLine:l})=>{if(!a)throw new Error("not authorized");if(!t.includes(a))throw new Error("you  dont have the access to make this api");if(!s)throw new Error("api is null");return await ye({formId:r,deadLine:l,projectId:n,api:s})}})},qe=()=>{const t=["owner","staff","CTO","client"],{role:a}=m(),s=h(a);return g({mutationFn:async({formId:r,files:n,projectId:l})=>{if(!a)throw new Error("not authorized");if(!t.includes(a))throw new Error("you  dont have the access to make this api");if(!s)throw new Error("api is null");return await je({formId:r,files:n,projectId:l,api:s})}})},Oe=({room:t,onEdit:a,onDelete:s,deleteRoomLoading:r})=>{const n=t.length&&t.breadth?(t.length*t.breadth).toFixed(2):null;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-700",children:t.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>a(t),className:"text-blue-600 hover:text-blue-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx(v,{isLoading:r,onClick:s,variant:"ghost",className:"!text-red-600 hover:text-red-800 bg-white shadow-none hover:!bg-none",children:e.jsx("i",{className:"fas fa-trash-can"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Length"}),e.jsxs("p",{className:"font-semibold text-gray-800",children:[t.length||0," ft"]})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Breadth"}),e.jsxs("p",{className:"font-semibold text-gray-800",children:[t.breadth||0," ft"]})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Height"}),e.jsxs("p",{className:"font-semibold text-gray-800",children:[t.height||0," ft"]})]})]}),n&&e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("p",{className:"text-blue-700 font-medium text-center",children:["Total Area: ",n," sq.ft"]})})]})},Le=({measurementData:t,handleDeleteSiteMeasurement:a,deleteRoomLoading:s,setShowSiteForm:r,setShowRoomForm:n,handleEditRoom:l,handleDeleteRoom:p})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Site Measurements"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>r(!0),className:"px-2 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Edit"}),e.jsx("button",{onClick:()=>a(),className:"px-2 sm:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Plot Area"}),e.jsx("p",{className:"text-lg font-semibold text-blue-700",children:t.siteDetails.totalPlotAreaSqFt!==null?`${t.siteDetails.totalPlotAreaSqFt} sq.ft`:"Not mentioned"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Built-up Area"}),e.jsx("p",{className:"text-lg font-semibold text-blue-700",children:t.siteDetails.builtUpAreaSqFt!=null?`${t.siteDetails.builtUpAreaSqFt} sq.ft`:"Not mentioned"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Road Facing"}),e.jsx("p",{className:"text-lg font-semibold text-blue-700",children:t.siteDetails.roadFacing===!0?"YES":t.siteDetails.roadFacing===!1?"NO":"Not mentioned"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Number of Floors"}),e.jsx("p",{className:"text-lg font-semibold text-blue-700",children:t.siteDetails.numberOfFloors!=null?t.siteDetails.numberOfFloors:"Not mentioned"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Is having Slope"}),e.jsx("p",{className:"text-lg font-semibold text-blue-700",children:t.siteDetails.hasSlope===!0?"YES":t.siteDetails.hasSlope===!1?"NO":"Not mentioned"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Is Boundary Wall exists"}),e.jsx("p",{className:"text-lg font-semibold text-blue-700",children:t.siteDetails.boundaryWallExists===!0?"YES":t.siteDetails.boundaryWallExists===!1?"NO":"Not mentioned"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Additional Notes"}),e.jsx("p",{className:"text-lg font-semibold text-blue-700",children:t.siteDetails.additionalNotes?t.siteDetails.additionalNotes:"Not mentioned"})]})]})]}),t.siteDetails.totalPlotAreaSqFt!==null&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Rooms"}),e.jsx("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"+ Add Room"})]}),t.rooms.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsx("p",{className:"text-gray-500",children:"No rooms added yet"})]}):e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.rooms.map((c,w)=>e.jsx(Oe,{room:c,onEdit:()=>l(c),onDelete:()=>p(c._id),deleteRoomLoading:s},w))})]})]}),Ie=j.memo(Le),Te=({roomDetails:t,setRoomDetails:a,handleRoomSubmit:s,setShowRoomForm:r,updateRoomLoading:n,createRoomLoading:l,editingRoomId:p})=>e.jsx("div",{className:"fixed inset-0 bg-black/70 bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md p-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:p?"Edit Room":"Add New Room"}),e.jsxs("select",{value:t.name||"",onChange:c=>a(w=>({...w,name:c.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4",children:[e.jsx("option",{value:"",children:"Select Room Type"}),ie.map(c=>e.jsx("option",{value:c,children:c}))]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"Length (ft)"}),e.jsx("input",{type:"number",placeholder:"Length (ft)",value:t.length||0,onChange:c=>a({...t,length:Number(c.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"Breadth (ft)"}),e.jsx("input",{type:"number",placeholder:"Breadth (ft)",value:t.breadth||0,onChange:c=>a({...t,breadth:Number(c.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"Height (ft)"}),e.jsx("input",{type:"number",placeholder:"Height (ft)",value:t.height||0,onChange:c=>a({...t,height:Number(c.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),t.length&&t.breadth&&e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:e.jsxs("p",{className:"text-blue-700 font-medium",children:["Calculated Area: ",(Number(t.length)*Number(t.breadth)).toFixed(2)," sq.ft"]})}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx(v,{isLoading:p?n:l,onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:p?"Edit Room":"Add Room"})]})]})}),$e=({siteDetails:t,updatePending:a,setSiteDetails:s,handleSiteSubmit:r,setShowSiteForm:n})=>e.jsx("div",{className:"fixed inset-0 bg-black/70 bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl p-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Site Measurements"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"Total Plot Area (sq.ft)"}),e.jsx("input",{type:"number",placeholder:"Total Plot Area (sq.ft)",value:t.totalPlotAreaSqFt||0,onChange:l=>s({...t,totalPlotAreaSqFt:Number(l.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"Built-up Area (sq.ft)"}),e.jsx("input",{type:"number",placeholder:"Built-up Area (sq.ft)",value:t.builtUpAreaSqFt||0,onChange:l=>s({...t,builtUpAreaSqFt:Number(l.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"Number of Floors"}),e.jsx("input",{type:"number",placeholder:"Number of Floors",value:t.numberOfFloors||0,onChange:l=>s({...t,numberOfFloors:Number(l.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.hasSlope??!1,onChange:l=>s({...t,hasSlope:l.target.checked}),className:"mr-2"}),"Has Slope"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.roadFacing??!1,onChange:l=>s({...t,roadFacing:l.target.checked}),className:"mr-2"}),"Road Facing"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.boundaryWallExists??!1,onChange:l=>s({...t,boundaryWallExists:l.target.checked}),className:"mr-2"}),"Boundary Wall Exists"]})]}),e.jsx("textarea",{placeholder:"Additional Notes",value:t.additionalNotes||"",onChange:l=>s({...t,additionalNotes:l.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4",rows:4}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(v,{variant:"secondary",onClick:()=>n(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx(v,{variant:"primary",onClick:r,isLoading:a,children:"Save Details"})]})]})}),Ue=j.memo($e),Be={totalPlotAreaSqFt:null,builtUpAreaSqFt:null,roadFacing:null,numberOfFloors:null,hasSlope:!1,boundaryWallExists:!1,additionalNotes:null},U={name:null,length:null,breadth:null,height:null};function tt(){var q,O,L,I,T;const{projectId:t,organizationId:a}=se(),{isMobile:s,openMobileSidebar:r}=ae();if(!t)return;const[n,l]=j.useState(!1),[p,c]=j.useState(!1),[w,B]=j.useState(Be),[y,k]=j.useState(U),[S,C]=j.useState(null);let{data:o,isLoading:W,refetch:F,error:f}=Se({projectId:t});const H=Fe(),E=ke(),A=Ce(),R=Ee(),M=Re(),K=Me(),P=Ae(),{mutateAsync:Q,isPending:z}=Pe(),{mutateAsync:_,isPending:Y}=qe(),{mutateAsync:G,isPending:V}=ve(),J=async()=>{var d,u;try{o?await A.mutateAsync({projectId:t,payload:w}):await H.mutateAsync({projectId:t,siteDetails:w}),l(!1),x({description:"Site details updated successfully",title:"Success"})}catch(i){x({title:"Error",description:((u=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:u.message)||i.message||"Failed to save site details",variant:"destructive"})}},X=async()=>{var d,u;try{if(!y.name)throw new Error("please select the name");const i=y.length&&y.breadth?(Number(y.length)*Number(y.breadth)).toFixed(2):null,N={...y,area:i};S?await R.mutateAsync({projectId:t,roomId:S,room:N}):await E.mutateAsync({projectId:t,room:N}),c(!1),C(null),k(U),x({description:S?"Room updated":"Room added",title:"Success"})}catch(i){x({title:"Error",description:((u=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:u.message)||(i==null?void 0:i.message)||"Operation failed",variant:"destructive"})}},Z=async d=>{var u,i;try{await M.mutateAsync({projectId:t,roomId:d}),x({description:"Room deleted",title:"Success"})}catch(N){x({title:"Error",description:((i=(u=N==null?void 0:N.response)==null?void 0:u.data)==null?void 0:i.message)||"Delete failed",variant:"destructive"})}},D=async()=>{var d,u;try{await K.mutateAsync({projectId:t}),x({description:"Site measurement deleted",title:"Success"})}catch(i){x({title:"Error",description:((u=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:u.message)||"Delete failed",variant:"destructive"})}},ee=async()=>{var d,u;try{await P.mutateAsync({projectId:t}),x({description:"Completion updated",title:"Success"})}catch(i){x({title:"Error",description:((u=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:u.message)||"Update failed",variant:"destructive"})}},te=d=>{k(d),C(d==null?void 0:d._id),c(!0)};return W?e.jsx(ce,{}):e.jsxs("div",{className:"container mx-auto px-2 py-2 max-w-full h-full w-full overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-blue-600 flex items-center",children:[s&&e.jsx("button",{onClick:r,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsx("i",{className:"fa-solid fa-receipt mr-2"})," Site Measurement"]}),e.jsx("p",{className:"text-gray-600 hidden sm:block text-sm sm:text-base",children:"Plan your dream home"})]}),e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2  !w-[100%] sm:!w-[50%] lg:!w-[60%] justify-start lg:justify-end",children:[e.jsxs(v,{isLoading:P.isPending,onClick:ee,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2  w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-circle-check mr-2"})," Mark Complete"]}),e.jsx(de,{projectId:t,stageNumber:2,stagePath:"sitemeasurement",className:"sm:!max-w-[20%] w-full"}),!f&&e.jsx(ue,{projectId:t,stageNumber:"2",className:"w-full sm:w-fit",isStageCompleted:o==null?void 0:o.status}),e.jsx(ne,{stageName:"SiteMeasurementModel",projectId:t,organizationId:a,currentAssignedStaff:(o==null?void 0:o.assignedTo)||null,className:"w-full sm:w-auto"})]})]}),f&&e.jsxs("div",{className:"max-w-xl mx-auto mt-4 p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500 text-sm mb-4",children:((O=(q=f==null?void 0:f.response)==null?void 0:q.data)==null?void 0:O.message)||"Failed to load data"}),e.jsx(v,{onClick:()=>F(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]}),!f&&e.jsxs($,{className:"p-4 mb-4 shadow border-l-4 border-blue-600 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-700 text-sm font-medium mb-2",children:[e.jsx("i",{className:"fa-solid fa-clock text-blue-500 text-lg"}),e.jsx("span",{children:"Stage Timings"})]}),e.jsx(le,{completedAt:(L=o==null?void 0:o.timer)==null?void 0:L.compltedAt,stageName:"sitemeasurement",formId:o==null?void 0:o._id,projectId:t,deadLine:(I=o==null?void 0:o.timer)==null?void 0:I.deadLine,startedAt:(T=o==null?void 0:o.timer)==null?void 0:T.startedAt,refetchStageMutate:F,deadLineMutate:Q,isPending:z})]}),!f&&e.jsx("div",{className:"mb-6",children:e.jsx($,{className:"p-4 shadow border-l-4 border-blue-500 bg-white",children:e.jsx(oe,{formId:o==null?void 0:o._id,refetch:F,existingUploads:o==null?void 0:o.uploads,onUploadComplete:F,uploadFilesMutate:_,uploadPending:Y,projectId:t,onDeleteUpload:G,deleteFilePending:V})})}),!f&&e.jsxs(e.Fragment,{children:[!Object.values((o==null?void 0:o.siteDetails)||{}).some(d=>d!==null)&&!n?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No Site Details Added"}),e.jsx("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Add Site Details"})]}):e.jsx(Ie,{measurementData:o,handleDeleteSiteMeasurement:D,setShowSiteForm:l,setShowRoomForm:c,handleEditRoom:te,handleDeleteRoom:Z,deleteRoomLoading:M.isPending}),n&&e.jsx(Ue,{siteDetails:w,setSiteDetails:B,handleSiteSubmit:J,setShowSiteForm:l,updatePending:A.isPending}),p&&e.jsx(Te,{handleRoomSubmit:X,setShowRoomForm:c,roomDetails:y,setRoomDetails:k,updateRoomLoading:R.isPending,createRoomLoading:E.isPending,editingRoomId:S})]})]})}export{tt as default};
