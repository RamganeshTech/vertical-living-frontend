import{Q as W,j as e,r as f}from"./index-DcYk0AxP.js";import{N as w}from"./constants-B8VJ7ujN.js";import{d as _}from"./downloadFile-BkM6wezt.js";var M=W();function R({images:a,onDelete:r,onDownload:p,isDeleting:u=!1,refetch:h,className:b="",minWidth:x=100,maxWidth:N=100,heightClass:I=0}){const[l,i]=f.useState(null),[g,k]=f.useState(!1),[P,C]=f.useState({}),y=(t,o,v)=>{const d=v/o,H=Math.max(150,Math.min(400,200*d));C(L=>({...L,[t]:H}))},E=t=>{i(t),k(!0)},c=()=>{k(!1),i(null)},m=()=>{l!==null&&i((l-1+a.length)%a.length)},j=()=>{l!==null&&i((l+1)%a.length)};f.useEffect(()=>{const t=o=>{o.key==="Escape"?c():o.key==="ArrowRight"?j():o.key==="ArrowLeft"&&m()};return g&&(document.addEventListener("keydown",t),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",t),document.body.style.overflow="unset"}},[g,j,m,c]);const $=async t=>{if(r)try{await r(t),h&&await h(),a.length<=1?c():l!==null&&l>=a.length-1&&i(Math.max(0,a.length-2))}catch(o){console.error("Error deleting image:",o)}},D=t=>{p({src:t==null?void 0:t.url,alt:(t==null?void 0:t.originalName)||"image"})},z=()=>{c()},n=l!==null&&l>=0&&l<a.length?a[l]:null;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`gap-1 flex flex-wrap ${b}`,children:a.map((t,o)=>{const v=P[t._id]||200;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative cursor-pointer bg-gray-100 overflow-hidden mb-1 break-inside-avoid",style:{flex:`0 1 ${x}px`,minWidth:`${x}px`,maxWidth:`${N}px`,height:`${I||v}px`},onClick:()=>E(o),children:[e.jsx("img",{src:(t==null?void 0:t.url)||w,alt:(t==null?void 0:t.originalName)||`Image ${o+1}`,className:"w-full cursor-pointer h-full object-cover",loading:"lazy",onLoad:d=>{const s=d.target;y(t._id,s.naturalWidth,s.naturalHeight)}}),e.jsx("img",{src:(t==null?void 0:t.url)||w,alt:(t==null?void 0:t.originalName)||`Image ${o+1}`,className:"w-full cursor-pointer h-full object-cover",loading:"lazy",onLoad:d=>{const s=d.target;y(t._id,s.naturalWidth,s.naturalHeight)}})]},t._id)})})}),g&&n&&M.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/70 flex items-center justify-center",onClick:z,style:{margin:0,padding:0},children:[e.jsxs("div",{className:"absolute top-6 right-6 z-[10000] flex items-center gap-4",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),D(n)},className:"bg-black/50 hover:bg-black/70 text-white rounded-full p-3 transition-all duration-200",title:"Download",children:e.jsx("i",{className:"fas fa-download text-lg"})}),r&&e.jsx("button",{onClick:t=>{t.stopPropagation(),$(n._id)},className:"bg-black/50 hover:bg-red-600/70 text-white rounded-full p-3 transition-all duration-200",title:"Delete",disabled:u,children:e.jsx("i",{className:`fas ${u?"fa-spinner fa-spin":"fa-trash-can"} text-lg`})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),c()},className:"bg-black/50 hover:bg-black/70 text-white rounded-full p-3 transition-all duration-200",title:"Close",children:e.jsx("i",{className:"fas fa-times text-xl"})})]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),m()},className:"absolute left-6 top-1/2 transform -translate-y-1/2 z-[10000] bg-black/50 hover:bg-black/70 text-white rounded-full p-3 transition-all duration-200",children:e.jsx("i",{className:"fas fa-chevron-left text-2xl"})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),j()},className:"absolute right-6 top-1/2 transform -translate-y-1/2 z-[10000] bg-black/50 hover:bg-black/70 text-white rounded-full p-3 transition-all duration-200",children:e.jsx("i",{className:"fas fa-chevron-right text-2xl"})}),e.jsx("div",{className:"relative flex items-center justify-center",style:{width:"70vw",height:"70vh",maxWidth:"70vw",maxHeight:"70vh"},onClick:t=>t.stopPropagation(),children:e.jsx("img",{src:(n==null?void 0:n.url)||w,alt:n.originalName||`Image ${l!==null?l+1:1}`,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 text-white text-sm bg-black/50 px-4 py-2 rounded-full",children:[l!==null?l+1:1," of ",a.length]})]}),document.body)]})}function G({imageFiles:a=[],height:r,refetch:p,handleDeleteFile:u,className:h="",minWidth:b,maxWidth:x}){return e.jsx(e.Fragment,{children:e.jsx(R,{images:a,onDelete:u,onDownload:_,refetch:p,isDeleting:!1,className:h,heightClass:r,minWidth:b,maxWidth:x})})}export{G as I,M as r};
