import{c as l,i as h,d as u,q as s,k as p,g as d,y as f}from"./index-CUvv9ev0.js";const g=async({api:t,filesBeforeWork:e,...o})=>{const n=new FormData;Object.entries(o).forEach(([r,c])=>{n.append(r,c.toString())}),e&&e.length>0&&e.forEach(r=>n.append("files",r));const{data:a}=await t.post("/subcontract/create",n,{headers:{"Content-Type":"multipart/form-data"}});if(!a.ok)throw new Error(a.message);return a.data},C=async({api:t,subContractId:e,workerData:o})=>{const{data:n}=await t.put(`/subcontract/update/${e}`,{workerData:o});if(!n.ok)throw new Error(n.message);return n.data},E=async({params:t,api:e})=>{const o=new URLSearchParams;t.page&&o.append("page",t.page.toString()),t.limit&&o.append("limit",t.limit.toString()),t.status&&o.append("status",t.status),t.projectId&&o.append("projectId",t.projectId),t.search&&o.append("search",t.search),t.labourCostMin&&o.append("labourCostMin",t.labourCostMin),t.labourCostMax&&o.append("labourCostMax",t.labourCostMax),t.materialCostMin&&o.append("materialCostMin",t.materialCostMin),t.materialCostMax&&o.append("materialCostMax",t.materialCostMax),t.totalCostMin&&o.append("totalCostMin",t.totalCostMin),t.totalCostMax&&o.append("totalCostMax",t.totalCostMax),t.dateOfCommencementFrom&&o.append("dateOfCommencementFrom",t.dateOfCommencementFrom),t.dateOfCommencementTo&&o.append("dateOfCommencementTo",t.dateOfCommencementTo),t.dateOfCompletionFrom&&o.append("dateOfCompletionFrom",t.dateOfCompletionFrom),t.dateOfCompletionTo&&o.append("dateOfCompletionTo",t.dateOfCompletionTo);const{data:n}=await e.get(`/subcontract/getall/${t.organizationId}?${o.toString()}`);if(!n.ok)throw new Error(n.message);return n.data},k=async({subContractId:t,api:e})=>{const{data:o}=await e.get(`/subcontract/getsingle/${t}`);if(!o.ok)throw new Error(o.message);return o.data},S=async({subContractId:t,status:e,api:o})=>{const{data:n}=await o.put(`/subcontract/update-status/${t}`,{status:e});if(!n.ok)throw new Error(n.message);return n.data},F=async({subContractId:t,api:e})=>{const{data:o}=await e.delete(`/subcontract/delete/${t}`);if(!o.ok)throw new Error(o.message);return o.data},P=async({token:t,subContractId:e,workerData:o,files:n})=>{const a=new FormData;Object.entries(o).forEach(([c,w])=>{a.append(c,w.toString())}),n&&n.length>0&&n.forEach(c=>a.append("files",c));const{data:r}=await f.post(`https://houseofram.in/api/subcontract/public/submit/${e}?token=${t}`,a,{headers:{"Content-Type":"multipart/form-data"}});if(!r.ok)throw new Error(r.message);return r},I=async({subContractId:t,files:e})=>{const o=new FormData;e.forEach(a=>o.append("files",a));const{data:n}=await f.post(`https://houseofram.in/api/subcontract/public/upload-before-work/${t}`,o,{headers:{"Content-Type":"multipart/form-data"}});if(!n.ok)throw new Error(n.message);return n.data},M=async({subContractId:t,files:e})=>{const o=new FormData;e.forEach(a=>o.append("files",a));const{data:n}=await f.post(`https://houseofram.in/api/subcontract/public/upload-after-work/${t}`,o,{headers:{"Content-Type":"multipart/form-data"}});if(!n.ok)throw new Error(n.message);return n.data},O=async({subContractId:t})=>{const{data:e}=await f.get(`https://houseofram.in/api/subcontract/public/getsubcontract/basicdetail/${t}`);if(!e.ok)throw new Error(e.message);return e.data},i=["owner","staff","CTO","worker"],A=()=>{const{role:t}=l(),e=d(t);return u({mutationFn:async({organizationId:o,projectId:n,workName:a,dateOfCommencement:r,dateOfCompletion:c,workerName:w,filesBeforeWork:m,labourCost:b,materialCost:y})=>{if(!t||!i.includes(t))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await g({organizationId:o,projectId:n,workName:a,api:e,dateOfCommencement:r,dateOfCompletion:c,workerName:w,filesBeforeWork:m,labourCost:b,materialCost:y})},onSuccess:(o,n)=>{s.invalidateQueries({queryKey:["subcontracts","list",n.organizationId]})}})},$=()=>{const{role:t}=l(),e=d(t);return u({mutationFn:async({subContractId:o,workerData:n})=>{if(!t||!i.includes(t))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await C({subContractId:o,workerData:n,api:e})},onSuccess:()=>{s.invalidateQueries({queryKey:["subcontract","submission"]})}})},x=t=>{const{role:e}=l(),o=d(e);return h({queryKey:["subcontracts","list",t],queryFn:async({pageParam:n=1})=>{if(!e||!i.includes(e))throw new Error("Not allowed to make this API call");if(!o)throw new Error("API instance not found for role");return await E({params:{...t,page:n},api:o})},getNextPageParam:n=>{if(n.pagination.currentPage<n.pagination.totalPages)return n.pagination.currentPage+1},getPreviousPageParam:n=>{if(n.pagination.currentPage>1)return n.pagination.currentPage-1},initialPageParam:1,enabled:!!e&&i.includes(e)&&!!t.organizationId})},D=({subContractId:t})=>{const{role:e}=l(),o=d(e);return p({queryKey:["subcontract",t],queryFn:async()=>{if(!e||!i.includes(e))throw new Error("Not allowed to make this API call");if(!o)throw new Error("API instance not found for role");return await k({subContractId:t,api:o})},enabled:!!e&&i.includes(e)&&!!t})},v=()=>{const{role:t}=l(),e=d(t);return u({mutationFn:async({subContractId:o,status:n})=>{if(!t||!i.includes(t))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await S({subContractId:o,status:n,api:e})},onSuccess:(o,n)=>{s.invalidateQueries({queryKey:["subcontract",n.subContractId]}),s.invalidateQueries({queryKey:["subcontracts","list"]})}})},K=()=>{const{role:t}=l(),e=d(t);return u({mutationFn:async({subContractId:o})=>{if(!t||!i.includes(t))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await F({subContractId:o,api:e})},onSuccess:()=>{s.invalidateQueries({queryKey:["subcontracts","list"]})}})},T=()=>u({mutationFn:async({token:t,subContractId:e,workerData:o,files:n})=>await P({subContractId:e,workerData:o,files:n,token:t}),onSuccess:()=>{s.invalidateQueries({queryKey:["subcontract","submission"]})}}),Q=()=>u({mutationFn:async({subContractId:t,files:e})=>await I({subContractId:t,files:e}),onSuccess:(t,e)=>{s.invalidateQueries({queryKey:["subcontract","submission",e.subContractId]})}}),W=()=>u({mutationFn:async({subContractId:t,files:e})=>await M({subContractId:t,files:e}),onSuccess:(t,e)=>{s.invalidateQueries({queryKey:["subcontract","submission",e.subContractId]})}}),N=({subContractId:t})=>p({queryKey:["subcontract","submission",t],queryFn:async()=>await O({subContractId:t}),enabled:!!t});export{K as a,A as b,D as c,v as d,Q as e,W as f,$ as g,T as h,N as i,x as u};
