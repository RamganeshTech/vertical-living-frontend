import{r as y,u as I,a as G,h as ie,N as R,i as U,j as e,L as B,P as F,Q as K,T as V,U as H,V as Q,W as q,R as re}from"./index-IX_jUi_Z.js";import{M as le,b as ce,C as k}from"./constants-CGGnKgPh.js";import{b as J}from"./CTOApi-BeOUogGh.js";import{b as X}from"./clientApi-PrNgGECk.js";import{b as Z}from"./staffApi-CYqW3hqi.js";import{b as ee}from"./userApi-Dxpqdjvm.js";import{b as se}from"./workerApi-himsyIO8.js";import{B as _}from"./Button-D7Kb4xIQ.js";import{t as E}from"./toast-BSC5QTk1.js";import{u as de}from"./currentActiveStageApi-BTMOUmgS.js";function fe(x,c){y.useEffect(()=>{const r=o=>{o.ctrlKey&&o.key==="]"?(o.preventDefault(),c()):o.ctrlKey&&o.key==="["&&(o.preventDefault(),x())};window.addEventListener("keydown",r)},[c,x])}const ue=({labels:x,icons:c,path:r,setProjectName:o,projectName:P})=>{const[L,i]=y.useState(!1),{projectId:m}=I(),v=G(),b=ie(),g=b.pathname.split("/"),{organizationId:O}=I(),d=R(),{role:f}=U(s=>s.authStore),[a,h]=y.useState(""),{data:u,isLoading:A}=de(m),{mutateAsync:M,isPending:w}=J(),{mutateAsync:S,isPending:N}=X(),{mutateAsync:T,isPending:n}=Z(),{mutateAsync:p,isPending:l}=ee(),{mutateAsync:te,isPending:$}=se();y.useEffect(()=>{o&&u&&u.projectName&&!A&&o((u==null?void 0:u.projectName)||"Project")},[u,A]);const z=()=>{i(!1)},W=()=>{i(!0)},ae=g[2]==="projectdetails";y.useEffect(()=>{const t=b.pathname.split("/")[4];h(L?()=>le[t]:()=>ce[t])},[b.pathname,L]),fe(W,z);const D=g[2]==="projectdetails",oe=g[1]==="login",ne=()=>{D&&v(`/organizations/${O}/projects`),oe&&v("/organizations")},Y=async()=>{var s,t;try{f==="CTO"?await M():f==="client"?await S():f==="staff"?await T():f==="owner"?await p():f==="worker"&&await te(),d(F()),d(K()),d(V()),d(H()),d(Q()),d(q()),E({title:"Success",description:"logout successfull"}),(!w||!N||!n||!l||!$)&&v("/")}catch(j){E({title:"Error",description:((t=(s=j==null?void 0:j.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to logout",variant:"destructive"})}};return e.jsx(e.Fragment,{children:L?e.jsxs("aside",{onMouseLeave:()=>i(!1),className:"relative flex flex-col bg-[#2f303a] w-[17%] min-h-screen max-h-screen text-[#9ca3af] select-none transition-all duration-300",children:[e.jsxs("div",{className:"flex flex-col flex-grow overflow-y-auto overflow-x-hidden custom-scrollbar p-2 large-scrollbar",children:[e.jsxs("div",{onClick:ne,className:`flex ${D?"cursor-pointer":""} justify-between items-center border-b-1 py-2`,children:[e.jsx("span",{className:"text-xl",children:ae?P||"Project":k.COMPANY_NAME}),e.jsx("div",{className:"w-[30px] h-[30px]",children:e.jsx("img",{className:"w-full h-full",src:k.COMPANY_LOGO,alt:"LOGO"})})]}),e.jsxs("section",{className:"py-2 space-y-2",children:[" ",Object.entries(x).map(([s,t])=>{const j=a===t;return r[s]&&e.jsx(B,{to:r[s],className:"outline-none",children:e.jsxs("div",{onClick:()=>h(t),className:`cursor-pointer flex justify-between max-w-[95%] py-4 px-4 ${a===t?"bg-[#3a3b45] rounded-xl text-white":"rounded-xl hover:bg-[#3a3b45]"} `,ref:C=>{j&&C&&C.scrollIntoView({behavior:"smooth",block:"center"})},children:[e.jsx("span",{className:"text-lg",children:t}),e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-chevron-right"})})]})},t)})]})]}),e.jsxs("div",{className:"flex flex-col p-2 border-t border-[#3a3b45]",children:[g[1]!=="login"&&e.jsxs(_,{isLoading:w||N||n||l||$,onClick:Y,className:"flex items-center gap-2 px-4 py-3 rounded-lg !bg-[#3a3b45] !text-[#9ca3af] hover:!bg-[#464751] hover:!text-white transition",children:[e.jsx("i",{className:"fa-solid fa-right-from-bracket"}),e.jsx("span",{children:"Logout"})]}),e.jsx("button",{title:"Ctrl+] to close",onClick:z,className:"mt-2 flex items-center justify-center outline-none border border-blue-600 text-blue-500 hover:bg-[#3a3b45] rounded-lg w-full py-2",children:e.jsx("i",{className:"fa-solid fa-chevron-left"})})]})]}):e.jsxs("aside",{onMouseEnter:()=>i(!0),className:"flex flex-col relative justify-between bg-[#2f303a] w-[6%]  max-h-full  text-[#9ca3af] transition-all duration-300 ",children:[e.jsx("div",{className:"max-h-[95%] overflow-y-auto overflow-x-hidden custom-scrollbar ",children:e.jsx("div",{className:"flex items-center flex-col justify-between w-full",children:Object.entries(c).map(([s,t])=>{const j=(a==null?void 0:a.toLowerCase())===s.toLowerCase();return r[s]?e.jsx(B,{to:r[s],className:`${r[s]?"":"cursor-not-allowed"}`,children:e.jsx("div",{onClick:()=>h(s),className:`cursor-pointer flex justify-between max-w-[95%] py-4 px-4 ${(a==null?void 0:a.toLowerCase())===s.toLowerCase()?"bg-[#3a3b45] rounded-xl text-white":"rounded-xl hover:bg-[#3a3b45]"} `,ref:C=>{j&&C&&C.scrollIntoView({behavior:"smooth",block:"center"})},children:e.jsx("i",{className:`${t} ${(a==null?void 0:a.toLowerCase())===s.toLowerCase()?"text-[#4a86f7]":"text-[#9ca3af]"} `})})},s):e.jsx("div",{className:"cursor-not-allowed flex justify-between max-w-[95%] py-4 px-4",children:e.jsx("i",{className:`${t}`})})})})}),e.jsxs("div",{className:"flex flex-col items-center p-2 border-t border-[#3a3b45]",children:[g[1]!=="login"&&e.jsx(_,{isLoading:w||N||n||l||$,title:"logout",onClick:Y,className:"w-[40px] h-[40px] flex items-center justify-center !bg-[#3a3b45] !text-[#9ca3af] hover:!text-red-500 transition",children:e.jsx("i",{className:"fa-solid fa-right-from-bracket"})}),e.jsx("button",{title:"Ctrl+[ to open",onClick:W,className:"mt-2 cursor-pointer outline-none border-[#9ca3af] h-[40px] w-[40px] flex items-center justify-center border rounded-lg",children:e.jsx("i",{className:"fa-solid fa-chevron-right text-[#4a86f7]"})})]})]})})},Le=y.memo(ue),ve=({isOpen:x,onClose:c,labels:r,path:o})=>{const P=G(),{organizationId:L}=I(),i=R(),{role:m}=U(n=>n.authStore),{mutateAsync:v,isPending:b}=J(),{mutateAsync:g,isPending:O}=X(),{mutateAsync:d,isPending:f}=Z(),{mutateAsync:a,isPending:h}=ee(),{mutateAsync:u,isPending:A}=se(),M=async()=>{var n,p;try{m==="CTO"?await v():m==="client"?await g():m==="staff"?await d():m==="owner"?await a():m==="worker"&&await u(),i(F()),i(K()),i(V()),i(H()),i(Q()),i(q()),E({title:"Success",description:"logout successfull"}),(!b||!O||!f||!h||!A)&&P("/")}catch(l){E({title:"Error",description:((p=(n=l==null?void 0:l.response)==null?void 0:n.data)==null?void 0:p.message)||"Failed to logout",variant:"destructive"})}};let w=Object.entries(r);const S=location.pathname.split("/"),N=S[2]==="projectdetails",T=()=>{N&&P(`/organizations/${L}/projects`)};return e.jsxs(e.Fragment,{children:[x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:c}),e.jsxs("aside",{className:`fixed top-0 left-0 z-50 h-screen bg-white w-[75%] flex flex-col transition-transform duration-300 ${x?"translate-x-0":"-translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{onClick:T,className:`flex items-center gap-3 ${N?"cursor-pointer":""}`,children:[e.jsx("img",{src:k.COMPANY_LOGO,alt:"Logo",className:"w-10 h-10 rounded-full object-cover"}),e.jsx("span",{className:"text-lg font-semibold",children:k.COMPANY_NAME})]}),e.jsx("button",{onClick:c,className:"text-xl text-gray-700",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("nav",{className:"flex flex-col flex-grow overflow-y-auto p-4",children:w.map(([n,p],l)=>e.jsxs(re.Fragment,{children:[o[n]?e.jsx(B,{to:o[n],onClick:c,className:"text-gray-800 hover:bg-gray-100 p-3 rounded block",children:p}):e.jsx("span",{className:"text-gray-400 p-3 rounded cursor-not-allowed block",children:p}),l<w.length-1&&e.jsx("hr",{className:"border-t border-gray-200 my-1"})]},n))}),e.jsx("div",{className:"border-t border-gray-200 p-4",children:S[1]!=="login"&&e.jsxs(_,{className:"w-full flex items-center justify-center gap-2",isLoading:b||O||f||h||A,onClick:M,children:[e.jsx("i",{className:"fas fa-sign-out-alt"})," Logout"]})})]})]})};export{ve as M,Le as S};
