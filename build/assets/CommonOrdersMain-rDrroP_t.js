import{u as _,f as F,a as A,r as l,j as e,O as M,B as t,L as O,I as N,t as R}from"./index-DCvjwNGU.js";import{u as T,a as U,b as B,c as H}from"./commonOrderHistoryMaterialApi-CBCQYOw9.js";import{C as K,a as G,b as V,c as $,d as q}from"./Card-D6Sc2MI-.js";const Y=()=>{const{organizationId:f}=_(),{openMobileSidebar:C,isMobile:y}=F(),v=A(),[c,d]=l.useState(""),[j,r]=l.useState(!1),[n,m]=l.useState(null),[x,o]=l.useState(""),{data:i,isLoading:w,error:P,refetch:u}=T(f),{mutateAsync:b,isPending:k}=U(),{mutateAsync:E,isPending:S}=B(),{mutateAsync:D,isPending:z}=H(),g=location.pathname.split("/");if(g[g.length-1]!=="commonorder")return e.jsx(M,{context:{openMobileSidebar:C,isMobile:y}});const p=async()=>{c.trim()||R({title:"Error",description:"Project Name is mandatory",variant:"destructive"});try{await b({organizationId:f,payload:{projectName:c}}),d(""),r(!1),await u()}catch(a){console.error(a)}},I=async a=>{if(window.confirm("Are you sure?"))try{await E({id:a}),await u()}catch(s){console.error(s)}},L=async()=>{if(!(!x.trim()||!n))try{await D({id:n,payload:{projectName:x}}),m(null),o(""),await u()}catch(a){console.error(a)}};return e.jsxs("div",{className:"max-w-full mx-auto p-2 space-y-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("h1",{className:"text-2xl font-bold text-blue-600",children:[e.jsx("i",{className:"fas fa-layer-group mr-2"}),"Common Projects"]}),!j&&e.jsxs(t,{variant:"primary",onClick:()=>r(!0),children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Create New Project"]})]}),j&&e.jsx("div",{onClick:()=>r(!1),className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{onClick:a=>a.stopPropagation(),className:"flex rounded-2xl bg-white flex-col p-6 gap-3 max-w-lg items-start",children:[e.jsx(O,{className:"text-2xl",children:"Create Project"}),e.jsx(N,{placeholder:"Enter project name",value:c,onChange:a=>d(a.target.value),autoFocus:!0,onKeyDown:a=>{a.key==="Enter"&&p()}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{variant:"primary",onClick:p,isLoading:k,children:[e.jsx("i",{className:"fas fa-save mr-2"}),"Save"]}),e.jsx(t,{variant:"ghost",onClick:()=>{r(!1),d("")},children:"Cancel"})]})]})}),w&&e.jsx("p",{children:"Loading projects..."}),P&&e.jsx("p",{className:"text-red-500",children:"Something went wrong while loading projects."}),(i==null?void 0:i.length)===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center text-gray-500",children:[e.jsx("i",{className:"fas fa-folder-open text-5xl text-blue-300 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold",children:"No Projects Found"}),e.jsx("p",{children:"Create a project to start managing materials more efficiently."})]}),e.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3",children:i==null?void 0:i.map(a=>{var h;return e.jsx("div",{className:"transition-transform hover:scale-[1.02] cursor-pointer",children:e.jsxs(K,{className:"shadow-md hover:shadow-lg border-l-4 border-blue-600",children:[e.jsx(G,{children:n===a._id?e.jsx(N,{value:x,onChange:s=>{o(s.target.value)},autoFocus:!0,onKeyDown:s=>{s.key},placeholder:"Edit project name"}):e.jsxs(V,{className:"line-clamp-1",children:[e.jsx("i",{className:"fas fa-project-diagram mr-2 text-blue-500"}),a.projectName||"Untitled"]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs(q,{children:[e.jsx("i",{className:"fas fa-tasks mr-1 text-gray-400"}),"Order Units:"," ",e.jsx("span",{className:"font-medium text-blue-600",children:(h=a==null?void 0:a.selectedUnits)==null?void 0:h.length})]}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:n===a._id?e.jsxs(e.Fragment,{children:[e.jsxs(t,{size:"sm",variant:"primary",onClick:s=>{s.stopPropagation(),L()},isLoading:z,children:[e.jsx("i",{className:"fas fa-check mr-1"}),"Save"]}),e.jsx(t,{size:"sm",variant:"ghost",onClick:s=>{s.stopPropagation(),m(null),o("")},children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{size:"sm",variant:"outline",onClick:s=>{s.stopPropagation(),m(a._id),o(a.projectName||"")},children:[e.jsx("i",{className:"fas fa-edit mr-1 text-blue-500"}),"Edit"]}),e.jsxs(t,{size:"sm",variant:"danger",onClick:s=>{s.stopPropagation(),I(a._id)},isLoading:S,className:"hover:text-white",children:[e.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Delete"]}),e.jsxs(t,{size:"sm",variant:"secondary",onClick:s=>{s.stopPropagation(),v(`${a._id}`)},children:[e.jsx("i",{className:"fas fa-eye mr-1 text-blue-600"}),"View"]})]})})]})]})},a._id)})})]})};export{Y as default};
