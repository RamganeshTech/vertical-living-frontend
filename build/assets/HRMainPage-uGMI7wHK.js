import{k as me,r as b,j as e,ak as xe,t as H,a as ge,B as ee,af as he,u as be,O as ye}from"./index-BAM0eJUz.js";import{d as je,e as Ne,f as ve}from"./HrApi-2DedV8cJ.js";import{S as we}from"./StageGuide-e28gQ0h1.js";import"./useInfiniteQuery-BGz0VllC.js";const Ce=({organizationId:i,onSuccess:I})=>{var S,E,G,K,A,Q,L,O,Z,R,M,z,o,p,f,h,F,P,T,_,U,se,ae,te,re,le,ne,oe,ie,ce,de;const u=je(),{role:x,permission:y}=me(),d=x==="owner"||((S=y==null?void 0:y.hr)==null?void 0:S.create),[g,N]=b.useState("personal"),[m,v]=b.useState(null),[j,w]=b.useState([]),[t,J]=b.useState({organizationId:i,empId:null,employeeModel:null,empRole:"organization_staff",personalInfo:{empName:"",dateOfBirth:new Date,email:"",phoneNo:"",gender:"male",maritalStatus:"unmarried",address:{street:"",city:"",state:"",pincode:"",country:"India"},emergencyContact:{name:"",relationship:"",phone:""}},employment:{joinDate:new Date,designation:"",department:"",employmentType:"full_time",salary:{basic:0,hra:0,allowances:0,total:0},workLocation:""},documents:[],status:"active"}),D=s=>{var l;const r=[];return/^\d{10}$/.test(s.personalInfo.phoneNo)||r.push("Phone number must be exactly 10 digits."),(l=s.personalInfo.emergencyContact)!=null&&l.phone&&!/^\d{10}$/.test(s.personalInfo.emergencyContact.phone)&&r.push("Emergency contact phone must be exactly 10 digits."),s.personalInfo.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.personalInfo.email)&&r.push("Invalid email format."),s.personalInfo.empName.trim()||r.push("Employee name is required."),/^\d{6}$/.test(s.personalInfo.address.pincode)||r.push("Pincode must be exactly 6 digits."),r},n=(s,r,l,c)=>{J(C=>{var B,$,X;if(!C)return C;const a=JSON.parse(JSON.stringify(C));if(c){if(s==="personalInfo")(typeof a.personalInfo!="object"||a.personalInfo===null)&&(a.personalInfo={}),c in a.personalInfo||(a.personalInfo[c]={}),a.personalInfo[c][r]=l;else if(s==="employment"&&((typeof a.employment!="object"||a.employment===null)&&(a.employment={}),c in a.employment||(a.employment[c]={}),a.employment[c][r]=l,c==="salary")){const ue=r==="basic"?l:((B=a.employment.salary)==null?void 0:B.basic)||0,pe=r==="hra"?l:(($=a.employment.salary)==null?void 0:$.hra)||0,fe=r==="allowances"?l:((X=a.employment.salary)==null?void 0:X.allowances)||0;a.employment.salary||(a.employment.salary={}),a.employment.salary.total=Number(ue)+Number(pe)+Number(fe)}}else switch(s){case"empRole":a.empRole=l;break;case"status":a.status=l;break;case"personalInfo":(typeof a.personalInfo!="object"||a.personalInfo===null)&&(a.personalInfo={}),a.personalInfo={...a.personalInfo,[r]:l};break;case"employment":(typeof a.employment!="object"||a.employment===null)&&(a.employment={}),a.employment={...a.employment,[r]:l};break}return a})},k=(s,r)=>{var a;const l=(a=s.target.files)==null?void 0:a[0];if(!l)return;v(r);const c=URL.createObjectURL(l),C={type:r,fileName:l.name,fileUrl:c,uploadedAt:new Date};w(B=>[...B,C]),setTimeout(()=>{v(null),s.target.value=""},1e3)},Y=s=>{w(r=>r.filter((l,c)=>c!==s))},V=async()=>{var s,r;try{const l=D(t);if(l.length>0){l.forEach(a=>{H({title:"Validation Error",description:a,variant:"destructive"})});return}const c=new FormData,C={...t,documents:[]};c.append("employeeData",JSON.stringify(C)),await Promise.all(j.map(async a=>{const $=await(await fetch(a.fileUrl)).blob(),X=new File([$],a.fileName,{type:$.type});c.append(a.type,X)})),await u.mutateAsync({formData:c}),H({title:"Success",description:"Employee created successfully"})}catch(l){H({title:"Error",description:((r=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to create employee",variant:"destructive"})}},q=s=>s?new Date(s).toLocaleDateString("en-IN"):"N/A",W=s=>!s||s.total===0?"N/A":new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s.total);if(d)return e.jsx("div",{className:"max-h-full overflow-y-auto bg-gray-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{onClick:I,className:"bg-slate-50 hover:bg-slate-300 flex items-center justify-between w-8 h-8 border border-[#a6aab8] text-sm cursor-pointer rounded-md px-2",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 ml-3",children:"Create New Employee"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:V,disabled:u.isPending,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors text-sm font-medium",children:u.isPending?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save mr-2"}),"Create Employee"]})}),e.jsxs("button",{onClick:I,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium",children:[e.jsx("i",{className:"fas fa-times mr-2"}),"Cancel"]})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"personal",label:"Personal Info",icon:"fas fa-user"},{id:"employment",label:"Employment",icon:"fas fa-briefcase"},{id:"documents",label:"Documents",icon:"fas fa-file-alt"}].map(s=>e.jsxs("button",{onClick:()=>N(s.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${g===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("i",{className:`${s.icon} mr-2`}),s.label]},s.id))})}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(95vh-150px)] custom-scrollbar",children:[g==="personal"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",value:t.personalInfo.empName,onChange:s=>n("personalInfo","empName",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:t.personalInfo.email,onChange:s=>n("personalInfo","email",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),e.jsx("input",{type:"tel",maxLength:10,value:t.personalInfo.phoneNo,onChange:s=>n("personalInfo","phoneNo",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsxs("select",{value:t.personalInfo.gender,onChange:s=>n("personalInfo","gender",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",value:(E=t==null?void 0:t.personalInfo)!=null&&E.dateOfBirth?new Date(t.personalInfo.dateOfBirth).toISOString().split("T")[0]:"",onChange:s=>n("personalInfo","dateOfBirth",new Date(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marital Status"}),e.jsxs("select",{value:(G=t==null?void 0:t.personalInfo)==null?void 0:G.maritalStatus,onChange:s=>n("personalInfo","maritalStatus",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"unmarried",children:"UnMarried"}),e.jsx("option",{value:"married",children:"Married"}),e.jsx("option",{value:"divorced",children:"Divorced"}),e.jsx("option",{value:"widowed",children:"Widowed"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Address & Emergency Contact"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:"Address"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street"}),e.jsx("input",{type:"text",value:(A=(K=t==null?void 0:t.personalInfo)==null?void 0:K.address)==null?void 0:A.street,onChange:s=>n("personalInfo","street",s.target.value,"address"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:(L=(Q=t.personalInfo)==null?void 0:Q.address)==null?void 0:L.city,onChange:s=>n("personalInfo","city",s.target.value,"address"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),e.jsx("input",{type:"text",value:(Z=(O=t.personalInfo)==null?void 0:O.address)==null?void 0:Z.state,onChange:s=>n("personalInfo","state",s.target.value,"address"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pincode"}),e.jsx("input",{type:"text",maxLength:6,value:(M=(R=t.personalInfo)==null?void 0:R.address)==null?void 0:M.pincode,onChange:s=>{const r=s.target.value;/^\d*$/.test(r)&&n("personalInfo","pincode",s.target.value,"address")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsx("input",{type:"text",value:(o=(z=t.personalInfo)==null?void 0:z.address)==null?void 0:o.country,onChange:s=>n("personalInfo","country",s.target.value,"address"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"space-y-3 pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:"Emergency Contact"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",value:(f=(p=t==null?void 0:t.personalInfo)==null?void 0:p.emergencyContact)==null?void 0:f.name,onChange:s=>n("personalInfo","name",s.target.value,"emergencyContact"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Relationship"}),e.jsx("input",{type:"text",value:(F=(h=t.personalInfo)==null?void 0:h.emergencyContact)==null?void 0:F.relationship,onChange:s=>n("personalInfo","relationship",s.target.value,"emergencyContact"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",maxLength:10,value:(T=(P=t.personalInfo)==null?void 0:P.emergencyContact)==null?void 0:T.phone,onChange:s=>n("personalInfo","phone",s.target.value,"emergencyContact"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})]})}),g==="employment"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Job Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation *"}),e.jsx("input",{type:"text",value:(_=t.employment)==null?void 0:_.designation,onChange:s=>n("employment","designation",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs("select",{value:(U=t.employment)==null?void 0:U.department,onChange:s=>n("employment","department",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Department"}),(se=xe)==null?void 0:se.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),e.jsxs("select",{value:(ae=t.employment)==null?void 0:ae.employmentType,onChange:s=>n("employment","employmentType",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"full_time",children:"Full Time"}),e.jsx("option",{value:"part_time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"intern",children:"Intern"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Join Date"}),e.jsx("input",{type:"date",value:t.employment.joinDate?new Date(t.employment.joinDate).toISOString().split("T")[0]:"",onChange:s=>n("employment","joinDate",new Date(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Location"}),e.jsx("input",{type:"text",value:(te=t.employment)==null?void 0:te.workLocation,onChange:s=>n("employment","workLocation",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Status"}),e.jsxs("select",{value:t.status,onChange:s=>n("status","",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Salary Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Basic Salary"}),e.jsx("input",{type:"number",value:(le=(re=t.employment)==null?void 0:re.salary)==null?void 0:le.basic,onChange:s=>n("employment","basic",parseFloat(s.target.value)||0,"salary"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HRA"}),e.jsx("input",{type:"number",value:(oe=(ne=t.employment)==null?void 0:ne.salary)==null?void 0:oe.hra,onChange:s=>n("employment","hra",parseFloat(s.target.value)||0,"salary"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allowances"}),e.jsx("input",{type:"number",value:(ce=(ie=t.employment)==null?void 0:ie.salary)==null?void 0:ce.allowances,onChange:s=>n("employment","allowances",parseFloat(s.target.value)||0,"salary"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-200",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Salary"}),e.jsx("p",{className:"text-xl font-bold text-green-600 py-2",children:W((de=t.employment)==null?void 0:de.salary)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Role"}),e.jsxs("select",{value:t.empRole,onChange:s=>n("empRole","",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"organization_staff",children:"Organization Staff"}),e.jsx("option",{value:"nonorganization_staff",children:"Non-Organization Staff"})]})]})]})]})}),g==="documents"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Employee Documents"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Total Documents: ",j.length]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Upload Documents"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:["resume","aadhar","pan","passport","education","experience"].map(s=>e.jsx("div",{className:"text-center",children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,",onChange:r=>k(r,s),className:"hidden",disabled:m===s}),e.jsx("div",{className:`p-4 border-2 border-dashed rounded-lg transition-colors ${m===s?"border-blue-300 bg-blue-50":"border-gray-300 hover:border-blue-400 hover:bg-blue-50"}`,children:m===s?e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-blue-600 text-2xl mb-2"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Uploading..."})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-upload text-gray-400 text-2xl mb-2"}),e.jsx("p",{className:"text-xs text-gray-600 capitalize",children:s})]})})]})},s))})]}),e.jsx("div",{className:"space-y-4",children:j.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map((s,r)=>{var l;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:e.jsx("i",{className:"fas fa-file-alt text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900 capitalize",children:((l=s.type)==null?void 0:l.replace("_"," "))||"Document"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.fileName||"Unknown file"})]})]}),e.jsx("button",{onClick:()=>Y(r),className:"text-red-600 hover:text-red-800 transition-colors p-1",title:"Delete document",children:e.jsx("i",{className:"fas fa-trash text-sm"})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:["Uploaded: ",s.uploadedAt?q(s.uploadedAt):"N/A"]}),s.fileUrl&&e.jsxs("a",{href:s.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 font-medium",children:[e.jsx("i",{className:"fas fa-external-link-alt mr-1"}),"View"]})]})]},r)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"fas fa-file-alt text-gray-300 text-6xl mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Documents Uploaded"}),e.jsx("p",{className:"text-gray-600",children:"Upload documents using the section above."})]})})]})]})]})})},Ie=i=>{switch(i){case"organization_staff":return"bg-blue-100 text-blue-800";case"nonorganization_staff":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},ke=({employee:i,handleDeleteEmployee:I,deleteEmployeeMutation:u})=>{var d,g,N,m,v;const x=ge(),y=j=>{switch(j){case"WorkerModel":return"Worker";case"CTOModel":return"CTO";case"UserModel":return"Admin";default:return"N/A"}};return e.jsx(e.Fragment,{children:e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((d=i.personalInfo)==null?void 0:d.empName)||"N/A"})})})}),e.jsxs("td",{className:"px-6 py-4 text-center",children:[e.jsx("div",{className:"text-sm text-gray-900",children:((g=i.personalInfo)==null?void 0:g.email)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500 ",children:((N=i.personalInfo)==null?void 0:N.phoneNo)||"N/A"})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"text-sm text-gray-900",children:(m=i.employment)!=null&&m.department||(i==null?void 0:i.employeeModel)==="StaffModel"?((v=i.employment)==null?void 0:v.department)||"N/A":y(i==null?void 0:i.employeeModel)})}),e.jsx("td",{className:"px-6 py-4 text-center ",children:e.jsx("div",{children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ie(i.empRole)}`,children:i!=null&&i.empRole?i.empRole==="organization_staff"?"Organization Staff":"Non-Organization Staff":"N/A"})})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(ee,{variant:"secondary",onClick:()=>x(i._id),className:"text-blue-600 hover:text-blue-800 font-medium text-sm",children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"View"]}),e.jsxs(ee,{variant:"danger",onClick:()=>I(i._id),className:"text-white  bg-red-600 font-medium text-sm",disabled:u.isPending,children:[u.isPending?e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}):e.jsx("i",{className:"fas fa-trash mr-1"}),"Delete"]})]})})]})})},Le=()=>{var R,M,z;const{openMobileSidebar:i,isMobile:I}=he(),{organizationId:u}=be(),[x,y]=b.useState({}),[d,g]=b.useState(""),{role:N,permission:m}=me(),v=N==="owner"||((R=m==null?void 0:m.hr)==null?void 0:R.list),j=N==="owner"||((M=m==null?void 0:m.hr)==null?void 0:M.create),{data:w,fetchNextPage:t,hasNextPage:J,isFetchingNextPage:D,isLoading:n,error:k,refetch:Y}=Ne(u,x),[V,q]=b.useState(!1),W=ve(),S=b.useMemo(()=>(w==null?void 0:w.pages.flatMap(o=>o.data))||[],[w]),E=b.useMemo(()=>d?S.filter(o=>{var p,f,h,F,P,T,_,U;return((f=(p=o.personalInfo)==null?void 0:p.empName)==null?void 0:f.toLowerCase().includes(d.toLowerCase()))||((F=(h=o.personalInfo)==null?void 0:h.email)==null?void 0:F.toLowerCase().includes(d.toLowerCase()))||((T=(P=o.personalInfo)==null?void 0:P.phoneNo)==null?void 0:T.includes(d))||((U=(_=o.employment)==null?void 0:_.designation)==null?void 0:U.toLowerCase().includes(d.toLowerCase()))}):S,[S,d]),G=()=>{J&&!D&&t()},K=async o=>{var p,f;if(window.confirm("Are you sure you want to delete this employee? This action cannot be undone."))try{await W.mutateAsync({empId:o}),H({title:"Success",description:"deleted successfully"})}catch(h){H({title:"Error",description:((f=(p=h==null?void 0:h.response)==null?void 0:p.data)==null?void 0:f.message)||"Failed to delete",variant:"destructive"})}},A=(o,p)=>{y(f=>({...f,[o]:p||void 0}))},Q=()=>{y({})},L=Object.values(x).filter(Boolean).length;if(n)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading Employees"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the employee data..."})]})});if(k)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-red-500 text-6xl mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Employees"}),e.jsx("p",{className:"text-gray-600 mb-4",children:k==null?void 0:k.message}),e.jsxs("button",{onClick:()=>Y(),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("i",{className:"fas fa-redo mr-2"}),"Try Again"]})]})});const O=location.pathname.split("/");return O[O.length-1]!=="hr"?e.jsx(ye,{context:{openMobileSidebar:i,isMobile:I}}):e.jsxs("div",{className:"min-h-full max-h-full overflow-y-auto bg-gray-50",children:[!V&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-users mr-3 text-blue-600"}),"Human Resources"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your organization's employees and their information"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search with Name or Email or Phno",value:d,onChange:o=>g(o.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full sm:w-80"})]}),j&&e.jsx("div",{children:e.jsx(ee,{onClick:()=>q(!0),children:"Create New Employee"})}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(we,{organizationId:u,stageName:"hr"})})]})]})})}),e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col xl:flex-row gap-6",children:[e.jsx("div",{className:"xl:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),L>0&&e.jsxs("button",{onClick:Q,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",L,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Type"}),e.jsxs("select",{value:x.empRole||"",onChange:o=>A("empRole",o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"organization_staff",children:"Organization Staff"}),e.jsx("option",{value:"nonorganization_staff",children:"Non-Organization Staff"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsxs("select",{value:(x==null?void 0:x.department)||"",onChange:o=>A("department",o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Department"}),(z=xe)==null?void 0:z.map(o=>e.jsx("option",{value:o,children:o},o))]})]})]})]})}),e.jsx("div",{className:"flex-1  max-h-[74vh] overflow-y-auto",children:E.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[e.jsx("i",{className:"fas fa-users text-gray-300 text-6xl mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No employees found"}),e.jsx("p",{className:"text-gray-600",children:d||Object.keys(x).length>0?"Try adjusting your search or filters":"Start by adding your first employee"})]}):e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:E.map(o=>e.jsx(ke,{employee:o,handleDeleteEmployee:K,deleteEmployeeMutation:W},o._id))})]})})}),J&&e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:G,disabled:D,className:"bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:D?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Load More Employees"]})})})]})})]})})]}),V&&e.jsx(Ce,{organizationId:u,onSuccess:()=>q(!1)})]})};export{Le as default};
