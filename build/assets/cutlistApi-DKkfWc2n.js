import{f as c,g as f,h as p,b as y,i as l}from"./index-BAM0eJUz.js";import{u as g}from"./useInfiniteQuery-BGz0VllC.js";const h=async({id:n,formData:t,api:e})=>{const s=n?`/cutlist/save?id=${n}`:"/cutlist/save",a=n?"put":"post",{data:o}=await e[a](s,t,{headers:{"Content-Type":"multipart/form-data"}});if(!o.ok)throw new Error(o.message);return o.data},m=async({organizationId:n,projectId:t,page:e,limit:s,search:a,startDate:o,endDate:i,api:w})=>{const r=new URLSearchParams;n&&r.append("organizationId",n),t&&r.append("projectId",t),e&&r.append("page",e.toString()),s&&r.append("limit",s.toString()),a&&r.append("search",a),o&&r.append("startDate",o),i&&r.append("endDate",i);const{data:d}=await w.get(`/cutlist/all?${r.toString()}`);if(!d.ok)throw new Error(d.message);return d},C=async({id:n,api:t})=>{const{data:e}=await t.get(`/cutlist/single/${n}`);if(!e.ok)throw new Error(e.message);return e.data},E=async({id:n,api:t})=>{const{data:e}=await t.delete(`/cutlist/${n}`);if(!e.ok)throw new Error(e.message);return e.data},A=async({id:n,api:t})=>{const{data:e}=await t.post(`/cutlist/generatepdf/${n}`);if(!e.ok)throw new Error(e.message);return e.data},u=["owner","staff","CTO"],S=()=>{const n=f(),{role:t}=c(),e=l(t);return p({mutationFn:async({id:s,formData:a})=>{if(!t||!u.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found");return await h({id:s,formData:a,api:e})},onSuccess:()=>{n.invalidateQueries({queryKey:["cutlists"]})}})},v=({organizationId:n,projectId:t,limit:e=10,search:s,startDate:a,endDate:o})=>{const{role:i}=c(),w=l(i);return g({queryKey:["cutlists","all",n,t,e,s,a,o],queryFn:async({pageParam:r=1})=>{if(!i||!u.includes(i))throw new Error("Not allowed");if(!w)throw new Error("API instance not found");return await m({organizationId:n,projectId:t,page:r,limit:e,search:s,startDate:a,endDate:o,api:w})},getNextPageParam:r=>{if(r.pagination&&r.pagination.page<r.pagination.totalPages)return r.pagination.page+1},initialPageParam:1,enabled:!!i&&u.includes(i)&&!!n})},F=n=>{const{role:t}=c(),e=l(t);return y({queryKey:["cutlists","single",n],queryFn:async()=>{if(!t||!u.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found");return await C({id:n,api:e})},refetchOnWindowFocus:!1,refetchOnMount:!1,enabled:!!t&&u.includes(t)&&!!n})},N=()=>{const n=f(),{role:t}=c(),e=l(t);return p({mutationFn:async s=>{if(!t||!u.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found");return await E({id:s,api:e})},onSuccess:()=>{n.invalidateQueries({queryKey:["cutlists"]})}})},Q=()=>{const n=f(),{role:t}=c(),e=l(t);return p({mutationFn:async({id:s})=>{if(!t||!u.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found");return await A({id:s,api:e})},onSuccess:()=>{n.invalidateQueries({queryKey:["cutlists"]})}})};export{N as a,F as b,S as c,Q as d,v as u};
