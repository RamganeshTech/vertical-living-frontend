import{r,a as te,u as ae,R as le,j as e,B as n,t as E}from"./index-sOEqqOOm.js";import{u as ie}from"./ExternalUnitAPi-BdfX0QuF.js";import{u as re}from"./selectedExternalApi-B994rWsk.js";import{I as ne}from"./Input-BLVPl92q.js";import{L as f}from"./Label-BG8NiAko.js";import{S as p,a as b,b as j,c as N,d as v}from"./Select-BbVXcQk6.js";import"./useInfiniteQuery-WGNmh8pu.js";const pe=()=>{const[m,w]=r.useState(""),[i,T]=r.useState(null),[W,x]=r.useState(!1),[t,I]=r.useState({height:"",width:"",depth:""}),[L,U]=r.useState(null),[d,z]=r.useState(1),B=te(),{projectId:M}=ae(),G=q(m,500),{data:y,error:S,fetchNextPage:C,hasNextPage:k,isFetchingNextPage:h,isLoading:u,isError:g,refetch:R}=ie(G),{mutateAsync:_,isPending:P}=re();function q(s,a){const[l,c]=r.useState(s);return le.useEffect(()=>{const o=setTimeout(()=>c(s),a);return()=>clearTimeout(o)},[s,a]),l}r.useEffect(()=>{k&&!h&&C()},[k,h,C]);const D=(y==null?void 0:y.pages.flatMap(s=>s.items))??[],A=s=>{const a=[];for(let l=s.start;l<=s.end;l+=20)a.push(l);return a},Q=s=>{const a={...s,dimention:s.dimention};T(a),I({height:a.dimention.height.start.toString(),width:a.dimention.width.start.toString(),depth:a.dimention.depth.start.toString()}),x(!0)};r.useEffect(()=>{if(i!=null&&i.price&&t.height&&t.width&&t.depth&&d){const s=H({height:t.height,width:t.width,depth:t.depth,unitPrice:i.price,quantity:d});U(s)}else U(null)},[t.height,t.width,t.depth,d,i==null?void 0:i.price]);const H=({height:s,width:a,depth:l,unitPrice:c,quantity:o})=>{if(!s||!a||!l||!c||!o)return 0;const V=Number(s),K=Number(a),X=Number(l),Y=V/304.8,Z=K/304.8,ee=X/304.8,se=Y*Z*ee;return Math.ceil(se*c)*o},F=(s,a)=>{I(l=>({...l,[s]:a}))},O=async()=>{var s,a;if(!(!i||!M||!t.height||!t.width||!t.depth)){if(t.height==="0"||t.width==="0"||t.depth==="0"){E({title:"Error",description:"dimentions cannot be zero",variant:"destructive"});return}try{const{dimention:l,_id:c,...o}=i,V={...o,dimention:{height:Number(t.height),width:Number(t.width),depth:Number(t.depth)},totalPrice:L,quantity:d};await _({projectId:M,selectedUnit:V}),E({title:"Success",description:"Unit added to selected items successfully"}),x(!1),T(null)}catch(l){E({title:"Error",description:((a=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to add unit",variant:"destructive"})}}},$=()=>{B(-1)},J=location.pathname.includes("projectdetails");return e.jsxs("div",{className:"max-h-full overflow-y-auto bg-gradient-to-br from-blue-50 to-cyan-50",children:[e.jsx("div",{className:"bg-white border-b border-blue-200 shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"pb-2 px-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[e.jsx(n,{onClick:$,variant:"outline",size:"icon",className:"p-2 lg:p-3 rounded-xl border border-blue-300 hover:bg-blue-50 transition-all duration-200 bg-transparent",title:"Go back",children:e.jsx("i",{className:"fa-solid fa-arrow-left text-blue-600"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("i",{className:"fa-solid fa-door-open text-white text-lg sm:text-xl lg:text-2xl"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-slate-800",children:"Wardrobe Units"}),e.jsx("p",{className:"text-slate-600 text-xs sm:text-sm lg:text-base hidden sm:block",children:"Premium home interior collection"})]})]})]}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsxs("div",{className:"relative w-full sm:w-64 lg:w-80",children:[e.jsx(ne,{type:"text",placeholder:"Search wardrobe units...",value:m,onChange:s=>w(s.target.value),className:"w-full pl-10 pr-10 py-3 border border-blue-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white shadow-sm hover:shadow-md"}),e.jsx("i",{className:"fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-400"}),m&&e.jsx("button",{onClick:()=>w(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx("i",{className:"fa-solid fa-times"})})]})})]})})}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8",children:[u&&e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 lg:h-16 lg:w-16 border-4 border-blue-200 border-t-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 font-medium",children:"Loading wardrobe units..."})]})}),g&&e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-red-200 p-6 lg:p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 lg:w-16 lg:h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fa-solid fa-exclamation-triangle text-red-500 text-xl lg:text-2xl"})}),e.jsx("h3",{className:"text-lg lg:text-xl font-semibold text-slate-800 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-red-600 mb-6",children:(S==null?void 0:S.message)||"Failed to load wardrobe units"}),e.jsxs(n,{onClick:()=>R(),variant:"danger",className:"px-6 py-3 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-xl hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[e.jsx("i",{className:"fa-solid fa-refresh mr-2"}),"Try Again"]})]})}),!u&&!g&&D.length===0&&e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 lg:p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 lg:w-24 lg:h-24 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("i",{className:"fa-solid fa-search text-slate-400 text-2xl lg:text-3xl"})}),e.jsx("h3",{className:"text-lg lg:text-xl font-semibold text-slate-800 mb-2",children:"No wardrobe units found"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Try adjusting your search terms or browse all categories"}),m&&e.jsxs(n,{onClick:()=>w(""),variant:"primary",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-xl hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[e.jsx("i",{className:"fa-solid fa-times mr-2"}),"Clear Search"]})]})}),!u&&!g&&D.length>0&&e.jsx("div",{className:"w-full min-h-[77vh]",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 3xl:grid-cols-7 4xl:grid-cols-8 gap-4 sm:gap-6",children:D.map((s,a)=>e.jsxs("div",{className:"group bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",style:{animationDelay:`${a*50}ms`},children:[e.jsxs("div",{className:"relative overflow-hidden",children:[s.image?e.jsx("img",{src:s.image.url||"/placeholder.svg",alt:s.image.originalName,className:"w-full h-40 sm:h-48 object-cover group-hover:scale-110 transition-transform duration-500"}):e.jsx("div",{className:"w-full h-40 sm:h-48 bg-gradient-to-br from-blue-100 to-cyan-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fa-solid fa-image text-3xl sm:text-4xl text-blue-400 mb-2"}),e.jsx("p",{className:"text-blue-500 text-xs sm:text-sm",children:"No Image"})]})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 bg-gradient-to-r from-emerald-500 to-teal-500 text-white px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-semibold shadow-lg",children:["â‚¹",s.price.toFixed(2)]})]}),e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-slate-800 mb-2 group-hover:text-blue-600 transition-colors line-clamp-2",children:s.unitName}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm text-slate-500 mb-3",children:[e.jsx("i",{className:"fa-solid fa-hashtag"}),e.jsx("span",{className:"truncate",children:s.unitCode})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-600",children:"Category"}),e.jsx("span",{className:"px-2 sm:px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:s.category})]})}),J&&e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:e.jsxs(n,{onClick:()=>Q(s),variant:"primary",className:"w-full px-4 py-2 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg hover:shadow-lg transition-all duration-200 transform hover:scale-105 font-medium text-sm",children:[e.jsx("i",{className:"fa-solid fa-plus mr-2"}),"Add to Selected"]})})]})]},s._id))})}),k&&!u&&!g&&e.jsx("div",{className:"flex justify-center mt-8 lg:mt-12",children:h?e.jsxs("div",{className:"flex items-center space-x-3 text-slate-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-blue-200 border-t-blue-500"}),e.jsx("span",{className:"font-medium",children:"Loading more products..."})]}):e.jsxs(n,{onClick:()=>C(),disabled:h,variant:"primary",className:"px-6 lg:px-8 py-3 lg:py-4 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-2xl hover:shadow-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[e.jsx("i",{className:"fa-solid fa-plus mr-2"}),"Load More Products"]})})]}),W&&i&&e.jsx("div",{className:"fixed inset-0  bg-black/70 bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-800",children:"Select Dimensions"}),e.jsx("button",{onClick:()=>x(!1),className:"p-2 rounded-lg hover:bg-slate-100 transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-slate-400"})})]}),e.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-slate-800 mb-2 line-clamp-2",children:i.unitName}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-slate-600",children:[e.jsx("span",{className:"truncate",children:i.unitCode}),e.jsxs("span",{className:"font-semibold text-emerald-600 ml-2",children:["Base Price: â‚¹",i.price.toFixed(2)]}),e.jsxs("span",{className:"font-semibold text-indigo-600 ml-2",children:["Final Price: â‚¹",L]})]})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx(f,{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quantity"}),e.jsxs(p,{value:d.toString(),onValueChange:s=>{z(Number(s))},children:[e.jsx(b,{className:"w-full bg-white",children:e.jsx(j,{placeholder:"Select quantity",selectedValue:d.toString()})}),e.jsx(N,{children:[...Array(10)].map((s,a)=>{const l=a+1;return e.jsx(v,{value:l.toString(),children:l},l)})})]})]}),e.jsxs("div",{children:[e.jsx(f,{className:"block text-sm font-medium text-slate-700 mb-2",children:"Height (mm)"}),e.jsxs(p,{onValueChange:s=>F("height",s),children:[e.jsx(b,{className:"w-full",children:e.jsx(j,{placeholder:"Select height",selectedValue:t.height})}),e.jsx(N,{children:A(i.dimention.height).map(s=>e.jsxs(v,{value:s.toString(),children:[s,"mm"]},s))})]})]}),e.jsxs("div",{children:[e.jsx(f,{className:"block text-sm font-medium text-slate-700 mb-2",children:"Width (mm)"}),e.jsxs(p,{onValueChange:s=>F("width",s),children:[e.jsx(b,{className:"w-full",children:e.jsx(j,{placeholder:"Select width",selectedValue:t.width})}),e.jsx(N,{children:A(i.dimention.width).map(s=>e.jsxs(v,{value:s.toString(),children:[s,"mm"]},s))})]})]}),e.jsxs("div",{children:[e.jsx(f,{className:"block text-sm font-medium text-slate-700 mb-2",children:"Depth (mm)"}),e.jsxs(p,{onValueChange:s=>F("depth",s),children:[e.jsx(b,{className:"w-full",children:e.jsx(j,{placeholder:"Select depth",selectedValue:t.depth})}),e.jsx(N,{children:A(i.dimention.depth).map(s=>e.jsxs(v,{value:s.toString(),children:[s,"mm"]},s))})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 mt-6",children:[e.jsx(n,{onClick:()=>x(!1),variant:"outline",className:"flex-1 px-4 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx(n,{onClick:O,disabled:P||!t.height||!t.width||!t.depth,variant:"primary",isLoading:P,className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg hover:shadow-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:P?"Adding...":e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-check mr-2"}),"Add to Selected"]})})]})]})})})]})};export{pe as default};
