import{c as S,d as b,a1 as w,j as e,B as D,t as f}from"./index-DyM6T-eT.js";import{C as T,b as v,d as _,a as A}from"./Card-CnQJFMCV.js";import{e as I}from"./staffTaskApi-Cv-tWSy6.js";import{d as F,f as P}from"./dateFormator-BGKi5rfZ.js";const $=({task:s})=>{var n,l,c;const u=S(),{role:t,permission:i}=b(),x=t==="owner"||((n=i==null?void 0:i.stafftask)==null?void 0:n.delete),{_id:p}=w(a=>a.authStore),h=t==="staff",{mutateAsync:g,isPending:j}=I(),N=async a=>{var o,m;try{await g({mainTaskId:a}),f({description:"Task Deleted Successfully",title:"Success"})}catch(r){f({title:"Error",description:((m=(o=r==null?void 0:r.response)==null?void 0:o.data)==null?void 0:m.message)||"Failed to delete task",variant:"destructive"})}},d=p===((l=s.assigneeId)==null?void 0:l._id),y=a=>{t==="staff"&&!d||u(`single/${a}`)},C=a=>{switch(a){case"queued":case"puased":case"done":return a;case"in_progress":return"In Progress";default:return"queued"}};return e.jsxs(T,{onClick:()=>y(s._id),className:`${t!=="staff"||d?"cursor-pointer":"cursor-not-allowed"} p-0 border-l-4 border-blue-600`,children:[e.jsx(v,{children:e.jsx(_,{children:(s==null?void 0:s.title.trim())||"No title"})}),e.jsxs(A,{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("i",{className:"fa-solid fa-calendar-days mr-2 text-blue-600"}),"Due: ",s.due?e.jsxs(e.Fragment,{children:[F(s.due)," - ",P(s==null?void 0:s.due)," "]}):e.jsx(e.Fragment,{children:"N/A"})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("i",{className:"fa-solid fa-layer-group mr-2 text-purple-600"}),"assignee: ",((c=s==null?void 0:s.assigneeId)==null?void 0:c.staffName)||"N/A"]}),e.jsxs("p",{className:"text-sm capitalize",children:[e.jsx("i",{className:"fa-solid fa-chart-line mr-2 text-yellow-500"}),"Status: ",C(s.status)]}),e.jsxs("p",{className:"text-sm capitalize",children:[e.jsx("i",{className:"fa-solid fa-building mr-2 text-indigo-500"}),"Department: ",s.department]}),e.jsx("div",{className:"flex gap-2 mt-3 justify-end",children:!h&&x&&e.jsxs(D,{size:"sm",onClick:a=>{a.stopPropagation(),N(s._id)},className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-md text-sm",isLoading:j,children:[e.jsx("i",{className:"fa-solid fa-trash mr-1"}),"Delete"]})})]})]},s._id)};export{$ as S};
