import{u as G,a as H,r as m,j as e,S as w,h as C,i as U,k as S,l as k,L as V,I as u,B as I,t as g}from"./index-Bq7s2LOU.js";import{b as J,c as Q,m as F}from"./fieldConfigs-B5q2G1BG.js";const W=["_id","organizationId","customId","images","createdAt","updatedAt","__v"];function Z({unitToEdit:r,setUnitToEdit:p}){const A=G(),{organizationId:q}=H(),[n,P]=m.useState((r==null?void 0:r.category)||"showcase"),h=F[n],[c,o]=m.useState(r||{}),[d,f]=m.useState([]),{mutateAsync:z,isPending:b}=J(),{mutateAsync:$,isPending:j}=Q();if(!h)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-red-100 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-xl border border-red-200 max-w-md",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-red-500 text-3xl mb-4 block text-center"}),e.jsx("p",{className:"text-red-600 text-center font-semibold",children:"Invalid unit type selected."})]})});const x=(s,a)=>{o(i=>({...i,[s]:a}))},B=s=>{s.target.files&&f(Array.from(s.target.files))},L=s=>Object.fromEntries(Object.entries(s).filter(([a])=>!W.includes(a))),O=async s=>{var a,i;s.preventDefault();try{if(!c.name)throw new Error("Name is required");if(!c.price||c.price<0)throw new Error("Enter valid price");const t={...c,category:n};if(r){const l=L(t);await $({unitId:r._id,formValues:l,unitType:n,files:d}),g({title:"Success",description:"Product updated successfully"})}else await z({organizationId:q,unitType:n,formValues:t,files:d}),g({title:"Success",description:"Product added successfully"})}catch(t){g({title:"Error",description:((i=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:i.message)||(t==null?void 0:t.message)||"operation failed",variant:"destructive"})}},_=s=>{P(s),o({}),f([])},M=()=>{p&&p(null)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50",children:[e.jsx("div",{className:"bg-white shadow-lg border-b",children:e.jsx("div",{className:"max-w-full mx-auto px-2 sm:px-6 lg:px-8 sm:py-6 py-3",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between sm:gap-4 gap-2",children:[e.jsxs("div",{className:"flex items-center sm:gap-4 gap-2",children:[e.jsxs("div",{onClick:()=>A(-1),className:"flex gap-2 items-center cursor-pointer rounded-full hover:bg-gray-100 p-2",children:[e.jsx("i",{className:"fas fa-arrow-left"}),e.jsx("p",{className:"",children:"Back"})]}),e.jsx("div",{className:"bg-gradient-to-r  from-blue-600 to-purple-600 p-3 rounded-xl",children:e.jsx("i",{className:`fas ${r?"fa-edit":"fa-plus"} text-white text-xl`})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl sm:text-3xl font-bold text-gray-900",children:[r?"Edit":"Add New"," ",n," ",e.jsx("span",{className:"hidden sm:inline",children:"Unit"})]}),e.jsx("p",{className:"text-gray-600 mt-1 hidden sm:block",children:r?"Update product information":"Create a new product in your catalog"})]})]}),!r&&e.jsxs("div",{className:"flex items-center gap-4 bg-gray-50 p-4 rounded-xl",children:[e.jsxs("label",{className:"font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-layer-group text-blue-600"}),"Select Unit Type"]}),e.jsxs(w,{value:n,onValueChange:_,children:[e.jsx(C,{className:"min-w-[200px] bg-white",children:e.jsx(U,{placeholder:"Choose Unit Type",selectedValue:n})}),e.jsx(S,{children:Object.keys(F).map(s=>e.jsx(k,{value:s,children:e.jsx("span",{className:"capitalize",children:s})},s))})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border p-8",children:e.jsxs("form",{onSubmit:O,className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[Object.entries(h).map(([s,a])=>{var i,t;return a.label==="Budget Range"||a.label==="Price Range"?null:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(V,{className:"text-gray-700 font-semibold flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-tag text-blue-500"}),a.label,a.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),a.type==="text"&&e.jsx(u,{value:c[s]||"",onChange:l=>x(s,l.target.value),required:a.required,className:"rounded-xl border-gray-200 focus:ring-2 focus:ring-blue-500 bg-white",placeholder:`Enter ${a.label.toLowerCase()}`}),a.type==="number"&&e.jsx(u,{type:"number",value:c[s]||"",onChange:l=>x(s,+l.target.value),required:a.required,className:"rounded-xl border-gray-200 focus:ring-2 focus:ring-blue-500 bg-white",placeholder:`Enter ${a.label.toLowerCase()}`}),a.type==="select"&&e.jsxs(w,{onValueChange:l=>x(s,l),value:c[s]||"",children:[e.jsx(C,{className:"rounded-xl border-gray-200 focus:ring-2 focus:ring-blue-500 bg-white",children:e.jsx(U,{placeholder:`Select ${a.label}`,selectedValue:c[s]})}),e.jsx(S,{children:(i=a.options)==null?void 0:i.map(l=>e.jsx(k,{value:l,children:l},l))})]}),a.type==="checkbox"&&e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 max-h-40 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:(t=a.options)==null?void 0:t.map(l=>{var y;return e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-white rounded-lg p-2 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:((y=c[s])==null?void 0:y.includes(l))||!1,onChange:R=>{const D=R.target.checked;o(N=>{const v=N[s]||[];return{...N,[s]:D?[...v,l]:v.filter(K=>K!==l)}})},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:l})]},l)})})})]},s)}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(V,{className:"text-gray-700 font-semibold flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-images text-blue-500"}),"Upload Images"]}),e.jsx("div",{className:"relative",children:e.jsx(u,{type:"file",multiple:!0,accept:"image/*",onChange:B,className:"rounded-xl border-gray-200 focus:ring-2 focus:ring-blue-500 bg-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})}),d.length>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 bg-green-50 p-2 rounded-lg",children:[e.jsx("i",{className:"fas fa-check-circle"}),d.length," file(s) selected"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 pt-6 border-t border-gray-200",children:[e.jsx(I,{type:"submit",disabled:b||j,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-12 py-4 rounded-xl text-lg font-semibold shadow-lg hover:shadow-xl transition-all",children:b||j?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:`fas ${r?"fa-save":"fa-plus"} mr-2`}),r?"Update Unit":"Create Unit"]})}),r&&e.jsx(I,{variant:"secondary",className:" px-12 py-4 rounded-xl text-lg ",onClick:M,children:"Cancel"})]})]})})})]})}export{Z as default};
