import{u as w,b as S,r as n,R as T,j as e}from"./index-4xXsHyrq.js";import{B as A}from"./Button-BmD7QJLN.js";import E from"./MaterialOverviewLoading-CX4w9Avf.js";import{t as d}from"./toast-BSC5QTk1.js";import{C as B}from"./ClientFurnitures-ThQw5Vwu.js";import{a as R,b as L}from"./clientQuoteApi-_E0xjwov.js";import{L as M}from"./Label-DzCIp4JP.js";import"./Skeleton-CZeX8ICI.js";import"./constants-FaVgBbKC.js";import"./roleCheck-DDX7kp9U.js";import"./useQuery-CnKlDwE3.js";import"./useMutation-DAR9sTyS.js";const U=10,H=()=>{var g;const{organizationId:m,quoteId:u}=w(),f=S(),{data:s,isLoading:p}=R(m,u),{mutateAsync:h,isPending:x}=L(),i=n.useRef([]),[c,j]=n.useState(!0),[l,y]=n.useState([]),[o,b]=n.useState((s==null?void 0:s.grandTotal)||0);n.useEffect(()=>{b(s==null?void 0:s.grandTotal)},[s]);const N=async()=>{var r,t;try{if(!m||!u||!s){d({title:"Missing info",description:"Please ensure quote and all details are not missing",variant:"destructive"});return}if(!confirm("Are you sure want to send this quotation to payment?"))return;await h({organizationId:m,id:u}),d({title:"success",description:"Quote Selected and stored in the payment stage"})}catch(a){d({title:"Error",description:((t=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:t.message)??"Operation failed"})}},v=async()=>{var r,t;try{j(a=>!a)}catch(a){d({title:"Error",description:((t=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:t.message)??"Operation failed"})}};return n.useEffect(()=>{if(!(s!=null&&s.furnitures))return;const r=s.furnitures.map(t=>({furnitureName:t.furnitureName,coreMaterials:t.coreMaterials||[],fittingsAndAccessories:t.fittingsAndAccessories||[],glues:t.glues||[],nonBrandMaterials:t.nonBrandMaterials||[],totals:{core:t.coreMaterialsTotal||0,fittings:t.fittingsAndAccessoriesTotal||0,glues:t.gluesTotal||0,nbms:t.nonBrandMaterialsTotal||0,furnitureTotal:t.furnitureTotal||0},plywoodBrand:"",laminateBrand:""}));y(r)},[s]),i.current.length!==l.length&&(i.current=l.map((r,t)=>i.current[t]??T.createRef())),n.useEffect(()=>{console.log("furnitureRefs Array",i),i.current=l.map((r,t)=>i.current[t]??n.createRef())},[l]),e.jsxs("div",{className:"p-2 max-h-full overflow-y-auto",children:[e.jsxs("header",{className:"bg-white border-b border-gray-200 pb-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("button",{onClick:()=>f(-1),className:"flex cursor-pointer items-center justify-center w-8 h-8 bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md transition-colors flex-shrink-0",children:e.jsx("i",{className:"fas fa-arrow-left text-gray-600 text-sm"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900 truncate",children:((g=s==null?void 0:s.projectId)==null?void 0:g.projectName)||"Project"}),e.jsx("p",{className:"text-md text-gray-500",children:s!=null&&s.quoteNo?`Quote: #${s==null?void 0:s.quoteNo}`:""})]})]}),e.jsxs("div",{className:"flex gap-2 justify-between  items-center",children:[e.jsxs("div",{className:"px-4 text-center",children:[e.jsx("p",{className:"text-md text-gray-600",children:"Total Cost"}),e.jsxs("p",{className:"text-md font-bold text-green-600",children:["₹",o==null?void 0:o.toLocaleString("en-in")]})]}),e.jsx(A,{onClick:N,disabled:x,className:"flex-shrink-0 px-4 ",children:x?"Sending...":"Select Quote"}),e.jsxs("div",{className:"flex gap-2 w-fit px-4 justify-center",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:v,className:"sr-only",id:"blurinput"}),e.jsx("div",{className:`w-11 h-6 rounded-full cursor-pointer transition-colors ${c?"bg-gray-200":"bg-blue-600"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow transform transition-transform ${c?"translate-x-0":"translate-x-5"} mt-0.5 ml-0.5`})})]}),e.jsx(M,{htmlFor:"blurinput",className:" cursor-pointer flex flex-4/2",children:"Show Stats"})]})]})]}),e.jsx("div",{className:" grid grid-cols-4 gap-2"})]}),p?e.jsx(E,{}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-6",children:[l.map((r,t)=>e.jsx(B,{index:t,data:r,ref:i.current[t],isBlurred:c},t)),e.jsx("div",{className:"mt-10 text-right",children:e.jsxs("div",{className:"inline-block bg-green-50 border border-green-200 rounded-md px-6 py-4",children:[e.jsx("p",{className:"text-md font-medium text-gray-700 mb-1",children:"Total Estimate"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["₹",o==null?void 0:o.toLocaleString("en-in")]})]})})]})})]})};export{U as DEFAULT_LAMINATE_RATE_PER_SQFT,H as default};
