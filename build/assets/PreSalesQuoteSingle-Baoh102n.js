import{r as b,j as e,C as Ue,t as ue,u as De,B as ae,a as Re}from"./index-BAM0eJUz.js";import{u as xe}from"./quoteVariantApi-SI_JgpSl.js";import{I as te}from"./Input-1UBXZqEj.js";import{d as Qe,e as We,f as Ge,g as qe,C as He}from"./CreatePreSalesQuoteModal-BcsPeec9.js";import{u as ze}from"./orgApi-DGTdT7vR.js";import{Q as Ke,D as Ve}from"./ClientQuoteType4-D-xVHWxj.js";import{materialTypeOptions as Oe}from"./RateConfigSub-DPkKtDX1.js";import{I as Ye}from"./InfoToolTip-4w02Xows.js";import"./useInfiniteQuery-BGz0VllC.js";import"./requirementFormApi-_wh_iBu9.js";import"./projectApi-D7-uwdh2.js";import"./clientQuoteApi-B0Dnhpm6.js";import"./Select-C6lfB9t-.js";const Je=({rooms:g,data:r,grandTotal:_,organizationId:w,isBlurred:C})=>{console.log("rooms",g),console.log("data",r);const{data:F,isLoading:H}=ze(w),q=Array.isArray(F)?F[0]:F,L=b.useMemo(()=>{const a=(r==null?void 0:r.config)||{};return Object.entries(a).flatMap(([j,v])=>Object.values(v).flatMap(o=>Object.entries(o).flatMap(([u,W])=>Object.values(W).map((f,ne)=>({...f,_id:f.id||f._id||`prod-${j}-${ne}`,dimention:{width:f.w||0,height:f.h||0,depth:f.depth||0},totals:f.totals||{furnitureTotal:f.productTotal||0,core:f.productTotal||0,fittings:0,glues:0,nbms:0},scopeOfWork:f.scopeOfWork,roomContext:j})))))},[r]);console.log("furnitures",L);const S=()=>window.print(),{mutateAsync:A,isPending:P}=Qe(),[T,B]=b.useState({}),[M,i]=b.useState({}),$=(a,j)=>{const v=a.target.files;if(v&&v.length>0){B(u=>({...u,[j]:Array.from(v)}));const o=URL.createObjectURL(v[0]);i(u=>({...u,[j]:o}))}},se=a=>{const j=document.getElementById(`file-input-${a}`);j&&j.click()},X=async()=>{try{const a=new FormData;["clientDetails","projectDetails","whatsIncluded","whatsNotIncluded","whatIsFree","brandlist","TermsAndConditions","disclaimer"].forEach(o=>{let u=o,W=o;o==="clientDetails"&&(u="clientDetails",W="clientDataTextArea"),o==="projectDetails"&&(u="projectDetails",W="projectDetailsTextArea");const f=document.querySelector(`textarea[name="${u}"]`);a.append(W,(f==null?void 0:f.value)||"")});const v=L.map(o=>{var ce,de,be,Z;const u=document.querySelector(`[data-furniture-container="${o._id}"]`),W=(ce=u==null?void 0:u.querySelector('input[name="width"]'))==null?void 0:ce.value,f=(de=u==null?void 0:u.querySelector('input[name="height"]'))==null?void 0:de.value,ne=(be=u==null?void 0:u.querySelector('input[name="depth"]'))==null?void 0:be.value,oe=(Z=u==null?void 0:u.querySelector('textarea[name="scopeOfWork"]'))==null?void 0:Z.value;return{furnitureId:o._id,scopeOfWork:oe||o.scopeOfWork,dimention:{width:Number(W)||0,height:Number(f)||0,depth:Number(ne)||0}}});a.append("furnitureUpdates",JSON.stringify(v)),Object.keys(T).forEach(o=>{a.append(`furnitureImage_${o}`,T[o])}),await A({id:r._id,formData:a}),ue({title:"Success",description:"Quote and technical details updated successfully",variant:"default"}),B({})}catch(a){console.error("Save Error:",a),ue({title:"Error",description:(a==null?void 0:a.message)||"Failed to save template changes",variant:"destructive"})}},K=a=>{a&&(a.style.height="auto",a.style.height=`${a.scrollHeight}px`)},n=a=>{a.style.height="auto",a.style.height=a.scrollHeight+"px"},s=b.useMemo(()=>{const a=(g||[]).flatMap(j=>{var v;return(v=j.products)==null?void 0:v.flatMap(o=>[o.plywoodBrand,o.innerLaminateBrand,o.outerLaminateBrand])});return[...new Set(a)].filter(Boolean).join(", ")},[g]),h=(r==null?void 0:r.quoteNo)||"N/A",N=((r==null?void 0:r.__v)||0)+1,p=new Date((r==null?void 0:r.createdAt)||Date.now()).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),R=new Date((r==null?void 0:r.createdAt)||Date.now()).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),Q=b.useMemo(()=>{const a=r==null?void 0:r.clientData;return`Client Name: ${(a==null?void 0:a.clientName)||"Not Entered Yet"}
WhatsApp: ${(a==null?void 0:a.whatsapp)||"Not Entered Yet"}
Email: ${(a==null?void 0:a.email)||"Not Entered Yet"}
Location: ${(a==null?void 0:a.location)||"Not Entered Yet"}`},[r==null?void 0:r.clientData]),U=b.useMemo(()=>{var j;const a=r==null?void 0:r.projectDetails;return`Project: ${(a==null?void 0:a.projectName)||"Not Entered Yet"}
Site Context: ${((j=r==null?void 0:r.clientData)==null?void 0:j.location)||"Not Entered Yet"}
Quote Ref: ${(r==null?void 0:r.quoteNo)||"Not Entered Yet"}`},[r==null?void 0:r.projectDetails,r==null?void 0:r.clientData,r==null?void 0:r.quoteNo]),G=b.useMemo(()=>({...r,clientDetails:Q,projectDetails:U}),[r,Q,U]),z=a=>{var u,W;const j=Array.from(new Set((u=a.fittingsAndAccessories)==null?void 0:u.filter(f=>f.brandName).map(f=>f.brandName))).join(", "),v=Array.from(new Set((W=a.glues)==null?void 0:W.filter(f=>f.brandName).map(f=>f.brandName))).join(", "),o=[{category:"Plywood",brand:a.plywoodName,desc:""},{category:"Inner Laminate",brand:a.innerName,desc:""},{category:"Outer Laminate",brand:a.outerName,desc:""},{category:"Fittings & Accessories",brand:j,desc:""},{category:"Adhesives/Glues",brand:v,desc:""}].filter(f=>f.brand);return o.length===0?null:e.jsxs("table",{className:"w-full border-collapse mt-3 text-[12px] bg-white rounded-xl overflow-hidden border border-gray-100 shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#f8fbff] text-[#1e3a8a] border-b border-gray-100",children:[e.jsx("th",{className:"p-3 text-left",children:"Category"}),e.jsx("th",{className:"p-3 text-left",children:"Brand"}),e.jsx("th",{className:"p-3 text-left",children:"Description"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:o.map((f,ne)=>{var oe;return e.jsxs("tr",{className:"hover:bg-slate-50/50",children:[e.jsx("td",{className:"p-3 font-bold text-gray-700",children:f.category}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(oe=f.brand)==null?void 0:oe.split(", ").map((ce,de)=>e.jsx("span",{className:`${C?"blur-sm":""} px-2 py-0.5 bg-indigo-50 text-indigo-700 rounded text-[9px] font-black border border-indigo-100 uppercase`,children:ce},de))})}),e.jsx("td",{className:"p-3 text-gray-400 italic text-[10px]",children:f.desc})]},ne)})})]})};return e.jsx(Ke,{quoteNo:h,version:N,usedIn:"presales",creationDate:R,creationTime:p,COMPANY_DETAILS:Ue,orgData:q,orgLoading:H,data:G,showSaveTemplateButton:!0,clientDetailsFallback:Q,projectDetailsFallback:U,brandlistString:s,DEFAULT_QUOTE_TEXTS:Ve,furnitures:L,grandTotal:_,localPreviews:{},preSaleslocalPreviews:M,isBlurred:!1,handlePrint:S,handleImageClick:se,isSaving:P,handleSaveTemplate:X,handleFileChange:$,renderBrandSpecificationTable:z,autoExpand:n,adjustHeight:K})},Xe=({label:g,organizationId:r,units:_,innerOptions:w,outerOptions:C,globalProfitPercentage:F,groupProfitMargins:H,updateGroupMargin:q,updateProductInstance:L,transformBrands:S})=>{const[A,P]=b.useState("all"),{data:T,isLoading:B}=xe(r,g),M=n=>n.length<=3?n.toUpperCase():n.charAt(0).toUpperCase()+n.slice(1).toLowerCase(),i=b.useMemo(()=>S(T),[T,S]),$=b.useMemo(()=>A==="all"?i:i.filter(n=>{var s;return((s=n.materialType)==null?void 0:s.toLowerCase())===A.toLowerCase()}),[i,A]),se=H[g]??F,X=n=>{const s=n.match(/\d+/);return s?parseInt(s[0],10):null},K=(n,s,h)=>{const N={rate:0,key:null};if(!n)return N;const p=Number(s),R=Number(h),Q=Object.keys(n).find(U=>{const G=U.toLowerCase().split("x");if(G.length!==2)return!1;const z=X(G[0]),a=X(G[1]);return z===null||a===null?!1:z===p&&a===R||z===R&&a===p});return Q?{rate:Q?Number(n[Q]||0):0,key:Q||null}:N};return b.useEffect(()=>{var s,h;const n=(h=(s=_[0])==null?void 0:s.details)==null?void 0:h.plywoodType;n&&P(n)},[_]),B?e.jsxs("div",{className:"p-10 text-center animate-pulse text-slate-400",children:["Loading ",g," configurations..."]}):e.jsxs("div",{className:"bg-white border-blue-600 border-l-8 rounded-[40px] p-8 space-y-6 shadow-sm",children:[e.jsxs("section",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 bg-white p-6 rounded-[32px] border border-indigo-100 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:g}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-1",children:["Bulk update ",g," units"]})]}),e.jsxs("div",{className:"flex lg:flex-row flex-wrap  items-end gap-4 pb-1 w-full lg:w-auto justify-start md:justify-end",children:[e.jsxs("div",{className:"flex flex-col gap-1.5 min-w-[140px]",children:[e.jsx("span",{className:"text-[8px] font-black text-amber-500 uppercase ml-1 tracking-widest",children:"Material Type"}),e.jsx("select",{value:A,onChange:n=>{const s=n.target.value;P(s),_.forEach(h=>{L(h.roomId,h.rIdx,h.prodId,h.pIdx,{plywoodType:s,plywoodId:"",plywoodName:"",plywoodCost:0})})},className:"h-10 px-4 bg-white border border-slate-200 rounded-xl text-[10px] font-bold text-slate-700 outline-none cursor-pointer focus:border-indigo-500",children:Oe.map(n=>e.jsx("option",{value:n,children:M(n)},n))})]}),[{k:"plywood",l:"Plywood",o:$,c:"indigo"},{k:"inner",l:"Inner",o:w,c:"emerald"},{k:"outer",l:"Outer",o:C,c:"amber"}].map(n=>{const s=n.o&&n.o.length>0;return e.jsxs("div",{className:"flex flex-col gap-1.5 min-w-[200px] max-w-[200px]",children:[e.jsxs("span",{className:`text-[8px] font-black text-${n.c}-500 uppercase ml-1 tracking-widest`,children:["Master ",n.l]}),e.jsx("select",{className:`h-10 px-4 bg-white border ${s?"border-slate-200":"border-amber-200"} rounded-xl text-[10px] font-bold text-slate-700 outline-none cursor-pointer focus:border-indigo-500`,onChange:h=>{const N=n.o.find(p=>p.id===h.target.value);N&&_.forEach(p=>{let R=0;n.k==="plywood"?R=K(N.data,p.details.h,p.details.w).rate:R=Number(N.cost||0),L(p.roomId,p.rIdx,p.prodId,p.pIdx,{[`${n.k}Id`]:N.id,[`${n.k}Name`]:N.name,[`${n.k}Cost`]:R,[`${n.k}Thickness`]:N.thickness,[`${n.k}Rs`]:N.rs})})},value:A,children:s?e.jsxs(e.Fragment,{children:[e.jsxs("option",{value:"",children:["Apply ",n.l," to all ",g,"s..."]}),n.o.map(h=>{let N=0;return n.k==="plywood"?N=K(h.data,_[0].details.h,_[0].details.w).rate:N=Number(h.cost||0),e.jsxs("option",{value:h.id,children:[h.name," | ",h.thickness,"mm",n.k==="plywood"&&e.jsxs(e.Fragment,{children:["| ₹",N,"/sqft"]})]},h.id)})]}):e.jsxs(e.Fragment,{children:[e.jsxs("option",{value:"",children:["Apply ",n.l," to all ",g,"s..."]}),e.jsx("option",{disabled:!0,children:"──────────────────────────────"}),e.jsxs("option",{disabled:!0,className:"text-red-600 font-bold",children:["NO ",n.l.toUpperCase()," BRANDS FOUND"]}),e.jsxs("option",{disabled:!0,className:"text-red-600 font-bold",children:["FOR PRODUCT: ",g.toUpperCase()]}),e.jsx("option",{disabled:!0,className:"text-slate-600",children:"Action Required:"}),e.jsx("option",{disabled:!0,className:"text-slate-800",children:"Please enter rates in your rate configuration (Pre sales) module."}),e.jsx("option",{disabled:!0,children:"──────────────────────────────"})]})})]},`master-${g}-${n.k}`)}),e.jsxs("div",{className:"flex flex-col gap-1.5 min-w-[120px] relative",children:[e.jsx("span",{className:"text-[8px] font-black text-indigo-500 uppercase ml-1 tracking-widest",children:"Group Margin"}),e.jsx("input",{type:"number",value:se||"",onChange:n=>q(g,Math.max(0,Number(n.target.value))),className:"w-full h-10 pl-4 bg-white border border-slate-200 rounded-xl text-[10px] font-bold outline-none focus:border-indigo-500"}),e.jsx("div",{className:"absolute right-3 bottom-2.5 pointer-events-none",children:e.jsx("span",{className:"text-[8px] font-black text-indigo-300",children:"PROFIT"})})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:_.map(({roomId:n,rIdx:s,prodId:h,pIdx:N,details:p,name:R})=>{const Q=Number(p.h||0)*Number(p.w||0),U=Number(p.plywoodCost||0),G=1+se/100,z=Q*U*G;return e.jsxs("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 px-6 py-4 flex items-center justify-between border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"bg-indigo-600 text-white text-[9px] font-black px-2 py-1 rounded-lg uppercase",children:n}),e.jsx("h4",{className:"text-sm font-bold text-slate-700 uppercase",children:R})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[12px] font-black text-slate-400 uppercase tracking-tighter",children:"Size"}),e.jsxs("span",{className:"text-xs font-bold text-slate-700",children:[p.h,"H × ",p.w,"W (FT)"]})]}),e.jsxs("span",{className:"text-xl font-black text-emerald-600",children:["₹",z.toLocaleString("en-IN")]})]})]}),e.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-[9px] font-black uppercase text-amber-500",children:"Material Type"}),e.jsx("select",{className:"h-11 px-3 bg-white border border-slate-200 rounded-xl text-[11px] font-bold ",value:p.plywoodType||A,onChange:a=>{const j=a.target.value;L(n,s,h,N,{plywoodType:j,plywoodId:"",plywoodName:"",plywoodCost:0})},children:Oe.map(a=>e.jsx("option",{value:a,children:M(a)},a))})]}),[{k:"plywood",l:"Plywood",o:i.filter(a=>{var v;const j=p.plywoodType||A;return j==="all"?!0:((v=a.materialType)==null?void 0:v.toLowerCase())===j.toLowerCase()})},{k:"inner",l:"Inner Laminate",o:w},{k:"outer",l:"Outer Laminate",o:C}].map(a=>{const j=a.o&&a.o.length>0;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-[9px] font-black uppercase text-slate-500",children:a.l}),e.jsx("select",{className:"h-11 px-3 bg-white border border-slate-200 rounded-xl text-[11px] font-bold",value:p[`${a.k}Id`]||"",onChange:v=>{const o=a.o.find(W=>W.id===v.target.value);let u=0;a.k==="plywood"?u=K(o==null?void 0:o.data,p.h,p.w).rate:u=Number((o==null?void 0:o.cost)||0),L(n,s,h,N,{[`${a.k}Id`]:o==null?void 0:o.id,[`${a.k}Name`]:o==null?void 0:o.name,[`${a.k}Cost`]:u,[`${a.k}Thickness`]:o==null?void 0:o.thickness,[`${a.k}Rs`]:o==null?void 0:o.rs})},children:j?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select Brand"}),a.o.map(v=>{let o=0,u=null;if(a.k==="plywood"){const W=K(v.data,p.h,p.w);o=W.rate,u=W.key}return e.jsxs("option",{value:v.id,children:[v.name," | ",v.thickness,"mm",a.k==="plywood"&&e.jsxs(e.Fragment,{children:[u?` | Match: ${u}`:" | No Dimension matched","| ₹",o,"/sqft"]})]},v.id)})]}):e.jsxs(e.Fragment,{children:[e.jsxs("option",{value:"",children:["Apply ",a.l," to all ",g,"s..."]}),e.jsx("option",{disabled:!0,children:"──────────────────────────────"}),e.jsxs("option",{disabled:!0,className:"text-red-600 font-bold",children:["NO ",a.l.toUpperCase()," BRANDS FOUND"]}),e.jsxs("option",{disabled:!0,className:"text-red-600 font-bold",children:["FOR PRODUCT: ",g.toUpperCase()]}),e.jsx("option",{disabled:!0,className:"text-slate-600",children:"Action Required:"}),e.jsx("option",{disabled:!0,className:"text-slate-800",children:"Please enter rates in your rate configuration (Pre sales) module."}),e.jsx("option",{disabled:!0,children:"──────────────────────────────"})]})})]},a.k)})]})]},`${n}-${N}`)})})]})},Ze=({config:g,PRODUCT_CATALOG:r,updateProductInstance:_,handleUpdate:w,setStep:C,updatePending:F,globalProfitPercentage:H,setGlobalProfitPercentage:q,groupProfitMargins:L,updateGroupMargin:S})=>{const{organizationId:A}=De(),[P,T]=b.useState(0),B=["Initializing Production AI...","Scanning room configurations...","Fetching material specifications...","Redefining 'What's Included'...","Calculating engineering tolerances...","Synthesizing Plywood brand data...","Integrating technical exclusions...","Optimizing structural narratives...","Finalizing high-end disclaimer...","Calibrating material square footage...","Generating execution scope...","Generating professional quote view..."];b.useEffect(()=>{let n;return F?(T(0),n=setInterval(()=>{T(s=>{const h=s+1;return h>=B.length?2:h})},4500)):T(0),()=>clearInterval(n)},[F]);const{data:M}=xe(A,"inner laminate"),{data:i}=xe(A,"outer laminate"),$=n=>(n||[]).map(s=>{var h,N,p,R,Q,U,G;return{id:s._id,name:((h=s.data)==null?void 0:h.Brand)||((N=s.data)==null?void 0:N.brand)||"Generic",thickness:((p=s.data)==null?void 0:p["thickness (mm)"])||((R=s.data)==null?void 0:R.thickness)||((Q=s.data)==null?void 0:Q.Thickness)||0,materialType:(s==null?void 0:s.materialType)||"all",rs:parseFloat(((U=s.data)==null?void 0:U.Rs)||((G=s.data)==null?void 0:G.rs)||0),data:s.data}}),se=b.useMemo(()=>$(M),[M]),X=b.useMemo(()=>$(i),[i]),K=b.useMemo(()=>{const n={};return Object.entries(g).forEach(([s,h])=>{Object.entries(h).forEach(([N,p])=>{Object.entries(p).forEach(([R,Q])=>{var z;const U=(z=r[s])==null?void 0:z.find(a=>a.id===R),G=(U==null?void 0:U.label)||"other";Object.entries(Q).forEach(([a,j])=>{n[G]||(n[G]=[]),n[G].push({roomId:s,rIdx:parseInt(N),prodId:R,pIdx:parseInt(a),details:j,name:U==null?void 0:U.name})})})})}),n},[g,r]);return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-in fade-in duration-500 pb-20",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 uppercase tracking-tight",children:"Technical Mapping & Valuation"}),e.jsx("p",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-widest mt-1",children:"Select materials to see live unit pricing"})]}),e.jsxs("div",{className:"bg-slate-900 p-6 rounded-[32px] flex items-center justify-between shadow-xl mb-10 border border-indigo-500/30",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-500/20 rounded-2xl flex items-center justify-center text-emerald-400",children:e.jsx("i",{className:"fas fa-chart-line text-lg"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]",children:"Global Valuation"}),e.jsx("h3",{className:"text-white font-bold uppercase tracking-tight",children:"Profit Margin (%)"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-slate-800 p-2 rounded-2xl border border-slate-700",children:[e.jsx("input",{type:"number",value:H||"",onChange:n=>{const s=Math.max(0,Number(n.target.value));q(s),Object.keys(L).forEach(h=>{S(h,s)})},className:"w-20 bg-transparent text-white text-center font-black text-xl outline-none",placeholder:"0"}),e.jsx("span",{className:"text-indigo-400 font-black text-xl mr-2",children:"%"})]})]}),e.jsx("div",{className:"space-y-16",children:Object.entries(K).map(([n,s])=>e.jsx(Xe,{label:n,organizationId:A,units:s,innerOptions:se,outerOptions:X,globalProfitPercentage:H,groupProfitMargins:L,updateGroupMargin:S,updateProductInstance:_,transformBrands:$},n))}),e.jsxs("div",{className:"flex justify-end gap-3 pt-8 border-t",children:[e.jsx(ae,{variant:"secondary",className:"px-8 h-12",onClick:()=>C(3),children:"Back"}),e.jsxs(ae,{className:"px-12 h-12 bg-indigo-600 shadow-xl min-w-[320px] relative overflow-hidden transition-all duration-500",isLoading:F,disabled:F,onClick:async()=>{await w()},children:[F?e.jsx("div",{className:"flex items-center gap-3 animate-in fade-in slide-in-from-bottom-2 duration-500",children:e.jsx("span",{className:"text-[11px] font-bold uppercase tracking-widest animate-pulse italic",children:B[P]})}):e.jsxs(e.Fragment,{children:["Generate Quote ",e.jsx("i",{className:"fas fa-chevron-right ml-2 text-[7px]"})]}),F&&e.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-white/30 animate-progress-glow",style:{width:"100%"}})]})]})]})},Ie=["Living Room","Kitchen","Master Bedroom","Washroom"],pe={"Living Room":[{id:"grand_tv",label:"tv unit",name:"TV Unit",h:8,w:6},{id:"wardrobe",label:"wardrobe",name:"Wardrobe",h:7,w:6},{id:"crockery",label:"crockery unit",name:"Crockery Unit",h:7,w:4},{id:"bar_unit",label:"bar unit",name:"Bar Unit",h:7,w:3},{id:"book_shelf",label:"book shelf",name:"Book Shelf",h:7,w:3},{id:"wallpaper",label:"wall paper",name:"Wall Paper",h:10,w:10},{id:"temple",label:"pooja unit",name:"Pooja Unit",h:5,w:3},{id:"sofa_panel",label:"sofa back wall panelling",name:"Sofa Back Wall Panelling",h:4,w:10},{id:"dining_panel",label:"dining wall panelling",name:"Dining Wall Panelling",h:8,w:6},{id:"diamond_mirror",label:"diamond mirror wall",name:"Diamond Mirror Wall",h:8,w:4}],"Master Bedroom":[{id:"grand_tv",label:"tv unit",name:"TV Unit",h:8,w:6},{id:"wardrobe",label:"wardrobe",name:"Wardrobe",h:7,w:6},{id:"crockery",label:"crockery unit",name:"Crockery Unit",h:7,w:4},{id:"loft",label:"loft",name:"Loft",h:2,w:10},{id:"dressing",label:"dressing",name:"Dressing",h:6,w:2},{id:"book_shelf",label:"book shelf",name:"Book Shelf",h:7,w:3},{id:"bed",label:"bed",name:"Bed",h:1.5,w:6},{id:"bed_back_fabric",label:"bed",name:"Bed Back Rest with Fabric",h:3,w:6},{id:"wallpaper",label:"wall paper",name:"Wall Paper",h:10,w:10},{id:"sofa_panel",label:"sofa back wall panelling",name:"Sofa Back Wall Panelling",h:4,w:10},{id:"dining_panel",label:"dining wall panelling",name:"Dining Wall Panelling",h:8,w:6},{id:"side_table",label:"sideboard",name:"Side Table",h:1.5,w:1.5},{id:"work_table",label:"study table",name:"Working Table",h:2.5,w:4},{id:"temple",label:"pooja unit",name:"Pooja Unit",h:5,w:3},{id:"diamond_mirror",label:"diamond mirror wall",name:"Diamond Mirror Wall",h:8,w:4}],Washroom:[{id:"vanity",label:"vanity unit",name:"Vanity Below Handwash Counter",h:2,w:3},{id:"mirror_shelf",label:"mirror with shelfs behind",name:"Mirror with Shelfs Behind",h:3,w:2},{id:"shower_partition",label:"shower glass partition",name:"Shower Glass Partition",h:7,w:3},{id:"grand_tv",label:"tv unit",name:"TV Unit",h:8,w:6},{id:"wallpaper",label:"wall paper",name:"Wall Paper",h:10,w:10},{id:"wardrobe",label:"wardrobe",name:"Wardrobe",h:7,w:6},{id:"crockery",label:"crockery unit",name:"Crockery Unit",h:7,w:4},{id:"loft",label:"loft",name:"Loft",h:2,w:8},{id:"dressing",label:"dressing",name:"Dressing",h:6,w:2},{id:"book_shelf",label:"book shelf",name:"Book Shelf",h:7,w:3},{id:"temple",label:"pooja unit",name:"Pooja Unit",h:5,w:3}],Kitchen:[{id:"base_cabinets",label:"kitchen",name:"Base Cabinets",h:2.5,w:12},{id:"wall_cabinets",label:"kitchen",name:"Wall Cabinets",h:2,w:12},{id:"tall_unit",label:"tall unit",name:"Tall Unit",h:7,w:2},{id:"breakfast_counter",label:"breakfast counter",name:"Breakfast Counter",h:3,w:5},{id:"loft",label:"loft",name:"Loft",h:2,w:8},{id:"temple",label:"pooja unit",name:"Pooja Unit",h:5,w:3},{id:"dining_panel",label:"dining wall panelling",name:"Dining Wall Panelling",h:8,w:6},{id:"mirror_shelf",label:"mirror with shelfs behind",name:"Mirror with Shelfs Behind",h:3,w:2},{id:"shower_partition",label:"shower glass partition",name:"Shower Glass Partition",h:7,w:3},{id:"wardrobe",label:"wardrobe",name:"Wardrobe",h:7,w:6},{id:"wallpaper",label:"wall paper",name:"Wall Paper",h:10,w:10},{id:"grand_tv",label:"tv unit",name:"TV Unit",h:8,w:6},{id:"crockery",label:"crockery unit",name:"Crockery Unit",h:7,w:4},{id:"dressing",label:"dressing",name:"Dressing",h:6,w:2},{id:"book_shelf",label:"book shelf",name:"Book Shelf",h:7,w:3}]},pt=(g,r)=>{const _=Number(g.h||0),w=Number(g.w||0),C=Number(g.d||0),F=Number(g.p||0),H=Number(g.s||0),q=Number(g.dr||0),L=.5,S=2*(_*C)+2*(w*C)+w*_,A=F*(_*C),P=H*(w*C),T=2*(w*_),B=w*C+w*L+w*L+2*(C*L),M=q*B;switch(r){case"wardrobe":return S+A+P+T+M;case"grand_tv":case"mini_tv":return S+P+T+M;case"crockery":case"temple":return S+A+P+T+M;case"shoe_rack":return S+P+T+M;case"loft":return S+P+T;case"base_cabinets":return S+A+P+T+M;case"wall_cabinets":return S+P+T;case"vanity":return S+P+T+M;case"bar_unit":case"sideboard":return S+A+P+T+M;case"work_table":return S+P;case"bed":const i=w*3,$=w*C+2*(6*C)+2*(w*1.5);return i+$+M;case"sofa_panel":case"dining_panel":case"laminate_panel":case"wallpaper":case"wallpaper_bed":case"diamond_mirror":return w*_;default:return w*_}};function ut(){var je;const{organizationId:g,id:r}=De(),_=Re(),[w,C]=b.useState(1),[F,H]=b.useState({}),[q,L]=b.useState("standard"),[S,A]=b.useState(0),[P,T]=b.useState({}),[B,M]=b.useState({}),[i,$]=b.useState({mainQuoteName:"New Audit",quoteNo:"QT-PRE-001",carpetArea:0,bhk:"2 BHK",purpose:"Move In",clientData:{clientName:"",whatsapp:"",email:"",location:""},projectDetails:{projectName:"",quoteNo:"",dateofIssue:new Date}}),[se,X]=b.useState(!1),[K,n]=b.useState({mainQuoteName:""}),{data:s,isLoading:h,refetch:N}=We(r),{mutateAsync:p,isPending:R}=Ge(),{mutateAsync:Q,isPending:U}=qe();b.useEffect(()=>{if(s){if($({mainQuoteName:s==null?void 0:s.mainQuoteName,quoteNo:s==null?void 0:s.quoteNo,carpetArea:s==null?void 0:s.carpetArea,bhk:(s==null?void 0:s.bhk)||"2 BHK",purpose:(s==null?void 0:s.purpose)||"Move In",clientData:{...s.clientData,clientName:s.mainQuoteName||""},projectDetails:{...s.projectDetails,projectName:s.mainQuoteName||"",quoteNo:s.quoteNo}}),s.config){M(s.config);const t={},l={};Object.entries(s.config).forEach(([c,m])=>{const d=Object.keys(m).length;d>0&&(t[c]=d),Object.values(m).forEach(y=>{Object.entries(y).forEach(([x,k])=>{var O;const E=Object.values(k)[0];if(E&&E.profitPercentage!==void 0){const I=(O=pe[c])==null?void 0:O.find(V=>V.id===x);I&&(l[I.name]=E.profitPercentage)}})})}),H(t),T(l)}s.globalDimType&&L(s==null?void 0:s.globalDimType),(s.globalProfitPercentage!==void 0||s.globalProfitPercentage!==null)&&A(s.globalProfitPercentage),s.mainQuoteName&&n({mainQuoteName:s.mainQuoteName})}},[s]);const{data:G}=xe(g,"plywood"),{data:z}=xe(g,"inner laminate"),{data:a}=xe(g,"outer laminate"),j=t=>(t||[]).map(l=>{var c,m,d,y,x,k,E;return{id:l._id,name:((c=l.data)==null?void 0:c.Brand)||((m=l.data)==null?void 0:m.brand)||"Generic",cost:parseFloat(((d=l.data)==null?void 0:d.manufacturCostPerSqft)||0),thickness:((y=l.data)==null?void 0:y["thickness (mm)"])||((x=l.data)==null?void 0:x.thickness)||0,rs:parseFloat(((k=l.data)==null?void 0:k.Rs)||((E=l.data)==null?void 0:E.rs)||0),data:l.data}}),v=b.useMemo(()=>j(G),[G]),o=b.useMemo(()=>j(z),[z]),u=b.useMemo(()=>j(a),[a]),[W,f]=b.useState(""),[ne,oe]=b.useState(""),[ce,de]=b.useState(""),be=(t,l)=>{const c=(l==null?void 0:l.id)||"";t==="plywood"&&f(c),t==="inner"&&oe(c),t==="outer"&&de(c),M(m=>{const d={...m};return Object.keys(d).forEach(y=>{Object.keys(d[y]).forEach(x=>{Object.keys(d[y][x]).forEach(k=>{Object.keys(d[y][x][k]).forEach(E=>{const O=t==="inner"||t==="outer";d[y][x][k][E]={...d[y][x][k][E],[`${t}Id`]:c,[`${t}Name`]:l==null?void 0:l.name,[`${t}Cost`]:O?0:l==null?void 0:l.cost,[`${t}Thickness`]:l==null?void 0:l.thickness,[`${t}Rs`]:(l==null?void 0:l.rs)||(l==null?void 0:l.Rs)}})})})}),d})},Z=(t,l,c,m,d)=>{M(y=>{const x={...y};return x[t]||(x[t]={}),x[t][l]||(x[t][l]={}),x[t][l][c]||(x[t][l][c]={}),x[t][l][c][m]={...x[t][l][c][m],...d},x})},Pe=(t,l)=>{T(c=>({...c,[t]:l}))},{grandTotal:we}=b.useMemo(()=>{let t=0;return Object.entries(B).forEach(([l,c])=>{Object.entries(c).forEach(([m,d])=>{Object.entries(d).forEach(([y,x])=>{var V;const k=(V=pe[l])==null?void 0:V.find(D=>D.id===y),E=(k==null?void 0:k.name)||"other",I=1+(P[E]??S)/100;Object.values(x).forEach(D=>{const ee=parseFloat(D.h||0)*parseFloat(D.w||0),Y=parseFloat(D.plywoodCost||0);t+=ee*Y*I})})})}),{grandTotal:t}},[B,S,P]),Te=async()=>{var t,l,c,m,d,y,x,k,E;try{const O=JSON.parse(JSON.stringify(B));Object.entries(O).forEach(([D,ee])=>{Object.entries(ee).forEach(([Y,le])=>{Object.entries(le).forEach(([re,Ae])=>{var ve;const me=(ve=pe[D])==null?void 0:ve.find(ie=>ie.id===re),Ee=(me==null?void 0:me.name)||"other",Ne=P[Ee]??S??0,_e=1+Ne/100;Object.entries(Ae).forEach(([ie,J])=>{const Be=Number(J.h||0)*Number(J.w||0),$e=Number(J.plywoodCost||0),ge=Be*$e*_e,ye=J.plywoodName,ke=J.outerName,Ce=J.innerName,Se=(J.fittingsAndAccessories||[]).map(Le=>Le.brandName).filter(Boolean).join(", "),fe=[];J.w>0&&fe.push(`${J.w} ft (Width)`),J.h>0&&fe.push(`${J.h} ft (Height)`);let he=[];he.push(ye?`Primary structural fabrication utilizes ${ye} substrate to ensure core dimensional stability.`:"Structural fabrication is executed using specified core substrates to maintain architectural integrity."),he.push(ke?`Exterior surfaces are finished with ${ke} cladding for high-wear resistance.`:"Exterior surfaces involve technical cladding applied to ensure surface protection.");const Fe=Se?` and integrated with ${Se} hardware systems`:"";he.push(Ce?`Internal reinforcement includes ${Ce} liner application${Fe} to achieve a balanced seal.`:"Internal reinforcement utilizes technical liners to maintain structural equilibrium."),fe.length>0&&he.push(`Technical assembly is manufactured to precise engineering specifications of ${fe.join(" x ")}.`),he.push("Final execution follows a modular installation protocol focusing on precision edge-sealing."),O[D][Y][re][ie].scopeOfWork=he.join(" "),O[D][Y][re][ie].furnitureName=(me==null?void 0:me.name)||re.replace(/_/g," ").toUpperCase(),O[D][Y][re][ie].profitPercentage=Ne,O[D][Y][re][ie].productTotal=ge,O[D][Y][re][ie].totals={furnitureTotal:ge||0,core:ge||0,fittings:0,glues:0,nbms:0}})})})});const I={carpetArea:i.carpetArea||0,bhk:i.bhk,purpose:i.purpose,clientData:{clientName:((t=i.clientData)==null?void 0:t.clientName)||"",whatsapp:((l=i.clientData)==null?void 0:l.whatsapp)||"",email:((c=i.clientData)==null?void 0:c.email)||"",location:((m=i.clientData)==null?void 0:m.location)||""},projectDetails:{projectName:((d=i.projectDetails)==null?void 0:d.projectName)||"",quoteNo:((y=i.projectDetails)==null?void 0:y.quoteNo)||i.quoteNo||"",dateOfIssue:((x=i.projectDetails)==null?void 0:x.dateofIssue)||new Date},config:O,globalProfitPercentage:S||0,roomCounts:F,globalDimType:q,totalAmount:we,status:"draft"},V=await p({id:r,payload:I});V!=null&&V.ok&&(N(),C(5)),console.log("Update success:",V)}catch(O){console.error("Update error:",O),ue({title:"Error",description:((E=(k=O==null?void 0:O.response)==null?void 0:k.data)==null?void 0:E.message)||(O==null?void 0:O.message)||"Failed to save audit",variant:"destructive"})}},Me=async()=>{var t,l;if(!K.mainQuoteName){ue({title:"Error",description:"Please enter quote name",variant:"destructive"});return}try{const c=await Q({id:r,mainQuoteName:K.mainQuoteName});console.log("update response",c),ue({title:"Success",description:"Quote name updated successfully"}),X(!1),n({mainQuoteName:""})}catch(c){ue({title:"Error",description:((l=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:l.message)||(c==null?void 0:c.message)||"Failed to update",variant:"destructive"})}};return h?e.jsx("div",{className:"h-screen w-full flex items-center justify-center bg-slate-50",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("i",{className:"fas fa-circle-notch fa-spin text-4xl text-blue-600"}),e.jsx("p",{className:"text-xs font-black text-slate-400 uppercase tracking-widest",children:"Loading Technical Audit..."})]})}):e.jsxs("div",{className:"h-screen max-h-full overflow-y-auto bg-[#F8FAFC] flex flex-col",children:[se&&e.jsx(He,{formData:K,setFormData:n,setModalOpen:X,isEditing:!0,handleSubmit:Me,isSubmitting:U}),e.jsxs("header",{className:"sticky top-0 z-[110] bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>_(-1),className:"p-2 hover:bg-slate-50 text-slate-600 rounded-xl border border-slate-200",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("h1",{className:"text-xl font-black text-slate-900 uppercase tracking-tight leading-tight",children:i.mainQuoteName}),e.jsx(ae,{variant:"ghost",size:"sm",onClick:()=>{X(!0)},children:e.jsx("i",{className:"fas fa-pen text-sm text-gray-600"})})]}),e.jsxs("p",{className:"text-xs text-slate-400 font-bold uppercase",children:[i.quoteNo," • ",i.bhk]})]})]}),e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{onClick:()=>C(t),className:`w-8 h-8 cursor-pointer rounded-full flex items-center justify-center text-xs font-black transition-all duration-500 border-2 
                                    ${t===5?"rounded-full px-4 min-w-[70px]":"w-8 rounded-full"}
                                    ${w>=t?"bg-blue-600 border-blue-600 text-white shadow-lg shadow-blue-100":"bg-white border-slate-200 text-slate-400"}`,children:t===5?"Quote":t}),t<5&&e.jsx("div",{className:`w-6 h-0.5 transition-all duration-500 ${w>t?"bg-blue-600":"bg-slate-100"}`})]},t))})]}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-6 md:py-2 custom-scrollbar",children:[w===1&&e.jsxs("div",{className:"max-w-xl mx-auto bg-white p-8 rounded-3xl shadow-xl border border-slate-100 mt-10",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-500 block mb-3 tracking-widest",children:"Total Area (SQFT)"}),e.jsx(te,{type:"number",className:"h-14 text-2xl font-bold text-slate-900 mb-8 border-slate-300 focus:border-indigo-500 transition-colors cursor-pointer",value:i.carpetArea||"",onChange:t=>{const l=t.target.value;$({...i,carpetArea:l===""?0:Math.max(0,Number(l))})}}),e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-500 block mb-3 tracking-widest",children:"BHK"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-8",children:["1 BHK","2 BHK","3 BHK","4 BHK","Villa"].map(t=>e.jsx("button",{onClick:()=>$({...i,bhk:t}),className:`py-3.5 cursor-pointer rounded-xl text-[11px] font-bold transition-all duration-200 border-2 ${i.bhk===t?"bg-purple-500 border-purple-500 text-white shadow-lg shadow-purple-100":"bg-white text-slate-600 border-slate-200 hover:border-purple-200 hover:text-slate-900"}`,children:t},t))}),e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-500 block mb-3 tracking-widest",children:"Project Intent"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-10",children:["Move In","Rent Out","Renovate"].map(t=>e.jsx("button",{onClick:()=>$({...i,purpose:t}),className:`py-3.5 cursor-pointer rounded-xl text-[11px] font-bold transition-all duration-200 border-2 ${i.purpose===t?"bg-indigo-600 border-indigo-600 text-white shadow-lg shadow-indigo-100":"bg-white text-slate-600 border-slate-200 hover:border-indigo-200 hover:text-slate-900"}`,children:t},t))}),e.jsx("hr",{className:"border-slate-100 mb-10"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-10 gap-y-6 mb-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-[11px] font-black text-indigo-600 uppercase tracking-[0.2em] mb-4",children:"Client Information"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-bold text-slate-400 uppercase ml-1",children:"Client Name"}),e.jsx(te,{placeholder:"Client Name",value:i.clientData.clientName,onChange:t=>$({...i,clientData:{...i.clientData,clientName:t.target.value}})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-bold text-slate-400 uppercase ml-1",children:"Phone Number"}),e.jsx(te,{placeholder:"Phone Number",value:i.clientData.whatsapp,maxLength:10,onChange:t=>$({...i,clientData:{...i.clientData,whatsapp:t.target.value}})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-bold text-slate-400 uppercase ml-1",children:"Email Address"}),e.jsx(te,{type:"email",placeholder:"Client Email",value:i.clientData.email,onChange:t=>$({...i,clientData:{...i.clientData,email:t.target.value}})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-[11px] font-black text-purple-600 uppercase tracking-[0.2em] mb-4",children:"Project Context"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-bold text-slate-400 uppercase ml-1",children:"Project/Site Name"}),e.jsx(te,{placeholder:"Skyline Residency",value:i.projectDetails.projectName,onChange:t=>$({...i,projectDetails:{...i.projectDetails,projectName:t.target.value}})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-bold text-slate-400 uppercase ml-1",children:"Site Location"}),e.jsx(te,{placeholder:"",value:i.clientData.location,onChange:t=>$({...i,clientData:{...i.clientData,location:t.target.value}})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-bold text-slate-400 uppercase ml-1",children:"Quote Reference"}),e.jsx(te,{value:i.projectDetails.quoteNo,onChange:t=>$({...i,quoteNo:t.target.value})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 items-center pt-8 border-t border-slate-100",children:[e.jsx("div",{className:"flex-1"}),e.jsxs(ae,{className:"cursor-pointer px-10 h-10 font-bold uppercase text-[10px] tracking-widest bg-slate-900 text-white shadow-md rounded-lg hover:!bg-black transition-all",onClick:()=>C(2),children:["Step ",w+1," ",e.jsx("i",{className:"fas fa-chevron-right ml-2 text-[7px]"})]})]})]}),w===2&&e.jsxs("div",{className:"w-full px-4 space-y-4 animate-in fade-in duration-500",children:[e.jsx("div",{className:"text-center space-y-1",children:e.jsx("h2",{className:"text-xl font-bold text-slate-800 uppercase tracking-tight",children:"Room Selection"})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-4 gap-3",children:Ie.map(t=>{const l=F[t]||0,c=l>0;return e.jsxs("div",{onClick:()=>!c&&H(m=>({...m,[t]:1})),className:`group bg-white relative rounded-xl border-2 transition-all duration-200 min-h-[70px] flex items-center justify-between px-4 cursor-pointer ${c?"border-blue-500 shadow-lg shadow-blue-50":"border-slate-100 hover:border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{onClick:m=>{c&&(m.stopPropagation(),H(d=>({...d,[t]:0})))},className:`w-5 h-5 flex-shrink-0 rounded-full border-2 flex items-center justify-center transition-all cursor-pointer ${c?"bg-blue-600 border-blue-600":"bg-white border-slate-300 group-hover:border-blue-400"}`,children:c&&e.jsx("i",{className:"fas fa-check text-[8px] text-white"})}),e.jsx("span",{className:`text-sm uppercase tracking-wide transition-colors ${c?"text-slate-900 font-bold":"text-slate-500"}`,children:t})]}),c&&e.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 p-1 rounded-full border border-slate-200 flex-shrink-0 animate-in slide-in-from-right-1",onClick:m=>m.stopPropagation(),children:[e.jsx("button",{onClick:()=>H(m=>({...m,[t]:Math.max(1,l-1)})),className:"w-6 h-6 cursor-pointer rounded-full bg-white text-slate-500 hover:text-slate-800 shadow-sm flex items-center justify-center transition-all active:scale-90",children:e.jsx("i",{className:"fas fa-minus text-[8px]"})}),e.jsx("span",{className:"text-xs font-bold text-slate-700 min-w-[14px] text-center",children:l}),e.jsx("button",{onClick:()=>H(m=>({...m,[t]:l+1})),className:"w-6 h-6 cursor-pointer rounded-full bg-white text-slate-500 hover:text-emerald-600 shadow-sm flex items-center justify-center transition-all active:scale-90",children:e.jsx("i",{className:"fas fa-plus text-[8px]"})})]})]},t)})}),e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t border-slate-100",children:[e.jsxs("p",{className:"text-slate-600 text-[10px] font-bold uppercase tracking-widest",children:[e.jsx("span",{className:"text-blue-600",children:Object.values(F).filter(t=>t>0).length})," Areas Defined"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(ae,{variant:"secondary",className:"px-6 h-10 font-bold uppercase text-[10px] tracking-widest rounded-lg cursor-pointer border border-slate-200",onClick:()=>C(1),children:"Back"}),e.jsxs(ae,{className:"px-8 h-10 font-bold uppercase text-[10px] tracking-widest shadow-md rounded-lg bg-indigo-600 hover:bg-indigo-700 cursor-pointer text-white",onClick:()=>C(3),children:["Step ",w+1," ",e.jsx("i",{className:"fas fa-chevron-right ml-2 text-[7px]"})]})]})]})]}),w===3&&e.jsxs("div",{className:"w-full px-4 space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"bg-slate-900 p-4 rounded-2xl flex items-center justify-between shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-indigo-500/20 rounded-lg flex items-center justify-center text-indigo-400",children:e.jsx("i",{className:"fas fa-ruler-combined text-xs"})}),e.jsx("span",{className:"text-xs font-medium text-slate-300 uppercase tracking-widest",children:"Dimension Model"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Ye,{position:"bottom",content:"Switching from Customized to Standard will remove all the dimension values entered in Customized type"}),e.jsxs("div",{className:"flex bg-slate-800 p-1 rounded-xl border border-slate-700",children:[e.jsx("button",{onClick:()=>{L("standard"),Object.entries(B).forEach(([t,l])=>{Object.entries(l).forEach(([c,m])=>{Object.entries(m).forEach(([d,y])=>{var k;const x=(k=pe[t])==null?void 0:k.find(E=>E.id===d);x&&Object.keys(y).forEach(E=>{Z(t,parseInt(c),d,parseInt(E),{h:x.h,w:x.w})})})})})},className:`px-6 py-1.5 text-[10px] font-medium rounded-lg transition-all ${q==="standard"?"bg-indigo-600 text-white shadow-md":"text-slate-500 hover:text-slate-300"}`,children:"STANDARD"}),e.jsx("button",{onClick:()=>L("custom"),className:`px-6 py-1.5 text-[10px] font-medium rounded-lg transition-all ${q==="custom"?"bg-indigo-600 text-white shadow-md":"text-slate-500 hover:text-slate-300"}`,children:"CUSTOMIZED"})]})]})]}),e.jsx("div",{className:"space-y-8",children:Object.entries(F).filter(([t,l])=>l>0).map(([t,l])=>e.jsx("div",{className:"space-y-4",children:Array.from({length:l}).map((c,m)=>e.jsxs("div",{className:"bg-white rounded-3xl p-6 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-slate-200 pb-3",children:[e.jsx("span",{className:"bg-indigo-600 text-white w-6 h-6 rounded-lg flex items-center justify-center font-bold text-[10px] shadow-sm",children:m+1}),e.jsx("h3",{className:"text-sm font-semibold text-slate-900 uppercase tracking-tight flex items-center gap-2",children:t})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:(pe[t]||[]).map(d=>{var E,O,I,V;const y=((O=(E=B[t])==null?void 0:E[m])==null?void 0:O[d.id])||{},x=Object.keys(y).length,k=x>0;return e.jsxs("div",{onClick:()=>!k&&Z(t,m,d.id,0,{h:q==="custom"?0:d.h,w:q==="custom"?0:d.w}),className:`p-3 rounded-2xl border transition-all duration-200 bg-white ${k?"border-indigo-500 shadow-md ring-1 ring-indigo-50":"border-slate-200 hover:border-slate-300 cursor-pointer"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("div",{onClick:D=>{if(k){D.stopPropagation();const ee={...B[t]};delete ee[m][d.id],M({...B,[t]:ee})}},className:`w-5 h-5 flex-shrink-0 rounded-md border flex items-center justify-center transition-all ${k?"bg-indigo-600 border-indigo-600":"bg-white border-slate-300"}`,children:k&&e.jsx("i",{className:"fas fa-check text-[8px] text-white"})}),e.jsx("span",{className:`text-[11px] uppercase tracking-wide truncate ${k?"text-slate-800 font-semibold":"font-semibold text-slate-800"}`,children:d.name})]}),k&&e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 p-1 rounded-full border border-slate-200 flex-shrink-0",onClick:D=>D.stopPropagation(),children:[e.jsx("button",{onClick:()=>{if(x>1){const D={...B[t]};delete D[m][d.id][x-1],M({...B,[t]:D})}},className:"w-7 h-7 cursor-pointer rounded-full bg-white text-slate-500 hover:text-rose-500 shadow-sm flex items-center justify-center transition-all active:scale-90",children:e.jsx("i",{className:"fas fa-minus text-[9px]"})}),e.jsx("span",{className:"text-xs font-black text-slate-700 min-w-[16px] text-center",children:x}),e.jsx("button",{onClick:()=>Z(t,m,d.id,x,{h:q==="custom"?0:d.h,w:q==="custom"?0:d.w}),className:"w-7 h-7 cursor-pointer rounded-full bg-white text-slate-500 hover:text-emerald-500 shadow-sm flex items-center justify-center transition-all active:scale-90",children:e.jsx("i",{className:"fas fa-plus text-[9px]"})})]})]}),k&&e.jsx("div",{className:"space-y-1.5 pt-2 border-t border-slate-50 animate-in fade-in",children:q==="standard"?e.jsxs("div",{className:"flex items-center justify-center gap-6 py-2 bg-slate-50/50 rounded-xl border border-dashed border-slate-200 mt-2",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-black text-emerald-600 uppercase tracking-widest mb-1",children:"Height"}),e.jsx("span",{className:"text-base font-bold text-slate-700",children:((I=y[0])==null?void 0:I.h)||d.h})]}),e.jsx("span",{className:"text-slate-300 text-lg font-light mt-3",children:"×"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest mb-1 text-amber-600",children:"Width"}),e.jsx("span",{className:"text-base font-bold text-slate-700",children:((V=y[0])==null?void 0:V.w)||d.w})]})]}):Object.entries(y).map(([D,ee])=>e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-white border border-slate-100 shadow-sm",children:[e.jsxs("span",{className:"text-[7px] font-bold text-indigo-400 w-5",children:["U",parseInt(D)+1]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-[8px] font-black text-emerald-600 uppercase tracking-tighter ml-1",children:"Height"}),e.jsx(te,{type:"number",value:ee.h||"",onChange:Y=>{const le=Y.target.value;Z(t,m,d.id,parseInt(D),{h:le===""?0:Math.max(0,parseFloat(le))})},className:"h-7 w-12 text-[10px] font-medium border-emerald-100 bg-emerald-50/30 focus:border-emerald-400 focus:bg-white p-1 transition-colors",placeholder:"H"})]}),e.jsx("span",{className:"text-[8px] text-slate-300 mt-3",children:"×"}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:`text-[8px] font-black uppercase  ml-1 
                                                                                            text-amber-600`,children:"Width"}),e.jsx(te,{type:"number",value:ee.w||"",onChange:Y=>{const le=Y.target.value;Z(t,m,d.id,parseInt(D),{w:le===""?0:Math.max(0,parseFloat(le))})},className:"h-7 w-12 text-[10px] font-medium border-amber-100 bg-amber-50/30 focus:border-amber-400 focus:bg-white p-1 transition-colors",placeholder:"W"})]})]})]},D))})]},d.id)})})]},m))},t))}),e.jsxs("div",{className:"flex justify-end gap-3 items-center pt-8 border-t border-slate-100",children:[e.jsx(ae,{variant:"secondary",className:"px-6 h-10 font-medium uppercase text-[10px] tracking-widest rounded-lg ",onClick:()=>C(2),children:"Back"}),e.jsxs(ae,{className:"px-10 h-10 font-medium uppercase text-[10px] tracking-widest bg-indigo-600 shadow-sm rounded-lg hover:bg-indigo-700",onClick:()=>C(4),children:["Step ",w+1,"  ",e.jsx("i",{className:"fas fa-chevron-right ml-2 text-[7px]"})]})]})]}),w===4&&e.jsx(Ze,{config:B,PRODUCT_CATALOG:pe,plywoodOptions:v,innerOptions:o,outerOptions:u,globalPlywood:W,globalInner:ne,globalOuter:ce,globalProfitPercentage:S,setGlobalProfitPercentage:A,updateAllProductsGlobally:be,updateProductInstance:Z,handleUpdate:Te,setStep:C,updatePending:R,groupProfitMargins:P,updateGroupMargin:Pe}),w===5&&e.jsxs("div",{className:"animate-in fade-in zoom-in-95 duration-500",children:[e.jsx(Je,{organizationId:g,rooms:Object.entries(s.config||{}).map(([t,l])=>({roomName:t,products:Object.values(l).flatMap(c=>Object.entries(c).flatMap(([m,d])=>Object.values(d).map(y=>({...y,furnitureName:y.furnitureName||m.replace(/_/g," ").toUpperCase()}))))})),data:s,grandTotal:we},((je=s==null?void 0:s.clientData)==null?void 0:je.clientName)||"loading"),e.jsx("div",{className:"fixed bottom-8 right-8 flex gap-3 print:hidden z-50",children:e.jsx(ae,{variant:"primary",onClick:()=>C(4),className:"shadow-lg",children:"Back to Summary"})})]})]})]})}export{pt as calculateMaterialSqft,ut as default};
