import{u as w}from"./useQuery-CqjHwNP0.js";import{z as c,q as m,V as f}from"./index-e8sHY52i.js";import{u as l}from"./useMutation-BqjQ-Xv_.js";import{u as i,g as s}from"./roleCheck-DbhaipVR.js";const u=["owner","staff","CTO"],y=async(e,r,t)=>{const{data:a}=await t.put(`/orderingmaterial/${e}/shop`,r);if(!a.ok)throw new Error(a.message);return a.data},F=()=>{const{role:e}=i(),r=s(e),t=c();return l({mutationFn:async({projectId:a,updates:o})=>{if(!e||!u.includes(e))throw new Error("Not allowed to update shop details");if(!r)throw new Error("API instance not available");return await y(a,o,r)},onSuccess:(a,{projectId:o})=>{t.invalidateQueries({queryKey:["ordering-material",o]})}})},g=async(e,r,t)=>{const{data:a}=await t.put(`/orderingmaterial/${e}/delivery-location`,r);if(!a.ok)throw new Error(a.message);return a.data},P=()=>{const{role:e}=i(),r=s(e),t=c();return l({mutationFn:async({projectId:a,updates:o})=>{if(!e||!u.includes(e))throw new Error("Not allowed to update delivery location");if(!r)throw new Error("API instance not available");return await g(a,o,r)},onSuccess:(a,{projectId:o})=>{t.invalidateQueries({queryKey:["ordering-material",o]})}})},p=async(e,r,t,a,o)=>{const{data:n}=await o.put(`/orderingmaterial/${e}/room/${t}/${r}`,{items:a});if(!n.ok)throw new Error(n.message);return n.data},S=()=>{const{role:e}=i(),r=s(e),t=c();return l({mutationFn:async({projectId:a,roomKey:o,itemId:n,updates:d})=>{if(!e||!u.includes(e))throw new Error("Not allowed to update room materials");if(!r)throw new Error("API instance not available");return await p(a,o,n,d,r)},onSuccess:(a,{projectId:o,roomKey:n})=>{t.invalidateQueries({queryKey:["ordering-material",o,n]})}})},h=async(e,r,t,a)=>{const{data:o}=await a.post(`/orderingmaterial/${e}/room/${r}/add`,t);if(!o.ok)throw new Error(o.message);return o.data},D=()=>{const{role:e}=i(),r=s(e);return l({mutationFn:async({projectId:t,roomKey:a,newItem:o})=>{if(!e||!u.includes(e))throw new Error("Not allowed to add item");if(!r)throw new Error("API instance not available");return await h(t,a,o,r)},onSuccess:(t,{projectId:a,roomKey:o})=>{m.invalidateQueries({queryKey:["ordering-material",a,o]})}})},E=async(e,r,t,a)=>{const{data:o}=await a.delete(`/orderingmaterial/${e}/room/${r}/${t}`);if(!o.ok)throw new Error(o.message);return o.data},I=()=>{const{role:e}=i(),r=s(e),t=c();return l({mutationFn:async({projectId:a,roomKey:o,itemId:n})=>{if(!e||!u.includes(e))throw new Error("Not allowed to delete item");if(!r)throw new Error("API instance not available");return await E(a,o,n,r)},onSuccess:(a,{projectId:o,roomKey:n})=>{t.invalidateQueries({queryKey:["ordering-material",o,n]})}})},A=async(e,r)=>{const{data:t}=await r.get(`/orderingmaterial/${e}`);if(!t.ok)throw new Error(t.message);return t.data},Q=e=>{const r=["owner","staff","CTO","worker","client"],{role:t}=i(),a=s(t);return w({queryKey:["ordering-material",e],queryFn:async()=>{if(!t||!r.includes(t))throw new Error("Not allowed to fetch ordering material");if(!a)throw new Error("API not available");return await A(e,a)},enabled:!!t&&!!e&&!!a,retry:!1,refetchOnMount:!1})},M=async(e,r,t)=>{const{data:a}=await t.get(`/orderingmaterial/${e}/room/${r}`);if(!a.ok)throw new Error(a.message);return a.data},K=(e,r)=>{const t=["owner","staff","CTO","worker","client"],{role:a}=i(),o=s(a);return w({queryKey:["ordering-material",e,r],queryFn:async()=>{if(!a||!t.includes(a))throw new Error("Not allowed to fetch room materials");if(!o)throw new Error("API not available");return await M(e,r,o)},enabled:!!a&&!!e&&!!r&&!!o,retry:!1,refetchOnMount:!1})},q=async(e,r)=>{const{data:t}=await r.post(`/orderingmaterial/${e}/generate-link`);if(!t.ok)throw new Error(t.message);return t.data},O=async(e,r)=>{const{data:t}=await f.get(`https://houseofram.in/api/orderingmaterial/public/${e}/${r}`);if(!t.ok)throw new Error(t.message);return t.data},N=()=>{const{role:e}=i(),r=s(e);return l({mutationFn:async({projectId:t})=>{if(!e||!u.includes(e))throw new Error("Not allowed to generate link");if(!r)throw new Error("API instance not found");return await q(t,r)}})},_=(e,r)=>w({queryKey:["ordering-material-public",e,r],queryFn:async()=>await O(e,r),enabled:!!e&&!!r,retry:!1,refetchOnMount:!1}),$=async({formId:e,projectId:r,deadLine:t,api:a})=>{const{data:o}=await a.put(`/orderingmaterial/deadline/${r}/${e}`,{deadLine:t});if(!o.ok)throw new Error(o.message);return o.data},v=async({projectId:e,api:r})=>{const{data:t}=await r.put(`/orderingmaterial/completionstatus/${e}`);if(!t.ok)throw new Error(t.message);return t.data},G=()=>{const e=["owner","staff","CTO"],{role:r}=i(),t=s(r),a=c();return l({mutationFn:async({formId:o,projectId:n,deadLine:d})=>{if(!r||!e.includes(r))throw new Error("not allowed to make this api call");if(!t)throw new Error("API instance missing");return await $({formId:o,projectId:n,deadLine:d,api:t})},onSuccess:(o,n)=>{a.invalidateQueries({queryKey:["ordering-material",n.formId]})}})},T=()=>{const e=["owner","staff","CTO"],{role:r}=i(),t=s(r),a=c();return l({mutationFn:async({projectId:o})=>{if(!r||!e.includes(r))throw new Error("not allowed to make this api call");if(!t)throw new Error("API instance missing");return await v({projectId:o,api:t})},onSuccess:(o,{projectId:n})=>{a.invalidateQueries({queryKey:["ordering-material",n]})}})};export{N as a,F as b,P as c,G as d,T as e,K as f,D as g,S as h,I as i,_ as j,Q as u};
