import{b as I,f as R,d as k,j as e,O as A,L as O}from"./index-DkfQDeIt.js";import{u as M,a as P,b as B}from"./installationWorkApi-DzA_gYKc.js";import{t as g}from"./toast-BSC5QTk1.js";import{R as T}from"./ResetStageButton-DPKiOhg7.js";import{B as h}from"./Button-C-chqFKc.js";import{c as F}from"./Card-Dx_Z9f0D.js";import{A as D,S as G}from"./AssignStaff-DXCssW_O.js";import z from"./MaterialOverviewLoading-CgXl-m5l.js";import"./useQuery-mUmMtORz.js";import"./useMutation-BWlLDX_I.js";import"./roleCheck-DNL7PxQZ.js";import"./Input-lr8I7tVA.js";import"./getAllUsersApi-CuWWGdu9.js";import"./Skeleton-CVtEMTN7.js";const E=["LivingRoom","Bedroom","Kitchen","DiningRoom","Balcony","FoyerArea","Terrace","StudyRoom","CarParking","Garden","StorageRoom","EntertainmentRoom","HomeGym"];function se(){var m,d,c,x,u;const{projectId:i,organizationId:p}=I(),f=R(),{isMobile:b,openMobileSidebar:j}=k(),w=f.pathname.includes("/installationroom"),{data:s,isLoading:r,isError:N,refetch:n,error:a}=M(i),{mutateAsync:v,isPending:y}=P(),{mutateAsync:S,isPending:L}=B(),C=async()=>{var t,o;try{await v({projectId:i}),g({title:"Success",description:"Completion status updated successfully"})}catch(l){g({title:"Error",description:((o=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:o.message)||l.message||"Failed to update status",variant:"destructive"})}};return r?e.jsx(z,{}):e.jsx("main",{className:"w-full h-full",children:w?e.jsx(A,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-blue-600 flex items-center",children:[b&&e.jsx("button",{onClick:j,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsx("i",{className:"fas fa-tools mr-2"})," Installation Overview"]}),e.jsxs("div",{className:"w-full sm:w-auto flex flex-col sm:flex-row gap-2",children:[e.jsxs(h,{isLoading:y,onClick:C,className:"bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-circle-check mr-2"}),"Mark Complete"]}),e.jsx(T,{projectId:i,stageNumber:11,stagePath:"installation",className:"w-full sm:w-auto"}),e.jsx(D,{stageName:"InstallationModel",projectId:i,organizationId:p,currentAssignedStaff:(s==null?void 0:s.assignedTo)||null,className:"w-full sm:w-auto"})]})]}),N?e.jsxs("div",{className:"max-w-xl mx-auto p-6 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 text-xl font-semibold mb-2",children:"⚠️ Oops! An Error Occurred"}),e.jsx("p",{className:"text-red-500 text-sm mb-4",children:((d=(m=a==null?void 0:a.response)==null?void 0:m.data)==null?void 0:d.message)||(a==null?void 0:a.message)||"Something went wrong"}),e.jsx(h,{isLoading:r,onClick:()=>n(),className:"bg-red-600 text-white hover:bg-red-700",children:"Retry"})]}):s&&e.jsxs(e.Fragment,{children:[e.jsxs(F,{className:"p-4 mb-6 w-full shadow border-l-4 border-blue-600 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-700 text-sm font-medium mb-2",children:[e.jsx("i",{className:"fa-solid fa-clock text-blue-500 text-lg"}),e.jsx("span",{children:"Stage Timings"})]}),e.jsx(G,{completedAt:(c=s==null?void 0:s.timer)==null?void 0:c.completedAt,stageName:"installation",projectId:i,formId:s==null?void 0:s._id,deadLine:(x=s==null?void 0:s.timer)==null?void 0:x.deadLine,startedAt:(u=s==null?void 0:s.timer)==null?void 0:u.startedAt,refetchStageMutate:n,deadLineMutate:S,isPending:L})]}),e.jsx("div",{className:"sm:max-h-[47vh] lg:max-h-[55vh] xl:max-h-[70vh] overflow-y-auto grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4",children:E.map(t=>{var o;return e.jsxs(O,{to:`installationroom/${t}`,className:"border-l-4 border-blue-600 p-4 rounded-xl shadow hover:shadow-md transition cursor-pointer bg-white",children:[e.jsx("h3",{className:"text-md font-semibold capitalize text-blue-800",children:t}),e.jsxs("p",{className:"text-xs text-gray-500",children:[((o=s==null?void 0:s[t])==null?void 0:o.length)||0," work items"]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Tap to view details"})]},t)})})]})]})})}export{se as default,E as roomKeys};
