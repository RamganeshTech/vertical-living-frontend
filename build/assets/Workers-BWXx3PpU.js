import{a as R,b as k,r as g,j as e}from"./index-Di9fivK2.js";import{B as l}from"./Button-CVj9LlQY.js";import{C as b,a as j,b as v,c as N}from"./Card-BLnLpKqb.js";import{B as $}from"./Badge-iZ7miANc.js";import{A as B,a as E}from"./Avatar-2XUTjLsT.js";import{I as F}from"./Input-CT6Rp1Ze.js";import{L as G}from"./Label-BBKatCOH.js";import{S as c}from"./Skeleton-o7WjJukS.js";import{t as i}from"./toast-BSC5QTk1.js";import{e as P,f as z,g as M}from"./orgApi-v9kvvLv7.js";import"./useQuery-D3U2IXUF.js";import"./useBaseQuery-DArxBqcU.js";import"./useMutation-Br_DKCOJ.js";import"./roleCheck-CZ0YkMwP.js";function ee(){const{projectId:o,organizationId:m}=R(),{openMobileSidebar:y,isMobile:C}=k(),[n,x]=g.useState(""),[w,h]=g.useState(!1),{data:r,isLoading:W}=P(o||""),d=z(),f=M(),p=async()=>{var s,t;try{const a=await d.mutateAsync({projectId:o||"",role:"worker",organizationId:m});x((a==null?void 0:a.inviteLink)||a),i({title:"Success",description:"Worker invitation link generated successfully"})}catch(a){i({title:"Error",description:((t=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:t.message)||(a==null?void 0:a.message)||"Failed to generate invitation link",variant:"destructive"})}},u=async()=>{try{await navigator.clipboard.writeText(n),h(!0),i({title:"Success",description:"Link copied to clipboard"}),setTimeout(()=>h(!1),2e3)}catch{i({title:"Error",description:"Failed to copy link",variant:"destructive"})}},I=()=>{const s=`You're invited to work with us Click this link to join: ${n}`,t=`https://wa.me/?text=${encodeURIComponent(s)}`;window.open(t,"_blank")},L=async(s,t)=>{if(window.confirm(`Are you sure you want to remove ${t} from this project?`))try{await f.mutateAsync({workerId:s,orgId:m,projectId:o||""}),i({title:"Success",description:`${t} has been removed from the project`})}catch(a){i({title:"Error",description:a.message||"Failed to remove worker",variant:"destructive"})}},S=s=>s?s.split(" ").map(t=>t[0]).join("").toUpperCase():"WK",A=s=>({carpenter:"bg-amber-100 text-amber-800 border-amber-200",plumber:"bg-blue-100 text-blue-800 border-blue-200",electrician:"bg-yellow-100 text-yellow-800 border-yellow-200",painter:"bg-green-100 text-green-800 border-green-200",mason:"bg-gray-100 text-gray-800 border-gray-200",welder:"bg-red-100 text-red-800 border-red-200"})[s.toLowerCase()]||"bg-purple-100 text-purple-800 border-purple-200";return e.jsxs("div",{className:"max-h-full sm:overflow-y-hidden custom-scrollbar",children:[e.jsx("div",{className:"bg-white ",children:e.jsx("div",{className:"max-w-full mx-auto  py-2",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{className:"flex items-center space-x-4 min-w-0 flex-1",children:[C&&e.jsx("button",{onClick:y,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars "})}),e.jsx("div",{className:"hidden sm:block w-px bg-gray-300 flex-shrink-0"}),e.jsx("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:e.jsx("div",{className:"min-w-0 flex-1",children:e.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-blue-600 truncate",children:[e.jsx("i",{className:"fas fa-user-plus mr-1"}),"Invite Workers"]})})})]})})})}),e.jsx("div",{className:"max-w-full !max-h-[100%] overflow-y-auto custom-scrollbar mx-auto p-2",children:e.jsxs("div",{className:"grid grid-cols-1 max-h-full lg:grid-cols-3 gap-6 lg:gap-8 w-full",children:[e.jsx("div",{className:"lg:col-span-1 h-fit space-y-6",children:e.jsxs(b,{className:"bg-white backdrop-blur-sm rounded-2xl shadow-md border-l-4 border-green-600 ",children:[e.jsx(j,{children:e.jsxs(v,{className:"text-gray-800 flex items-center text-lg",children:[e.jsx("i",{className:"fas fa-user-plus mr-2 text-green-600"}),"Invite Workers"]})}),e.jsx(N,{className:"space-y-4",children:n?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{className:"text-gray-700 font-medium",children:"Invitation Link"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(F,{value:n,readOnly:!0,className:"border-green-200 bg-green-50 text-sm flex-1 min-w-0"}),e.jsx(l,{onClick:u,variant:"outline",size:"icon",className:"border-green-200 text-green-600 hover:bg-green-50 rounded-xl flex-shrink-0",children:e.jsx("i",{className:`fas ${w?"fa-check":"fa-copy"}`})})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs(l,{onClick:u,variant:"outline",className:"w-full border-green-200 text-green-600 hover:bg-green-50 rounded-xl",children:[e.jsx("i",{className:"fas fa-copy mr-2"}),"Copy Link"]}),e.jsxs(l,{onClick:I,className:"w-full bg-green-600 hover:bg-green-700 text-white rounded-xl",children:[e.jsx("i",{className:"fab fa-whatsapp mr-2"}),"Share on WhatsApp"]}),e.jsxs(l,{onClick:()=>{x("")},variant:"outline",className:"w-full border-blue-200 text-blue-600 hover:bg-blue-50 rounded-xl",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Generate Another"]})]})]}):e.jsxs(l,{onClick:p,isLoading:d.isPending,className:"w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-xl",children:[e.jsx("i",{className:"fas fa-link mr-2"}),d.isPending?"Generating...":"Generate Invitation Link"]})})]})}),e.jsx("div",{className:"lg:col-span-2 sm:max-h-[43%] lg:!max-h-[48%] rounded-2xl border-l-4 border-orange-600  overflow-y-auto shadow-md custom-scrollbar",children:e.jsxs(b,{className:"bg-white/70 backdrop-blur-sm border-0  shadow-xl",children:[e.jsx(j,{children:e.jsx(v,{className:"text-gray-800 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-hard-hat mr-2 text-orange-600"}),e.jsxs("span",{className:"text-lg",children:["Project Workers (",(r==null?void 0:r.length)||0,")"]})]})})}),e.jsx(N,{children:W?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsxs("div",{className:"flex items-center space-x-4 p-4 border border-blue-100 rounded-xl",children:[e.jsx(c,{className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(c,{className:"h-4 w-32"}),e.jsx(c,{className:"h-3 w-48"})]}),e.jsx(c,{className:"h-8 w-20"})]},s))}):r&&r.length>0?e.jsx("div",{className:"space-y-4 overflow-hidden",children:r.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 border border-blue-100 rounded-xl hover:bg-blue-50/50 transition-all duration-200 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 min-w-0 flex-1",children:[e.jsx(B,{className:"w-12 h-12 border-2 border-blue-200 flex-shrink-0",children:e.jsx(E,{className:"bg-gradient-to-br from-orange-500 to-red-600 text-white font-semibold",children:S(s==null?void 0:s.workerName)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800 truncate",children:(s==null?void 0:s.workerName)||(s==null?void 0:s.name)}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 text-sm text-gray-600 gap-1 sm:gap-0",children:[s.email&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("i",{className:"fas fa-envelope text-xs"}),e.jsx("span",{className:"truncate",children:s.email})]}),s.phoneNo&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("i",{className:"fas fa-phone text-xs"}),e.jsx("span",{children:s.phoneNo})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs($,{className:`text-xs ${A((s==null?void 0:s.specifiedRole)||(s==null?void 0:s.role)||"worker")}`,children:[e.jsx("i",{className:"fas fa-tools mr-1"}),(s==null?void 0:s.specifiedRole)||(s==null?void 0:s.role)||"Worker"]})})]})]}),e.jsxs(l,{onClick:()=>L(s._id,(s==null?void 0:s.workerName)||(s==null?void 0:s.name)),variant:"danger",size:"sm",className:"text-red-600 border-red-200 hover:bg-red-50 rounded-xl w-full sm:w-auto",isLoading:f.isPending,children:[e.jsx("i",{className:"fas fa-user-minus mr-1"}),"Remove"]})]},s._id))}):e.jsxs("div",{className:"text-center py-12 min-h-[100vh]",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-100 to-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fas fa-hard-hat text-orange-500 text-2xl"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Workers Assigned"}),e.jsx("p",{className:"text-gray-600 mb-6 text-sm sm:text-base",children:"Start building your team by inviting skilled workers to this project"}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center mb-6"}),e.jsxs(l,{onClick:()=>{p()},className:"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 text-white rounded-xl",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Invite First Worker"]})]})})]})})]})})]})}export{ee as default};
