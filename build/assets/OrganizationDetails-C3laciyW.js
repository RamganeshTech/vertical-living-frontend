import{r as o,j as e,aw as u,u as X,p as Z,a as ee,B as r,C as A,I as z,t as d}from"./index-MXS_gbde.js";import{B as se}from"./Badge-DnX2tetz.js";import{h as ae,i as te}from"./orgApi-CsTEC_SP.js";import{u as v}from"./getAllUsersApi-Gbc98a74.js";import{IssueDiscussionPage as le}from"./IssueDiscussionPage-DDT-0D3L.js";import"./issueDiscussionApi-D9aOeR77.js";import"./TextArea-CqY0luNO.js";import"./Label-BYfdMzSb.js";import"./SearchSelectNew-C8k-FWEO.js";import"./ImageGalleryMain-LKPoIxi9.js";import"./downloadFile-BskFWteI.js";import"./index-BDg928G7.js";import"./dateFormator-BGKi5rfZ.js";import"./projectApi-BH0dGL_K.js";import"./useDebounce-D0G-FEVR.js";const w=({title:n,icon:y,list:t,isLoading:g})=>{const[m,f]=o.useState(""),c=o.useMemo(()=>t!=null&&t.length?t==null?void 0:t.filter(i=>{var x,p;return((x=i.name)==null?void 0:x.toLowerCase().includes(m.toLowerCase()))||((p=i.email)==null?void 0:p.toLowerCase().includes(m.toLowerCase()))}):[],[t,m]);return e.jsxs("div",{className:"bg-white border rounded-xl !min-h-[50%] !max-h-[93%] overflow-hidden border-blue-100 shadow-sm px-4 py-5 flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-blue-800 font-semibold flex items-center gap-2 text-base",children:[e.jsx("i",{className:`fas ${y} text-blue-600 text-lg`}),n]}),t&&e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs font-medium px-2 py-0.5 rounded-full",children:[t==null?void 0:t.length," total"]})]}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Search name or email",value:m,onChange:i=>f(i.target.value),className:"w-full px-3 py-1.5 border border-blue-200 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-400"})}),e.jsx("div",{className:"max-h-[100%] overflow-y-auto custom-scrollbar pr-1 scroll-smooth scrollbar-thin scrollbar-thumb-blue-300 hover:scrollbar-thumb-blue-400 scrollbar-track-blue-100",children:g?e.jsx(u,{className:"h-4 w-1/2 mx-2 mb-2"}):(c==null?void 0:c.length)>0?e.jsx("ul",{className:"space-y-3 pt-1",children:c==null?void 0:c.map(i=>e.jsxs("li",{className:"flex items-start gap-3 px-1",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm mt-0.5",children:e.jsx("i",{className:"fas fa-user"})}),e.jsxs("div",{className:"text-sm text-gray-700 leading-tight",children:[e.jsx("p",{className:"font-medium",children:i.name}),e.jsx("p",{className:"text-gray-500 text-xs",children:i.email})]})]},i._id))}):e.jsxs("p",{className:"text-sm text-gray-500 text-center py-6",children:["No ",n.toLowerCase()," found."]})})]})};function Ne(){const{organizationId:n}=X(),{openMobileSidebar:y,isMobile:t}=Z(),g=ee(),[m,f]=o.useState(!1),[c,i]=o.useState(""),[x,p]=o.useState(!0),[F,k]=o.useState(!1),[T,C]=o.useState(!1),[j,E]=o.useState(""),[N,L]=o.useState(""),I=()=>{p(a=>!a)};let{data:s,isLoading:B,error:D}=ae(n);Array.isArray(s)&&(s=s[0]);const h=te(),{data:U,isLoading:G}=v(n,"staff"),{data:K,isLoading:M}=v(n,"CTO"),{data:_,isLoading:Y}=v(n,"worker"),{data:$,isLoading:R}=v(n,"client"),S=async()=>{if(!c.trim()){d({title:"Error",description:"Organization name cannot be empty",variant:"destructive"});return}try{await h.mutateAsync({updateField:{organizationName:c},orgsId:n}),d({title:"Success",description:"Organization name updated successfully"}),f(!1)}catch(a){d({title:"Error",description:a.message||"Failed to update organization name",variant:"destructive"})}},H=()=>{i((s==null?void 0:s.organizationName)||""),f(!0)},V=()=>{i(""),f(!1)},W=()=>{E((s==null?void 0:s.organizationPhoneNo)||""),k(!0)},q=()=>{L((s==null?void 0:s.address)||""),C(!0)},O=async()=>{var a,b;if(!j.trim()){d({title:"Error",description:"Phone number cannot be empty",variant:"destructive"});return}if(!/^\d{10}$/.test(j)){d({title:"Error",description:"Phone number should contain 10 digits number",variant:"destructive"});return}try{await h.mutateAsync({orgsId:n,updateField:{organizationPhoneNo:j}}),d({title:"Success",description:"Phone number updated successfully"}),k(!1)}catch(l){d({title:"Error",description:((b=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:b.message)||(l==null?void 0:l.message)||"Failed to update phone number",variant:"destructive"})}},P=async()=>{var a,b;if(!N.trim()){d({title:"Error",description:"Address cannot be empty",variant:"destructive"});return}if(N.length>150){d({title:"Error",description:"Address cannot be more than 150 characters",variant:"destructive"});return}try{await h.mutateAsync({orgsId:n,updateField:{address:N}}),d({title:"Success",description:"Address updated successfully"}),C(!1)}catch(l){d({title:"Error",description:((b=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:b.message)||(l==null?void 0:l.message)||"Failed to update address",variant:"destructive"})}},J=()=>{E(""),k(!1)},Q=()=>{L(""),C(!1)};return B?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-blue-100 sticky top-0 z-10",children:e.jsx("div",{className:"max-w-full   mx-auto px-4 sm:px-6 py-4 sm:py-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[e.jsx(u,{className:"h-8 w-24 sm:h-10 sm:w-32"}),e.jsx("div",{className:"hidden sm:block h-6 w-px bg-gray-300"}),e.jsx(u,{className:"h-10 w-10 sm:h-12 sm:w-12 rounded-xl"}),e.jsx(u,{className:"h-6 w-32 sm:h-8 sm:w-48"})]}),e.jsx(u,{className:"h-8 w-20 sm:h-10 sm:w-24"})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8",children:[e.jsx(u,{className:"h-64 w-full rounded-2xl"}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(u,{className:"h-96 w-full rounded-2xl"})})]})})]}):D||!s?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center bg-white p-6 sm:p-8 rounded-2xl shadow-lg max-w-md w-full",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fas fa-building text-blue-500 text-2xl"})}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-red-600 mb-2",children:"Organization Not Found"}),e.jsx("p",{className:"text-blue-600 mb-4 text-sm sm:text-base",children:"The organization you're looking for doesn't exist or you don't have access to it."}),e.jsxs(r,{onClick:()=>g("/organizations"),variant:"primary",className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-xl",children:[e.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Organizations"]})]})}):e.jsx("div",{className:"flex w-full h-full ",children:e.jsxs("div",{className:"min-h-full w-full max-h-[100vh] overflow-y-auto custom-scrollbar bg-gradient-to-br from-blue-50 via-white bg-blue-100",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-blue-100 sticky top-0 z-10 w-full",children:e.jsx("div",{className:"max-w-full mx-auto px-4 sm:px-6 py-3 flex flex-row sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-6",children:e.jsxs("div",{className:"flex flex-row sm:items-center justify-between  w-full gap-3 sm:gap-4",children:[t?e.jsx("button",{onClick:y,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}):e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>g("/organizations"),className:"text-blue-600 hover:bg-blue-50 rounded-xl",children:[e.jsx("i",{className:"fas fa-arrow-left mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Back to Organizations"}),e.jsx("span",{className:"md:hidden",children:"Back"})]}),e.jsx("div",{className:"hidden sm:block h-6 w-px bg-gray-300"})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg flex-shrink-0",children:s!=null&&s.logoUrl?e.jsx("img",{src:(s==null?void 0:s.logoUrl)||A.COMPANY_LOGO,alt:s==null?void 0:s.organizationName,className:"w-6 h-6 sm:w-7 sm:h-7 rounded-lg object-cover"}):e.jsx("img",{src:A.COMPANY_LOGO,alt:"Company Logo",className:"w-6 h-6 sm:w-7 sm:h-7 rounded-lg object-cover"})}),e.jsx("div",{className:"min-w-0 flex-1 ",children:m?e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsx(z,{value:c,onChange:a=>i(a.target.value),onKeyPress:a=>a.key==="Enter"&&S(),placeholder:"Organization name",className:"w-full text-lg sm:text-xl font-bold border-2 border-blue-300 focus:border-blue-500 rounded-xl bg-white/90 backdrop-blur-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{size:"sm",variant:"primary",onClick:S,isLoading:h.isPending,className:"bg-green-600 hover:bg-green-700 text-white rounded-xl",children:[e.jsx("i",{className:"fas fa-check mr-1"})," Save"]}),e.jsxs(r,{size:"sm",variant:"outline",onClick:V,className:"border-gray-300 text-gray-600 hover:bg-gray-50 rounded-xl",children:[e.jsx("i",{className:"fas fa-times mr-1"})," Cancel"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-blue-900 truncate",children:(s==null?void 0:s.organizationName)||"N/A"}),(s==null?void 0:s.type)&&e.jsx(se,{className:"mt-1 bg-blue-100 text-blue-700 text-xs",children:s==null?void 0:s.type})]})})]}),e.jsxs("div",{className:"flex gap-2 ",children:[!m&&e.jsx("div",{className:"flex justify-end sm:justify-start  w-fit flex-shrink-0",children:e.jsxs(r,{variant:"outline",onClick:H,className:"border-blue-200 text-blue-600 hover:bg-blue-50 rounded-xl bg-white/80 backdrop-blur-sm",children:[e.jsx("i",{className:"fas fa-edit mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Edit Name"}),e.jsx("span",{className:"sm:hidden",children:"Edit"})]})}),e.jsx(r,{variant:"secondary",onClick:()=>g("settings"),className:"",children:e.jsx("i",{className:"fas fa-gear"})})]})]})})}),e.jsx("div",{className:"max-w-full mx-auto p-4 sm:p-6",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8",children:e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"p-4 bg-blue-50 rounded-xl shadow-sm h-fit",children:F?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"fas fa-phone text-blue-600"}),e.jsx(z,{value:j,type:"tel",maxLength:10,onChange:a=>E(a.target.value),placeholder:"Enter phone number",className:"text-sm border-blue-200 focus:border-blue-500 bg-white flex-1",onKeyPress:a=>a.key==="Enter"&&O()})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[e.jsxs(r,{size:"sm",variant:"outline",onClick:J,className:"text-gray-600 border-gray-300 hover:bg-gray-50 text-xs px-3 py-1",children:[e.jsx("i",{className:"fas fa-times mr-1"})," Cancel"]}),e.jsxs(r,{size:"sm",variant:"primary",onClick:O,isLoading:h.isPending,className:"bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1",children:[e.jsx("i",{className:"fas fa-check mr-1"})," Save"]})]})]}):e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"fas fa-phone text-blue-600"}),e.jsx("span",{className:"text-gray-700 text-sm sm:text-base",children:(s==null?void 0:s.organizationPhoneNo)||"N/A"})]}),e.jsx(r,{size:"sm",variant:"ghost",onClick:W,className:"text-blue-600 hover:bg-blue-100 p-1 h-auto",children:e.jsx("i",{className:"fas fa-edit text-xs"})})]})}),e.jsx("div",{className:"p-4 bg-blue-50 rounded-xl shadow-sm ",children:T?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"fas fa-map-marker-alt text-blue-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{value:N,onChange:a=>L(a.target.value),placeholder:"Enter address",className:"w-full text-sm border-2 border-blue-200 focus:border-blue-500 bg-white rounded-lg p-2 resize-none focus:outline-none",rows:3,onKeyDown:a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),P())}}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-blue-600",children:[e.jsx("i",{className:"fa-solid fa-circle-info text-[13px]"}),e.jsx("span",{className:"text-[12px] sm:text-sm",children:"Press Shift + Enter for next line"})]})]})]}),e.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[e.jsxs(r,{size:"sm",variant:"outline",onClick:Q,className:"text-gray-600 border-gray-300 hover:bg-gray-50 text-xs px-3 py-1",children:[e.jsx("i",{className:"fas fa-times mr-1"})," Cancel"]}),e.jsxs(r,{size:"sm",variant:"primary",onClick:P,isLoading:h.isPending,className:"bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1",children:[e.jsx("i",{className:"fas fa-check mr-1"})," Save"]})]})]}):e.jsxs("div",{className:"flex justify-between items-start gap-3  w-full",children:[e.jsxs("div",{className:"flex items-start gap-3 ",children:[e.jsx("i",{className:"fas fa-map-marker-alt text-blue-600 mt-1"}),e.jsx("div",{className:"max-w-[90%] overflow-h-auto !max-h-[150px] ",children:e.jsx("span",{className:"text-gray-700 text-sm sm:text-base break-words whitespace-pre-wrap",children:(s==null?void 0:s.address)||"N/A"})})]}),e.jsx(r,{size:"sm",variant:"ghost",onClick:q,className:"text-blue-600 hover:bg-blue-100 p-1 h-auto flex-shrink-0",children:e.jsx("i",{className:"fas fa-edit text-xs"})})]})})]})})})}),e.jsxs("section",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("aside",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6 pb-4 border-b border-gray-100",children:[x?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"fas fa-ticket-alt text-blue-600 text-lg"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Ticket Operations"})]}):e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"fas fa-users text-blue-600 text-lg"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Employees"})]}),e.jsxs(r,{onClick:I,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-lg font-medium transition-colors duration-200 flex items-center gap-2 shadow-sm hover:shadow-md",children:[e.jsx("i",{className:`fas ${x?"fa-users":"fa-ticket-alt"} text-sm`}),"Show ",x?"employee list":"tickets"]})]}),x?e.jsx("div",{className:"h-full w-full bg-gray-50 rounded-lg border border-gray-200 overflow-hidden",children:e.jsx(le,{showFilters:!0,showFullView:!1,showHeader:!1})}):e.jsxs("div",{className:"px-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-3  sm:min-h-[65vh] sm:max-h-[100%]",children:[e.jsx(w,{title:"Staffs",icon:"fa-user-tie",list:U,isLoading:G}),e.jsx(w,{title:"CTOs",icon:"fa-user-cog",list:K,isLoading:M}),e.jsx(w,{title:"Workers",icon:"fa-user-hard-hat",list:_,isLoading:Y}),e.jsx(w,{title:"Clients",icon:"fa-user-friends",list:$,isLoading:R})]})]})]})})}export{Ne as default};
