import{j as e,B as g,t as j,a as D,d as M,r as p,u as S,O as P,M as k}from"./index-BAM0eJUz.js";import{u as E}from"./useDebounce-DSMcRuVp.js";import{u as F,a as L}from"./shopMaterialDocumentApi-g7G1R7HN.js";import{d as z}from"./dateFormator-BGKi5rfZ.js";import"./useInfiniteQuery-BGz0VllC.js";const A=({data:s,index:d,onView:x})=>{var i,m;const l=F(),c=async(a,u)=>{var n,r;a.stopPropagation();try{await l.mutateAsync(u),j({title:"Success",description:"Document deleted successfully"})}catch(o){j({title:"Error",description:((r=(n=o==null?void 0:o.response)==null?void 0:n.data)==null?void 0:r.message)||"Failed to delete",variant:"destructive"})}};return e.jsxs("div",{onClick:x,className:"grid grid-cols-10 gap-4 px-6 py-4 hover:bg-blue-50/30 transition-colors cursor-pointer items-center group",children:[e.jsx("div",{className:"col-span-1 text-center text-gray-400 font-medium text-sm",children:d+1}),e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-900 truncate text-sm",children:s.categoryName}),e.jsx("span",{className:"text-[11px] text-blue-600 truncate flex items-center mt-1"})]})}),e.jsx("div",{className:"col-span-2 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${((i=s.file)==null?void 0:i.type)==="pdf"?"bg-red-50 text-red-600 border border-red-100":"bg-green-50 text-green-600 border border-green-100"}`,children:((m=s==null?void 0:s.file)==null?void 0:m.length)||0})}),e.jsx("div",{className:"col-span-2 text-center text-sm text-gray-500 font-medium",children:z(s==null?void 0:s.createdAt)}),e.jsx("div",{className:"col-span-2 text-center flex justify-center gap-4",children:e.jsx(g,{variant:"danger",size:"sm",disabled:l.isPending,onClick:a=>c(a,s._id),children:l.isPending?e.jsx("i",{className:"fas fa-circle-notch fa-spin text-xs"}):e.jsx("i",{className:"fas fa-trash-alt text-xs"})})})]})},$=()=>{const s=D(),d=M(),x=p.useRef(null),{organizationId:l}=S(),[c,i]=p.useState({categoryName:""}),m=E(c.categoryName,600),{data:a,fetchNextPage:u,hasNextPage:n,isFetchingNextPage:r,isLoading:o,isError:N,error:h,refetch:y}=L(l,m);p.useEffect(()=>{const t=x.current;if(!t)return;const f=()=>{const{scrollTop:v,scrollHeight:w,clientHeight:C}=t;w-v-C<100&&n&&!r&&u()};return t.addEventListener("scroll",f),()=>t.removeEventListener("scroll",f)},[n,r,u]);const b=(a==null?void 0:a.pages.flatMap(t=>t.data))||[];return d.pathname.includes("single")||d.pathname.includes("create")?e.jsx(P,{}):e.jsxs("div",{className:"p-2 space-y-4 h-full relative",children:[e.jsxs("header",{className:"flex justify-between items-center pb-2",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-store mr-3 text-blue-600"}),"Shop Material Documents"]}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm",children:"Manage and organize documents received from various material shops"})]}),e.jsx("div",{className:"flex gap-2 items-center",children:e.jsxs(g,{variant:"primary",onClick:()=>s("create"),children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Add Category"]})})]}),o?e.jsx(k,{}):N?e.jsxs("div",{className:"max-w-xl mx-auto mt-4 p-6 bg-red-50 border border-red-200 rounded-xl text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2 text-xl",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500 mb-4",children:(h==null?void 0:h.message)||"Failed to load shop documents"}),e.jsx(g,{onClick:()=>y(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]}):e.jsxs("main",{className:"flex gap-4 h-[calc(100%-90px)]",children:[e.jsx("div",{className:"xl:w-72 w-64 flex-shrink-0 overflow-y-auto custom-scrollbar",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-5 border border-gray-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),c.categoryName&&e.jsx("button",{onClick:()=>i({categoryName:""}),className:"text-sm text-blue-600 cursor-pointer hover:text-blue-800 font-medium",children:"Clear"})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category Name"}),e.jsx("input",{type:"text",placeholder:"Search by category...",value:c.categoryName,onChange:t=>i({categoryName:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]})})]})}),e.jsx("div",{className:"flex-1 flex flex-col min-w-0",children:b.length===0?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center bg-white rounded-xl border border-gray-200 text-center p-6",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mb-4",children:e.jsx("i",{className:"fas fa-file-pdf text-3xl text-blue-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"No Documents Found"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload your first shop receipt to see it here."})]}):e.jsxs("div",{ref:x,className:"flex-1 bg-white rounded-xl shadow-sm border border-gray-200 overflow-y-auto custom-scrollbar flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white border-b border-blue-200 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-10 gap-4 px-6 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 font-semibold text-gray-700 text-sm uppercase tracking-wider",children:[e.jsx("div",{className:"col-span-1 text-center",children:"#"}),e.jsx("div",{className:"col-span-3",children:"Category / File Name"}),e.jsx("div",{className:"col-span-2 text-center",children:"No of Pdf"}),e.jsx("div",{className:"col-span-2 text-center",children:"Created Date"}),e.jsx("div",{className:"col-span-2 text-center",children:"Action"})]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:b.map((t,f)=>e.jsx(A,{data:t,index:f,onView:()=>s(`single/${t._id}`)},t._id))}),r&&e.jsxs("div",{className:"flex justify-center py-6 bg-gray-50",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-blue-600 mr-2"}),e.jsx("span",{className:"text-sm",children:"Loading more..."})]})]})})]})]})};export{$ as default};
