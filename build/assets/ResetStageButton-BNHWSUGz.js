import{c as g,j as o}from"./index-C2yypHlC.js";import{g as w}from"./roleCheck-ZvNAcsbM.js";import{u as h}from"./useMutation-5BwurMj6.js";import{B as R}from"./Button-tnhURsi3.js";import{t as d}from"./toast-BSC5QTk1.js";const x=async({projectId:t,stageNumber:s,stagePath:a,api:r})=>{const{data:e}=await r.put(`/stage${s}/${a}/${t}`);if(!e.ok)throw new Error(e.message);return e},y=()=>{const{role:t}=g(),s=w(t),a=["staff","owner","CTO"];return h({mutationFn:async({projectId:r,stageNumber:e,stagePath:n})=>{if(!t||!a.includes(t))throw new Error("You are not authorized to reset this stage.");if(!s)throw new Error("API instance not available.");return await x({projectId:r,stageNumber:e,stagePath:n,api:s})}})},A=({projectId:t,stageNumber:s,stagePath:a,buttonClass:r="bg-red-600 text-white",iconClass:e="fas fa-rotate-left",disabled:n=!1,className:m=""})=>{const{mutateAsync:f,isPending:c}=y(),p=async()=>{var l,u;try{await f({projectId:t,stageNumber:s,stagePath:a}),d({description:"Stage Reset successfully",title:"Success"})}catch(i){d({title:"Error",description:((u=(l=i==null?void 0:i.response)==null?void 0:l.data)==null?void 0:u.message)||"Failed to Reset the stage",variant:"destructive"})}};return o.jsx("div",{className:`space-y-1 w-full ${m}`,children:o.jsxs(R,{onClick:p,variant:"danger",disabled:c||n,className:`${r} flex items-center gap-2 !p-2 w-full`,children:[o.jsx("i",{className:e}),o.jsx("span",{children:c?"Resetting...":"Reset Stage"})]})})};export{A as R};
