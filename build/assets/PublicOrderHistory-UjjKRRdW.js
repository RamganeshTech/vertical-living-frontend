import{a as f,r as N,j as e}from"./index-C0KkMjHg.js";import{l as j}from"./orderMaterialHistoryApi-CDtJ9BEw.js";import{N as b}from"./constants-CQazHsZc.js";import"./roleCheck-DWgWWcQZ.js";import"./useQuery-Dp3DvoKb.js";import"./useMutation-CaYNPTtb.js";function A(){var d;const{projectId:o}=f(),{data:r,isLoading:g}=j(o),[l,h]=N.useState(new Set),p=s=>{console.log("Toggling unit:",s,"Current expanded:",Array.from(l));const t=new Set(l);t.has(s)?t.delete(s):t.add(s),h(t)};if(g)return e.jsx("div",{className:"w-full max-w-6xl mx-auto p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-blue-500 text-2xl mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading order details..."})]})});if(!r||!(r!=null&&r.selectedUnits))return e.jsx("div",{className:"w-full max-w-6xl mx-auto p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-yellow-500 text-2xl mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No order data found"})]})});const{selectedUnits:a}=r;return e.jsxs("div",{className:"w-full max-w-6xl mx-auto p-4 space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Order Overview"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[(a==null?void 0:a.length)||0," unit",(a==null?void 0:a.length)!==1?"s":""," • Status:",e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${(r==null?void 0:r.status)==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:r.status})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["₹",((d=r.totalCost)==null?void 0:d.toLocaleString())||0]})]})]})}),e.jsx("div",{className:"space-y-3",children:a==null?void 0:a.map(s=>{var t,i,x,m;return console.log(`Unit ${s.unitName} subItems:`,s.subItems),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 transition-colors duration-200",onClick:()=>p(s._id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden",children:s.image?e.jsx("img",{src:s.image||b,alt:s.unitName||"Unit",className:"w-full h-full object-cover"}):e.jsx("i",{className:"fas fa-cube text-gray-400 text-lg"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.unitName||"Unnamed Unit"}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mt-1",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-tag mr-1"}),s.category]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-hashtag mr-1"}),s.customId||"No ID"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-cubes mr-1"}),"Qty: ",s.quantity]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Unit Cost"}),e.jsxs("p",{className:"text-lg font-semibold text-blue-600",children:["₹",((t=s.singleUnitCost)==null?void 0:t.toLocaleString())||0]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sub Items"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:Array.isArray(s==null?void 0:s.subItems)?(i=s==null?void 0:s.subItems)==null?void 0:i.length:0})]}),e.jsx("div",{className:"ml-4",children:e.jsx("i",{className:`fas fa-chevron-${l.has(s._id)?"up":"down"} text-gray-400 transition-transform duration-200`})})]})]})}),(l==null?void 0:l.has(s._id))&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50",children:Array.isArray(s==null?void 0:s.subItems)&&((x=s==null?void 0:s.subItems)==null?void 0:x.length)>0?e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 mb-3 pb-2 border-b border-gray-300",children:[e.jsx("div",{className:"md:col-span-1 text-xs font-semibold text-gray-700 uppercase tracking-wide",children:"#"}),e.jsxs("div",{className:"md:col-span-5 text-xs font-semibold text-gray-700 uppercase tracking-wide",children:[e.jsx("i",{className:"fas fa-box mr-2"}),"Sub Item Name"]}),e.jsxs("div",{className:"md:col-span-3 text-xs font-semibold text-gray-700 uppercase tracking-wide",children:[e.jsx("i",{className:"fas fa-calculator mr-2"}),"Quantity"]}),e.jsxs("div",{className:"md:col-span-3 text-xs font-semibold text-gray-700 uppercase tracking-wide",children:[e.jsx("i",{className:"fas fa-ruler mr-2"}),"Unit Type"]})]}),e.jsx("div",{className:"space-y-2",children:(m=s==null?void 0:s.subItems)==null?void 0:m.map((c,n)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 py-3 px-2 bg-white rounded-lg border border-gray-200 hover:shadow-sm transition-shadow duration-200",children:[e.jsx("div",{className:"md:col-span-1 flex items-center",children:e.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-medium",children:n+1})}),e.jsx("div",{className:"md:col-span-5 flex items-center",children:e.jsx("div",{children:e.jsx("p",{className:"font-medium text-gray-900",children:c.subItemName||"Unnamed Sub Item"})})}),e.jsx("div",{className:"md:col-span-3 flex items-center",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-sm font-medium",children:c.quantity||0})})}),e.jsx("div",{className:"md:col-span-3 flex items-center",children:e.jsx("span",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium",children:c.unit||"N/A"})})]},c._id||n))})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("i",{className:"fas fa-inbox text-gray-300 text-3xl mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No sub items found for this unit"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Debug: subItems = ",JSON.stringify(s.subItems)]})]})})]},s._id)})}),(!a||(a==null?void 0:a.length)===0)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx("i",{className:"fas fa-clipboard-list text-gray-300 text-4xl mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Units Found"}),e.jsx("p",{className:"text-gray-600",children:"There are no selected units in this order."})]})]})}export{A as default};
