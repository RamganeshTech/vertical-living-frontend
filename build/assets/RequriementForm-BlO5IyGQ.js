import{b as I,r as q,j as e,R as ee,d as se}from"./index-DkfQDeIt.js";import{a as le,b as ne,c as ie,d as re,e as te,f as ae,g as ce,h as oe,i as de,j as ue}from"./requirementFormApi-PwtC0Hct.js";import{c as E}from"./Card-Dx_Z9f0D.js";import{B as k}from"./Button-C-chqFKc.js";import{I as w}from"./Input-lr8I7tVA.js";import{L as a}from"./Label-B6sZwOar.js";import{T as A}from"./TextArea-DdmuMNPl.js";import{S as P,a as L,b as F,c as R,d as t}from"./Select-BS8c4mwJ.js";import{t as g}from"./toast-BSC5QTk1.js";import{A as me,S as he}from"./AssignStaff-DXCssW_O.js";import{R as xe}from"./StageFileUploader-r5sDvoMN.js";import{u as pe}from"./roleCheck-DNL7PxQZ.js";import{R as ge}from"./ResetStageButton-DPKiOhg7.js";import je from"./MaterialOverviewLoading-CgXl-m5l.js";import{u as fe,a as be}from"./documentationApi-BRYSBj0l.js";import"./useQuery-mUmMtORz.js";import"./useMutation-BWlLDX_I.js";import"./getAllUsersApi-CuWWGdu9.js";import"./downloadFile-CKDbPSiN.js";import"./Skeleton-CVtEMTN7.js";const ve=({data:s,setVisibleSection:j})=>{var i,l,r;const{projectId:m}=I(),[n,c]=q.useState({layoutType:(s==null?void 0:s.layoutType)||"L-shaped",measurements:(s==null?void 0:s.measurements)||{top:0,left:0,right:0},kitchenPackage:(s==null?void 0:s.kitchenPackage)||"Essentials",graniteCountertop:(s==null?void 0:s.graniteCountertop)||!1,numberOfShelves:(s==null?void 0:s.numberOfShelves)||0,notes:(s==null?void 0:s.notes)||""}),{mutateAsync:b,isPending:v}=le(),o=u=>{const h=u.target,{name:d,type:p,value:T}=h;let O=T;if(p==="checkbox")O=h.checked;else if(p==="number"){const S=parseFloat(T);O=isNaN(S)?0:Math.max(0,S)}["top","left","right"].includes(d)?c(S=>({...S,measurements:{...S==null?void 0:S.measurements,[d]:O}})):c(S=>({...S,[d]:O}))},x=(u,h)=>{c(d=>({...d,[u]:h}))},y=async()=>{var u,h;try{if(!m)return;await b({projectId:m,updateData:n}),g({title:"Success",description:"Kitchen data updated successfully"})}catch(d){g({title:"Error",description:((h=(u=d==null?void 0:d.response)==null?void 0:u.data)==null?void 0:h.message)||(d==null?void 0:d.message)||"Failed to generate invitation link",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 bg-white rounded-2xl p-6 shadow border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-800",children:"Kitchen Requirements"}),e.jsxs("button",{onClick:()=>j(null),className:"text-blue-500 text-sm underline",children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-1"}),e.jsx("span",{children:"Back"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Layout Type"}),e.jsxs(P,{onValueChange:u=>x("layoutType",u),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select layout",selectedValue:n.layoutType||""})}),e.jsxs(R,{children:[e.jsx(t,{value:"L-shaped",children:"L-shaped"}),e.jsx(t,{value:"Straight",children:"Straight"}),e.jsx(t,{value:"U-shaped",children:"U-shaped"}),e.jsx(t,{value:"Parallel",children:"Parallel"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Kitchen Package"}),e.jsxs(P,{onValueChange:u=>x("kitchenPackage",u),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select package",selectedValue:n.kitchenPackage||""})}),e.jsxs(R,{children:[e.jsx(t,{value:"Essentials",children:"Essentials"}),e.jsx(t,{value:"Premium",children:"Premium"}),e.jsx(t,{value:"Luxury",children:"Luxury"}),e.jsx(t,{value:"Build Your Own Package",children:"Build Your Own Package"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"graniteCountertop",checked:n.graniteCountertop??void 0,onChange:o}),e.jsx(a,{children:"Granite Countertop"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Shelves"}),e.jsx(w,{type:"number",name:"numberOfShelves",value:n.numberOfShelves||"",onChange:o,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Measurement - Top (in feet)"}),e.jsx(w,{type:"number",name:"top",value:((i=n.measurements)==null?void 0:i.top)||"",onChange:o,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Measurement - Left (in feet)"}),e.jsx(w,{type:"number",name:"left",value:((l=n.measurements)==null?void 0:l.left)||"",onChange:o,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Measurement - Right (in feet)"}),e.jsx(w,{type:"number",name:"right",value:((r=n.measurements)==null?void 0:r.right)||"",onChange:o,min:0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{children:"Additional Notes"}),e.jsx(A,{name:"notes",value:n.notes||"",onChange:o,placeholder:"Add any specific requirements or comments",rows:3,className:"w-full"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(k,{onClick:y,isLoading:v,className:"bg-blue-600 text-white w-full md:w-auto",children:"Save Kitchen Requirements"})})]})},we=({data:s,setVisibleSection:j})=>{const{projectId:m}=I(),[n,c]=q.useState({seatingStyle:(s==null?void 0:s.seatingStyle)||"Sofa Set",tvUnitDesignRequired:(s==null?void 0:s.tvUnitDesignRequired)||!1,falseCeilingRequired:(s==null?void 0:s.falseCeilingRequired)||!1,wallDecorStyle:(s==null?void 0:s.wallDecorStyle)||"Paint",numberOfFans:(s==null?void 0:s.numberOfFans)||0,numberOfLights:(s==null?void 0:s.numberOfLights)||0,livingHallPackage:(s==null?void 0:s.livingHallPackage)||"Essentials",notes:(s==null?void 0:s.notes)||""}),{mutateAsync:b,isPending:v}=ne(),o=i=>{const l=i.target,{name:r,type:u,value:h}=l;let d=h;if(u==="checkbox")d=l.checked;else if(u==="number"){const p=parseFloat(h);d=isNaN(p)?0:Math.max(0,p)}c(p=>({...p,[r]:d}))},x=(i,l)=>{c(r=>({...r,[i]:l}))},y=async()=>{var i,l;try{if(!m)return;await b({projectId:m,updateData:n}),g({title:"Success",description:"Living Hall data updated successfully"})}catch(r){g({title:"Error",description:((l=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:l.message)||(r==null?void 0:r.message)||"Failed to generate invitation link",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 bg-white rounded-2xl p-6 shadow border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-800",children:"Living Hall Requirements"}),e.jsxs("button",{onClick:()=>j(null),className:"text-blue-500 text-sm underline",children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-1"}),e.jsx("span",{children:"Back"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Seating Style"}),e.jsxs(P,{onValueChange:i=>x("seatingStyle",i),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select seating style",selectedValue:n.seatingStyle||""})}),e.jsxs(R,{children:[e.jsx(t,{value:"",children:"Select Value"}),e.jsx(t,{value:"Sofa Set",children:"Sofa Set"}),e.jsx(t,{value:"L-Shaped Sofa",children:"L-Shaped Sofa"}),e.jsx(t,{value:"Recliner Chairs",children:"Recliner Chairs"}),e.jsx(t,{value:"Floor Seating",children:"Floor Seating"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Wall Decor Style"}),e.jsxs(P,{onValueChange:i=>x("wallDecorStyle",i),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select wall decor",selectedValue:n.wallDecorStyle||""})}),e.jsxs(R,{children:[e.jsx(t,{value:"",children:"Select Value"}),e.jsx(t,{value:"Paint",children:"Paint"}),e.jsx(t,{value:"Wallpaper",children:"Wallpaper"}),e.jsx(t,{value:"Wood Paneling",children:"Wood Paneling"}),e.jsx(t,{value:"Stone Cladding",children:"Stone Cladding"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Fans"}),e.jsx(w,{type:"number",name:"numberOfFans",value:n.numberOfFans||"",onChange:o,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Lights"}),e.jsx(w,{type:"number",name:"numberOfLights",value:n.numberOfLights||"",onChange:o,min:0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"tvUnitDesignRequired",checked:n.tvUnitDesignRequired||void 0,onChange:o}),e.jsx(a,{children:"TV Unit Design Required"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"falseCeilingRequired",checked:n.falseCeilingRequired||void 0,onChange:o}),e.jsx(a,{children:"False Ceiling Required"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Package"}),e.jsxs(P,{onValueChange:i=>x("livingHallPackage",i),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select package",selectedValue:n.livingHallPackage||""})}),e.jsxs(R,{children:[e.jsx(t,{value:"",children:"Select Value"}),e.jsx(t,{value:"Essentials",children:"Essentials"}),e.jsx(t,{value:"Premium",children:"Premium"}),e.jsx(t,{value:"Luxury",children:"Luxury"}),e.jsx(t,{value:"Build Your Own Package",children:"Build Your Own Package"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{children:"Additional Notes"}),e.jsx(A,{name:"notes",value:n.notes||"",onChange:o,placeholder:"Add any specific requirements or comments",rows:3,className:"w-full"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(k,{onClick:y,isLoading:v,className:"bg-blue-600 text-white w-full md:w-auto",children:"Save Living Hall Requirements"})})]})},ye=({data:s,setVisibleSection:j})=>{const{projectId:m}=I(),[n,c]=q.useState({numberOfBedrooms:(s==null?void 0:s.numberOfBedrooms)||1,bedType:(s==null?void 0:s.bedType)||"Queen",wardrobeIncluded:(s==null?void 0:s.wardrobeIncluded)||!1,falseCeilingRequired:(s==null?void 0:s.falseCeilingRequired)||!1,tvUnitRequired:(s==null?void 0:s.tvUnitRequired)||!1,studyTableRequired:(s==null?void 0:s.studyTableRequired)||!1,bedroomPackage:(s==null?void 0:s.bedroomPackage)||"Essentials",notes:(s==null?void 0:s.notes)||""}),{mutateAsync:b,isPending:v}=ie(),o=i=>{const l=i.target,{name:r,type:u,value:h}=l;let d=h;if(u==="checkbox")d=l.checked;else if(u==="number"){const p=parseFloat(h);d=isNaN(p)?0:Math.max(0,p)}c(p=>({...p,[r]:d}))},x=(i,l)=>{c(r=>({...r,[i]:l}))},y=async()=>{var i,l;try{if(!m)return;await b({projectId:m,updateData:n}),g({title:"Success",description:"bedroom data updated successfully"})}catch(r){g({title:"Error",description:((l=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:l.message)||(r==null?void 0:r.message)||"Failed to generate invitation link",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 bg-white rounded-2xl p-6 shadow border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-800",children:"Bedroom Requirements"}),e.jsxs("button",{onClick:()=>j(null),className:"text-blue-500 text-sm underline",children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-1"}),e.jsx("span",{children:"Back"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Number of Bedrooms"}),e.jsx(w,{type:"number",name:"numberOfBedrooms",value:n.numberOfBedrooms??"",onChange:o,min:1})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Bed Type"}),e.jsxs(P,{onValueChange:i=>x("bedType",i),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select bed type",selectedValue:n.bedType||""})}),e.jsxs(R,{children:[e.jsx(t,{value:"Single",children:"Single"}),e.jsx(t,{value:"Double",children:"Double"}),e.jsx(t,{value:"Queen",children:"Queen"}),e.jsx(t,{value:"King",children:"King"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"wardrobeIncluded",checked:n.wardrobeIncluded??void 0,onChange:o}),e.jsx(a,{children:"Wardrobe Included"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"falseCeilingRequired",checked:n.falseCeilingRequired??void 0,onChange:o}),e.jsx(a,{children:"False Ceiling Required"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"tvUnitRequired",checked:n.tvUnitRequired??void 0,onChange:o}),e.jsx(a,{children:"TV Unit Required"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"studyTableRequired",checked:n.studyTableRequired??void 0,onChange:o}),e.jsx(a,{children:"Study Table Required"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Package"}),e.jsxs(P,{onValueChange:i=>x("bedroomPackage",i),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select package",selectedValue:n.bedroomPackage||""})}),e.jsxs(R,{children:[e.jsx(t,{value:"Essentials",children:"Essentials"}),e.jsx(t,{value:"Premium",children:"Premium"}),e.jsx(t,{value:"Luxury",children:"Luxury"}),e.jsx(t,{value:"Build Your Own Package",children:"Build Your Own Package"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{children:"Additional Notes"}),e.jsx(A,{name:"notes",value:n.notes||"",onChange:o,placeholder:"Add any specific requirements or comments",rows:3,className:"w-full"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(k,{onClick:y,isLoading:v,className:"bg-blue-600 text-white w-full md:w-auto",children:"Save Bedroom Requirements"})})]})},Ne=({data:s,setVisibleSection:j})=>{const{projectId:m}=I(),[n,c]=q.useState({wardrobeType:(s==null?void 0:s.wardrobeType)||"Sliding",lengthInFeet:(s==null?void 0:s.lengthInFeet)||0,heightInFeet:(s==null?void 0:s.heightInFeet)||0,mirrorIncluded:(s==null?void 0:s.mirrorIncluded)||!1,wardrobePackage:(s==null?void 0:s.wardrobePackage)||"Essentials",numberOfShelves:(s==null?void 0:s.numberOfShelves)||0,numberOfDrawers:(s==null?void 0:s.numberOfDrawers)||0,notes:(s==null?void 0:s.notes)||""}),{mutateAsync:b,isPending:v}=re(),o=i=>{const l=i.target,{name:r,type:u,value:h}=l;let d=h;if(u==="checkbox")d=l.checked;else if(u==="number"){const p=parseFloat(h);d=isNaN(p)?0:Math.max(0,p)}c(p=>({...p,[r]:d}))},x=(i,l)=>{c(r=>({...r,[i]:l}))},y=async()=>{var i,l;try{if(!m)return;await b({projectId:m,updateData:n}),g({title:"Success",description:"Wardrobe data updated successfully"})}catch(r){g({title:"Error",description:((l=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:l.message)||(r==null?void 0:r.message)||"Failed to generate invitation link",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 bg-white rounded-2xl p-6 shadow border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-800",children:"Wardrobe Requirements"}),e.jsxs("button",{onClick:()=>j(null),className:"text-blue-500 text-sm underline",children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-1"}),e.jsx("span",{children:"Back"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Wardrobe Type"}),e.jsxs(P,{onValueChange:i=>x("wardrobeType",i),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select wardrobe type",selectedValue:n.wardrobeType||""})}),e.jsxs(R,{children:[e.jsx(t,{value:"Sliding",children:"Sliding"}),e.jsx(t,{value:"Openable",children:"Openable"})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Length (in feet)"}),e.jsx(w,{type:"number",name:"lengthInFeet",value:n.lengthInFeet||0,onChange:o,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Height (in feet)"}),e.jsx(w,{type:"number",name:"heightInFeet",value:n.heightInFeet||0,onChange:o,min:0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"mirrorIncluded",checked:n.mirrorIncluded??void 0,onChange:o}),e.jsx(a,{children:"Mirror Included"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Shelves"}),e.jsx(w,{type:"number",name:"numberOfShelves",value:n.numberOfShelves||"",onChange:o,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Number of Drawers"}),e.jsx(w,{type:"number",name:"numberOfDrawers",value:n.numberOfDrawers||"",onChange:o,min:0})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Package"}),e.jsxs(P,{onValueChange:i=>x("wardrobePackage",i),children:[e.jsx(L,{children:e.jsx(F,{placeholder:"Select package",selectedValue:n.wardrobePackage||""})}),e.jsxs(R,{children:[e.jsx(t,{value:"Essentials",children:"Essentials"}),e.jsx(t,{value:"Premium",children:"Premium"}),e.jsx(t,{value:"Luxury",children:"Luxury"}),e.jsx(t,{value:"Build Your Own Package",children:"Build Your Own Package"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{children:"Additional Notes"}),e.jsx(A,{name:"notes",value:n.notes||"",onChange:o,placeholder:"Add any specific requirements or comments",rows:3,className:"w-full"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(k,{onClick:y,isLoading:v,className:"bg-blue-600 text-white w-full md:w-auto",children:"Save Wardrobe Requirements"})})]})},ke=({client:s})=>e.jsxs(E,{className:"p-4 bg-white shadow border-l-4 border-blue-500",children:[e.jsxs("h2",{className:"text-lg font-semibold text-blue-700 mb-4",children:[e.jsx("i",{className:"fa-solid fa-user-tie mr-2"})," Client Info"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx(V,{label:"Name",value:s==null?void 0:s.clientName,icon:"fa-user"}),e.jsx(V,{label:"Email",value:s==null?void 0:s.email,icon:"fa-envelope"}),e.jsx(V,{label:"WhatsApp",value:s==null?void 0:s.whatsapp,icon:"fa-phone"}),e.jsx(V,{label:"Location",value:s==null?void 0:s.location,icon:"fa-location-dot"})]})]}),V=({label:s,value:j,icon:m})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`fa-solid ${m} text-gray-600`}),e.jsxs("strong",{children:[s,":"]})," ",j||"No data"]}),Se=q.memo(ke),Ce=({sections:s,setVisibleSection:j})=>e.jsx("section",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:s.map(({key:m,label:n,icon:c})=>e.jsx("div",{className:"bg-white border-l-4 border-blue-600 rounded-xl shadow-md hover:shadow-lg transition cursor-pointer group",onClick:()=>j(m),children:e.jsxs("div",{className:"flex items-center justify-between p-5 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 text-blue-600 p-3 rounded-full text-xl",children:e.jsx("i",{className:c})}),e.jsx("span",{className:"text-sm font-medium text-gray-800 group-hover:text-blue-700",children:n})]}),e.jsx("i",{className:"fa-solid fa-chevron-right text-blue-400 group-hover:text-blue-600"})]})},m))}),Pe=ee.memo(Ce),Le=({projectId:s,stageNumber:j,isStageCompleted:m,className:n=""})=>{const{data:c,isLoading:b}=fe(s),{data:v,isLoading:o}=be({projectId:s,stageNumber:j}),x=c!=null&&c.phoneNo.startsWith("+91")?c==null?void 0:c.phoneNo:`+91${c==null?void 0:c.phoneNo}`,y=`Hello ${c==null?void 0:c.clientName},

${v==null?void 0:v.message}`,i=`https://wa.me/${x.replace("+","")}?text=${encodeURIComponent(y)}`,l=()=>c!=null&&c.phoneNo?m!=="completed"?"complete the stage":"":"client's phone number not provided";return e.jsxs(k,{variant:"outline",disabled:b||o||m!=="completed",title:l(),className:`bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded items-center ${n}`,children:[e.jsx("i",{className:"fab fa-whatsapp mr-1 "}),e.jsx("a",{href:i,target:"_blank",rel:"noopener noreferrer",children:"Share via WhatsApp"})]})},G=[{Component:ye,icon:"fa-solid fa-bed",label:"Bedroom Section",key:"bedroom"},{Component:ve,icon:"fa-solid fa-kitchen-set",label:"Kitchen Section",key:"kitchen"},{Component:we,icon:"fa-solid fa-house",label:"Living Hall Section",key:"livingHall"},{Component:Ne,icon:"fa-solid fa-shirt",label:"Wardrobe Section",key:"wardrobe"}];function ze(){var B,M,W,H,$;const{projectId:s,organizationId:j}=I(),{role:m}=pe(),{isMobile:n,openMobileSidebar:c}=se(),[b,v]=q.useState(""),[o,x]=q.useState(!1),[y,i]=q.useState(null),{data:l,isLoading:r,error:u,refetch:h}=te({projectId:s}),{mutateAsync:d,isPending:p}=ae(),{mutateAsync:T,isPending:O}=ce(),{mutateAsync:S,isPending:K}=oe(),{mutateAsync:Y,isPending:_}=de(),{mutateAsync:Q,isPending:z}=ue();if(r)return e.jsx(je,{});const D=async()=>{var N,f;if(window.confirm("Are you sure want to mark it as completed?"))try{O||(await T({formId:l._id,projectId:s}),g({title:"Success",description:"completion updated successfully"}))}catch(C){g({title:"Error",description:((f=(N=C==null?void 0:C.response)==null?void 0:N.data)==null?void 0:f.message)||"Failed to update to complete the form",variant:"destructive"})}},J=async N=>{try{const f=["owner","staff","CTO"];if(!m)throw new Error("Not Authorized");if(!f.includes(m))throw new Error("Dont have the access");await navigator.clipboard.writeText(N),x(!0),g({title:"Success",description:"Link copied to clipboard"}),setTimeout(()=>x(!1),4e3)}catch(f){g({title:"Error",description:f.message||"Failed to copy link",variant:"destructive"})}},X=async()=>{var N,f;try{const C=await d({projectId:s});v(C.inviteLink||C),g({title:"Success",description:"Invitation link generated successfully"})}catch(C){g({title:"Error",description:((f=(N=C==null?void 0:C.response)==null?void 0:N.data)==null?void 0:f.message)||C.message||"Failed to generate invitation link",variant:"destructive"})}},U=async()=>{try{await navigator.clipboard.writeText(b),x(!0),g({title:"Success",description:"Link copied to clipboard"}),setTimeout(()=>x(!1),2e3)}catch{g({title:"Error",description:"Failed to copy link",variant:"destructive"})}},Z=()=>{const N=`You're requested to fill the form, Click this link to fill the form: ${b}`,f=`https://wa.me/?text=${encodeURIComponent(N)}`;window.open(f,"_blank")};return e.jsx("div",{className:"h-full w-full overflow-y-auto ",children:y?e.jsx("div",{className:"min-h-screen",children:G.map(({Component:N,key:f})=>y===f&&e.jsx("div",{className:"pt-6",children:e.jsx(N,{data:l==null?void 0:l[f],isEditable:l==null?void 0:l.isEditable,setVisibleSection:i})},f))}):e.jsxs("div",{className:"h-full w-full space-y-4",children:[e.jsxs("div",{className:"flex flex-col w-full sm:flex-row justify-between sm:items-center items-start gap-4",children:[e.jsx("div",{className:"",children:e.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-blue-600 flex items-center",children:[n&&e.jsx("button",{onClick:c,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})})," ",e.jsx("i",{className:"fa-solid fa-pencil mr-2"})," Client Requirement"]})}),e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2  !w-[100%] sm:!w-[50%] justify-end lg:justify-end",children:[e.jsxs(k,{isLoading:O,onClick:D,className:"bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-circle-check mr-2"}),"Mark as Complete"]}),e.jsx(ge,{projectId:s,stageNumber:1,stagePath:"requirementform",className:"sm:!max-w-[20%] w-full"}),e.jsx(Le,{projectId:s,stageNumber:"1",className:"w-full sm:w-fit",isStageCompleted:l.status}),e.jsx(me,{stageName:"RequirementFormModel",projectId:s,organizationId:j,currentAssignedStaff:(l==null?void 0:l.assignedTo)||null,className:"w-full sm:w-auto"})]})]}),u&&e.jsxs("div",{className:"max-w-xl sm:min-w-[80%]  mx-auto mt-4 p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2 text-xl sm:text-3xl",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500  mb-4 text-lg sm:text-xl",children:((M=(B=u==null?void 0:u.response)==null?void 0:B.data)==null?void 0:M.message)||"Failed to load data"}),e.jsx(k,{onClick:()=>h(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]}),!u&&e.jsxs("main",{className:"h-[calc(100vh-90px)] overflow-y-auto custom-scrollbar space-y-6",children:[e.jsxs(E,{className:"p-4 w-full shadow border-l-4 border-blue-600 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-700 text-sm font-medium mb-2",children:[e.jsx("i",{className:"fa-solid fa-clock text-blue-500 text-lg"}),e.jsx("span",{children:"Stage Timings"})]}),e.jsx(he,{startedAt:(W=l==null?void 0:l.timer)==null?void 0:W.startedAt,projectId:s,stageName:"requirementform",refetchStageMutate:h,completedAt:(H=l==null?void 0:l.timer)==null?void 0:H.completedAt,deadLine:($=l==null?void 0:l.timer)==null?void 0:$.deadLine,formId:l==null?void 0:l._id,deadLineMutate:S,isPending:K})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx(Se,{client:l==null?void 0:l.clientData}),e.jsx(E,{className:"p-4 shadow border-l-4 border-blue-500 bg-white",children:e.jsx(xe,{formId:l==null?void 0:l._id,existingUploads:l==null?void 0:l.uploads,onUploadComplete:h,uploadFilesMutate:Y,uploadPending:_,projectId:s,refetch:h,onDeleteUpload:Q,deleteFilePending:z})})]}),e.jsx(Pe,{sections:G,setVisibleSection:i}),e.jsx("div",{className:"pb-6",children:l!=null&&l.shareToken?e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{children:"Form Link"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[e.jsx(w,{value:l==null?void 0:l.shareToken,readOnly:!0,className:"bg-blue-50 text-blue-800 flex-1"}),e.jsx(k,{onClick:()=>J(l==null?void 0:l.shareToken),className:"w-full sm:w-auto",children:e.jsx("i",{className:`fas ${o?"fa-check":"fa-copy"}`})})]})]}):e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-2xl shadow-lg space-y-4",children:[e.jsxs("h2",{className:"text-lg sm:text-xl font-bold text-blue-900 flex items-center",children:[e.jsx("i",{className:"fas fa-link mr-2"})," Generate Form Link"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Request to fill the form by generating a link."}),b?e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{children:"Form Link"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[e.jsx(w,{value:b,readOnly:!0,className:"bg-blue-50 text-blue-800 flex-1"}),e.jsx(k,{onClick:U,className:"w-full sm:w-auto",children:e.jsx("i",{className:`fas ${o?"fa-check":"fa-copy"}`})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(k,{onClick:Z,className:"w-full sm:w-auto bg-green-600 text-white",children:[e.jsx("i",{className:"fab fa-whatsapp mr-2"})," Share on WhatsApp"]}),e.jsxs(k,{onClick:U,className:"w-full sm:w-auto border border-blue-400 text-blue-700",children:[e.jsx("i",{className:"fas fa-copy mr-2"})," Copy"]})]})]}):e.jsxs(k,{onClick:X,isLoading:p,className:"w-full bg-blue-600 text-white py-2.5 sm:py-3",children:[e.jsx("i",{className:"fas fa-link mr-2"})," Generate Form Link"]})]})})]})]})})}export{ze as default};
