import{c as Ke,F as Qe,d as Je,r as y,e as Ye,j as e,O as Ze,M as Xe,B as x,A as N,I as es,C as ss,f as ts,t as n,h as oe}from"./index-CBsAK0nv.js";import{g as as,h as rs,i as ls,a as ns,j as is,k as cs,l as os,m as ds,n as ms,o as us,p as xs,b as hs}from"./commonOrderHistoryMaterialApi-uwpl6THY.js";import{ORDERMATERIAL_UNIT_OPTIONS as de}from"./OrderMaterialOverview-DPfqeiU4.js";import"./AssignStaff-sIZdITJf.js";import"./ResetStageButton-B7sMo0Hh.js";import"./ShareDocumentWhatsapp-B5KdABdk.js";import"./documentationApi-D-dHEfnd.js";import"./requirementFormApi-Kwdfn7sN.js";import"./orderMaterialHistoryApi-Tv_wZzhK.js";import"./shopLibDetailApi-7Q-KTTTk.js";import"./StageGuide-DK1G5Ici.js";const Os=()=>{var B,R,W,$,F,V,H,K,Q,J,Y,Z,X,ee,se,te,ae,re,le,ne,ie,ce;const{id:m,organizationId:q}=Ke(),{openMobileSidebar:me,isMobile:ue}=Qe(),U=Je(),[xe,k]=y.useState(!1),[i,w]=y.useState({}),[he,O]=y.useState(!1),[o,S]=y.useState({}),[c,p]=y.useState(null),[d,P]=y.useState({name:"",quantity:1,unit:""}),I=y.useRef(null),{data:a,isLoading:z,error:E,refetch:j,isError:A}=as(m),{mutateAsync:pe,isPending:ge}=rs(),{mutateAsync:be,isPending:fe}=ls(),{mutateAsync:Ne,isPending:ve}=ns(),{mutateAsync:ye,isPending:je}=is(),{mutateAsync:we}=cs(),{mutateAsync:Se,isPending:G}=os(),{mutateAsync:Ie}=ds(),{mutateAsync:Ce,isPending:D}=ms(),Pe=us(),{mutateAsync:ke,isPending:Oe}=xs(),{mutateAsync:Ee,isPending:Ae}=hs(),{role:L,permission:g}=Ye(),_=L==="owner"||((B=g==null?void 0:g.commonorder)==null?void 0:B.delete),v=L==="owner"||((R=g==null?void 0:g.commonorder)==null?void 0:R.create),b=L==="owner"||((W=g==null?void 0:g.commonorder)==null?void 0:W.edit),De=async()=>{var s,t;try{if(i!=null&&i.phoneNumber&&!/^\d{10}$/.test(i==null?void 0:i.phoneNumber.trim()))throw new Error("Phone number should contain exactly 10 digit numbers");await pe({id:m,updates:i}),k(!1),n({title:"Success",description:"Delivery Details Updated"}),j()}catch(r){n({variant:"destructive",title:"Error",description:((t=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Update failed"})}},Le=async()=>{var s,t;try{if(o.phoneNumber&&!/^\d{10}$/.test(o.phoneNumber.trim()))throw new Error("Phone number should contain exactly 10 digit numbers");await be({id:m,updates:o}),n({title:"Success",description:"Shop Details Updated"}),O(!1),j()}catch(r){n({variant:"destructive",title:"Error",description:((t=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Update failed"})}},_e=async s=>{var t,r;try{const l=s.target.files;if(!l||l.length===0)return;const u=Array.from(l).filter(h=>h.type.startsWith("image/"));if(u.length!==l.length){n({title:"Invalid file type",description:"Only images are allowed (JPG, PNG, etc.)",variant:"destructive"});return}await Ce({files:u,id:m}),n({description:"Successfully uploaded images",title:"Success"})}catch(l){n({title:"Error",description:((r=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:r.message)||l.message||"Failed to upload images",variant:"destructive"})}},Me=async s=>{var t,r;try{await Pe.mutateAsync({id:m,imageId:s}),j==null||j(),n({title:"Success",description:"deleted successfully"})}catch(l){n({title:"Error",description:((r=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:r.message)||"failed to delete",variant:"destructive"})}},qe=async()=>{var s,t;try{if(!window.confirm("Are you sure need to perform this operation?"))return;await ke({id:m}),n({description:"All Sub Items successfully",title:"Success"})}catch(r){n({title:"Error",description:((t=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:t.message)||r.message||"Failed to delete sub items",variant:"destructive"})}},C=async(s,t,r)=>{var l,u,h;try{const f=(l=a.currentOrder.subItems)==null?void 0:l.find(He=>He._id===s);if(!f)return;const Ve={id:m,subItemId:s,subItemName:t==="name"?r:f.subItemName,quantity:t==="quantity"?Number(r)?Number(r):1:f.quantity,unit:t==="unit"?r:f.unit};await Ie(Ve),n({title:"Success",description:"Item updated successfully"})}catch(f){console.log("filed",f),n({title:"Error",description:((h=(u=f==null?void 0:f.response)==null?void 0:u.data)==null?void 0:h.message)||"Failed to update item",variant:"destructive"})}},M=async s=>{var r,l;if(!b&&!v)return;const t=s;if(!t&&!(t!=null&&t.name.trim()))return n({title:"Error",description:"Material Name is mandatory",variant:"destructive"});try{await we({id:m,subItemName:t.name,quantity:t.quantity??1,unit:t.unit}),P({name:"",quantity:1,unit:""}),n({title:"Success",description:"Item created successfully"})}catch(u){n({title:"Error",description:((l=(r=u==null?void 0:u.response)==null?void 0:r.data)==null?void 0:l.message)||"Failed to create item",variant:"destructive"})}},Ue=async s=>{var t,r;try{await Se({id:m,subItemId:s}),n({title:"Success",description:"Item deleted successfully"})}catch(l){n({title:"Error",description:((r=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to delete item",variant:"destructive"})}},ze=async s=>{var t,r;try{const l=await Ne({id:m,organizationId:q,orderItemId:s});await oe({src:l==null?void 0:l.pdfUrl,alt:"Order Material"}),n({title:"Success",description:"Pdf Generated successfully"}),j()}catch(l){n({title:"Error",description:((r=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:r.message)||(l==null?void 0:l.message)||"Failed to generate link",variant:"destructive"})}},Ge=async s=>{var t,r,l,u;try{await oe({src:(t=s==null?void 0:s.pdfLink)==null?void 0:t.url,alt:(r=s==null?void 0:s.pdfLink)==null?void 0:r.pdfName}),n({title:"Success",description:"PDF Downloaded successfully"})}catch(h){n({title:"Error",description:((u=(l=h==null?void 0:h.response)==null?void 0:l.data)==null?void 0:u.message)||(h==null?void 0:h.message)||"Failed to generate PDF",variant:"destructive"})}},Te=async()=>{var s,t;try{await ye({id:m}),n({description:"All Sub Items successfully",title:"Success"})}catch(r){n({title:"Error",description:((t=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:t.message)||r.message||"Failed to delete sub items",variant:"destructive"})}},Be=async s=>{var t,r;try{await Ee({id:m,orderItemId:s,organizationId:q}),n({description:"Sent to Procurement",title:"Success"})}catch(l){n({title:"Error",description:((r=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:r.message)||l.message||"Failed to update completion status",variant:"destructive"})}};y.useEffect(()=>{c&&I.current&&(I.current.focus(),I.current.select())},[c]);const Re=m==null?void 0:m.replace(/[^a-zA-Z0-9]/g,"").slice(-3).toLowerCase(),We=new Date().getFullYear(),T=(((F=($=a==null?void 0:a.orderedItems)==null?void 0:$.map(s=>s==null?void 0:s.orderMaterialNumber))==null?void 0:F.filter(Boolean))||[]).map(s=>{const t=s.split("-").pop();return parseInt(t,10)||0}),$e=((T.length?Math.max(...T):0)+1).toString().padStart(3,"0"),Fe=((V=a==null?void 0:a.currentOrder)==null?void 0:V.orderMaterialNumber)||`ORD-${Re}-${We}-${$e}`||null;return location.pathname.includes("singleorder")?e.jsx(Ze,{}):z?e.jsx(Xe,{}):e.jsxs("div",{className:"max-w-full max-h-full overflow-y-auto mx-auto p-2 space-y-6",children:[e.jsxs("div",{className:"flex-shrink-0 flex justify-between sm:flex-row   items-start sm:items-center mb-4 gap-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{onClick:()=>U(-1),className:"bg-blue-50 hover:bg-slate-300 flex items-center justify-between w-8 h-8 border border-[#a6aab8] text-sm cursor-pointer rounded-md px-2",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsx("h1",{className:"md:!text-2xl text-base sm:text-3xl font-bold text-blue-600",children:(a==null?void 0:a.projectName)||"N/A"})]}),ue&&e.jsx("button",{onClick:me,className:"mr-3 p-2 rounded-md border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars"})})]}),A&&e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-xl p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500 text-sm mb-4",children:((K=(H=E==null?void 0:E.response)==null?void 0:H.data)==null?void 0:K.message)||"Failed to load ordering material"}),e.jsx(x,{isLoading:z,onClick:()=>j(),className:"bg-red-600 text-white hover:bg-red-700",children:"Retry"})]})}),!A&&e.jsxs("section",{className:"bg-white rounded-3xl shadow-[0_10px_40px_-15px_rgba(0,0,0,0.1)] overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full mb-3",children:[e.jsxs("div",{className:"border-l-4 flex-1 border-blue-600 rounded-lg p-4 shadow-sm relative bg-white",children:[e.jsxs("h2",{className:"text-base sm:text-lg font-bold mb-3 text-blue-700 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-store"}),"Shop Details"]}),he?e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{placeholder:"Shop Name",value:(o==null?void 0:o.shopName)||"",onChange:s=>S({...o,shopName:s.target.value}),className:"w-full"}),e.jsx(N,{placeholder:"Contact Person",value:(o==null?void 0:o.contactPerson)||"",onChange:s=>S({...o,contactPerson:s.target.value}),className:"w-full"}),e.jsx(N,{placeholder:"Phone Number",value:(o==null?void 0:o.phoneNumber)||"",type:"tel",maxLength:10,onChange:s=>S({...o,phoneNumber:s.target.value}),className:"w-full"}),e.jsx(N,{placeholder:"Address",value:(o==null?void 0:o.address)||"",onChange:s=>S({...o,address:s.target.value}),className:"w-full"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-3",children:[e.jsxs(x,{onClick:Le,isLoading:fe,className:"w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-save mr-2"}),"Save"]}),e.jsxs(x,{variant:"outline",onClick:()=>O(!1),className:"w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-times mr-2"}),"Cancel"]})]})]}):e.jsxs("div",{className:"space-y-2 text-sm sm:text-base",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Shop Name:"})," ",((Q=a==null?void 0:a.shopDetails)==null?void 0:Q.shopName)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact Person:"})," ",((J=a==null?void 0:a.shopDetails)==null?void 0:J.contactPerson)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",((Y=a==null?void 0:a.shopDetails)==null?void 0:Y.phoneNumber)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((Z=a==null?void 0:a.shopDetails)==null?void 0:Z.address)||"-"]}),b&&e.jsxs("button",{onClick:()=>{S(a==null?void 0:a.shopDetails),O(!0)},className:"absolute top-3 right-4 text-blue-600 text-xs sm:text-sm underline hover:text-blue-800",children:[e.jsx("i",{className:"fa-solid fa-edit mr-1"}),"Edit"]})]})]}),e.jsxs("div",{className:"border-l-4 flex-1 mt-4 border-blue-600 rounded-lg p-4 shadow-sm relative bg-white",children:[e.jsxs("h2",{className:"text-base sm:text-lg font-bold mb-3 text-blue-700 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-truck"}),"Delivery Location"]}),xe?e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{placeholder:"Site Name",value:(i==null?void 0:i.siteName)||"",onChange:s=>w({...i,siteName:s.target.value}),className:"w-full"}),e.jsx(N,{placeholder:"Site Supervisor",value:(i==null?void 0:i.siteSupervisor)||"",onChange:s=>w({...i,siteSupervisor:s.target.value}),className:"w-full"}),e.jsx(N,{placeholder:"Phone Number",type:"tel",maxLength:10,value:(i==null?void 0:i.phoneNumber)||"",onChange:s=>w({...i,phoneNumber:s.target.value}),className:"w-full"}),e.jsx(N,{placeholder:"Address",value:(i==null?void 0:i.address)||"",onChange:s=>w({...i,address:s.target.value}),className:"w-full"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-3",children:[e.jsxs(x,{onClick:De,isLoading:ge,className:"w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-save mr-2"}),"Save"]}),e.jsxs(x,{variant:"outline",onClick:()=>k(!1),className:"w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-times mr-2"}),"Cancel"]})]})]}):e.jsxs("div",{className:"space-y-2 text-sm sm:text-base",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Site Name:"})," ",((X=a==null?void 0:a.deliveryLocationDetails)==null?void 0:X.siteName)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Supervisor:"})," ",((ee=a==null?void 0:a.deliveryLocationDetails)==null?void 0:ee.siteSupervisor)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",((se=a==null?void 0:a.deliveryLocationDetails)==null?void 0:se.phoneNumber)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((te=a==null?void 0:a.deliveryLocationDetails)==null?void 0:te.address)||"-"]}),b&&e.jsxs("button",{onClick:()=>{w(a==null?void 0:a.deliveryLocationDetails),k(!0)},className:"absolute top-3 right-4 text-blue-600 text-xs sm:text-sm underline hover:text-blue-800",children:[e.jsx("i",{className:"fa-solid fa-edit mr-1"}),"Edit"]})]})]})]}),e.jsx("section",{className:"w-full",children:e.jsxs("section",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 border-b pb-2 flex items-center",children:[e.jsx("i",{className:"fas fa-folder-open mr-2 text-blue-500"})," Images"]}),e.jsxs("div",{className:"flex items-center justify-between w-full relative",children:[(b||v)&&e.jsx(N,{type:"file",multiple:!0,accept:"image/*",placeholder:"select files",onChange:_e,disabled:D,className:D?"pr-10 opacity-70 cursor-not-allowed w-full mb-4":"mb-4"}),D&&e.jsx("div",{className:"absolute inset-y-0 right-2 flex items-center",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3.5-3.5L12 0v4a8 8 0 100 16v4l3.5-3.5L12 20v-4a8 8 0 01-8-8z"})]})})]}),e.jsx("div",{className:"mb-6",children:((ae=a==null?void 0:a.images)==null?void 0:ae.length)>0?e.jsx(es,{..._?{handleDeleteFile:s=>Me(s)}:{},imageFiles:a==null?void 0:a.images,height:150,minWidth:150,maxWidth:200}):e.jsx("div",{className:"text-gray-500 text-sm italic bg-gray-50 p-8 rounded-lg text-center border-2 border-dashed border-gray-200",children:"No Images uploaded yet."})})]})}),e.jsxs("div",{className:"mt-6 pt-4 border-t-2 border-blue-200 bg-gradient-to-r from-white to-white rounded-lg p-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between pb-4 border-b-2 border-blue-600",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-blue-50",children:e.jsx("i",{className:"fa-solid fa-list text-blue-600"})}),e.jsx("h4",{className:"font-bold text-gray-900 text-2xl tracking-tight",children:"Create Material Order"})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-10",children:[e.jsx("span",{className:"flex items-center gap-1 text-[10px] font-bold uppercase tracking-wider text-blue-600 bg-blue-50 px-2 py-0.5 rounded",children:"Instruction"}),e.jsxs("p",{className:"text-xs text-gray-500 italic",children:["Click cells to edit • Press ",e.jsx("span",{className:"font-bold text-gray-700",children:"Enter"})," to save"]})]})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsxs("div",{className:"flex items-center self-stretch bg-white rounded-lg border border-gray-200 px-3 py-1 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col leading-none border-r border-gray-200 pr-3 mr-3",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Order ID"}),e.jsx("span",{className:"text-sm font-mono font-black text-blue-700 mt-0.5",children:Fe})]}),e.jsx("div",{className:"flex items-center gap-1.5",children:_&&e.jsxs(x,{variant:"danger",size:"sm",className:"h-8 text-xs px-3 bg-red-600 text-white shadow-none",isLoading:Oe,onClick:qe,children:[e.jsx("i",{className:"fas fa-trash mr-2"}),"Delete All"]})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border-2 border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-17 gap-0 bg-gradient-to-r from-blue-100 to-blue-100 border-b-2 border-blue-200",children:[e.jsx("div",{className:"col-span-3 px-4 py-3 text-sm font-medium text-gray-700 border-r border-gray-200",children:"Ref ID"}),e.jsx("div",{className:"col-span-8 px-4 py-3 text-sm font-medium text-gray-700 border-r border-gray-200",children:"Material Name"}),e.jsx("div",{className:"col-span-2 px-4 py-3 text-sm font-medium text-gray-700 border-r border-gray-200",children:"Quantity"}),e.jsx("div",{className:"col-span-3 px-4 py-3 text-sm font-medium text-gray-700 border-r border-gray-200",children:"Unit"}),e.jsx("div",{className:"col-span-1 px-4 py-3 text-sm font-medium text-gray-700",children:"Action"})]}),a.currentOrder.subItems&&((re=a.currentOrder)==null?void 0:re.subItems.length)>0&&a.currentOrder.subItems.map(s=>e.jsxs("div",{className:"grid grid-cols-17 gap-0 border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("div",{className:"col-span-3 border-r border-blue-200",children:e.jsx("div",{className:"w-full px-4 py-3 border-none outline-none focus:bg-blue-50",children:(s==null?void 0:s.refId)||"N/A"})}),e.jsx("div",{className:"col-span-8 border-r border-blue-200",children:(c==null?void 0:c.subItemId)===s._id&&(c==null?void 0:c.field)==="name"?e.jsx("input",{ref:I,type:"text",defaultValue:s.subItemName,className:"w-full px-4 py-3 border-none outline-none focus:bg-blue-50",onBlur:t=>{C(s._id,"name",t.target.value),p(null)},onKeyDown:t=>{if(t.key==="Enter"){const r=t.target.value;C(s._id,"name",r),p(null)}t.key==="Escape"&&p(null)}}):e.jsx("div",{className:"px-4 py-3 cursor-pointer hover:bg-blue-50 transition-colors",onClick:()=>{(v||b)&&p({subItemId:s._id,field:"name"})},children:s.subItemName})}),e.jsx("div",{className:"col-span-2 border-r border-blue-200",children:(c==null?void 0:c.subItemId)===s._id&&(c==null?void 0:c.field)==="quantity"?e.jsx("input",{ref:I,type:"number",defaultValue:s.quantity,min:"0",className:"w-full px-4 py-3 border-none outline-none focus:bg-blue-50",onBlur:t=>{C(s._id,"quantity",t.target.value),p(null)},onKeyDown:t=>{t.key==="Enter"&&(C(s._id,"quantity",t.currentTarget.value),p(null)),t.key==="Escape"&&p(null)}}):e.jsx("div",{className:"px-4 py-3 cursor-pointer hover:bg-blue-50 transition-colors",onClick:()=>{(v||b)&&p({subItemId:s._id,field:"quantity"})},children:s.quantity})}),e.jsx("div",{className:"col-span-3 border-r border-blue-200",children:(c==null?void 0:c.subItemId)===s._id&&(c==null?void 0:c.field)==="unit"?e.jsx("div",{className:"p-2 relative z-50",children:e.jsxs("select",{defaultValue:s.unit,onChange:t=>{C(s._id,"unit",t.target.value),p(null)},className:"w-full relative z-[50] px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Selected unit"}),de.map(t=>e.jsx("option",{value:t,children:t},t))]})}):e.jsx("div",{className:"px-4 py-3 cursor-pointer hover:bg-blue-50 transition-colors",onClick:()=>{(v||b)&&p({subItemId:s._id,field:"unit"})},children:s.unit})}),_&&e.jsx("div",{className:"col-span-1 flex items-center justify-center",children:e.jsx(x,{variant:"danger",onClick:()=>Ue(s._id),disabled:G,isLoading:G,className:"p-2 bg-red-600 text-white  hover:bg-red-50 rounded transition-colors disabled:opacity-50",title:"Delete item",children:e.jsx("i",{className:"fa fa-trash text-sm"})})})]},s._id)),e.jsxs("div",{className:"grid grid-cols-17 gap-0 bg-green-50 border-b border-gray-100",children:[e.jsx("div",{className:"col-span-3 border-r border-gray-200",children:e.jsx("div",{className:"w-full px-4 py-3 border-none outline-none focus:bg-blue-50",children:"Ref Id"})}),e.jsx("div",{className:"col-span-8 border-r border-gray-200",children:e.jsx("input",{type:"text",placeholder:"Enter matterial name...",value:(d==null?void 0:d.name)||"",onChange:s=>{P(t=>({...t,name:s.target.value}))},onBlur:()=>{var s;(s=d==null?void 0:d.name)!=null&&s.trim()&&d.quantity&&d.unit&&M(d)},onKeyDown:s=>{s.key==="Enter"&&M(d)},className:"w-full px-4 py-3 bg-transparent border-none outline-none placeholder-gray-400"})}),e.jsx("div",{className:"col-span-2 border-r border-gray-200",children:e.jsx("input",{type:"number",placeholder:"Qty",min:"0",value:(d==null?void 0:d.quantity)||1,onChange:s=>{P(t=>({...t,quantity:Number(s.target.value)||1}))},className:"w-full px-4 py-3 bg-transparent border-none outline-none placeholder-gray-400"})}),e.jsx("div",{className:"col-span-3 border-r border-gray-200",children:e.jsx("div",{className:"p-2",children:e.jsxs("select",{value:(d==null?void 0:d.unit)||"",onChange:async s=>{const t={...d,unit:s.target.value};P(r=>({...r,unit:s.target.value})),await M(t)},className:"w-full relative z-[50] px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-sm",children:[e.jsx("option",{value:"",children:"Selected unit"}),de.map(s=>e.jsx("option",{value:s,children:s},s))]})})})]}),(!a.currentOrder.subItems||((ne=(le=a.currentOrder)==null?void 0:le.subItems)==null?void 0:ne.length)===0)&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"fa-solid fa-inbox text-2xl mb-2"}),e.jsx("p",{className:"text-sm",children:"No sub-items yet. Start typing in the row above to add items."})]})]})]})]}),!A&&e.jsx("section",{className:"mt-4",children:e.jsxs("section",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Orders"}),e.jsx("p",{className:"text-sm text-gray-600",children:"view your orders"})]}),v&&e.jsx(x,{onClick:Te,isLoading:je,className:"min-w-[140px] bg-blue-600 hover:bg-blue-700 text-white font-medium",size:"lg",children:"Submit Order"})]}),a!=null&&a.orderedItems&&((ie=a==null?void 0:a.orderedItems)==null?void 0:ie.length)>0?e.jsx("div",{className:"flex flex-col gap-2",children:(ce=a==null?void 0:a.orderedItems)==null?void 0:ce.map(s=>e.jsx(ss,{className:"border-green-200 bg-green-50 shadow ",children:e.jsx(ts,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"fas fa-check-circle text-7reen-600"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-blue-700 ",children:[e.jsx("span",{className:"!text-sm text-gray-600",children:"Order Id: "})," ",s.orderMaterialNumber]}),e.jsx("span",{className:"text-sm text-gray-900",children:"Order Material"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto ",children:[e.jsxs(x,{variant:"outline",onClick:()=>U(`singleorder/${s._id}`),className:"border-green-300 text-blue-700 hover:bg-blue-100 hover:border-blue-400",children:[e.jsx("i",{className:"fas mr-2 fa-external-link-alt"}),"View"]}),(v||b)&&e.jsx(x,{variant:"outline",onClick:()=>ze(s._id),isLoading:ve,className:"border-green-300 text-blue-700 hover:bg-blue-100 hover:border-blue-400",children:"Generate Pdf"}),e.jsx(x,{variant:"secondary",onClick:()=>Ge(s),className:"border-blue-300 text-blue-700 hover:bg-blue-100 hover:border-blue-400",children:"Download PDF"}),(v||b)&&e.jsx(x,{variant:"outline",onClick:()=>Be(s._id),disabled:s==null?void 0:s.isSyncWithProcurement,title:s!=null&&s.isSyncWithProcurement?"already sent to procurement":"",isLoading:Ae,className:"border-green-300 text-blue-700 disabled:cursor-not-allowed hover:bg-blue-100 hover:border-blue-400",children:"Send To Procurement"})]})]})})},s._id))}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col items-center  justify-center min-h-[300px] w-full bg-white rounded-xl text-center p-6",children:[e.jsx("i",{className:"fa-solid fa-box text-5xl text-blue-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-1",children:"No Orders Found"})]})})]})})]})};export{Os as default};
