import{u as l}from"./useQuery-BlDIWKCM.js";import{u as c}from"./useMutation-CAsfcLt-.js";import{u as d}from"./useInfiniteQuery-Cey4CECX.js";import{c as i,q as a}from"./index-g9v5L7eS.js";import{g as u}from"./roleCheck-vn63l46q.js";const w=async({expenseData:t,api:n})=>{const{data:e}=await n.post("/department/accounting/expense/create",t);if(!e.ok)throw new Error(e.message);return e.data},p=async({id:t,expenseData:n,api:e})=>{const{data:o}=await e.put(`/department/accounting/expense/update/${t}`,n);if(!o.ok)throw new Error(o.message);return o.data},f=async({id:t,api:n})=>{const{data:e}=await n.delete(`/department/accounting/expense/delete/${t}`);if(!e.ok)throw new Error(e.message);return e},y=async({id:t,api:n})=>{const{data:e}=await n.get(`/department/accounting/expense/getsingle/${t}`);if(!e.ok)throw new Error(e.message);return e.data},g=async({params:t,api:n})=>{const{data:e}=await n.get("/department/accounting/expense/getall",{params:t});if(!e.ok)throw new Error(e.message);return e},x=async({expenseId:t,api:n})=>{const{data:e}=await n.post(`/department/accounting/expense/syntopayments/${t}`);if(!e.ok)throw new Error(e.message);return e.data},q=()=>{const t=["owner","staff","CTO"],{role:n}=i(),e=u(n);return c({mutationFn:async o=>{if(!n||!t.includes(n))throw new Error("Not allowed to create expense");if(!e)throw new Error("API instance not found for role");return await w({expenseData:o,api:e})},onSuccess:o=>{a.invalidateQueries({queryKey:["expenses","list",o.organizationId]}),a.invalidateQueries({queryKey:["expenses","statistics",o.organizationId]})}})},v=()=>{const t=["owner","staff","CTO"],{role:n}=i(),e=u(n);return c({mutationFn:async({id:o,...r})=>{if(!n||!t.includes(n))throw new Error("Not allowed to update expense");if(!e)throw new Error("API instance not found for role");return await p({id:o,expenseData:r,api:e})},onSuccess:(o,r)=>{a.invalidateQueries({queryKey:["expenses","detail",r.id]}),a.invalidateQueries({queryKey:["expenses","list",o.organizationId]}),a.invalidateQueries({queryKey:["expenses","statistics",o.organizationId]})}})},K=()=>{const t=["owner","staff","CTO"],{role:n}=i(),e=u(n);return c({mutationFn:async({id:o,_organizationId:r})=>{if(!n||!t.includes(n))throw new Error("Not allowed to delete expense");if(!e)throw new Error("API instance not found for role");return await f({id:o,api:e})},onSuccess:(o,r)=>{a.invalidateQueries({queryKey:["expenses","detail",r.id]}),a.invalidateQueries({queryKey:["expenses","list",r._organizationId]}),a.invalidateQueries({queryKey:["expenses","statistics",r._organizationId]})}})},Q=(t,n=!0)=>{const e=["owner","staff","CTO"],{role:o}=i(),r=u(o);return l({queryKey:["expenses","detail",t],queryFn:async()=>{if(!o||!e.includes(o))throw new Error("Not allowed to view expense");if(!r)throw new Error("API instance not found for role");return await y({id:t,api:r})},enabled:n&&!!t&&!!o&&!!r})},z=(t,n=!0)=>{const e=["owner","staff","CTO"],{role:o}=i(),r=u(o);return d({queryKey:["expenses","list",t.organizationId,t],queryFn:async({pageParam:s=1})=>{if(!o||!e.includes(o))throw new Error("Not allowed to view expenses");if(!r)throw new Error("API instance not found for role");return await g({params:{...t,page:s},api:r})},getNextPageParam:s=>s.pagination.hasNextPage?s.pagination.page+1:void 0,getPreviousPageParam:s=>s.pagination.hasPrevPage?s.pagination.page-1:void 0,initialPageParam:1,enabled:n&&!!t.organizationId&&!!o&&!!r})},A=()=>{const t=["owner","staff","CTO"],{role:n}=i(),e=u(n);return c({mutationFn:async({expenseId:o})=>{if(!n||!t.includes(n))throw new Error("Unauthorized");if(!e)throw new Error("API instance not found for role");return await x({expenseId:o,api:e})},onSuccess:()=>{a.invalidateQueries({queryKey:["bills"]})}})};export{K as a,q as b,v as c,A as d,Q as e,z as u};
