import{r as f,j as s}from"./index-DkfQDeIt.js";import{B as i}from"./Button-C-chqFKc.js";import{I as z}from"./Input-lr8I7tVA.js";import{t as c}from"./toast-BSC5QTk1.js";import{d as b}from"./downloadFile-CKDbPSiN.js";const B=({formId:o,projectId:x,refetch:w,existingUploads:p=[],onUploadComplete:r,uploadFilesMutate:v,uploadPending:F,onDeleteUpload:n,deleteFilePending:h})=>{const[u,g]=f.useState([]),[j,d]=f.useState(null),k=e=>{e.target.files&&g(Array.from(e.target.files))},C=async()=>{var e,a;if(!(!o||u.length===0))try{await v({formId:o,files:u,projectId:x}),c({title:"Success",description:"Files uploaded successfully."}),g([]),r==null||r()}catch(t){c({title:"Upload Failed",description:((a=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:a.message)||"Try again later.",variant:"destructive"})}},N=async e=>{var a,t;try{await(n==null?void 0:n({fileId:e,projectId:x})),c({title:"Success",description:"Files Deleted successfully."}),w()}catch(m){c({title:"Upload Failed",description:((t=(a=m==null?void 0:m.response)==null?void 0:a.data)==null?void 0:t.message)||"Try again later.",variant:"destructive"})}},l=p.filter(e=>e.type==="pdf"),y=p.filter(e=>e.type==="image");return s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-xl font-semibold text-blue-700",children:"Uploads"}),s.jsxs("div",{className:"flex gap-4 items-center",children:[s.jsx(z,{type:"file",multiple:!0,onChange:k,accept:"image/jpeg,image/png,application/pdf"}),s.jsx(i,{onClick:C,isLoading:F,className:"bg-blue-600 text-white",children:"Upload"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"📄 PDF Files"}),s.jsxs("ul",{className:"space-y-2 max-h-[180px]  rounded-lg  border-2 border-[#5e5f612a] max-w-[100%] overflow-x-hidden custom-scrollbar overflow-y-auto ",children:[l.length===0&&s.jsx("div",{className:"min-h-[145px]   flex items-center justify-center",children:s.jsx("p",{className:"text-sm text-gray-500",children:"No PDFs uploaded."})}),l==null?void 0:l.map((e,a)=>s.jsxs("li",{className:"flex justify-between items-center  bg-blue-50 p-2 rounded-xl",children:[s.jsx("span",{className:"truncate whitespace-wrap max-w-[100%]",children:e.originalName}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx(i,{onClick:()=>b({src:e==null?void 0:e.url,alt:(e==null?void 0:e.originalName)||"file.pdf"}),size:"sm",className:"text-sm",children:s.jsx("i",{className:"fa-solid fa-download"})}),s.jsx(i,{size:"sm",isLoading:h,onClick:()=>N(e==null?void 0:e._id),className:"text-green-600 text-sm",children:s.jsx("i",{className:"fa-solid fa-trash-can"})})]})]},a))]})]}),s.jsxs("div",{className:"overflow-y-auto",children:[s.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🖼️ Image Files"}),s.jsxs("ul",{className:"space-y-2  max-h-[180px] rounded-lg border-2 border-[#5e5f612a] max-w-[100%] overflow-x-hidden custom-scrollbar overflow-y-auto custom-scrollbar",children:[y.length===0&&s.jsx("div",{className:"min-h-[145px]  flex items-center justify-center",children:s.jsx("p",{className:"text-sm text-gray-500",children:"No Images uploaded."})}),y.map((e,a)=>s.jsxs("li",{className:"flex justify-between items-center bg-green-50 sm:p-2 p-1 rounded-xl",children:[s.jsx("span",{className:"truncate whitespace-wrap max-w-[100%]",children:e.originalName}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx(i,{size:"sm",variant:"primary",onClick:()=>d(e==null?void 0:e.url),children:s.jsx("i",{className:"fas fa-eye"})}),s.jsx(i,{size:"sm",onClick:()=>b({src:e.url,alt:e.originalName||"file.pdf"}),className:"text-sm",children:s.jsx("i",{className:"fa-solid fa-download"})}),s.jsx(i,{size:"sm",isLoading:h,onClick:()=>N(e==null?void 0:e._id),className:"text-blue-600 text-sm",children:s.jsx("i",{className:"fa-solid fa-trash-can"})})]})]},a))]})]})]}),j&&s.jsx("div",{onClick:()=>d(null),className:"fixed inset-0 z-50 p-8 bg-opacity-60 flex items-center justify-center",children:s.jsxs("div",{onClick:e=>e.stopPropagation(),className:"relative bg-white rounded py-8 px-4 max-w-[90vw] max-h-[80vh] shadow-lg",children:[s.jsx("i",{className:"fas fa-times absolute top-2 right-3 text-xl text-gray-700 hover:text-red-500 cursor-pointer",onClick:()=>d(null)}),s.jsx("img",{src:j,alt:"Full View",className:"max-h-[70vh] w-auto object-contain rounded"})]})})]})};export{B as R};
