import{b as le,a as ae,c as re,r as N,j as e}from"./index-By5P0A7l.js";import{u as oe,a as ne,D as ie,P as de,b as ce,C as ue}from"./core.esm-CwhTwzyq.js";import{f as xe,g as he,h as ge,u as fe}from"./billNewAccountingApi-Bkyy8Vhg.js";import{B as ee}from"./Button-DLUK8O0t.js";import{u as be}from"./projectApi-_duyp5-I.js";import"./index-BQTHaHB-.js";import"./useQuery-Cc7pLKfK.js";import"./useMutation-7YLqc7VE.js";import"./useInfiniteQuery-DQF0m-E9.js";import"./roleCheck-YGaMnK_P.js";function me(t){const[d,p]=N.useState([t]),[u,o]=N.useState(0),f=d[u],k=C=>{const A=typeof C=="function"?C(f):C;if(JSON.stringify(f)===JSON.stringify(A))return;const y=d.slice(0,u+1);y.push(A),p(y),o(y.length-1)},m=N.useCallback(()=>o(C=>Math.max(C-1,0)),[]),x=N.useCallback(()=>o(C=>Math.min(C+1,d.length-1)),[d]),I=C=>{p([C]),o(0)};return{state:f,setState:k,undo:m,redo:x,canUndo:u>0,canRedo:u<d.length-1,reset:I}}const Z=()=>`blk_${Math.random().toString(36).substr(2,9)}`,F={fontSize:12,color:"#000000",backgroundColor:"transparent",fontWeight:"normal",textAlign:"left",width:200,height:"auto"},ye=({onSelect:t})=>{const[d,p]=N.useState({rows:0,cols:0});return e.jsxs("div",{className:"absolute top-12 left-0 z-50 bg-white shadow-xl border border-gray-300 p-3 rounded w-48",children:[e.jsxs("div",{className:"text-xs font-bold mb-2 text-gray-500",children:["Table ",d.cols,"x",d.rows]}),e.jsx("div",{className:"grid grid-cols-10 gap-1",onMouseLeave:()=>p({rows:0,cols:0}),children:Array.from({length:50}).map((u,o)=>{const f=Math.floor(o/10)+1,k=o%10+1,m=f<=d.rows&&k<=d.cols;return e.jsx("div",{className:`w-3 h-3 border ${m?"bg-blue-500 border-blue-600":"bg-gray-100 border-gray-300"}`,onMouseEnter:()=>p({rows:f,cols:k}),onClick:()=>t(f,k)},o)})})]})},pe=({x:t,y:d,actions:p,onClose:u})=>(N.useEffect(()=>{const o=()=>u();return document.addEventListener("click",o),()=>document.removeEventListener("click",o)},[u]),e.jsx("div",{className:"fixed z-[9999] bg-white shadow-xl border border-gray-200 rounded py-1 min-w-[180px]",style:{top:d,left:t},children:p.map((o,f)=>e.jsx("button",{onClick:o.action,className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 block ${o.color||"text-gray-700"}`,children:o.label},f))})),ve=({organizationId:t,onSelect:d,onClose:p})=>{const{data:u}=fe({organizationId:t,limit:20}),o=(u==null?void 0:u.pages.flatMap(f=>f.data))||[];return e.jsxs("div",{className:"w-full bg-gray-50 border-b border-gray-200 p-4 animate-in slide-in-from-top-10 duration-300 shadow-inner",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-700 uppercase",children:"Select a Template"}),e.jsx("button",{onClick:p,children:e.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:o.map(f=>e.jsxs("div",{onClick:()=>d(f),className:"min-w-[160px] bg-white border rounded cursor-pointer hover:ring-2 ring-blue-500 transition-all",children:[e.jsx("div",{className:"h-24 bg-gray-100 flex items-center justify-center border-b text-gray-300",children:e.jsx("i",{className:"fas fa-file-invoice text-3xl"})}),e.jsx("div",{className:"p-2",children:e.jsx("p",{className:"text-xs font-bold truncate",children:f.templateName})})]},f._id))})]})},we=({component:t,isSelected:d,onClick:p,onUpdateValue:u,onUpdateMeta:o,onResize:f,onDelete:k,activeCell:m,onCellSelect:x})=>{var _,B,$;const{attributes:I,listeners:C,setNodeRef:A,transform:y,isDragging:M}=ce({id:t.id,data:{...t}}),[v,S]=N.useState(null),G={transform:ue.Translate.toString(y),position:"absolute",left:`${t.x}px`,top:`${t.y}px`,width:t.style.width?`${t.style.width}px`:"auto",height:t.style.height?`${t.style.height}px`:"auto",zIndex:M?9999:d?100:1,fontSize:`${t.style.fontSize}px`,color:t.style.color,fontWeight:t.style.fontWeight,textAlign:t.style.textAlign,backgroundColor:t.style.backgroundColor},K=a=>{a.stopPropagation(),a.preventDefault();const r=a.clientX,i=a.clientY,h=t.style.width||100,w=t.style.height||100,b=z=>f(Math.max(50,h+(z.clientX-r)),Math.max(20,w+(z.clientY-i))),j=()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",j)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",j)},R=(a,r)=>{a.stopPropagation();const i=a.clientX,h=t.columnWidths||[],w=t.style.width||300,b=z=>{const T=(z.clientX-i)/w*100,D=[...h];D[r+1]!==void 0&&(D[r]=Math.max(5,D[r]+T),D[r+1]=Math.max(5,D[r+1]-T),o("columnWidths",D))},j=()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",j)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",j)},H=(a,r)=>{a.stopPropagation();const i=a.clientY,h=t.rowHeights||[],w=j=>{const z=[...h];z[r]=Math.max(20,(z[r]||30)+(j.clientY-i)),o("rowHeights",z)},b=()=>{document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",b)};document.addEventListener("mousemove",w),document.addEventListener("mouseup",b)},E=(a,r=-1,i=-1)=>{t.type==="table"&&(a.preventDefault(),a.stopPropagation(),S({x:a.clientX,y:a.clientY,targetR:r,targetC:i}))},L=()=>{const a=v.targetR===-1?t.value.length:v.targetR+1,r=JSON.parse(JSON.stringify(t.value));r.splice(a,0,Array.from({length:r[0].length},()=>({content:"",style:{}})));const i=[...t.rowHeights||[]];i.splice(a,0,30),u(r),o("rowHeights",i),S(null)},Y=()=>{var w;const a=v.targetC===-1?((w=t.columnWidths)==null?void 0:w.length)||1:v.targetC+1,r=t.value.map(b=>{const j=[...b];return j.splice(a,0,{content:"",style:{}}),j});let i=[...t.columnWidths||[]];i.splice(a,0,15);const h=i.reduce((b,j)=>b+j,0);i=i.map(b=>b/h*100),u(r),o("columnWidths",i),S(null)},J=()=>{if(t.value.length<=1)return;const a=[...t.value];a.splice(v.targetR,1);const r=[...t.rowHeights];r.splice(v.targetR,1),u(a),o("rowHeights",r),S(null)},X=()=>{if(t.value[0].length<=1)return;const a=t.value.map(h=>h.filter((w,b)=>b!==v.targetC));let r=[...t.columnWidths];r.splice(v.targetC,1);const i=r.reduce((h,w)=>h+w,0);r=r.map(h=>h/i*100),u(a),o("columnWidths",r),S(null)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:A,style:G,onContextMenu:a=>E(a),onClick:a=>{a.stopPropagation(),p()},className:`group ${d?"ring-2 ring-blue-500":"hover:ring-1 hover:ring-gray-300"}`,children:[e.jsx("div",{...C,...I,className:`absolute -top-3 -left-3 w-6 h-6 bg-white shadow rounded-full flex items-center justify-center cursor-move z-50 ${d?"flex":"hidden group-hover:flex"}`,children:e.jsx("i",{className:"fa-solid fa-arrows-up-down-left-right text-xs text-gray-600"})}),t.type==="text"&&e.jsx("textarea",{className:"w-full h-full p-1 bg-transparent border-transparent outline-none resize-none overflow-hidden",value:t.label,style:{fontSize:t.style.fontSize,fontWeight:t.style.fontWeight,textAlign:t.style.textAlign,color:t.style.color},onChange:a=>o("label",a.target.value),onPointerDown:a=>a.stopPropagation()}),t.type==="data-field"&&e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 border border-dashed border-gray-400 bg-gray-50 w-full h-full overflow-hidden",children:[e.jsxs("span",{className:"font-bold text-xs whitespace-nowrap",children:[t.label,":"]}),e.jsx("input",{className:"bg-transparent border-b border-gray-300 text-xs w-full outline-none",value:t.value,onChange:a=>u(a.target.value),onPointerDown:a=>a.stopPropagation()})]}),t.type==="image"&&e.jsx("div",{className:"w-full h-full bg-gray-100",children:Array.isArray(t.value)&&t.value.length>0?e.jsx("img",{src:typeof t.value[0]=="string"?t.value[0]:t.value[0].preview,className:"w-full h-full block pointer-events-none object-fill"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400 border border-dashed",children:"No Img"})}),t.type==="table"&&Array.isArray(t.value)&&e.jsxs("div",{className:"w-full h-full flex flex-col relative",children:[d&&e.jsx("div",{className:"flex w-full h-2 absolute -top-2 left-0 pointer-events-none z-20",children:(_=t.columnWidths)==null?void 0:_.map((a,r)=>e.jsx("div",{style:{width:`${a}%`},className:"relative border-r border-blue-400 h-2 pointer-events-auto",children:e.jsx("div",{onMouseDown:i=>R(i,r),className:"absolute right-[-4px] top-[-4px] w-3 h-3 cursor-col-resize bg-blue-500 rounded-sm z-50"})},r))}),d&&e.jsx("div",{className:"absolute -left-2 top-0 w-2 h-full flex flex-col pointer-events-none z-20",children:(B=t.rowHeights)==null?void 0:B.map((a,r)=>e.jsx("div",{style:{height:`${a}px`},className:"relative border-b border-blue-400 w-2 pointer-events-auto",children:e.jsx("div",{onMouseDown:i=>H(i,r),className:"absolute bottom-[-4px] left-[-4px] w-3 h-3 cursor-row-resize bg-blue-500 rounded-sm z-50"})},r))}),e.jsxs("table",{className:"w-full table-fixed",style:{borderCollapse:"collapse",border:"1px solid #9ca3af"},children:[e.jsx("colgroup",{children:($=t.columnWidths)==null?void 0:$.map((a,r)=>e.jsx("col",{style:{width:`${a}%`}},r))}),e.jsx("tbody",{children:t.value.map((a,r)=>e.jsx("tr",{style:{height:`${t.rowHeights&&t.rowHeights[r]||30}px`},children:a.map((i,h)=>{var w,b,j,z,T;return e.jsx("td",{style:{border:"1px solid #9ca3af",padding:0,verticalAlign:"top",backgroundColor:((w=i.style)==null?void 0:w.backgroundColor)||"transparent"},className:`relative ${(m==null?void 0:m.r)===r&&(m==null?void 0:m.c)===h?"ring-2 ring-inset ring-blue-500 z-10":""}`,onContextMenu:D=>E(D,r,h),children:e.jsx("textarea",{className:"w-full h-full p-1 border-none outline-none bg-transparent resize-none overflow-hidden",style:{fontSize:`${((b=i.style)==null?void 0:b.fontSize)||t.style.fontSize}px`,color:((j=i.style)==null?void 0:j.color)||t.style.color,textAlign:((z=i.style)==null?void 0:z.textAlign)||t.style.textAlign,fontWeight:((T=i.style)==null?void 0:T.fontWeight)||t.style.fontWeight,fontFamily:"inherit",lineHeight:"1.2"},value:i.content,onChange:D=>{const O=JSON.parse(JSON.stringify(t.value));O[r][h].content=D.target.value,u(O)},onFocus:()=>x(r,h),onPointerDown:D=>D.stopPropagation()})},h)})},r))})]})]}),d&&e.jsx("div",{onMouseDown:K,onPointerDown:a=>a.stopPropagation(),className:"absolute -bottom-1 -right-1 w-4 h-4 bg-blue-500 cursor-nwse-resize rounded-full z-50 border-2 border-white shadow"})]}),v&&e.jsx(pe,{x:v.x,y:v.y,onClose:()=>S(null),actions:[{label:"Insert Row Below",action:L,color:"text-blue-600"},{label:"Insert Col Right",action:Y,color:"text-blue-600"},{label:"Delete Row",action:J},{label:"Delete Col",action:X},{label:"Delete Table",action:k,color:"text-red-600"}]})]})},je=({component:t,activeCell:d,onUpdate:p,onUpdateCell:u,onDelete:o,onClose:f})=>{const k=(x,I,C,A,y,M,v)=>e.jsxs("div",{className:"space-y-2 p-3 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("h4",{className:"text-[10px] font-bold text-gray-500 uppercase",children:[v," Styling"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:"Size"}),e.jsx("input",{type:"number",className:"w-full border p-1 text-xs rounded",value:x||12,onChange:S=>M("fontSize",Number(S.target.value))})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:"Text"}),e.jsx("div",{className:"flex items-center border p-1 rounded bg-white h-7",children:e.jsx("input",{type:"color",className:"w-full h-full border-none p-0 bg-transparent cursor-pointer",value:I||"#000000",onChange:S=>M("color",S.target.value)})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:"BG"}),e.jsx("div",{className:"flex items-center border p-1 rounded bg-white h-7",children:e.jsx("input",{type:"color",className:"w-full h-full border-none p-0 bg-transparent cursor-pointer",value:C||"#ffffff",onChange:S=>M("backgroundColor",S.target.value)})})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>M("fontWeight",A==="bold"?"normal":"bold"),className:`flex-1 border p-1 text-xs ${A==="bold"?"bg-blue-100":"bg-white"}`,children:e.jsx("i",{className:"fa-solid fa-bold"})}),e.jsx("button",{onClick:()=>M("textAlign","left"),className:`flex-1 border p-1 text-xs ${y==="left"?"bg-blue-100":"bg-white"}`,children:e.jsx("i",{className:"fa-solid fa-align-left"})}),e.jsx("button",{onClick:()=>M("textAlign","center"),className:`flex-1 border p-1 text-xs ${y==="center"?"bg-blue-100":"bg-white"}`,children:e.jsx("i",{className:"fa-solid fa-align-center"})}),e.jsx("button",{onClick:()=>M("textAlign","right"),className:`flex-1 border p-1 text-xs ${y==="right"?"bg-blue-100":"bg-white"}`,children:e.jsx("i",{className:"fa-solid fa-align-right"})})]})]});let m={};return t.type==="table"&&d&&(m=t.value[d.r][d.c].style||{}),e.jsxs("div",{className:"w-72 bg-white border-l border-gray-200 flex flex-col h-full shadow-xl z-50 fixed right-0 top-16 bottom-0",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-xs uppercase text-gray-600",children:"Properties"}),e.jsx("button",{onClick:f,children:e.jsx("i",{className:"fa-solid fa-xmark"})})]}),e.jsxs("div",{className:"p-4 space-y-6 overflow-y-auto flex-1",children:[t.type==="text"&&e.jsx("textarea",{className:"w-full border p-2 text-sm rounded",rows:3,value:t.label,onChange:x=>p("label",x.target.value)}),t.type==="data-field"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{className:"w-full border p-2 text-sm rounded mb-2",value:t.label,onChange:x=>p("label",x.target.value)}),e.jsx("input",{className:"w-full border p-2 text-sm rounded",value:t.value,onChange:x=>p("value",x.target.value)})]}),t.type==="table"&&d&&k(m.fontSize||t.style.fontSize,m.color||t.style.color,m.backgroundColor||"transparent",m.fontWeight||t.style.fontWeight,m.textAlign||t.style.textAlign,(x,I)=>u(d.r,d.c,x,I),"Cell"),k(t.style.fontSize,t.style.color,t.style.backgroundColor,t.style.fontWeight,t.style.textAlign,(x,I)=>p(x,I,!0),"Global"),e.jsx("button",{onClick:o,className:"w-full mt-6 bg-red-50 text-red-600 py-2 rounded border border-red-200 text-sm",children:"Delete Block"})]})]})},We=({mode:t})=>{var q,Q;const d=le(),{id:p,organizationId:u}=ae(),{data:o,isLoading:f}=xe({id:p||""}),{data:k}=be(u),{role:m,permission:x}=re(),I=m==="owner"||((q=x==null?void 0:x.billtemplate)==null?void 0:q.create),C=m==="owner"||((Q=x==null?void 0:x.billtemplate)==null?void 0:Q.edit),{state:A=[],setState:y,undo:M,redo:v,canUndo:S,canRedo:G,reset:K}=me([]),[R,H]=N.useState({customerName:"",billNumber:"",projectId:"",projectName:"",pdfData:null}),[E,L]=N.useState(null),[Y,J]=N.useState(null),[X,_]=N.useState(!1),[B,$]=N.useState(!1),[a,r]=N.useState(null),i=N.useRef(null),h=he(),w=ge(),b=oe(ne(de,{activationConstraint:{distance:5}}));N.useEffect(()=>{const s=l=>{(l.ctrlKey||l.metaKey)&&l.key==="z"&&(l.preventDefault(),l.shiftKey?v():M()),(l.ctrlKey||l.metaKey)&&l.key==="y"&&(l.preventDefault(),v())};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[M,v]),N.useEffect(()=>{var s,l;if(t==="edit"&&o&&(H({customerName:o.customerName,billNumber:o.billNumber,projectId:((s=o.projectId)==null?void 0:s._id)||o.projectId,projectName:"",pdfData:o.pdfData}),o.layout&&((l=o.layout[0])!=null&&l.components))){const n=o.layout[0].components.map(c=>{var g;return c.type==="table"&&typeof((g=c.value[0])==null?void 0:g[0])=="string"&&(c.value=c.value.map(W=>W.map(P=>({content:P,style:{}})))),c});K(n)}t==="create"&&A.length===0&&$(!0)},[o,t]);const j=s=>{r(s._id);const n=JSON.parse(JSON.stringify(s.layout[0].components)).map(c=>{var g;return c.type==="table"&&typeof((g=c.value[0])==null?void 0:g[0])=="string"&&(c.value=c.value.map(W=>W.map(P=>({content:P,style:{}})))),c});y(n),H(c=>({...c,pdfData:s.pdfData||null})),$(!1)},z=s=>{const l={id:Z(),type:s,label:s==="text"?"Text":"Field",value:s==="text"?"":"Val",x:50,y:50,style:{...F,width:150,height:"auto"}};y(n=>[...n,l]),L(l.id),J(null)},T=(s,l)=>{const n={id:Z(),type:"table",label:"Table",value:Array.from({length:s},()=>Array(l).fill({content:"",style:{}})),x:50,y:100,style:{...F,width:400,height:s*30},columnWidths:Array(l).fill(100/l),rowHeights:Array(s).fill(30)};y(c=>[...c,n]),_(!1),L(n.id)},D=s=>{if(s.target.files&&s.target.files[0]){const l=s.target.files[0],n=Object.assign(l,{preview:URL.createObjectURL(l)}),c={id:Z(),type:"image",label:"Img",value:[n],x:50,y:50,style:{...F,width:200,height:200}};y(g=>[...g,c])}},O=(s,l,n,c=!1)=>{y(g=>g.map(W=>W.id===s?c?{...W,style:{...W.style,[l]:n}}:{...W,[l]:n}:W))},te=(s,l,n,c,g)=>{y(W=>W.map(P=>{if(P.id!==s)return P;const U=JSON.parse(JSON.stringify(P.value));return U[l][n].style={...U[l][n].style,[c]:g},{...P,value:U}}))},se=()=>{const s=[{id:"main_canvas",name:"Canvas",order:0,style:F,components:A}],l={organizationId:u,projectId:R.projectId||null,templateId:a,customerName:R.customerName,billNumber:R.billNumber,layout:s,initialValues:{}};t==="create"?h.mutate(l,{onSuccess:n=>d(`../single/${n.data._id}`,{replace:!0})}):w.mutate({...l,id:p})};if(t==="edit"&&f)return e.jsx("div",{className:"p-10 text-center",children:"Loading..."});const V=A.find(s=>s.id===E);return e.jsxs("div",{className:"h-screen flex flex-col bg-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"bg-white border-b px-4 py-2 shadow-sm z-30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>d(-1),children:e.jsx("i",{className:"fa-solid fa-arrow-left text-gray-500"})}),e.jsx("input",{className:"font-bold text-gray-700 outline-none border-b border-transparent hover:border-gray-300 focus:border-blue-500 w-48",value:R.customerName,onChange:s=>H({...R,customerName:s.target.value}),placeholder:"Customer Name"}),e.jsxs("select",{className:"text-sm border border-gray-300 rounded px-2 py-1 w-48",value:R.projectId,onChange:s=>H({...R,projectId:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Project"}),k==null?void 0:k.map(s=>e.jsx("option",{value:s._id,children:s.projectName},s._id))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ee,{variant:"outline",onClick:()=>$(!B),children:[B?"Hide":"Show"," Templates"]}),(I||C)&&e.jsx(ee,{onClick:se,isLoading:h.isPending||w.isPending,children:"Save Bill"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 border-t pt-2",children:[e.jsx("button",{onClick:M,disabled:!S,className:`btn-tool ${S?"":"opacity-50"}`,title:"Undo (Ctrl+Z)",children:e.jsx("i",{className:"fa-solid fa-rotate-left"})}),e.jsx("button",{onClick:v,disabled:!G,className:`btn-tool ${G?"":"opacity-50"}`,title:"Redo (Ctrl+Y)",children:e.jsx("i",{className:"fa-solid fa-rotate-right"})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-2"}),e.jsxs("button",{onClick:()=>z("text"),className:"btn-tool",children:[e.jsx("i",{className:"fa-solid fa-font"})," Text"]}),e.jsxs("button",{onClick:()=>z("data-field"),className:"btn-tool",children:[e.jsx("i",{className:"fa-solid fa-database"})," Field"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>_(!X),className:"btn-tool",children:[e.jsx("i",{className:"fa-solid fa-table"})," Table"]}),X&&e.jsx(ye,{onSelect:T})]}),e.jsxs("button",{onClick:()=>{var s;return(s=i.current)==null?void 0:s.click()},className:"btn-tool",children:[e.jsx("i",{className:"fa-regular fa-image"})," Image"]}),e.jsx("input",{type:"file",ref:i,className:"hidden",onChange:D})]})]}),B&&e.jsx(ve,{organizationId:u,onSelect:j,onClose:()=>$(!1)}),e.jsx("div",{className:"flex-1 bg-gray-200 overflow-auto p-8 relative",onClick:()=>{L(null),J(null)},children:e.jsx(ie,{sensors:b,onDragEnd:s=>{const{active:l,delta:n}=s;y(c=>c.map(g=>g.id===l.id?{...g,x:g.x+n.x,y:g.y+n.y}:g))},children:e.jsxs("div",{className:"mx-auto bg-white shadow-2xl relative",style:{width:794,minHeight:1123,height:"auto"},children:[R.pdfData&&e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none",children:e.jsx("img",{src:R.pdfData.url,className:"w-full h-full opacity-50 object-cover"})}),A.map(s=>e.jsx(we,{component:s,isSelected:s.id===E,activeCell:s.id===E?Y:null,onClick:()=>L(s.id),onCellSelect:(l,n)=>{L(s.id),J({r:l,c:n})},onUpdateValue:l=>O(s.id,"value",l),onUpdateMeta:(l,n)=>O(s.id,l,n,l!=="label"),onResize:(l,n)=>y(c=>c.map(g=>g.id===s.id?{...g,style:{...g.style,width:l,height:n}}:g)),onDelete:()=>{y(l=>l.filter(n=>n.id!==s.id)),L(null)}},s.id))]})})}),E&&V&&e.jsx(je,{component:V,activeCell:V.type==="table"?Y:null,onUpdate:(s,l,n=!1)=>O(E,s,l,n),onUpdateCell:(s,l,n,c)=>te(E,s,l,n,c),onDelete:()=>{y(s=>s.filter(l=>l.id!==E)),L(null)},onClose:()=>L(null)})]})};export{We as default};
