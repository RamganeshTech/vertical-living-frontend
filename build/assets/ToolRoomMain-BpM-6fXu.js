import{j as e,b as L,d as D,a as F,r as j,O as I}from"./index-By5P0A7l.js";import{u as y}from"./useDebounce-DqqsQWok.js";import{u as P,a as E}from"./toolRoomApi-DBkaYxWz.js";import{t as w}from"./toast-BSC5QTk1.js";import{B as A}from"./Button-DLUK8O0t.js";import{B as z}from"./Breadcrumb-CBhb_ayJ.js";import"./useQuery-Cc7pLKfK.js";import"./useMutation-7YLqc7VE.js";import"./useInfiniteQuery-DQF0m-E9.js";import"./roleCheck-YGaMnK_P.js";const M=({data:t,index:c,onView:o,onDelete:x,deletePending:m})=>{var l,r,d;const n=i=>i?"bg-green-100 text-green-700 border-green-200":"bg-red-100 text-red-700 border-red-200";return e.jsxs("div",{onClick:o,className:"grid grid-cols-13 gap-4 px-6 py-4 hover:bg-blue-50/40 transition-colors cursor-pointer items-center group",children:[e.jsx("div",{className:"col-span-1 text-center text-gray-400 font-mono text-xs",children:String(c+1).padStart(2,"0")}),e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-900 text-sm group-hover:text-blue-600 transition-colors",children:t.toolRoomName}),e.jsxs("span",{className:"text-[10px] text-gray-400 font-mono mt-0.5 uppercase",children:["ID: ",t._id.slice(-6)]})]})}),e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx("i",{className:"fas fa-map-marker-alt text-gray-300 text-xs"}),e.jsx("span",{className:"text-sm truncate",children:t.location||"Not Specified"})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:((l=t.inchargeUser)==null?void 0:l.name)||((r=t.inchargeUser)==null?void 0:r.staffName)||"Unassigned"}),e.jsx("span",{className:"text-[9px] text-blue-500 font-bold uppercase tracking-tighter",children:(d=t.inchargeModel)==null?void 0:d.replace("Model","")})]})}),e.jsx("div",{className:"col-span-2 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-gray-50 border border-gray-200 px-2 py-1 rounded text-[11px] font-medium text-gray-500",children:[e.jsx("i",{className:"far fa-clock text-[10px]"}),t.allowedIssueFrom||"00:00"," - ",t.allowedIssueTo||"00:00"]})}),e.jsx("div",{className:"col-span-1 flex items-center justify-center gap-4",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[9px] font-black uppercase border ${n(t.isActive)}`,children:t.isActive?"Active":"Closed"})}),e.jsxs("div",{className:"col-span-1 flex justify-center items-center gap-4",children:[e.jsx(A,{onClick:i=>{i.stopPropagation(),x(t._id)},isLoading:m,className:"bg-red-600 hover:bg-red-600 p-2 cursor-pointer  rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete",size:"sm",children:e.jsx("i",{className:"fas fa-trash"})}),e.jsx("i",{className:"fas fa-chevron-right text-[10px] text-gray-300 group-hover:text-blue-500 group-hover:translate-x-1 transition-all"})]})]})},K=()=>{const t=L(),c=D(),{organizationId:o}=F(),x=[{label:"Tools & Hardware",path:`/organizations/${o}/projects/toolhub`},{label:"Tool Room",path:`/organizations/${o}/projects/toolroom`}],m=c.pathname.includes("single/")||c.pathname.includes("create"),n=j.useRef(null),[l,r]=j.useState({search:"",location:"",isActive:"all"}),d=y(l.search,700),i=y(l.location,700),{data:u,isLoading:R,fetchNextPage:v,hasNextPage:h,isFetchingNextPage:f}=P({organizationId:o,toolRoomName:d,location:i,isActive:l.isActive==="all"?void 0:l.isActive}),g=E();j.useEffect(()=>{const s=n.current;if(!s)return;const a=()=>{const{scrollTop:b,scrollHeight:S,clientHeight:T}=s;S-b-T<100&&h&&!f&&v()};return s.addEventListener("scroll",a),()=>s.removeEventListener("scroll",a)},[h,f,v]);const k=async s=>{try{await g.mutateAsync(s),w({title:"Deleted",description:"Tool room removed successfully"})}catch(a){w({title:"Error",description:a.message,variant:"destructive"})}},C=()=>{r({search:"",location:"",isActive:"all"})},N=Object.values(l).filter(s=>s!==""&&s!=="all").length,p=(u==null?void 0:u.pages.flatMap(s=>s.data))||[];return m?e.jsx(I,{}):e.jsxs("div",{className:"h-full flex flex-col ",children:[e.jsxs("header",{className:"flex justify-between items-center px-1 shrink-0",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-warehouse mr-3 text-blue-600"}),"Tool Rooms"]}),e.jsx("div",{className:"mt-2",children:e.jsx(z,{paths:x})})]}),e.jsx("div",{className:"flex gap-3 items-center",children:e.jsxs(A,{onClick:()=>t("create"),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 shadow-md transition-all",children:[e.jsx("i",{className:"fas fa-plus"}),"New Tool Room"]})})]}),e.jsxs("main",{className:"flex gap-6 flex-1 overflow-hidden",children:[e.jsx("aside",{className:"xl:w-72 w-64 flex-shrink-0 overflow-y-auto custom-scrollbar",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-5 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),N>0&&e.jsx("button",{onClick:C,className:"text-sm text-blue-600 cursor-pointer hover:text-blue-800 font-medium",children:"Clear All"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Room"}),e.jsx("input",{type:"text",placeholder:"Search by name...",value:l.search,autoFocus:!0,onChange:s=>r(a=>({...a,search:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Physical Location"}),e.jsx("input",{type:"text",placeholder:"Area or Site name...",value:l.location,onChange:s=>r(a=>({...a,location:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operational Status"}),e.jsxs("select",{value:l.isActive,onChange:s=>r(a=>({...a,isActive:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"true",children:"Active Rooms"}),e.jsx("option",{value:"false",children:"Inactive / Closed"})]})]})]})]})}),e.jsx("section",{className:"flex-1 flex flex-col overflow-hidden",children:R?e.jsx("div",{className:"flex-1 flex justify-center items-center bg-white rounded-xl border border-gray-200",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-3xl text-blue-600"})}):p.length===0?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center bg-white rounded-xl border border-gray-200 text-center p-6",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mb-4",children:e.jsx("i",{className:"fas fa-warehouse text-3xl text-blue-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"No Tool Rooms Found"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-md",children:N>0?"Try adjusting your filters or search query.":"Create your first tool room to start managing asset storage."})]}):e.jsxs("div",{ref:n,className:"flex-1 bg-white rounded-xl shadow-sm border border-gray-200 overflow-y-auto custom-scrollbar flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white border-b border-blue-100 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-13 gap-4 px-6 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 font-bold text-gray-700 text-[10px] uppercase tracking-wider",children:[e.jsx("div",{className:"col-span-1 text-center",children:"#"}),e.jsx("div",{className:"col-span-3",children:"Room Name / ID"}),e.jsx("div",{className:"col-span-3",children:"Location"}),e.jsx("div",{className:"col-span-2",children:"In-Charge"}),e.jsx("div",{className:"col-span-2 text-center",children:"Timings"}),e.jsx("div",{className:"col-span-1 text-center",children:"Status"}),e.jsx("div",{className:"col-span-1 text-center",children:"Action"})]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:p.map((s,a)=>e.jsx(M,{data:s,index:a,onView:()=>t(`single/${s._id}`),onDelete:b=>k(b),deletePending:g.isPending&&g.variables.id===s._id},s._id))}),f&&e.jsx("div",{className:"flex justify-center py-6 bg-gray-50 border-t",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 text-sm font-medium",children:[e.jsx("i",{className:"fas fa-spinner fa-spin"})," Loading more..."]})}),!h&&p.length>0&&e.jsx("div",{className:"flex justify-center py-6 bg-gray-50 border-t border-gray-100",children:e.jsxs("p",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest flex items-center",children:[e.jsx("i",{className:"fas fa-check-circle mr-2"})," All Rooms Loaded"]})})]})})]})]})};export{K as default};
