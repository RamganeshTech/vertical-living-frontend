import{f as a,h as i,s as u,b as w,i as s}from"./index-BAM0eJUz.js";import{u as g}from"./useInfiniteQuery-BGz0VllC.js";const p=async({payload:t,api:r})=>{const e=new FormData,{files:o,phone:m,...f}=t;Object.entries(f).forEach(([l,d])=>{d!=null&&e.append(l,String(d))}),m&&e.append("phone",JSON.stringify(m)),o&&o.length>0&&o.forEach(l=>{e.append("files",l)});const{data:c}=await r.post("/department/accounting/customer/createcustomer",e,{headers:{"Content-Type":"multipart/form-data"}});if(!c.ok)throw new Error(c.message);return c.data},y=async({params:t,api:r})=>{const{data:e}=await r.get("/department/accounting/customer/getallcustomer",{params:t});if(!e.ok)throw new Error(e.message);return e},h=async({customerId:t,api:r})=>{const{data:e}=await r.get(`/department/accounting/customer/singlecustomer/${t}`);if(!e.ok)throw new Error(e.message);return e.data},P=async({organizationId:t,api:r})=>{const{data:e}=await r.get(`/department/accounting/customer/getallcustomername/${t}`);if(!e.ok)throw new Error(e.message);return e.data},E=async({customerId:t,payload:r,api:e})=>{const{data:o}=await e.put(`/department/accounting/customer/updatecustomer/${t}`,r);if(!o.ok)throw new Error(o.message);return o.data},A=async({api:t,formData:r,id:e})=>(await t.put(`/department/accounting/customer/updatecustomer/${e}/document`,r,{headers:{"Content-Type":"multipart/form-data"}})).data,C=async({customerId:t,api:r})=>{const{data:e}=await r.delete(`/department/accounting/customer/deletecustomer/${t}`);if(!e.ok)throw new Error(e.message)},n=["owner","staff","CTO"],D=()=>{const{role:t}=a(),r=s(t);return i({mutationFn:async e=>{if(!t||!n.includes(t))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await p({payload:e,api:r})},onSuccess:(e,o)=>{u.invalidateQueries({queryKey:["customers","list",o.organizationId]})}})},q=t=>{const{role:r}=a(),e=s(r);return g({queryKey:["customers","list",t.organizationId,t.projectId,t.search,t.sortBy,t.sortOrder,t.createdFromDate,t.createdToDate],queryFn:async({pageParam:o=1})=>{if(!r||!n.includes(r))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await y({params:{...t,page:o},api:e})},getNextPageParam:o=>{if(o.pagination.hasNextPage)return o.pagination.currentPage+1},getPreviousPageParam:o=>{if(o.pagination.hasPrevPage)return o.pagination.currentPage-1},initialPageParam:1,enabled:!!r&&n.includes(r)&&!!t.organizationId})},F=(t,r=!0)=>{const{role:e}=a(),o=s(e);return w({queryKey:["customers","single",t],queryFn:async()=>{if(!e||!n.includes(e))throw new Error("Not allowed to make this API call");if(!o)throw new Error("API instance not found for role");return await h({customerId:t,api:o})},enabled:r&&!!e&&n.includes(e)&&!!t})},N=(t,r=!0)=>{const{role:e}=a(),o=s(e);return w({queryKey:["allcustomersname",t],queryFn:async()=>{if(!e||!n.includes(e))throw new Error("Not allowed to make this API call");if(!o)throw new Error("API instance not found for role");return await P({organizationId:t,api:o})},enabled:r&&!!e&&n.includes(e)&&!!t})},v=()=>{const{role:t}=a(),r=s(t);return i({mutationFn:async({customerId:e,payload:o})=>{if(!t||!n.includes(t))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await E({customerId:e,payload:o,api:r})},onSuccess:e=>{u.invalidateQueries({queryKey:["customers","single",e.customerId]}),u.invalidateQueries({queryKey:["customers","list"]})}})},K=()=>{const{role:t}=a(),r=s(t);return i({mutationFn:async({id:e,formData:o})=>{if(!t||!n.includes(t))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await A({id:e,formData:o,api:r})}})},b=()=>{const{role:t}=a(),r=s(t);return i({mutationFn:async e=>{if(!t||!n.includes(t))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await C({customerId:e,api:r})},onSuccess:()=>{u.invalidateQueries({queryKey:["customers","list"]})}})};export{q as a,b,F as c,v as d,K as e,D as f,N as u};
