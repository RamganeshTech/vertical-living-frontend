import{u as l,f as h,a as u,q as s,h as p,g as d,v as f}from"./index-DyM6T-eT.js";const g=async({api:t,filesBeforeWork:e,...o})=>{const a=new FormData;Object.entries(o).forEach(([r,c])=>{a.append(r,c.toString())}),e&&e.length>0&&e.forEach(r=>a.append("files",r));const{data:n}=await t.post("/subcontract/create",a,{headers:{"Content-Type":"multipart/form-data"}});if(!n.ok)throw new Error(n.message);return n.data},C=async({api:t,subContractId:e,workerData:o})=>{const{data:a}=await t.put(`/subcontract/update/${e}`,{workerData:o});if(!a.ok)throw new Error(a.message);return a.data},E=async({params:t,api:e})=>{const o=new URLSearchParams;t.page&&o.append("page",t.page.toString()),t.limit&&o.append("limit",t.limit.toString()),t.status&&o.append("status",t.status),t.projectId&&o.append("projectId",t.projectId),t.search&&o.append("search",t.search),t.labourCostMin&&o.append("labourCostMin",t.labourCostMin),t.labourCostMax&&o.append("labourCostMax",t.labourCostMax),t.materialCostMin&&o.append("materialCostMin",t.materialCostMin),t.materialCostMax&&o.append("materialCostMax",t.materialCostMax),t.totalCostMin&&o.append("totalCostMin",t.totalCostMin),t.totalCostMax&&o.append("totalCostMax",t.totalCostMax),t.dateOfCommencementFrom&&o.append("dateOfCommencementFrom",t.dateOfCommencementFrom),t.dateOfCommencementTo&&o.append("dateOfCommencementTo",t.dateOfCommencementTo),t.dateOfCompletionFrom&&o.append("dateOfCompletionFrom",t.dateOfCompletionFrom),t.dateOfCompletionTo&&o.append("dateOfCompletionTo",t.dateOfCompletionTo);const{data:a}=await e.get(`/subcontract/getall/${t.organizationId}?${o.toString()}`);if(!a.ok)throw new Error(a.message);return a.data},S=async({subContractId:t,api:e})=>{const{data:o}=await e.get(`/subcontract/getsingle/${t}`);if(!o.ok)throw new Error(o.message);return o.data},k=async({subContractId:t,status:e,api:o})=>{const{data:a}=await o.put(`/subcontract/update-status/${t}`,{status:e});if(!a.ok)throw new Error(a.message);return a.data},F=async({subContractId:t,api:e})=>{const{data:o}=await e.delete(`/subcontract/delete/${t}`);if(!o.ok)throw new Error(o.message);return o.data},P=async({token:t,subContractId:e,workerData:o,files:a})=>{const n=new FormData;Object.entries(o).forEach(([c,w])=>{n.append(c,w.toString())}),a&&a.length>0&&a.forEach(c=>n.append("files",c));const{data:r}=await f.post(`https://houseofram.in/api/subcontract/public/submit/${e}?token=${t}`,n,{headers:{"Content-Type":"multipart/form-data"}});if(!r.ok)throw new Error(r.message);return r},I=async({subContractId:t,files:e})=>{const o=new FormData;e.forEach(n=>o.append("files",n));const{data:a}=await f.post(`https://houseofram.in/api/subcontract/public/upload-before-work/${t}`,o,{headers:{"Content-Type":"multipart/form-data"}});if(!a.ok)throw new Error(a.message);return a.data},M=async({subContractId:t,files:e})=>{const o=new FormData;e.forEach(n=>o.append("files",n));const{data:a}=await f.post(`https://houseofram.in/api/subcontract/public/upload-after-work/${t}`,o,{headers:{"Content-Type":"multipart/form-data"}});if(!a.ok)throw new Error(a.message);return a.data},O=async({subContractId:t})=>{const{data:e}=await f.get(`https://houseofram.in/api/subcontract/public/getsubcontract/basicdetail/${t}`);if(!e.ok)throw new Error(e.message);return e.data},i=["owner","staff","CTO","worker"],A=()=>{const{role:t}=l(),e=d(t);return u({mutationFn:async({organizationId:o,projectId:a,workName:n,dateOfCommencement:r,dateOfCompletion:c,workerName:w,filesBeforeWork:m,labourCost:b,materialCost:y})=>{if(!t||!i.includes(t))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await g({organizationId:o,projectId:a,workName:n,api:e,dateOfCommencement:r,dateOfCompletion:c,workerName:w,filesBeforeWork:m,labourCost:b,materialCost:y})},onSuccess:(o,a)=>{s.invalidateQueries({queryKey:["subcontracts","list",a.organizationId]})}})},$=()=>{const{role:t}=l(),e=d(t);return u({mutationFn:async({subContractId:o,workerData:a})=>{if(!t||!i.includes(t))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await C({subContractId:o,workerData:a,api:e})},onSuccess:()=>{s.invalidateQueries({queryKey:["subcontract","submission"]})}})},v=t=>{const{role:e}=l(),o=d(e);return h({queryKey:["subcontracts","list",t],queryFn:async({pageParam:a=1})=>{if(!e||!i.includes(e))throw new Error("Not allowed to make this API call");if(!o)throw new Error("API instance not found for role");return await E({params:{...t,page:a},api:o})},getNextPageParam:a=>{if(a.pagination.currentPage<a.pagination.totalPages)return a.pagination.currentPage+1},getPreviousPageParam:a=>{if(a.pagination.currentPage>1)return a.pagination.currentPage-1},initialPageParam:1,enabled:!!e&&i.includes(e)&&!!t.organizationId})},x=({subContractId:t})=>{const{role:e}=l(),o=d(e);return p({queryKey:["subcontract",t],queryFn:async()=>{if(!e||!i.includes(e))throw new Error("Not allowed to make this API call");if(!o)throw new Error("API instance not found for role");return await S({subContractId:t,api:o})},enabled:!!e&&i.includes(e)&&!!t})},D=()=>{const{role:t}=l(),e=d(t);return u({mutationFn:async({subContractId:o,status:a})=>{if(!t||!i.includes(t))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await k({subContractId:o,status:a,api:e})},onSuccess:(o,a)=>{s.invalidateQueries({queryKey:["subcontract",a.subContractId]}),s.invalidateQueries({queryKey:["subcontracts","list"]})}})},K=()=>{const{role:t}=l(),e=d(t);return u({mutationFn:async({subContractId:o})=>{if(!t||!i.includes(t))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await F({subContractId:o,api:e})},onSuccess:()=>{s.invalidateQueries({queryKey:["subcontracts","list"]})}})},T=()=>u({mutationFn:async({token:t,subContractId:e,workerData:o,files:a})=>await P({subContractId:e,workerData:o,files:a,token:t}),onSuccess:()=>{s.invalidateQueries({queryKey:["subcontract","submission"]})}}),Q=()=>u({mutationFn:async({subContractId:t,files:e})=>await I({subContractId:t,files:e}),onSuccess:(t,e)=>{s.invalidateQueries({queryKey:["subcontract","submission",e.subContractId]})}}),W=()=>u({mutationFn:async({subContractId:t,files:e})=>await M({subContractId:t,files:e}),onSuccess:(t,e)=>{s.invalidateQueries({queryKey:["subcontract","submission",e.subContractId]})}}),N=({subContractId:t})=>p({queryKey:["subcontract","submission",t],queryFn:async()=>await O({subContractId:t}),enabled:!!t});export{K as a,A as b,x as c,D as d,Q as e,W as f,$ as g,T as h,N as i,v as u};
