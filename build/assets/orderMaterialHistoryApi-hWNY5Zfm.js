import{d as i,q as d,f as w,n as f}from"./index-DcYk0AxP.js";import{g as s}from"./roleCheck-D-Yu12LV.js";import{u as m}from"./useQuery-BPoeBSke.js";import{u as c}from"./useMutation-BbhnaANP.js";const g=async({projectId:t,api:e})=>{const{data:r}=await e.get(`/orderingmaterial/getalldetails/${t}`);if(!r.ok)throw new Error(r.message);return r.data},P=t=>{const e=["owner","staff","CTO","worker","client"],{role:r}=i(),a=s(r);return m({queryKey:["ordering-material-history",t],queryFn:async()=>{if(!r||!e.includes(r))throw new Error("Not allowed to fetch ordering material");if(!a)throw new Error("API not available");return await g({projectId:t,api:a})},enabled:!!r&&!!t&&!!a,retry:!1,refetchOnMount:!1})},h=async({formId:t,projectId:e,deadLine:r,api:a})=>{const{data:n}=await a.put(`/orderingmaterial/deadline/${e}/${t}`,{deadLine:r});if(!n.ok)throw new Error(n.message);return n.data},p=async({projectId:t,api:e})=>{const{data:r}=await e.put(`/orderingmaterial/completionstatus/${t}`);if(!r.ok)throw new Error(r.message);return r.data},E=async(t,e,r)=>{const{data:a}=await r.put(`/orderingmaterial/${t}/delivery-location`,e);if(!a.ok)throw new Error(a.message);return a.data},F=()=>{const t=["owner","staff","CTO"],{role:e}=i(),r=s(e),a=w();return c({mutationFn:async({projectId:n,updates:o})=>{if(!e||!t.includes(e))throw new Error("Not allowed to update delivery location");if(!r)throw new Error("API instance not available");return await E(n,o,r)},onSuccess:(n,{projectId:o})=>{a.invalidateQueries({queryKey:["ordering-material",o]})}})},R=()=>{const t=["owner","staff","CTO"],{role:e}=i(),r=s(e);return c({mutationFn:async({formId:a,projectId:n,deadLine:o})=>{if(!e||!t.includes(e))throw new Error("not allowed to make this api call");if(!r)throw new Error("API instance missing");return await h({formId:a,projectId:n,deadLine:o,api:r})},onSuccess:(a,n)=>{d.invalidateQueries({queryKey:["ordering-material-history",n.projectId]})}})},K=()=>{const t=["owner","staff","CTO"],{role:e}=i(),r=s(e);return c({mutationFn:async({projectId:a})=>{if(!e||!t.includes(e))throw new Error("not allowed to make this api call");if(!r)throw new Error("API instance missing");return await p({projectId:a,api:r})},onSuccess:(a,{projectId:n})=>{d.invalidateQueries({queryKey:["ordering-material-history",n]})}})},O=async({projectId:t})=>{const{data:e}=await f.get(`https://houseofram.in/api/orderingmaterial/getpublic/${t}`);if(console.log("data",e),!e.ok)throw new Error(e.message);return e.data},Q=t=>m({queryKey:["ordering-material-public",t],queryFn:async()=>await O({projectId:t}),enabled:!!t,retry:!1,refetchOnMount:!1}),b=async({projectId:t,api:e})=>{const{data:r}=await e.patch(`/orderingmaterial/generatelink/${t}`);if(!r.ok)throw new Error(r.message);return r.data},T=()=>{const t=["owner","staff","CTO"],{role:e}=i(),r=s(e);return c({mutationFn:async({projectId:a})=>{if(!e||!t.includes(e))throw new Error("not allowed to make this api call");if(!r)throw new Error("API instance missing");return await b({projectId:a,api:r})},onSuccess:(a,{projectId:n})=>{d.invalidateQueries({queryKey:["ordering-material-history",n]})}})},k=async({projectId:t,unitId:e,subItemName:r,quantity:a,unit:n,api:o})=>{const{data:l}=await o.post(`/orderingmaterial/${t}/unit/${e}/addsubitem`,{subItemName:r,quantity:a,unit:n});if(!l.ok)throw new Error(l.message);return l.data},D=()=>{const t=["owner","staff","CTO"],{role:e}=i(),r=s(e);return c({mutationFn:async({projectId:a,unitId:n,subItemName:o,quantity:l,unit:u})=>{if(!e||!t.includes(e))throw new Error("not allowed to make this api call");if(!r)throw new Error("API instance missing");return await k({projectId:a,unitId:n,subItemName:o,quantity:l,unit:u,api:r})},onSuccess:(a,n)=>{d.invalidateQueries({queryKey:["ordering-material-history",n.projectId]})}})},A=async({projectId:t,unitId:e,subItemId:r,api:a})=>{const{data:n}=await a.delete(`/orderingmaterial/${t}/unit/${e}/deletesubitem/${r}`);if(!n.ok)throw new Error(n.message);return n.data},_=()=>{const t=["owner","staff","CTO"],{role:e}=i(),r=s(e);return c({mutationFn:async({projectId:a,unitId:n,subItemId:o})=>{if(!e||!t.includes(e))throw new Error("not allowed to make this api call");if(!r)throw new Error("API instance missing");return await A({projectId:a,unitId:n,subItemId:o,api:r})},onSuccess:(a,n)=>{d.invalidateQueries({queryKey:["ordering-material-history",n.projectId]})}})},S=async({projectId:t,unitId:e,subItemId:r,subItemName:a,quantity:n,unit:o,api:l})=>{const{data:u}=await l.put(`/orderingmaterial/${t}/unit/${e}/updatesubitem/${r}`,{subItemName:a,quantity:n,unit:o});if(!u.ok)throw new Error(u.message);return u.data},H=()=>{const t=["owner","staff","CTO"],{role:e}=i(),r=s(e);return c({mutationFn:async({projectId:a,unitId:n,subItemId:o,subItemName:l,quantity:u,unit:y})=>{if(!e||!t.includes(e))throw new Error("not allowed to make this api call");if(!r)throw new Error("API instance missing");return await S({projectId:a,unitId:n,subItemId:o,subItemName:l,quantity:u,unit:y,api:r})},onSuccess:(a,n)=>{d.invalidateQueries({queryKey:["ordering-material-history",n.projectId]})}})},$=async(t,e,r)=>{const{data:a}=await r.put(`/orderingmaterial/${t}/shop`,e);if(!a.ok)throw new Error(a.message);return a.data},G=()=>{const t=["owner","staff","CTO"],{role:e}=i(),r=s(e),a=w();return c({mutationFn:async({projectId:n,updates:o})=>{if(!e||!t.includes(e))throw new Error("Not allowed to update shop details");if(!r)throw new Error("API instance not available");return await $(n,o,r)},onSuccess:(n,{projectId:o})=>{a.invalidateQueries({queryKey:["ordering-material-history",o]})}})},q=async(t,e,r)=>{const{data:a}=await r.delete(`/orderingmaterial/delete/${t}/${e}`);if(!a.ok)throw new Error(a.message);return a.data},L=()=>{const t=["owner","staff","CTO"],{role:e}=i(),r=s(e),a=w();return c({mutationFn:async({projectId:n,pdfId:o})=>{if(!e||!t.includes(e))throw new Error("Youre not allowed to delete pdf");if(!r)throw new Error("API instance not available");return await q(n,o,r)},onSuccess:(n,{projectId:o})=>{a.invalidateQueries({queryKey:["ordering-material-history",o]})}})};export{T as a,D as b,_ as c,H as d,R as e,K as f,F as g,L as h,G as i,Q as j,P as u};
