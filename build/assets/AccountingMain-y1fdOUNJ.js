import{j as e,r as g,b as D,u as E,O as P}from"./index-DLaY3p7d.js";import{C as A,c as F}from"./Card-BHri7Z1r.js";import{B as j}from"./Button-B7O4a2pZ.js";import{u as O,a as I}from"./accountingApi-C7m4EMcE.js";import{t as C}from"./toast-BSC5QTk1.js";import{u as _}from"./projectApi-glASxL2N.js";import B from"./MaterialOverviewLoading-DdlXekwW.js";import"./useQuery-CsoXJJPn.js";import"./useMutation-BqZ7KIEa.js";import"./roleCheck-BlurDUv2.js";import"./Skeleton-DyzXtmm3.js";const L=({id:s,transactionNumber:a,dept:f,totalAmount:n,status:c,onView:d})=>{const{mutateAsync:r,isPending:x}=O(),o=async()=>{var m,u;try{await r({id:s}),C({title:"success",description:"Deleted Successfully"})}catch(l){C({title:"Error",description:((u=(m=l==null?void 0:l.response)==null?void 0:m.data)==null?void 0:u.message)||"Failed to delete",variant:"destructive"})}},i=(n==null?void 0:n.amount)+(n==null?void 0:n.taxAmount)||0;return e.jsx(A,{className:"w-full border-l-4 border-blue-600 shadow-md bg-white hover:shadow-lg",children:e.jsxs(F,{className:"p-4 space-y-2",children:[e.jsx("h3",{className:"text-base font-bold text-blue-700 mb-2",children:a??"Transaction"}),e.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:["Department: ",e.jsx("strong",{children:f||"N/A"})]}),e.jsxs("p",{className:"text-sm text-gray-800",children:["Amount: ₹ ",e.jsxs("strong",{children:[" ",i.toLocaleString("en-in")]})]}),e.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:["Status: ",e.jsx("strong",{children:c})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsxs(j,{size:"sm",variant:"secondary",onClick:d,children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"View"]}),e.jsxs(j,{size:"sm",isLoading:x,variant:"danger",className:"bg-red-600 text-white",onClick:o,children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Delete"]})]})]})})},R=({isOpen:s,onClose:a,sections:f,heading:n,subHeading:c})=>{const d=g.useRef(null);return g.useEffect(()=>{const r=x=>{x.key==="Escape"&&a()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[a]),e.jsxs(e.Fragment,{children:[s&&e.jsx("div",{className:"fixed inset-0 bg-black/10 bg-opacity-30 z-40",onClick:a}),e.jsxs("div",{ref:d,className:`fixed left-1/2 top-[90px] -translate-x-1/2 z-50 max-w-6xl bg-white rounded-lg shadow-xl transition-all duration-300 transform ${s?"translate-y-0 opacity-100 visible":"-translate-y-5 opacity-0 invisible"}`,children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-b-[#9a9c9e] px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:n}),c&&e.jsx("p",{className:"text-sm text-gray-500",children:c})]}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 cursor-pointer",title:"Close",children:e.jsx("i",{className:"fas fa-xmark text-xl"})})]}),e.jsx("div",{className:"p-6 max-h-[400px] max-w-full overflow-x-auto overflow-y-auto",style:{whiteSpace:"nowrap"},children:f.map((r,x)=>e.jsxs("div",{className:"inline-block align-top mr-6 vertical-section",style:{verticalAlign:"top",whiteSpace:"normal"},children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 mb-3",children:r.title}),e.jsx("div",{className:"flex flex-col gap-2",children:r.items.map((o,i)=>e.jsxs("button",{onClick:o.onClick,className:"flex cursor-pointer items-center px-2 py-1.5 rounded-md text-sm text-gray-700 hover:bg-gray-100 transition w-44 text-left",children:[e.jsx("i",{className:`${o.icon} mr-2 text-[14px] w-4`}),e.jsx("span",{children:o.label})]},i))})]},x))})]})]})},X=()=>{var y,w;const{organizationId:s}=D(),a=E(),f=[{title:"Sales Transactions",items:[{label:"Invoice",path:`/organizations/${s}/projects/invoicemain`,icon:"fas fa-file-invoice text-blue-600",onClick:()=>a(`/organizations/${s}/projects/invoicemain`)},{label:"Retail Invoice",path:`/organizations/${s}/projects/retailinvoicemain`,icon:"fas fa-receipt text-blue-600",onClick:()=>a(`/organizations/${s}/projects/retailinvoicemain`)},{label:"Sales Order",path:`/organizations/${s}/projects/salesordermain`,icon:"fas fa-shopping-cart text-blue-600",onClick:()=>a(`/organizations/${s}/projects/salesordermain`)},{label:"Purchase Orders",path:`/organizations/${s}/projects/purchasemain`,icon:"fas fa-wallet text-blue-600",onClick:()=>a(`/organizations/${s}/projects/purchasemain`)}]},{title:"Expense Transactions",items:[{label:"Expense",path:`/organizations/${s}/projects/expensemain`,icon:"fas fa-money-bill text-blue-600",onClick:()=>a(`/organizations/${s}/projects/expensemain`)},{label:"Bills",path:`/organizations/${s}/projects/billmain`,icon:"fas fa-receipt text-blue-600",onClick:()=>a(`/organizations/${s}/projects/billmain`)},{label:"Design Bills",path:`/organizations/${s}/projects/billnew`,icon:"fas fa-file-pdf text-blue-600",onClick:()=>a(`/organizations/${s}/projects/billnew`)},{label:"Vendor Payments",path:`/organizations/${s}/projects/vendorpaymentmain`,icon:"fas fa-credit-card text-blue-600",onClick:()=>a(`/organizations/${s}/projects/vendorpaymentmain`)}]},{title:"Office Records",items:[{label:"Customer",path:`/organizations/${s}/projects/customermain`,icon:"fas fa-users text-blue-600",onClick:()=>a(`/organizations/${s}/projects/customermain`)},{label:"Vendor",path:`/organizations/${s}/projects/vendormain`,icon:"fas fa-user text-blue-600",onClick:()=>a(`/organizations/${s}/projects/vendormain`)}]}],[n,c]=g.useState(!1),[d,r]=g.useState(""),[x,o]=g.useState(""),[i,m]=g.useState({}),{data:u}=_(s),l=u==null?void 0:u.map(t=>({_id:t._id,projectName:t.projectName})),{data:h,isLoading:k,error:b,isError:z,refetch:$}=I(s,i,x),N=Object.values(i).filter(Boolean).length,S=()=>{m({})};return location.pathname.includes("single")?e.jsx(P,{}):e.jsxs("div",{className:"p-2 space-y-6 h-full overflow-y-auto",children:[e.jsx(R,{isOpen:n,onClose:()=>c(!1),heading:"Accounts",sections:f}),e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-money-bill-wave mr-3 text-blue-600"}),"Accounting Department"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your project’s financial transactions and accounting records                    "})]}),e.jsxs("div",{className:"flex gap-2  w-[300px] md:w-[400px]",children:[e.jsx("button",{onClick:()=>c(!0),className:"bg-blue-600 hover:bg-blue-700 cursor-pointer text-white p-2.5 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg transform hover:scale-105",title:"Quick Navigation",children:e.jsx("i",{className:"fas fa-plus text-lg"})}),e.jsx("input",{type:"text",placeholder:"Search By transNo, notes, department",value:d,autoFocus:!0,onChange:t=>r(t.target.value),onKeyDown:t=>{t.key==="Enter"&&o(d)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx(j,{onClick:()=>o(d),className:"bg-blue-600 text-white px-4 py-2 rounded",children:e.jsx("i",{className:"fas fa-search",children:" "})})]})]}),k?e.jsx(B,{}):z?e.jsxs("div",{className:"max-w-xl sm:min-w-[80%]  mx-auto mt-4 p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2 text-xl sm:text-3xl",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500  mb-4 text-lg sm:text-xl",children:((w=(y=b==null?void 0:b.response)==null?void 0:y.data)==null?void 0:w.message)||"Failed to load data"}),e.jsx(j,{onClick:()=>$(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]}):e.jsxs("main",{className:"flex gap-2 h-[90%]",children:[e.jsx("div",{className:"xl:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),N>0&&e.jsxs("button",{onClick:S,className:"text-sm text-blue-600 cursor-pointer hover:text-blue-800 font-medium",children:["Clear All (",N,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:i.status||"",onChange:t=>m(p=>({...p,status:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsxs("select",{value:i.fromDept||"",onChange:t=>m(p=>({...p,fromDept:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Departments"}),e.jsx("option",{value:"logistics",children:"Logistics"}),e.jsx("option",{value:"hr",children:"HR"}),e.jsx("option",{value:"procurement",children:"Procurement"}),e.jsx("option",{value:"factory",children:"Factory"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Project"}),e.jsx("select",{value:(i==null?void 0:i.projectId)||"",onChange:t=>{const p=l==null?void 0:l.find(v=>v._id===t.target.value);p&&m(v=>({...v,projectId:p._id,projectName:p.projectName}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:l==null?void 0:l.map(t=>e.jsx("option",{value:t._id,children:t.projectName},t._id))})]})]})]})}),(h==null?void 0:h.length)===0?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px] w-full bg-white rounded-xl   text-center p-6",children:[e.jsx("i",{className:"fas fa-box-open text-5xl text-blue-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-1",children:"No Bills Found"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["No Bills Generated Yet.",e.jsx("br",{})]})]}):e.jsx("div",{className:"flex-1 max-h-[100%] overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:h==null?void 0:h.map(t=>e.jsx(L,{id:t._id,transactionNumber:t.transactionNumber,dept:(t==null?void 0:t.fromDept)||"",totalAmount:t.totalAmount,status:t.status,onView:()=>a(`single/${t._id}`)},t._id))})})]})]})};export{X as default};
