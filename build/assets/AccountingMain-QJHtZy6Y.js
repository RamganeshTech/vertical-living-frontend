import{j as e,B as u,t as y,u as D,a as k,r as f,e as P,O as F}from"./index-BO7-A9Kz.js";import{C as _,a as A}from"./Card-f5wWE5lT.js";import{u as B,a as E}from"./accountingApi-BGBf7GFa.js";import z from"./MaterialOverviewLoading-NvLxL-Rh.js";import"./Skeleton-C-bZXmQ3.js";const I=({id:x,transactionNumber:h,dept:c,totalAmount:n,status:g,onView:m})=>{const{mutateAsync:t,isPending:r}=B(),d=async()=>{var a,l;try{await t({id:x}),y({title:"success",description:"Deleted Successfully"})}catch(o){y({title:"Error",description:((l=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:l.message)||"Failed to delete",variant:"destructive"})}};return e.jsx(_,{className:"w-full border-l-4 border-blue-600 shadow-md bg-white hover:shadow-lg",children:e.jsxs(A,{className:"p-4 space-y-2",children:[e.jsx("h3",{className:"text-base font-bold text-blue-700 mb-2",children:h??"Transaction"}),e.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:["Department: ",e.jsx("strong",{children:c||"N/A"})]}),e.jsxs("p",{className:"text-sm text-gray-800",children:["Amount: ₹ ",e.jsxs("strong",{children:[" ",(n==null?void 0:n.amount)+(n==null?void 0:n.taxAmount)||0]})]}),e.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:["Status: ",e.jsx("strong",{children:g})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsxs(u,{size:"sm",variant:"secondary",onClick:m,children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"View"]}),e.jsxs(u,{size:"sm",isLoading:r,variant:"danger",className:"bg-red-600 text-white",onClick:d,children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Delete"]})]})]})})},V=()=>{var N,v;const{organizationId:x}=D(),h=k(),[c,n]=f.useState(""),[g,m]=f.useState(""),[t,r]=f.useState({}),{data:d}=P(x),a=d==null?void 0:d.map(s=>({_id:s._id,projectName:s.projectName})),{data:l,isLoading:o,error:p,isError:w,refetch:C}=E(x,t,g),b=Object.values(t).filter(Boolean).length,S=()=>{r({})};return location.pathname.includes("single")?e.jsx(F,{}):e.jsxs("div",{className:"p-2 space-y-6 h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-money-bill-wave mr-3 text-blue-600"}),"Accounting Department"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your project’s financial transactions and accounting records                    "})]}),e.jsxs("div",{className:"flex gap-2  w-[300px] md:w-[400px]",children:[e.jsx("input",{type:"text",placeholder:"Search By transNo, notes, department",value:c,autoFocus:!0,onChange:s=>n(s.target.value),onKeyDown:s=>{s.key==="Enter"&&m(c)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx(u,{onClick:()=>m(c),className:"bg-blue-600 text-white px-4 py-2 rounded",children:e.jsx("i",{className:"fas fa-search",children:" "})})]})]}),o?e.jsx(z,{}):w?e.jsxs("div",{className:"max-w-xl sm:min-w-[80%]  mx-auto mt-4 p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2 text-xl sm:text-3xl",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500  mb-4 text-lg sm:text-xl",children:((v=(N=p==null?void 0:p.response)==null?void 0:N.data)==null?void 0:v.message)||"Failed to load data"}),e.jsx(u,{onClick:()=>C(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]}):e.jsxs("main",{className:"flex gap-2 h-[90%]",children:[e.jsx("div",{className:"xl:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),b>0&&e.jsxs("button",{onClick:S,className:"text-sm text-blue-600 cursor-pointer hover:text-blue-800 font-medium",children:["Clear All (",b,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:t.status||"",onChange:s=>r(i=>({...i,status:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsxs("select",{value:t.fromDept||"",onChange:s=>r(i=>({...i,fromDept:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Departments"}),e.jsx("option",{value:"logistics",children:"Logistics"}),e.jsx("option",{value:"hr",children:"HR"}),e.jsx("option",{value:"procurement",children:"Procurement"}),e.jsx("option",{value:"factory",children:"Factory"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Project"}),e.jsx("select",{value:(t==null?void 0:t.projectId)||"",onChange:s=>{const i=a==null?void 0:a.find(j=>j._id===s.target.value);i&&r(j=>({...j,projectId:i._id,projectName:i.projectName}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:a==null?void 0:a.map(s=>e.jsx("option",{value:s._id,children:s.projectName},s._id))})]})]})]})}),(l==null?void 0:l.length)===0?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px] w-full bg-white rounded-xl   text-center p-6",children:[e.jsx("i",{className:"fas fa-box-open text-5xl text-blue-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-1",children:"No Bills Found"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["No Bills Generated Yet.",e.jsx("br",{})]})]}):e.jsx("div",{className:"flex-1 max-h-[100%] overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:l==null?void 0:l.map(s=>e.jsx(I,{id:s._id,transactionNumber:s.transactionNumber,dept:(s==null?void 0:s.fromDept)||"",totalAmount:s.totalAmount,status:s.status,onView:()=>h(`single/${s._id}`)},s._id))})})]})]})};export{V as default};
