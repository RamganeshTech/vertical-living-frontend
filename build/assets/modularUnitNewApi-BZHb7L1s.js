import{u as h,n as E,a as N,q as m,o as A,b as g}from"./index-CBsAK0nv.js";const P=async(e,r,t,a,s,l)=>{const i=new FormData;Object.keys(r).forEach(o=>{const n=r[o];n!=null&&(Array.isArray(n)?i.append(o,JSON.stringify(n)):i.append(o,n))}),t.forEach(o=>{i.append("productImages",o)}),a.forEach(o=>{i.append("2dImages",o)}),s.forEach(o=>{i.append("3dImages",o)});const{data:d}=await l.post(`/modularunitnew/create/${e}`,i,{headers:{"Content-Type":"multipart/form-data"}});if(!d.ok)throw new Error(d.message);return d.data},I=async(e,r,t,a,s,l,i,d,o)=>{const n=new FormData,{dimention:u,attributes:w,...f}=r;Object.keys(f).forEach(c=>{const y=f[c];y!=null&&y!==""&&n.append(c,String(y))}),u&&(n.append("height",String(u.height||0)),n.append("width",String(u.width||0)),n.append("depth",String(u.depth||0))),w&&w.length>0?n.append("attributes",JSON.stringify(w)):n.append("attributes",JSON.stringify([])),n.append("replaceProductImages",String(l)),n.append("replace2dImages",String(i)),n.append("replace3dImages",String(d)),t.forEach(c=>{n.append("productImages",c)}),a.forEach(c=>{n.append("2dImages",c)}),s.forEach(c=>{n.append("3dImages",c)});const{data:p}=await o.put(`/modularunitnew/update/${e}`,n,{headers:{"Content-Type":"multipart/form-data"}});if(!p.ok)throw new Error(p.message);return p.data},S=async(e,r)=>{const{data:t}=await r.delete(`/modularunitnew/delete/${e}`);if(!t.ok)throw new Error(t.message);return t.data},U=async(e,r)=>{const{data:t}=await r.get(`/modularunitnew/getunits/${e}`);if(!t.ok)throw new Error(t.message);return t.data},O=async(e,r)=>{const t=new URLSearchParams;t.append("page",String(e.page)),t.append("limit",String(e.limit)),e.category&&t.append("category",e.category),e.minPrice&&t.append("minPrice",String(e.minPrice)),e.maxPrice&&t.append("maxPrice",String(e.maxPrice)),e.search&&t.append("search",e.search),e.sortBy&&t.append("sortBy",e.sortBy),e.sortOrder&&t.append("sortOrder",e.sortOrder);const{data:a}=await r.get(`/modularunitnew/getallunits/${e.organizationId}?${t.toString()}`);if(!a.ok)throw new Error(a.message);return a.data},M=()=>{const{role:e}=h(),r=g(e),t=["owner","staff","CTO"];return N({mutationFn:async({organizationId:a,formValues:s,productImages:l=[],images2d:i=[],images3d:d=[]})=>{if(!e)throw new Error("Not Authorized");if(!t.includes(e))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await P(a,s,l,i,d,r)},onSuccess:(a,{organizationId:s})=>{m.invalidateQueries({queryKey:["modularUnitsNew",s]})}})},b=()=>{const{role:e}=h(),r=g(e),t=["owner","staff","CTO"];return N({mutationFn:async({unitId:a,formValues:s,productImages:l=[],images2d:i=[],images3d:d=[],replaceProductImages:o=!1,replace2dImages:n=!1,replace3dImages:u=!1})=>{if(!e)throw new Error("Not Authorized");if(!t.includes(e))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await I(a,s,l,i,d,o,n,u,r)},onSuccess:a=>{m.invalidateQueries({queryKey:["modularUnitsNew"]}),m.invalidateQueries({queryKey:["modularUnitNew",a._id]})}})},k=()=>{const{role:e}=h(),r=g(e),t=["owner","staff","CTO"];return N({mutationFn:async({unitId:a})=>{if(!e)throw new Error("Not Authorized");if(!t.includes(e))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await S(a,r)},onSuccess:()=>{m.invalidateQueries({queryKey:["modularUnitsNew"]})}})},v=e=>{const{role:r}=h(),t=g(r),a=["owner","staff","CTO","client"];return A({queryKey:["modularUnitNew",e],queryFn:async()=>{if(!r)throw new Error("Not Authorized");if(!a.includes(r))throw new Error("Not allowed to make this API call");if(!t)throw new Error("API instance not found for role");return await U(e,t)},enabled:!!e&&!!r&&!!t,staleTime:5*60*1e3})},C=({organizationId:e,limit:r=10,category:t,minPrice:a,maxPrice:s,search:l,sortBy:i="createdAt",sortOrder:d="desc"})=>{const{role:o}=h(),n=g(o),u=["owner","staff","CTO","client"];return E({queryKey:["modularUnitsNew",e,{category:t,minPrice:a,maxPrice:s,search:l,sortBy:i,sortOrder:d}],queryFn:async({pageParam:w=1})=>{if(!o)throw new Error("Not Authorized");if(!u.includes(o))throw new Error("Not allowed to make this API call");if(!n)throw new Error("API instance not found for role");return await O({organizationId:e,page:w,limit:r,category:t,minPrice:a,maxPrice:s,search:l,sortBy:i,sortOrder:d},n)},getNextPageParam:w=>{const{currentPage:f,totalPages:p}=w.pagination;return f<p?f+1:void 0},initialPageParam:1,enabled:!!e&&!!o&&!!n,retry:!1})};export{k as a,M as b,b as c,v as d,C as u};
