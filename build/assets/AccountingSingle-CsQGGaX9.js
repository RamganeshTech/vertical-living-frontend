import{a as A,c as L,j as e}from"./index-CqEiDvr_.js";import{B as E}from"./Button-DzcQpMPj.js";import{C as l,a as d}from"./Card-CHisThjm.js";import R from"./MaterialOverviewLoading-DjqpQRJC.js";import{d as g}from"./dateFormator-BGKi5rfZ.js";import{a as z}from"./accountingApi-CTKF9ZiH.js";import"./Skeleton-DMaf5_kG.js";import"./useQuery-DyvuN1xf.js";import"./useInfiniteQuery-DFFyAdlX.js";import"./roleCheck-BJ07f95N.js";const G=n=>{switch(n==null?void 0:n.toLowerCase()){case"paid":return{bg:"bg-green-100",text:"text-green-700",icon:"fa-check-circle",border:"border-green-200"};case"processing":return{bg:"bg-blue-100",text:"text-blue-700",icon:"fa-spinner fa-spin",border:"border-blue-200"};case"cancelled":case"failed":return{bg:"bg-red-100",text:"text-red-700",icon:"fa-times-circle",border:"border-red-200"};default:return{bg:"bg-orange-100",text:"text-orange-700",icon:"fa-clock",border:"border-orange-200"}}},K=()=>{var b,f,y,j,N,u,v,w,k;const{id:n}=A(),P=L(),{data:p,isLoading:D,isError:T,refetch:I}=z(n);if(D)return e.jsx("div",{className:"p-6",children:e.jsx(R,{})});if(T||!p||!p.data)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] bg-white rounded-xl p-6 border border-red-100 m-4",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-4xl text-red-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Could not load details"}),e.jsx(E,{onClick:()=>I(),variant:"secondary",children:"Retry"})]});const r=p.data,t=r.sourceDetails,a=r.paymentDetails,h=((b=r.type)==null?void 0:b.toLowerCase())||"",x=h.includes("invoice"),c=h.includes("expense"),$=!c,o=!x,m=G(r.status);return e.jsxs("div",{className:"p-4 h-full overflow-y-auto custom-scrollbar space-y-6 bg-gray-50/50",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 border-b border-gray-200 pb-4",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("button",{onClick:()=>P(-1),className:"bg-white hover:bg-gray-100 shadow-sm flex items-center justify-center w-10 h-10 border border-gray-200 text-gray-600 rounded-lg transition-all",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:r.recordNumber||"Transaction Details"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Created on ",g(r.createdAt)," via ",e.jsx("span",{className:"font-semibold text-blue-600 capitalize",children:r.type})]})]})]}),o&&e.jsxs("div",{className:`px-4 py-2 rounded-lg text-sm font-bold border ${m.bg} ${m.text} ${m.border} capitalize flex items-center gap-2 shadow-sm`,children:[e.jsx("i",{className:`fas ${m.icon}`}),r.status]})]}),e.jsxs("div",{className:`grid grid-cols-1 ${o?"md:grid-cols-2 lg:grid-cols-4":"md:grid-cols-3"} gap-4`,children:[e.jsx(l,{className:"shadow-sm border-gray-200",children:e.jsxs(d,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:x?"Payer Details":"Payee Details"}),e.jsx("i",{className:"fas fa-user-circle text-blue-200 text-xl"})]}),e.jsx("div",{className:"font-bold text-gray-800 text-lg truncate",title:(f=r.person)==null?void 0:f.name,children:((y=r.person)==null?void 0:y.name)||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1 capitalize",children:((N=(j=r.person)==null?void 0:j.model)==null?void 0:N.replace("AccountModel","").replace("Model",""))||"Unknown"})]})}),e.jsx(l,{className:"shadow-sm border-gray-200",children:e.jsxs(d,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:x?"Invoice Info":c?"Expense Info":"Source Document"}),e.jsx("i",{className:`fas ${x?"fa-file-contract":c?"fa-receipt":"fa-file-invoice"} text-purple-200 text-xl`})]}),e.jsx("div",{className:"font-bold text-gray-800",children:(t==null?void 0:t.deptNumber)||"N/A"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Date: ",g(t==null?void 0:t.deptGeneratedDate)]})]})}),o&&e.jsx(l,{className:`shadow-sm ${a?"border-green-200 bg-green-50/30":"border-gray-200 bg-gray-50"}`,children:e.jsxs(d,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Payment Record"}),e.jsx("i",{className:`fas fa-money-check-alt text-xl ${a?"text-green-500":"text-gray-300"}`})]}),a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold text-gray-800",children:a.number}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:a.date?`Paid: ${g(a.date)}`:"Processing..."})]}):e.jsx("div",{className:"text-sm text-gray-400 italic mt-2",children:"No payment record linked."})]})}),e.jsx(l,{className:"shadow-sm border-blue-200 bg-blue-50/30",children:e.jsxs(d,{className:"p-5 flex flex-col justify-center items-end h-full",children:[e.jsx("h3",{className:"text-xs font-bold text-blue-400 uppercase tracking-wider mb-1",children:"Grand Total"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:["₹",((u=t==null?void 0:t.grandTotal)==null?void 0:u.toLocaleString("en-IN"))||((v=r.amount)==null?void 0:v.toLocaleString("en-IN"))]}),(t==null?void 0:t.taxAmount)>0&&e.jsxs("div",{className:"text-xs text-blue-400 mt-1",children:["(Incl. ₹",t.taxAmount," Tax)"]})]})})]}),$&&e.jsxs(l,{className:"shadow-sm border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center",children:[e.jsxs("h2",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-list text-blue-500"}),r.type," Items"]}),e.jsxs("span",{className:"px-3 py-1 bg-white border border-gray-200 rounded-full text-xs font-medium text-gray-600",children:[((w=t==null?void 0:t.items)==null?void 0:w.length)||0," Items"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-semibold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-center w-16",children:"S.No"}),e.jsx("th",{className:"px-6 py-3",children:"Item Name"}),e.jsx("th",{className:"px-6 py-3",children:"Unit"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Qty"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Rate"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Total Cost"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:!(t!=null&&t.items)||t.items.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-400 italic",children:"No items found in the source document."})}):t.items.map((s,i)=>{var C,S;return e.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-center text-gray-500",children:i+1}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-800",children:s.itemName||s.name}),e.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs uppercase",children:s.unit||"-"}),e.jsx("td",{className:"px-6 py-4 text-center text-gray-700 font-medium",children:s.quantity}),e.jsx("td",{className:"px-6 py-4 text-right text-gray-600 font-mono text-xs",children:(C=s.rate)==null?void 0:C.toLocaleString()}),e.jsxs("td",{className:"px-6 py-4 text-right font-bold text-blue-700 font-mono text-xs",children:["₹",(S=s.totalCost||s.rate*s.quantity)==null?void 0:S.toLocaleString()]})]},s._id||i)})})]})})]}),c&&e.jsxs(l,{className:"shadow-sm border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-pink-50/50",children:e.jsxs("h2",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-info-circle text-pink-500"}),"Expense Details"]})}),e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-100",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Description / Purpose"}),e.jsx("p",{className:"text-gray-800 text-lg font-medium leading-relaxed",children:(t==null?void 0:t.notes)||"No description provided."})]})})]}),o&&e.jsxs(l,{className:"shadow-sm border-green-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-green-100 bg-green-50/50 flex justify-between items-center",children:[e.jsxs("h2",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-money-bill-wave text-green-600"}),"Payment Transactions"]}),e.jsxs("span",{className:"px-3 py-1 bg-white border border-green-200 rounded-full text-xs font-medium text-green-600",children:[((k=a==null?void 0:a.items)==null?void 0:k.length)||0," Transactions"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-semibold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-center w-16",children:"#"}),e.jsx("th",{className:"px-6 py-3",children:"Item / Description"}),e.jsx("th",{className:"px-6 py-3",children:"Order ID"}),e.jsx("th",{className:"px-6 py-3",children:"Transaction ID"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Paid Amount"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:!(a!=null&&a.items)||a.items.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-400 italic",children:"No transaction breakdown available."})}):a.items.map((s,i)=>e.jsxs("tr",{className:"hover:bg-green-50/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-center text-gray-500",children:i+1}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-800",children:s.itemName||"Payment Item"}),e.jsx("td",{className:"px-6 py-4",children:s.orderId?e.jsx("span",{className:"font-mono text-[10px] bg-gray-100 px-2 py-1 rounded text-gray-600 block truncate w-28",title:s.orderId,children:s.orderId}):e.jsx("span",{className:"text-gray-300",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:s.transactionId?e.jsx("span",{className:"font-mono text-[10px] bg-green-50 text-green-700 px-2 py-1 rounded border border-green-100 block truncate w-28",title:s.transactionId,children:s.transactionId}):e.jsx("span",{className:"text-xs text-gray-400 italic",children:"Pending"})}),e.jsx("td",{className:"px-6 py-4 text-right font-mono text-xs text-gray-700 font-bold",children:s.totalCost?`₹${s.totalCost.toLocaleString()}`:"-"}),e.jsx("td",{className:"px-6 py-4 text-center",children:s.status==="paid"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-100 text-green-700 text-[10px] font-bold uppercase",children:[e.jsx("i",{className:"fas fa-check"})," Paid"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-orange-100 text-orange-700 text-[10px] font-bold uppercase",children:[e.jsx("i",{className:"fas fa-clock"})," Pending"]})})]},s._id||i))})]})})]}),!c&&(t==null?void 0:t.notes)&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-yellow-800 mb-1 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-sticky-note"})," Notes"]}),e.jsx("p",{className:"text-sm text-yellow-800/90 leading-relaxed",children:t.notes})]})]})};export{K as default};
