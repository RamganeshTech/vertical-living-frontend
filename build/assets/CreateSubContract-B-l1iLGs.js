import{u as b,b as j,r as m,j as e}from"./index-C1DtYOG4.js";import{b as C}from"./subContractNewApi-C0cm3OoF.js";import{t}from"./toast-BSC5QTk1.js";import{S as g}from"./SubContractForm-DJMjoBhV.js";import{C as N,b as k,d as v,a as y}from"./Card-CK78z7_O.js";import{B as S}from"./Button-D6HVPia8.js";import{I as w}from"./Input-CHqrZBuN.js";import"./useQuery-DD9aZBjN.js";import"./useMutation-BgVKkKtF.js";import"./useInfiniteQuery-4I03x6LQ.js";import"./roleCheck-vyRiFK58.js";import"./Label-CtYe-41D.js";import"./projectApi-CV3wP0VJ.js";import"./SearchSelectNew-BTjN8GZK.js";import"./ImageGalleryMain-6QaierE0.js";import"./constants-ZBpAFlne.js";import"./downloadFile-CUpkasnf.js";import"./index-BzRRwkiY.js";const K=()=>{const r=b(),{organizationId:i}=j(),o=C(),[d,c]=m.useState(!1),[a,x]=m.useState(""),p=async f=>{var n,l;try{const s=await o.mutateAsync({organizationId:i,...f});t({title:"Success",description:"Sub Contract created successfully"}),console.log("result",s);const h=`https://houseofram.in/subcontract/share/${s==null?void 0:s.contractId}?token=${s==null?void 0:s.token}`;x(h)}catch(s){t({title:"Error",description:((l=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:l.message)||(s==null?void 0:s.message)||"Failed to create sub contract",variant:"destructive"})}},u=()=>{navigator.clipboard.writeText(a),c(!0),t({title:"Copied!",description:"Link copied to clipboard"}),setTimeout(()=>c(!1),2e3)};return e.jsxs("div",{className:"space-y-6 max-h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{onClick:()=>r(-1),className:"bg-blue-50 hover:bg-slate-300 flex items-center justify-between w-8 h-8 border border-[#a6aab8] text-sm cursor-pointer rounded-md px-2 ",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center mb-2",children:[e.jsx("i",{className:"fas fa-hard-hat mr-3 text-blue-600"}),"Create Sub Contract"]})]}),e.jsxs("div",{className:"max-w-full mx-auto space-y-6",children:[e.jsx(g,{organizationId:i,mode:"create",onSubmit:p,isLoading:o.isPending,onCancel:()=>r(-1)}),a&&e.jsxs(N,{children:[e.jsx(k,{children:e.jsxs(v,{className:"flex items-center text-lg",children:[e.jsx("i",{className:"fas fa-link mr-2 text-blue-600"}),"Generate Shareable Link"]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Generate a shareable link for workers to submit their information for this sub contract."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{value:a,readOnly:!0,className:"flex-1"}),e.jsx(S,{onClick:u,variant:"outline",children:d?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-check mr-2"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-copy mr-2"}),"Copy"]})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx("i",{className:"fas fa-check-circle"}),e.jsx("span",{children:"Link generated successfully! Share this with workers."})]})]})]})})]})]})]})};export{K as default};
