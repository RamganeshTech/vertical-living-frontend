import{b as v,c as w,r as b,j as e,u as D}from"./index-BAM0eJUz.js";import{B as A}from"./Breadcrumb-BmsgLXgK.js";import{S}from"./index-n9niHwLg.js";import{u as n}from"./useDebounce-DSMcRuVp.js";import"./index-C8BdbktQ.js";const k=(r,t)=>v({queryKey:["publicTransactions",r,t],queryFn:async()=>{const l=new URLSearchParams({organizationId:r,search:t.search||"",status:t.status||"",startDate:t.startDate||"",endDate:t.endDate||""}),{data:o}=await w.get(`https://houseofram.in/api/v1/public/transaction/getall?${l.toString()}`);return o.data},enabled:!!r}),C=({organizationId:r})=>{const[t,l]=b.useState({search:"",status:"",startDate:"",endDate:"",minAmount:0,maxAmount:5e6}),o=n(t.search,800),c=n(t.minAmount,800),i=n(t.maxAmount,800),d=n(t.startDate,800),x=n(t.endDate,800),h=b.useMemo(()=>({status:t.status,search:o,startDate:d,endDate:x,minAmount:c,maxAmount:i}),[t.status,o,d,x,c,i]),{data:m=[],isLoading:p,error:g}=k(r,h),u=[t.status,t.startDate,t.endDate].filter(Boolean).length+(t.minAmount>0||t.maxAmount<1e5?1:0),f=()=>{l({search:"",status:"",startDate:"",endDate:"",minAmount:0,maxAmount:5e6})},y=[{label:"Account",path:`/organizations/${r}/projects/accounting`},{label:"Payments",path:`/organizations/${r}/projects/paymentmain`},{label:"Client Payment",path:`/organizations/${r}/projects/publicpayment`}];return g?e.jsx("div",{className:"p-10 text-center text-red-500",children:"Error loading data."}):e.jsxs("div",{className:"w-full bg-gray-50/30 h-full",children:[e.jsx("header",{className:"flex justify-between items-center mb-3",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-receipt mr-3 text-blue-600"}),"Client Payments"]}),e.jsx(A,{paths:y})]})}),e.jsxs("main",{className:"flex gap-6 h-[83vh] flex-col md:flex-row",children:[e.jsx("div",{className:"xl:w-72 w-64 flex-shrink-0 overflow-y-auto custom-scrollbar",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-5 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),u>0&&e.jsx("button",{onClick:f,className:"text-sm text-blue-600 cursor-pointer hover:text-blue-800 font-medium",children:"Clear All"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsx("input",{type:"text",placeholder:"Search Record No, Name",value:t.search,autoFocus:!0,onChange:s=>l(a=>({...a,search:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:t.status||"",onChange:s=>l(a=>({...a,status:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white text-sm outline-none",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 mb-1 block",children:"From"}),e.jsx("input",{type:"date",value:t.startDate,onChange:s=>l(a=>({...a,startDate:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 mb-1 block",children:"To"}),e.jsx("input",{type:"date",value:t.endDate,onChange:s=>l(a=>({...a,endDate:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount Range"}),e.jsx("div",{className:"px-2 mb-3 pt-2",children:e.jsx(S,{range:!0,min:0,max:5e6,step:1e3,value:[Number(t.minAmount),Number(t.maxAmount)],onChange:s=>{const[a,j]=s;l(N=>({...N,minAmount:a,maxAmount:j}))},trackStyle:[{backgroundColor:"#3b82f6",height:6}],handleStyle:[{borderColor:"#3b82f6",backgroundColor:"#fff",boxShadow:"0 2px 6px rgba(59, 130, 246, 0.4)",width:18,height:18,marginTop:-6,opacity:1},{borderColor:"#3b82f6",backgroundColor:"#fff",boxShadow:"0 2px 6px rgba(59, 130, 246, 0.4)",width:18,height:18,marginTop:-6,opacity:1}],railStyle:{backgroundColor:"#e5e7eb",height:6}})}),e.jsxs("div",{className:"flex justify-between items-center gap-2 text-sm",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs text-gray-500 block mb-1",children:"Min"}),e.jsxs("div",{className:"bg-blue-50 px-2 py-1.5 rounded border border-blue-100 font-semibold text-blue-700 text-center text-xs",children:["₹",Number(t.minAmount).toLocaleString("en-IN")]})]}),e.jsx("div",{className:"text-gray-300",children:"—"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs text-gray-500 block mb-1",children:"Max"}),e.jsxs("div",{className:"bg-blue-50 px-2 py-1.5 rounded border border-blue-100 font-semibold text-blue-700 text-center text-xs",children:["₹",Number(t.maxAmount).toLocaleString("en-IN")]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center mt-3",children:[e.jsx("input",{type:"number",value:t.minAmount,onChange:s=>l(a=>({...a,minAmount:+s.target.value})),placeholder:"Min",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none",min:"0"}),e.jsx("input",{type:"number",value:t.maxAmount,onChange:s=>l(a=>({...a,maxAmount:+s.target.value})),placeholder:"Max",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none",min:"0"})]})]})]})]})}),p?e.jsx("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-blue-500"})}):m.length===0?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center bg-white rounded-xl border border-gray-200 text-center p-6",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mb-4",children:e.jsx("i",{className:"fas fa-file-invoice-dollar text-3xl text-blue-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"No Records Found"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-md",children:u>0?"Try adjusting your filters or search query.":"Transactions from client payments will appear here automatically."})]}):e.jsx("div",{className:"flex-1 bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col",children:e.jsx("div",{className:"flex-1 max-h-[100%] overflow-y-auto custom-scrollbar overflow-x-auto relative",children:e.jsxs("table",{className:"w-full text-left border-collapse min-w-[800px]",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 shadow-[0_1px_0_0_rgba(229,231,235,1)]",children:e.jsxs("tr",{className:"text-[10px] uppercase tracking-widest text-gray-400",children:[e.jsx("th",{className:"px-6 py-4 font-bold bg-slate-50",children:"S.No"}),e.jsx("th",{className:"px-6 py-4 font-bold bg-slate-50",children:"Date"}),e.jsx("th",{className:"px-6 py-4 font-bold bg-slate-50",children:"Client Name"}),e.jsx("th",{className:"px-6 py-4 font-bold bg-slate-50",children:"Phone"}),e.jsx("th",{className:"px-6 py-4 font-bold text-center bg-slate-50",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 font-bold text-center bg-slate-50",children:"Status"}),e.jsx("th",{className:"px-6 py-4 font-bold bg-slate-50",children:"Payment ID"}),e.jsx("th",{className:"px-6 py-4 font-bold bg-slate-50",children:"Order ID"})]})}),e.jsx("tbody",{className:"text-[13px] divide-y divide-gray-50",children:m.map((s,a)=>e.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4 text-gray-400 font-medium",children:a+1}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:new Date(s.createdAt).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-gray-900",children:s.customerDetails.name}),e.jsx("div",{className:"text-[11px] text-gray-400",children:s.customerDetails.email})]}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:s.customerDetails.phone}),e.jsxs("td",{className:"px-6 py-4 font-black text-center text-blue-600",children:["₹",s.amount.toLocaleString("en-IN")]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-tighter ${s.status==="success"?"bg-green-50 text-green-600":"bg-amber-50 text-amber-600"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 text-gray-800",children:s.razorpay_payment_id||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-gray-800",children:s.razorpay_order_id||"N/A"})]},s._id))})]})})})]})]})},L=()=>{const{organizationId:r}=D();return e.jsx("main",{children:e.jsx(C,{organizationId:r})})};export{L as default};
