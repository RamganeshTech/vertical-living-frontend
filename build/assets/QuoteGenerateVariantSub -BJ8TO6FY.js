import{r as l,j as e,N as fe,a as ge,b as Ne,c as be,R as ye}from"./index-By5P0A7l.js";import{a as je,b as me,c as Se}from"./quoteVariantApi-BgUf8GwQ.js";import{B as Te}from"./Button-DLUK8O0t.js";import Me from"./MaterialOverviewLoading-9Ck4pGPe.js";import{t as xe}from"./toast-BSC5QTk1.js";import{d as ke}from"./downloadFile-DR20oZne.js";import{S as re}from"./SearchSelect-C9Z_8DQE.js";import{C as se}from"./Card-CFqBlVQz.js";import{c as we,u as ve}from"./labourRateconfigApi-puuFtIF2.js";import{S as Le}from"./SearchSelectNew-B6SBCGTt.js";import"./useQuery-Cc7pLKfK.js";import"./useMutation-7YLqc7VE.js";import"./roleCheck-YGaMnK_P.js";import"./Skeleton-FCBR4RgB.js";const W=(n,B,v)=>{const p=String(n).toLowerCase().replace("mm","").trim(),M=B.find(L=>String(L.thickness).toLowerCase().replace("mm","").trim()===p);return(M==null?void 0:M.rs)!==void 0?M.rs:v==="laminate"?Ce:0},Re=l.forwardRef(({data:n,index:B,brandOptions:v,laminateBrandOptions:p,laminateRatesByBrand:M,brandRatesByName:L,labourCost:Y,selectedBrand:P,selectedLaminateBrand:I,onFurnitureChange:g},z)=>{var K,X;const[j,U]=l.useState(null),[y,V]=l.useState(null),S=j?L[j]||[]:[],q=y?M[y]||[]:[],$=l.useRef(I),G=l.useRef(P),[u,D]=l.useState((n==null?void 0:n.coreMaterials)||[]),[k,Z]=l.useState((n==null?void 0:n.fittingsAndAccessories)||[]),[H,F]=l.useState((n==null?void 0:n.glues)||[]),[T,_]=l.useState((n==null?void 0:n.nonBrandMaterials)||[]);l.useEffect(()=>{D((n==null?void 0:n.coreMaterials)||[])},[n==null?void 0:n.coreMaterials]),l.useEffect(()=>{G.current!==P&&(U(P),G.current=P)},[P]),l.useEffect(()=>{$.current!==I&&(V(I),$.current=I)},[I]),l.useEffect(()=>{!j&&(v==null?void 0:v.length)>0&&U(v[0])},[v]),l.useEffect(()=>{!y&&(p==null?void 0:p.length)>0&&V(p[0])},[p]);const E=()=>{let t=0;const s=j?L[j]||[]:[],a=y?M[y]||[]:[],c=u,o=c[0],d=((o==null?void 0:o.carpenters)||0)*((o==null?void 0:o.days)||0)*Y,i=c.length>0?d/c.length:0;for(const N of c){const w=W(N.plywoodNos.thickness,s,"plywood"),b=W(N.laminateNos.thickness,a,"laminate"),A=N.plywoodNos.quantity*32*w,de=N.laminateNos.quantity*32*b;t+=A+de+i}const m=N=>(N.quantity||0)*(N.cost||0),x=N=>N.cost||0,h=n.fittingsAndAccessories.reduce((N,w)=>N+m(w),0),f=n.glues.reduce((N,w)=>N+x(w),0),C=n.nonBrandMaterials.reduce((N,w)=>N+m(w),0);return t+=h+f+C,Math.round(t)},R=(r,t)=>{if(!y&&!y)return r.rowTotal||0;const a=W(r.plywoodNos.thickness,S,"plywood"),c=W(r.laminateNos.thickness,q,"laminate");console.log("ply Rate",a),console.log("lami Rate",c);const o=32,d=r.plywoodNos.quantity*(a*o),i=r.laminateNos.quantity*(c*o);console.log("plyCost",d),console.log("lamiCost",i);const m=d+i;console.log("baseMaterialCost",m);const x=m*(r.profitOnMaterial/100);console.log("profitOnMaterial",x);const h=t.length,f=t[0],w=f.carpenters*f.days*Y*(1+(f.profitOnLabour||0)/100)/h,b=m+x+w;return Math.round(b)},ee=u.reduce((r,t)=>r+R(t,u),0),O=k.reduce((r,t)=>{const s=(t.quantity||0)*(t.cost||0),a=s*((t.profitOnMaterial||0)/100);return r+s+a},0),te=H.reduce((r,t)=>{const s=t.cost||0,a=s*((t.profitOnMaterial||0)/100);return r+s+a},0),Q=T.reduce((r,t)=>{const s=(t.quantity||0)*(t.cost||0),a=s*((t.profitOnMaterial||0)/100);return r+s+a},0),ae=ee+O+te+Q;l.useImperativeHandle(z,()=>({getUpdatedFurniture:()=>{const r=u.map(x=>({...x,rowTotal:R(x,u)})),t=[...k],s=[...H],a=[...T],c=t.reduce((x,h)=>{const f=(h.quantity||0)*(h.cost||0),C=f*((h.profitOnMaterial||0)/100);return x+f+C},0),o=s.reduce((x,h)=>{const f=h.cost||0,C=f*((h.profitOnMaterial||0)/100);return x+f+C},0),d=a.reduce((x,h)=>{const f=(h.quantity||0)*(h.cost||0),C=f*((h.profitOnMaterial||0)/100);return x+f+C},0),i=r.reduce((x,h)=>x+(h.rowTotal||0),0),m=i+c+o+d;return{furnitureName:n.furnitureName,plywoodBrand:j,laminateBrand:y,coreMaterials:u.map(x=>({...x,rowTotal:R(x,u)})),fittingsAndAccessories:t,glues:s,nonBrandMaterials:a,coreMaterialsTotal:i,fittingsAndAccessoriesTotal:c,gluesTotal:o,nonBrandMaterialsTotal:d,furnitureTotal:m,totals:{core:i,fittings:c,glues:o,nbms:d,furnitureTotal:m}}}}));const ce=(r,t)=>{const s=[...u];if(s[r]={...s[r],profitOnMaterial:t||0},D(s),r!==0){g==null||g();return}const a=t,c=(o,d=!1)=>o.map(i=>{const m=d?i.cost||0:(i.quantity||0)*(i.cost||0),x=m*((a||0)/100);return{...i,profitOnMaterial:a,rowTotal:Math.round(m+x)}});Z(o=>c(o)),F(o=>c(o,!0)),_(o=>c(o)),g==null||g()},ne=r=>{if(!u[0])return;const t=[...u];t[0]={...t[0],profitOnLabour:r||0},D(t),g==null||g()},oe=(r,t,s)=>{if(r==="Fittings & Accessories"){const a=[...k],c=(a[t].quantity||0)*(a[t].cost||0),o=c*((s||0)/100);a[t]={...a[t],profitOnMaterial:s,rowTotal:Math.round(c+o)},Z(a)}if(r==="Glues"){const a=[...H],c=a[t].cost||0,o=c*((s||0)/100);a[t]={...a[t],profitOnMaterial:s,rowTotal:Math.round(c+o)},F(a)}if(r==="Non-Branded Materials"){const a=[...T],c=(a[t].quantity||0)*(a[t].cost||0),o=c*((s||0)/100);a[t]={...a[t],profitOnMaterial:s,rowTotal:Math.round(c+o)},_(a)}g==null||g()};l.useEffect(()=>{g==null||g()},[j,y,u,n.fittingsAndAccessories,n.glues]);const le=()=>e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"font-semibold text-md text-gray-800 mb-2",children:["Core Materials (Total: ₹",ee.toLocaleString("en-IN"),")"]}),e.jsx("div",{className:"overflow-x-auto rounded-md",children:e.jsxs("table",{className:"min-w-full text-sm bg-white shadow-sm",children:[e.jsxs("thead",{className:"bg-blue-50 text-sm font-semibold text-gray-600",children:[e.jsxs("tr",{children:[e.jsx("th",{rowSpan:2,className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Image"}),e.jsx("th",{rowSpan:2,className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item Name"}),e.jsx("th",{colSpan:2,className:"text-center px-6 py-1 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Plywood"}),e.jsx("th",{colSpan:2,className:"text-center px-6 py-1 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Laminate"}),e.jsx("th",{rowSpan:2,className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"No. of Carpenters / Day"}),e.jsx("th",{rowSpan:2,className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"No. of Days"}),e.jsx("th",{rowSpan:2,className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit % Material"}),e.jsx("th",{rowSpan:2,className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit % Labour"}),e.jsx("th",{rowSpan:2,className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Remarks"}),e.jsx("th",{rowSpan:2,className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{rowSpan:2,className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"text-center px-6 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"text-center px-6 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thk"}),e.jsx("th",{className:"text-center px-6 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"text-center px-6 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thk"})]})]}),e.jsx("tbody",{children:(u==null?void 0:u.length)>0&&(u==null?void 0:u.map((r,t)=>{var a,c,o,d,i,m,x,h;const s=R(r,u);return e.jsxs("tr",{className:"group border",children:[t===0&&e.jsx("td",{rowSpan:(a=n==null?void 0:n.coreMaterials)==null?void 0:a.length,className:"text-center border-r-1 p-2",children:r!=null&&r.imageUrl?e.jsx("img",{src:(r==null?void 0:r.imageUrl)||fe,className:"h-10 mx-auto"}):e.jsx(e.Fragment,{children:"—"})}),e.jsx("td",{className:"text-center border-r-1 p-2",children:(r==null?void 0:r.itemName)||"—"}),e.jsx("td",{className:"text-center border-r-1 p-2",children:((c=r==null?void 0:r.plywoodNos)==null?void 0:c.quantity)??0}),e.jsx("td",{className:"text-center border-r-1 p-2",children:((o=r==null?void 0:r.plywoodNos)==null?void 0:o.thickness)??0}),e.jsx("td",{className:"text-center border-r-1 p-2",children:((d=r==null?void 0:r.laminateNos)==null?void 0:d.quantity)??0}),e.jsx("td",{className:"text-center border-r-1 p-2",children:((i=r==null?void 0:r.laminateNos)==null?void 0:i.thickness)??0}),t===0&&e.jsxs(e.Fragment,{children:[e.jsx("td",{rowSpan:(m=n==null?void 0:n.coreMaterials)==null?void 0:m.length,className:"text-center border-r-1 p-2",children:(r==null?void 0:r.carpenters)||0}),e.jsx("td",{rowSpan:(x=n==null?void 0:n.coreMaterials)==null?void 0:x.length,className:"text-center border-r-1 p-2",children:(r==null?void 0:r.days)||0})]}),e.jsx("td",{className:"text-center border-r-1 p-2",children:e.jsx("input",{type:"number",value:u[t].profitOnMaterial,onChange:f=>ce(t,parseFloat(f.target.value)),className:"w-16 text-center border border-gray-300 rounded px-2 py-1 text-sm"})}),t===0&&e.jsx("td",{rowSpan:(h=n==null?void 0:n.coreMaterials)==null?void 0:h.length,className:"text-center border-r-1 p-2",children:e.jsx("input",{type:"number",value:u[0].profitOnLabour,onChange:f=>ne(parseFloat(f.target.value)),className:"w-16 text-center border border-gray-300 rounded px-2 py-1 text-sm"})}),e.jsx("td",{className:"text-center border-r-1 p-2",children:(r==null?void 0:r.remarks)||"—"}),e.jsxs("td",{className:"text-center border-r-1 p-2 text-green-700 font-bold",children:["₹",s==null?void 0:s.toLocaleString("en-IN")]}),e.jsx("td",{className:"text-center border-r-1 p-2",children:"—"})]},t)}))})]})})]}),ie=r=>r==="Fittings & Accessories"?Math.round(O):r==="Glues"?Math.round(te):r==="Non-Branded Materials"?Math.round(Q):0,J=(r,t)=>e.jsxs("div",{className:"mt-4",children:[e.jsxs("h3",{className:"font-semibold text-md mb-2 text-gray-800",children:[r,"(Total: ₹",ie(r).toLocaleString("en-IN"),")"]}),e.jsxs("table",{className:"min-w-full text-sm bg-white shadow-sm",children:[e.jsx("thead",{className:"bg-blue-50 text-sm font-semibold text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center px-6 py-3 text-xs font-medium uppercase tracking-wider",children:"Item Name"}),e.jsx("th",{className:"text-center px-6 py-3 text-xs font-medium uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"text-center px-6 py-3 text-xs font-medium uppercase tracking-wider",children:"Quantity"}),e.jsx("th",{className:"text-center px-6 py-3 text-xs font-medium uppercase tracking-wider",children:"Cost"}),e.jsx("th",{className:"text-center px-6 py-3 text-xs font-medium uppercase tracking-wider",children:"Profit On Materials"}),e.jsx("th",{className:"text-center px-6 py-3 text-xs font-medium uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"text-center px-6 py-3 text-xs font-medium uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{children:t.length>0&&t.map((s,a)=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"text-center border p-2",children:(s==null?void 0:s.itemName)||"—"}),e.jsx("td",{className:"text-center border p-2",children:(s==null?void 0:s.description)||"—"}),e.jsx("td",{className:"text-center border p-2",children:(s==null?void 0:s.quantity)||0}),e.jsx("td",{className:"text-center border p-2",children:(s==null?void 0:s.cost)||0}),e.jsx("td",{className:"text-center border p-2",children:e.jsx("input",{type:"number",value:s.profitOnMaterial||0,onChange:c=>oe(r,a,parseFloat(c.target.value)),className:"w-16 text-center border border-gray-300 rounded px-2 py-1 text-sm"})}),e.jsxs("td",{className:"text-center border p-2 text-green-700 font-bold",children:["₹",(s.rowTotal||0).toLocaleString("en-IN")]}),e.jsx("td",{className:"text-center border p-2",children:"—"})]},a))})]})]});return e.jsxs("div",{className:"shadow-md p-4 my-4 border rounded-lg bg-white",children:[e.jsxs("div",{className:" flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-semibold  text-blue-600",children:["Product ",B+1,": ",n.furnitureName]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-right text-xl font-bold text-green-700",children:["Product Total: ₹",ae.toLocaleString("en-IN")]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Raw Cost (no profit)"}),e.jsxs("p",{className:"text-lg font-semibold text-blue-700",children:["₹",E().toLocaleString("en-IN")]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"font-medium text-gray-700",children:"Select Plwyood Brand:"}),e.jsx(re,{options:v,placeholder:"-- Choose Plwyood Brand --",searchPlaceholder:"Search Plywood brands...",onSelect:U,selectedValue:j||"",className:"mt-1"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"font-medium text-gray-700",children:"Select Laminate Brand:"}),e.jsx(re,{options:p,placeholder:"-- Choose Laminate Brand --",searchPlaceholder:"Search laminate brands...",onSelect:V,selectedValue:y||"",className:"mt-1"})]})]}),e.jsxs("div",{children:[j&&((K=L[j])==null?void 0:K.length)>0&&e.jsxs("div",{className:"mt-6 border border-gray-200 bg-white rounded-md shadow-sm p-4",children:[e.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-2",children:["Available Thickness & Rates for ",e.jsx("span",{className:"text-blue-600",children:j})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left border border-gray-100",children:[e.jsx("thead",{className:"bg-blue-50 text-xs text-gray-600 uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 border-r",children:"Thickness"}),e.jsx("th",{className:"px-4 py-2",children:"Rate (₹/sqft)"})]})}),e.jsx("tbody",{children:L[j].map((r,t)=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"px-4 py-2 border-r text-gray-700 font-medium",children:r.thickness}),e.jsxs("td",{className:"px-4 py-2 text-green-800 font-bold",children:["₹",r.rs.toFixed(2)]})]},t))})]})})]}),y&&((X=M[y])==null?void 0:X.length)>0&&e.jsxs("div",{className:"mt-4 border bg-white rounded-md shadow-sm p-4",children:[e.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-2",children:["Laminate Rates for ",e.jsx("span",{className:"text-blue-600",children:y})]}),e.jsxs("table",{className:"min-w-full text-sm border",children:[e.jsx("thead",{className:"bg-blue-50 text-xs text-gray-600 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 border-r",children:"Thickness"}),e.jsx("th",{className:"px-4 py-2",children:"Rate (₹/sqft)"})]})}),e.jsx("tbody",{children:M[y].map((r,t)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2 border-r font-medium",children:r.thickness}),e.jsxs("td",{className:"px-4 py-2 text-green-800 font-bold",children:["₹",r.rs.toFixed(2)]})]},t))})]})]})]})]}),le(),J("Fittings & Accessories",k),J("Glues",H),J("Non-Branded Materials",T)]})}),Ce=0,He=()=>{var K,X,r;const{organizationId:n,quoteId:B}=ge(),v=Ne(),{data:p,isLoading:M}=je(n,B);let{data:L,isLoading:Y}=me(n,"plywood"),{data:P}=me(n,"Laminate");const[I,g]=l.useState({categoryId:"",categoryName:""});let{data:z=0}=we({organizationId:n,categoryId:I.categoryId}),{data:j=[]}=ve(n);const U=(j||[]).map(t=>({value:t._id,label:t.name})),{mutateAsync:y,isPending:V}=Se(),S=l.useRef([]),[q,$]=l.useState(null),[G,u]=l.useState(null),{role:D,permission:k}=be(),Z=D==="owner"||((K=k==null?void 0:k.materialquote)==null?void 0:K.create),H=D==="owner"||((X=k==null?void 0:k.materialquote)==null?void 0:X.edit),F=l.useMemo(()=>{if(!L)return{};const t={};return L.forEach(s=>{const a=(s==null?void 0:s.data)||{},c=a.Brand??a.brand,o=a["thickness (mm)"]||a.thickness||a.Thickness;let d=a.Rs||a.rs;if(c&&o&&d){const i=String(c).trim(),m=String(o).trim(),x=parseFloat(d);t[i]||(t[i]=[]),t[i].push({thickness:m,rs:x})}}),t},[L]),T=l.useMemo(()=>Object.keys(F),[F]),_=l.useMemo(()=>{if(!P)return{};const t={};return P.forEach(s=>{const a=(s==null?void 0:s.data)||{},c=a.Brand??a.brand,o=a["thickness (mm)"]||a.thickness||a.Thickness,d=a.Rs||a.rs;if(c&&o&&d){const i=String(c).trim(),m=String(o).trim(),x=parseFloat(d);t[i]||(t[i]=[]),t[i].push({thickness:m,rs:x})}}),t},[P]),E=l.useMemo(()=>Object.keys(_),[_]),[R,ee]=l.useState([]),[O,te]=l.useState(0),[Q,ae]=l.useState(0),ce=()=>{const t=S.current.map(a=>a.current).filter(a=>a!==null).map(a=>a.getUpdatedFurniture());console.log("updatedFurnitures",t);const s=t.reduce((a,c)=>a+c.totals.furnitureTotal,0);console.log("total",s),te(s),ae(ie())},ne=t=>{const s=U.find(a=>a.value===t);g(s?{categoryId:s.value,categoryName:s.label}:{categoryId:"",categoryName:""})},{profitDifference:oe,profitPercentage:le}=l.useMemo(()=>{const t=O-Q,s=Q>0?t/Q*100:0;return{profitDifference:Math.round(t),profitPercentage:s}},[O,Q]),ie=()=>{const t=S.current.map(c=>c.current).filter(c=>c!==null).map(c=>c.getUpdatedFurniture()),s=32;let a=0;return t.forEach(c=>{const o=c.plywoodBrand?F[c.plywoodBrand]||[]:[],d=c.laminateBrand?_[c.laminateBrand]||[]:[],i=c.coreMaterials,m=i[0],x=((m==null?void 0:m.carpenters)||0)*((m==null?void 0:m.days)||0)*z,h=i.length>0?x/i.length:0;i.forEach(b=>{const A=W(b.plywoodNos.thickness,o,"plywood"),de=W(b.laminateNos.thickness,d,"laminate"),pe=b.plywoodNos.quantity*(A*s),ue=b.laminateNos.quantity*(de*s),he=pe+ue;a+=he+h});const f=b=>b.quantity*b.cost,C=c.fittingsAndAccessories.reduce((b,A)=>b+f(A),0),N=c.glues.reduce((b,A)=>b+(A.cost||0),0),w=c.nonBrandMaterials.reduce((b,A)=>b+f(A),0);a+=C+N+w}),Math.round(a)},J=async()=>{var t,s;try{if(!n||!B||!p||!q){xe({title:"Missing info",description:"Please ensure brand and all details are selected",variant:"destructive"});return}const a=S.current.map(d=>d.current).filter(d=>d!==null).map(d=>d.getUpdatedFurniture()),c=a.reduce((d,i)=>d+i.totals.furnitureTotal,0),o=await y({quoteId:B,organizationId:n,data:{quoteId:B,organizationId:n,projectId:p.projectId,brandName:q,laminateBrand:G,furnitures:a,grandTotal:c,notes:"Generated with brand variant"}});ke({src:o.url,alt:o.fileName}),xe({title:"success",description:"Successfully created, check it in the Quote for clients section"})}catch(a){xe({title:"Error",description:((s=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:s.message)??"Operation failed"})}};return l.useEffect(()=>{if(!(p!=null&&p.furnitures))return;const t=p.furnitures.map(s=>({furnitureName:s.furnitureName,coreMaterials:s.coreMaterials||[],fittingsAndAccessories:s.fittingsAndAccessories||[],glues:s.glues||[],nonBrandMaterials:s.nonBrandMaterials||[],totals:{core:s.coreMaterialsTotal||0,fittings:s.fittingsAndAccessoriesTotal||0,glues:s.gluesTotal||0,nbms:s.nonBrandMaterialsTotal||0,furnitureTotal:s.furnitureTotal||0},plywoodBrand:q,laminateBrand:G}));ee(t)},[p]),S.current.length!==R.length&&(S.current=R.map((t,s)=>S.current[s]??ye.createRef())),l.useEffect(()=>{console.log("furnitureRefs Array",S),S.current=R.map((t,s)=>S.current[s]??l.createRef())},[R]),l.useEffect(()=>{!q&&(T==null?void 0:T.length)>0&&$(T[0])},[T]),l.useEffect(()=>{!G&&(E==null?void 0:E.length)>0&&u(E[0])},[E]),e.jsxs("div",{className:"p-2 max-h-full overflow-y-auto",children:[e.jsxs("header",{className:"bg-white border-b border-gray-200 pb-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("button",{onClick:()=>v(-1),className:"flex items-center justify-center w-8 h-8 bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md transition-colors flex-shrink-0",children:e.jsx("i",{className:"fas fa-arrow-left text-gray-600 text-sm"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900 truncate",children:((r=p==null?void 0:p.projectId)==null?void 0:r.projectName)||"Project"}),e.jsx("p",{className:"text-md text-gray-500",children:p!=null&&p.quoteNo?`Quote: #${p==null?void 0:p.quoteNo}`:""})]})]}),(Z||H)&&e.jsx(Te,{onClick:J,disabled:V,className:"flex-shrink-0",children:V?"Generating...":"Generate Quote for Client"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 whitespace-nowrap",children:"Plywood Brand:"}),e.jsx(re,{options:T,placeholder:"Select Plywood Brand",searchPlaceholder:"Search brands...",onSelect:$,selectedValue:q||"",className:"flex-1"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 whitespace-nowrap",children:"Laminate Brand:"}),e.jsx(re,{options:E,placeholder:"Select Laminate Brand",searchPlaceholder:"Search brands...",onSelect:u,selectedValue:G||"",className:"flex-1"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-700 whitespace-nowrap",children:"Select Salary Category"}),e.jsx(Le,{options:U,placeholder:"Choose Labour Category",searchPlaceholder:"Search by name...",value:I.categoryId,onValueChange:ne,searchBy:"name",displayFormat:"detailed",className:"flex-1"})]})]}),e.jsxs("div",{className:" grid grid-cols-4 gap-2",children:[e.jsx(se,{className:"px-2 py-4 border-l-4 border-blue-600",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-md text-gray-600",children:["Project Cost "," "," ",e.jsx("span",{className:"font-bold",children:"(without profit)"})]}),e.jsxs("p",{className:"text-md font-bold text-blue-600",children:["₹",Q.toLocaleString("en-IN")]})]})}),e.jsx(se,{className:"px-2 py-4 border-l-4 border-green-600",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-md text-gray-600",children:["Client Quote Amount "," "," ",e.jsx("span",{className:"font-bold",children:"(with profit)"})]}),e.jsxs("p",{className:"text-md font-bold text-green-600",children:["₹",O.toLocaleString("en-IN")]})]})}),e.jsx(se,{className:"px-2 py-4 border-l-4 border-violet-600",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-md text-gray-600",children:"Profit Amount"}),e.jsxs("p",{className:"text-md font-bold text-violet-600",children:["₹",oe.toLocaleString("en-IN")," ",e.jsxs("span",{className:"text-black !text-[12px] ml-[5px] font-semibold",children:["(",le.toFixed(2),"%)"]})]})]})}),e.jsx(se,{className:"px-2 py-4 border-l-4 border-orange-600",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-md text-gray-600",children:"Single Labour Cost"}),e.jsxs("p",{className:"text-md font-bold text-orange-600",children:["₹",z]})]})})]})]}),M||Y?e.jsx(Me,{}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-6",children:[R.map((t,s)=>e.jsx(Re,{index:s,data:t,labourCost:z,ref:S.current[s],laminateRatesByBrand:_,brandRatesByName:F,selectedBrand:q,selectedLaminateBrand:G,brandOptions:T,laminateBrandOptions:E,onFurnitureChange:ce},s)),e.jsx("div",{className:"mt-10 text-right",children:e.jsxs("div",{className:"inline-block bg-green-50 border border-green-200 rounded-md px-6 py-4",children:[e.jsx("p",{className:"text-md font-medium text-gray-700 mb-1",children:"Total Estimate"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["₹",O.toLocaleString("en-IN")]})]})})]})})]})};export{Ce as DEFAULT_LAMINATE_RATE_PER_SQFT,He as default};
