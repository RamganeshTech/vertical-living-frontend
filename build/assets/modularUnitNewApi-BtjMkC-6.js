import{f as y,h as A,s as N,b as I,i as E}from"./index-BAM0eJUz.js";import{u as U}from"./useInfiniteQuery-BGz0VllC.js";const D=async(e,n,t,r,s,c,w)=>{const i=new FormData;Object.keys(n).forEach(a=>{const l=n[a];l!=null&&(Array.isArray(l)?i.append(a,JSON.stringify(l)):i.append(a,l))}),t.forEach(a=>{i.append("productImages",a)}),r.forEach(a=>{i.append("2dImages",a)}),s.forEach(a=>{i.append("3dImages",a)}),c.forEach(a=>{i.append("cutlistDoc",a)});const{data:d}=await w.post(`/modularunitnew/create/${e}`,i,{headers:{"Content-Type":"multipart/form-data"}});if(!d.ok)throw new Error(d.message);return d.data},O=async(e,n,t,r,s,c,w,i,d,a,l)=>{const o=new FormData,{dimention:f,attributes:m,...h}=n;Object.keys(h).forEach(u=>{const p=h[u];p!=null&&p!==""&&o.append(u,String(p))}),f&&(o.append("height",String(f.height||0)),o.append("width",String(f.width||0)),o.append("depth",String(f.depth||0))),m&&m.length>0?o.append("attributes",JSON.stringify(m)):o.append("attributes",JSON.stringify([])),o.append("replaceProductImages",String(w)),o.append("replace2dImages",String(i)),o.append("replace3dImages",String(d)),o.append("replaceCutlistDoc",String(a)),t.forEach(u=>{o.append("productImages",u)}),r.forEach(u=>{o.append("2dImages",u)}),s.forEach(u=>{o.append("3dImages",u)}),c.forEach(u=>{o.append("cutlistDoc",u)});const{data:g}=await l.put(`/modularunitnew/update/${e}`,o,{headers:{"Content-Type":"multipart/form-data"}});if(!g.ok)throw new Error(g.message);return g.data},M=async(e,n)=>{const{data:t}=await n.delete(`/modularunitnew/delete/${e}`);if(!t.ok)throw new Error(t.message);return t.data},q=async(e,n)=>{const{data:t}=await n.get(`/modularunitnew/getunits/${e}`);if(!t.ok)throw new Error(t.message);return t.data},x=async(e,n)=>{const t=new URLSearchParams;t.append("page",String(e.page)),t.append("limit",String(e.limit)),e.category&&t.append("category",e.category),e.minPrice&&t.append("minPrice",String(e.minPrice)),e.maxPrice&&t.append("maxPrice",String(e.maxPrice)),e.minHeight&&t.append("minHeight",String(e.minHeight)),e.maxHeight&&t.append("maxHeight",String(e.maxHeight)),e.minWidth&&t.append("minWidth",String(e.minWidth)),e.maxWidth&&t.append("maxWidth",String(e.maxWidth)),e.minDepth&&t.append("minDepth",String(e.minDepth)),e.maxDepth&&t.append("maxDepth",String(e.maxDepth)),e.search&&t.append("search",e.search),e.sortBy&&t.append("sortBy",e.sortBy),e.sortOrder&&t.append("sortOrder",e.sortOrder);const{data:r}=await n.get(`/modularunitnew/getallunits/${e.organizationId}?${t.toString()}`);if(!r.ok)throw new Error(r.message);return r.data},k=()=>{const{role:e}=y(),n=E(e),t=["owner","staff","CTO"];return A({mutationFn:async({organizationId:r,formValues:s,productImages:c=[],images2d:w=[],images3d:i=[],cutlistDoc:d=[]})=>{if(!e)throw new Error("Not Authorized");if(!t.includes(e))throw new Error("Not allowed to make this API call");if(!n)throw new Error("API instance not found for role");return await D(r,s,c,w,i,d,n)},onSuccess:(r,{organizationId:s})=>{N.invalidateQueries({queryKey:["modularUnitsNew",s]})}})},v=()=>{const{role:e}=y(),n=E(e),t=["owner","staff","CTO"];return A({mutationFn:async({unitId:r,formValues:s,productImages:c=[],images2d:w=[],images3d:i=[],cutlistDoc:d=[],replaceProductImages:a=!1,replace2dImages:l=!1,replace3dImages:o=!1,replaceCutlistDoc:f=!1})=>{if(!e)throw new Error("Not Authorized");if(!t.includes(e))throw new Error("Not allowed to make this API call");if(!n)throw new Error("API instance not found for role");return await O(r,s,c,w,i,d,a,l,o,f,n)},onSuccess:r=>{N.invalidateQueries({queryKey:["modularUnitsNew"]}),N.invalidateQueries({queryKey:["modularUnitNew",r._id]})}})},F=()=>{const{role:e}=y(),n=E(e),t=["owner","staff","CTO"];return A({mutationFn:async({unitId:r})=>{if(!e)throw new Error("Not Authorized");if(!t.includes(e))throw new Error("Not allowed to make this API call");if(!n)throw new Error("API instance not found for role");return await M(r,n)},onSuccess:()=>{N.invalidateQueries({queryKey:["modularUnitsNew"]})}})},R=e=>{const{role:n}=y(),t=E(n),r=["owner","staff","CTO","client"];return I({queryKey:["modularUnitNew",e],queryFn:async()=>{if(!n)throw new Error("Not Authorized");if(!r.includes(n))throw new Error("Not allowed to make this API call");if(!t)throw new Error("API instance not found for role");return await q(e,t)},enabled:!!e&&!!n&&!!t,staleTime:5*60*1e3})},T=({organizationId:e,limit:n=10,category:t,minPrice:r,maxPrice:s,minHeight:c,maxHeight:w,minWidth:i,maxWidth:d,minDepth:a,maxDepth:l,search:o,sortBy:f="createdAt",sortOrder:m="desc"})=>{const{role:h}=y(),g=E(h),u=["owner","staff","CTO","client"];return U({queryKey:["modularUnitsNew",e,{category:t,minPrice:r,maxPrice:s,search:o,sortBy:f,sortOrder:m,minHeight:c,maxHeight:w,minWidth:i,maxWidth:d,minDepth:a,maxDepth:l}],queryFn:async({pageParam:p=1})=>{if(!h)throw new Error("Not Authorized");if(!u.includes(h))throw new Error("Not allowed to make this API call");if(!g)throw new Error("API instance not found for role");return await x({organizationId:e,page:p,limit:n,category:t,minPrice:r,maxPrice:s,minHeight:c,maxHeight:w,minWidth:i,maxWidth:d,minDepth:a,maxDepth:l,search:o,sortBy:f,sortOrder:m},g)},getNextPageParam:p=>{const{currentPage:S,totalPages:P}=p.pagination;return S<P?S+1:void 0},initialPageParam:1,enabled:!!e&&!!h&&!!g,retry:!1})};export{F as a,k as b,v as c,R as d,T as u};
