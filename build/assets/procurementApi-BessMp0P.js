import{u as m}from"./useQuery-DFVFWtWl.js";import{u}from"./useMutation-sTZCeqmg.js";import{u as w}from"./useInfiniteQuery-BdEWgiGc.js";import{g as s,q as o,i as p}from"./index-BYTWf4fI.js";import{g as i}from"./roleCheck-DhBlwT6t.js";const y=async({id:t,payload:r,api:e})=>{const{data:n}=await e.put(`/department/procurement/updateshop/${t}`,r);if(!n.ok)throw new Error(n.message);return n.data},f=async({payload:t,api:r})=>{const{data:e}=await r.post("/department/procurement/create",t);if(!e.ok)throw new Error(e.message);return e.data},h=async({projectId:t,api:r})=>{const{data:e}=await r.get(`/department/procurement/getordermaterial/fromdeptnumbers/${t}`);if(!e.ok)throw new Error(e.message);return e.data},g=async({id:t,payload:r,api:e})=>{const{data:n}=await e.put(`/department/procurement/updatedelivery/${t}`,r);if(!n.ok)throw new Error(n.message);return n.data},P=async({id:t,api:r})=>{const{data:e}=await r.delete(`/department/procurement/deleteprocurement/${t}`);if(!e.ok)throw new Error(e.message);return e.data},E=async({organizationId:t,api:r,pageParam:e=1,filters:n})=>{const a=new URLSearchParams;a.append("organizationId",t),a.append("page",e.toString()),a.append("limit","10"),n&&(n.projectId&&a.append("projectId",n.projectId),n.search&&a.append("search",n.search),typeof n.isSyncWithPaymentsSection=="boolean"&&a.append("isSyncWithPaymentsSection",String(n.isSyncWithPaymentsSection)),typeof n.isConfirmedRate=="boolean"&&a.append("isConfirmedRate",String(n.isConfirmedRate)),n.minAmount!==void 0&&a.append("minAmount",String(n.minAmount)),n.maxAmount!==void 0&&a.append("maxAmount",String(n.maxAmount)),n.fromDate&&a.append("fromDate",n.fromDate),n.toDate&&a.append("toDate",n.toDate));const{data:d}=await r.get(`/department/procurement/getprocurementall?${a.toString()}`);if(!d.ok)throw new Error(d.message);return d.data},S=async({id:t})=>{const{data:r}=await p.get(`https://houseofram.in/api/department/procurement/getprocurementsingle/${t}`);if(!r.ok)throw new Error(r.message);return r.data},q=async({id:t,api:r})=>{const{data:e}=await r.patch(`/department/procurement/generatepdf/${t}`);if(!e.ok)throw new Error(e.message);return e.data},A=async(t,r,e)=>{const{data:n}=await e.delete(`/department/procurement/deletepdf/${t}/${r}`);if(!n.ok)throw new Error(n.message);return n.data},k=async({id:t,api:r})=>{const{data:e}=await r.post(`/department/procurement/synctopayments/${t}`);if(!e.ok)throw new Error(e.message);return e.data},b=async({orderId:t,api:r})=>{const{data:e}=await r.post(`/department/procurement/generatetoken/${t}`);if(!e.ok)throw new Error(e.message);return e.data},l="https://houseofram.in/api/department/procurement",v=async({orderId:t,token:r})=>{const{data:e}=await p.get(`${l}/public/get?token=${r}&orderId=${t}`);if(!e.ok)throw new Error(e.message);return e.data},I=async({orderId:t,itemId:r,token:e,payload:n})=>{const{data:a}=await p.put(`${l}/public/item/update?token=${e}&orderId=${t}&itemId=${r}`,n);if(!a.ok)throw new Error(a.message);return a.data},c=["owner","CTO","staff"],R=()=>{const{role:t}=s(),r=i(t);return u({mutationFn:async({id:e,payload:n})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await y({id:e,payload:n,api:r})},onSuccess:(e,{id:n})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",n]})}})},N=()=>{const{role:t}=s(),r=i(t);return u({mutationFn:async({id:e,payload:n})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await g({id:e,payload:n,api:r})},onSuccess:(e,{id:n})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",n]})}})},C=()=>{const{role:t}=s(),r=i(t);return u({mutationFn:async({payload:e})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await f({payload:e,api:r})},onSuccess:()=>{o.invalidateQueries({queryKey:["procurement","details"]})}})},x=t=>{const{role:r}=s(),e=i(r);return m({queryKey:["ordermaterial","refId",t],queryFn:async()=>{if(!r||!c.includes(r))throw new Error("Not allowed");if(!e)throw new Error("API instance not found for role");return await h({api:e,projectId:t})},enabled:!!t&&!!r&&!!e})},G=()=>{const{role:t}=s(),r=i(t);return u({mutationFn:async({id:e})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await P({id:e,api:r})},onSuccess:()=>{o.invalidateQueries({queryKey:["procurement","details"]})}})},O=(t,r)=>{const{role:e}=s(),n=i(e);return w({queryKey:["procurement","infinite",t,r],queryFn:async({pageParam:a=1})=>{if(!e||!c.includes(e))throw new Error("Not allowed");if(!n)throw new Error("API instance not found for role");return await E({organizationId:t,api:n,pageParam:a,filters:r})},getNextPageParam:a=>{if(a.hasNextPage)return a.currentPage+1},initialPageParam:1,enabled:!!t&&!!e&&!!n})},L=t=>m({queryKey:["procurement","single",t],queryFn:async()=>await S({id:t}),enabled:!!t,refetchOnMount:!0}),T=()=>{const t=["owner","staff","CTO"],{role:r}=s(),e=i(r);return u({mutationFn:async({id:n})=>{if(!r||!t.includes(r))throw new Error("not allowed to make this api call");if(!e)throw new Error("API instance missing");return await q({id:n,api:e})},onSuccess:(n,{id:a})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",a]})}})},U=()=>{const{role:t}=s(),r=i(t);return u({mutationFn:async({id:e,pdfId:n})=>{if(!t||!c.includes(t))throw new Error("Youre not allowed to delete pdf");if(!r)throw new Error("API instance not available");return await A(e,n,r)},onSuccess:(e,{id:n})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",n]})}})},_=()=>{const t=["owner","staff","CTO"],{role:r}=s(),e=i(r);return u({mutationFn:async({id:n})=>{if(!r||!t.includes(r))throw new Error("Unauthorized");if(!e)throw new Error("API instance not found for role");return await k({id:n,api:e})},onSuccess:()=>{o.invalidateQueries({queryKey:["bills"]})}})},M=()=>{const t=["owner","staff","CTO"],{role:r}=s(),e=i(r);return u({mutationFn:async({orderId:n})=>{if(!r||!t.includes(r))throw new Error("not allowed to make this api call");if(!e)throw new Error("API instance missing");return await b({orderId:n,api:e})},onSuccess:(n,{orderId:a})=>{o.invalidateQueries({queryKey:["procurement","details"]}),o.invalidateQueries({queryKey:["procurement","single",a]})}})},W=(t,r)=>m({queryKey:["procurement","public",t],queryFn:async()=>await v({token:t,orderId:r}),enabled:!!t,retry:!1}),j=()=>u({mutationFn:async({orderId:t,itemId:r,token:e,payload:n})=>await I({token:e,payload:n,orderId:t,itemId:r})});export{C as a,W as b,j as c,L as d,R as e,N as f,T as g,M as h,U as i,_ as j,O as k,G as l,x as u};
