import{u as l}from"./useQuery-BBoMICzh.js";import{u as c}from"./useMutation-DuqS-NT9.js";import{u as d}from"./useInfiniteQuery-Cd2DStse.js";import{u as i,q as a}from"./index-CVfwS1G2.js";import{g as u}from"./roleCheck-DROzFqxW.js";const p=async({expenseData:o,api:t})=>{const{data:e}=await t.post("/department/accounting/expense/create",o);if(!e.ok)throw new Error(e.message);return e.data},w=async({id:o,expenseData:t,api:e})=>{const{data:n}=await e.put(`/department/accounting/expense/update/${o}`,t);if(!n.ok)throw new Error(n.message);return n.data},f=async({id:o,api:t})=>{const{data:e}=await t.delete(`/department/accounting/expense/delete/${o}`);if(!e.ok)throw new Error(e.message);return e},g=async({id:o,api:t})=>{const{data:e}=await t.get(`/department/accounting/expense/getsingle/${o}`);if(!e.ok)throw new Error(e.message);return e.data},y=async({params:o,api:t})=>{const{data:e}=await t.get("/department/accounting/expense/getall",{params:o});if(!e.ok)throw new Error(e.message);return e},q=()=>{const o=["owner","staff","CTO"],{role:t}=i(),e=u(t);return c({mutationFn:async n=>{if(!t||!o.includes(t))throw new Error("Not allowed to create expense");if(!e)throw new Error("API instance not found for role");return await p({expenseData:n,api:e})},onSuccess:n=>{a.invalidateQueries({queryKey:["expenses","list",n.organizationId]}),a.invalidateQueries({queryKey:["expenses","statistics",n.organizationId]})}})},P=()=>{const o=["owner","staff","CTO"],{role:t}=i(),e=u(t);return c({mutationFn:async({id:n,...r})=>{if(!t||!o.includes(t))throw new Error("Not allowed to update expense");if(!e)throw new Error("API instance not found for role");return await w({id:n,expenseData:r,api:e})},onSuccess:(n,r)=>{a.invalidateQueries({queryKey:["expenses","detail",r.id]}),a.invalidateQueries({queryKey:["expenses","list",n.organizationId]}),a.invalidateQueries({queryKey:["expenses","statistics",n.organizationId]})}})},v=()=>{const o=["owner","staff","CTO"],{role:t}=i(),e=u(t);return c({mutationFn:async({id:n,_organizationId:r})=>{if(!t||!o.includes(t))throw new Error("Not allowed to delete expense");if(!e)throw new Error("API instance not found for role");return await f({id:n,api:e})},onSuccess:(n,r)=>{a.invalidateQueries({queryKey:["expenses","detail",r.id]}),a.invalidateQueries({queryKey:["expenses","list",r._organizationId]}),a.invalidateQueries({queryKey:["expenses","statistics",r._organizationId]})}})},K=(o,t=!0)=>{const e=["owner","staff","CTO"],{role:n}=i(),r=u(n);return l({queryKey:["expenses","detail",o],queryFn:async()=>{if(!n||!e.includes(n))throw new Error("Not allowed to view expense");if(!r)throw new Error("API instance not found for role");return await g({id:o,api:r})},enabled:t&&!!o&&!!n&&!!r})},Q=(o,t=!0)=>{const e=["owner","staff","CTO"],{role:n}=i(),r=u(n);return d({queryKey:["expenses","list",o.organizationId,o],queryFn:async({pageParam:s=1})=>{if(!n||!e.includes(n))throw new Error("Not allowed to view expenses");if(!r)throw new Error("API instance not found for role");return await y({params:{...o,page:s},api:r})},getNextPageParam:s=>s.pagination.hasNextPage?s.pagination.page+1:void 0,getPreviousPageParam:s=>s.pagination.hasPrevPage?s.pagination.page-1:void 0,initialPageParam:1,enabled:t&&!!o.organizationId&&!!n&&!!r})};export{v as a,q as b,P as c,K as d,Q as u};
