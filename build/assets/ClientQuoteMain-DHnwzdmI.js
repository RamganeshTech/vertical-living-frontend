import{a as C,j as e,B as N,t as w,u as F,r as p,b as P,f as _,O as D,M as E}from"./index-hYGmCEO1.js";import{u as L}from"./projectApi-Gwage_AH.js";import{C as O,a as B}from"./Card-ChYAICVg.js";import{d as z,f as G}from"./dateFormator-BGKi5rfZ.js";import{u as M,a as R}from"./clientQuoteApi-DtVstmmO.js";import{S as T}from"./StageGuide-BKWoPeLK.js";const V=({quote:t,canDelete:a})=>{var m,c;const n=C(),{mutateAsync:x,isPending:l}=M(),f=async j=>{var u,o;try{await x({id:j}),w({title:"Success",description:"Items deleted successfully"})}catch(r){console.log("error",r),w({title:"Error",description:((o=(u=r==null?void 0:r.response)==null?void 0:u.data)==null?void 0:o.message)??"Operation failed"})}};return e.jsx(O,{className:"w-full border-l-4 border-blue-600 shadow-md bg-white hover:shadow-lg transition-all",children:e.jsxs(B,{className:"p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"my-1",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-700 ",children:["Project: ",e.jsx("span",{className:"text-black",children:((m=t==null?void 0:t.projectId)==null?void 0:m.projectName)||"Project"})]}),e.jsxs("span",{className:"text-[12px] font-semibold text-gray-500",children:["Quote No: ",e.jsx("span",{className:"text-black",children:t.quoteNo||"N/A"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 ",children:["Created on: ",z(t.createdAt)," - ",G(t.createdAt)]})]}),e.jsx("i",{className:"fas fa-file-alt text-gray-400 text-xl"})]}),e.jsxs("p",{className:"text-sm text-gray-500 italic",children:[e.jsx("strong",{children:"Furnitures: "})," ",((c=t.furnitures)==null?void 0:c.length)||0]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsxs(N,{size:"sm",variant:"secondary",onClick:()=>n(`single/${t._id}`),children:[e.jsx("i",{className:"fas fa-eye mr-1"})," View"]}),a&&e.jsxs(N,{size:"sm",isLoading:l,variant:"danger",className:"bg-red-600 text-white",onClick:()=>f(t._id),children:[e.jsx("i",{className:"fas fa-trash mr-1"})," Delete"]})]})]})})},X=()=>{var y,v;const{organizationId:t}=F(),[a,n]=p.useState({projectId:"",projectName:"",createdAt:""}),{role:x,permission:l}=P(),f=x==="owner"||((y=l==null?void 0:l.clientquote)==null?void 0:y.list),m=x==="owner"||((v=l==null?void 0:l.clientquote)==null?void 0:v.delete),[c,j]=p.useState(""),[u,o]=p.useState(""),{data:r}=L(t),i=r==null?void 0:r.map(s=>({_id:s._id,projectName:s.projectName})),k=C(),{data:h,isLoading:A}=R(t,{createdAt:a.createdAt,projectId:a.projectId,quoteNo:u}),I=_(),Q=()=>{k("../quotevariant")},S=()=>{n({projectId:"",projectName:"",createdAt:""})},b=Object.values(a).filter(Boolean).length;return I.pathname.includes("single")?e.jsx(D,{}):e.jsxs("div",{className:"p-2 max-h-full overflow-y-auto  min-h-full",children:[e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("i",{className:"fas fa-file-invoice text-4xl text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Quotes for Clients"})]}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(T,{organizationId:t,stageName:"materialquote"})})]}),e.jsxs("main",{className:"flex gap-2 !max-h-[87%]",children:[e.jsx("div",{className:"xl:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),b>0&&e.jsxs("button",{onClick:S,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",b,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search By Quote No"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search and Press Enter",value:c,autoFocus:!0,onChange:s=>j(s.target.value),onKeyDown:s=>{s.key==="Enter"&&o(c)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx(N,{onClick:()=>o(c),className:"bg-blue-600 text-white px-4 py-2 rounded",children:e.jsx("i",{className:"fas fa-search",children:" "})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Created Date"}),e.jsx("input",{type:"date",onChange:s=>n(d=>({...d,createdAt:s.target.value})),value:a.createdAt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Project"}),e.jsx("select",{value:(a==null?void 0:a.projectId)||"",onChange:s=>{const d=i==null?void 0:i.find(g=>g._id===s.target.value);d&&n(g=>({...g,projectId:d._id,projectName:d.projectName}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:i==null?void 0:i.map(s=>e.jsx("option",{value:s._id,children:s.projectName},s._id))})]})]})]})}),f&&e.jsx("section",{className:"w-full max-h-full  gap-2  overflow-y-auto  min-h-full",children:A?e.jsx("p",{children:e.jsx(E,{})}):h!=null&&h.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map(s=>e.jsx(e.Fragment,{children:e.jsx(V,{canDelete:m,quote:s,organizationId:t},s._id)}))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center text-gray-700",children:[e.jsx("i",{className:"fas fa-file-circle-exclamation text-gray-300 text-7xl mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"No Quotes Found"}),e.jsxs("p",{className:"text-base text-gray-500 leading-relaxed max-w-md",children:["You haven't generated any quote for clients yet.",e.jsx("br",{}),"Please create a quote from the",e.jsx("span",{className:"font-semibold text-blue-600 cursor-pointer",onClick:Q,children:" Quote Varient "}),"section to view for clients."]})]})})]})]})};export{X as default};
