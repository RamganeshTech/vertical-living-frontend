import{a as D,j as e,B as v,t as w,u as F,k as S,r as C,d as A,O as P,M as E}from"./index-BAM0eJUz.js";import{u as O}from"./projectApi-D7-uwdh2.js";import{C as L,a as R}from"./Card-CdxfjEr-.js";import{d as M,f as z}from"./dateFormator-BGKi5rfZ.js";import{b as B,c as G}from"./clientQuoteApi-B0Dnhpm6.js";import{S as U}from"./StageGuide-e28gQ0h1.js";import{u as j}from"./useDebounce-DSMcRuVp.js";import{Q as V}from"./CreateQuoteModal-C4nTcKOM.js";import"./SearchSelectNew-IGAHiELy.js";import"./Label-C8i6KaZe.js";import"./Input-1UBXZqEj.js";import"./Select-C6lfB9t-.js";const Y=({quote:s,canDelete:x})=>{var r,o;const n=D(),{mutateAsync:p,isPending:f}=B(),a=async m=>{var d,u;try{await p({id:m}),w({title:"Success",description:"Items deleted successfully"})}catch(c){console.log("error",c),w({title:"Error",description:((u=(d=c==null?void 0:c.response)==null?void 0:d.data)==null?void 0:u.message)??"Operation failed"})}};return e.jsx(L,{className:"w-full border-l-4 border-blue-600 shadow-sm bg-white hover:shadow-md transition-all",children:e.jsxs(R,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3 gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 space-y-0.5",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[(s==null?void 0:s.quoteType)&&e.jsx("span",{className:"bg-blue-50 text-blue-700 text-[9px] font-bold px-1.5 py-0.5 rounded uppercase flex-shrink-0",children:s==null?void 0:s.quoteType}),e.jsx("h3",{className:"text-sm font-bold text-gray-900 break-words leading-tight",children:(s==null?void 0:s.mainQuoteName)||"Unnamed Quote"})]}),e.jsxs("p",{className:"text-[12px] font-medium text-blue-600 flex items-center gap-1 truncate",children:[e.jsx("i",{className:"fas fa-project-diagram text-[10px]"}),e.jsx("span",{className:"truncate",children:((r=s==null?void 0:s.projectId)==null?void 0:r.projectName)||"No Project"})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase leading-none",children:"Quote No"}),e.jsx("p",{className:"text-xs font-black text-gray-800 whitespace-nowrap",children:s.quoteNo||"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 py-2 border-y border-gray-50 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase tracking-tight",children:"Internal Quote No"}),e.jsx("p",{className:"text-[11px] font-semibold text-gray-700",children:((o=s==null?void 0:s.quoteId)==null?void 0:o.quoteNo)||"N/A"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase tracking-tight",children:"Created"}),e.jsxs("p",{className:"text-[10px] text-gray-600 font-semibold mt-1",children:[M(s.createdAt),e.jsx("span",{className:"text-gray-300 mx-0.5",children:"|"}),z(s.createdAt)]})]})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs("div",{className:"flex gap-1.5",children:[e.jsxs(v,{size:"sm",variant:"secondary",className:"h-7 px-2.5 text-[11px] font-bold",onClick:()=>n(`single/${s._id}/${s==null?void 0:s.quoteType}`),children:[e.jsx("i",{className:"fas fa-eye mr-1"})," View"]}),x&&e.jsxs(v,{size:"sm",isLoading:f,variant:"danger",className:"h-7 px-2.5 text-[11px] font-bold bg-red-50 text-red-600 hover:bg-red-600 hover:text-white border-none transition-colors",onClick:()=>a(s._id),children:[e.jsx("i",{className:"fas fa-trash mr-1"})," Delete"]})]})})]})})},re=()=>{var N,y;const{organizationId:s}=F(),{role:x,permission:n}=S(),p=x==="owner"||((N=n==null?void 0:n.clientquote)==null?void 0:N.list),f=x==="owner"||((y=n==null?void 0:n.clientquote)==null?void 0:y.delete),[a,r]=C.useState({projectId:"",projectName:"",startDate:"",endDate:"",quoteType:"",search:""}),o=j(a.search,800),m=j(a.startDate,800),d=j(a.endDate,800),u=C.useMemo(()=>({projectId:a.projectId,startDate:m,endDate:d,quoteType:a.quoteType,search:o}),[a.projectId,a.startDate,a.endDate,o,d,m,a.quoteType]),{data:c}=O(s),i=c==null?void 0:c.map(t=>({_id:t._id,projectName:t.projectName})),k=D(),{data:h,isLoading:Q}=G(s,u),T=A(),I=()=>{k("../quotevariant")},_=()=>{r({projectId:"",projectName:"",startDate:"",endDate:"",quoteType:"",search:""})},b=Object.values(a).filter(Boolean).length;return T.pathname.includes("single")?e.jsx(P,{}):e.jsxs("div",{className:"p-2 max-h-full overflow-y-auto  min-h-full",children:[e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("i",{className:"fas fa-file-invoice text-4xl text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Quotes for Clients"})]}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(U,{organizationId:s,stageName:"materialquote"})})]}),e.jsxs("main",{className:"flex gap-4 w-full h-[calc(100vh-99px)] overflow-hidden",children:[e.jsx("section",{className:"xl:w-80 flex-shrink-0  h-full overflow-y-auto ",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),b>0&&e.jsxs("button",{onClick:_,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",b,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsx("input",{type:"text",placeholder:"Search Quote No, Quote Name",value:a.search,autoFocus:!0,onChange:t=>r(l=>({...l,search:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quote Type"}),e.jsxs("select",{value:a.quoteType||"",onChange:t=>r(l=>({...l,quoteType:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Type"}),V.map(t=>e.jsx("option",{value:t,children:t==="sqft_rate"?"Sqft Rate":t[0].toUpperCase()+t.slice(1)},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Project"}),e.jsx("select",{value:(a==null?void 0:a.projectId)||"",onChange:t=>{const l=i==null?void 0:i.find(g=>g._id===t.target.value);l&&r(g=>({...g,projectId:l._id,projectName:l.projectName}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:i==null?void 0:i.map(t=>e.jsx("option",{value:t._id,children:t.projectName},t._id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 mb-1 block",children:"From"}),e.jsx("input",{type:"date",value:a.startDate,onChange:t=>r(l=>({...l,startDate:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 mb-1 block",children:"To"}),e.jsx("input",{type:"date",value:a.endDate,onChange:t=>r(l=>({...l,endDate:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]})]})]})]})]})}),p&&e.jsx("section",{className:"flex-1 h-full overflow-y-auto custom-scrollbar pb-10",children:Q?e.jsx("p",{children:e.jsx(E,{})}):h!=null&&h.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map(t=>e.jsx(e.Fragment,{children:e.jsx(Y,{canDelete:f,quote:t,organizationId:s},t._id)}))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center text-gray-700",children:[e.jsx("i",{className:"fas fa-file-circle-exclamation text-gray-300 text-7xl mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"No Quotes Found"}),e.jsxs("p",{className:"text-base text-gray-500 leading-relaxed max-w-md",children:["You haven't generated any quote for clients yet.",e.jsx("br",{}),"Please create a quote from the",e.jsx("span",{className:"font-semibold text-blue-600 cursor-pointer",onClick:I,children:" Quote Varient "}),"section to view for clients."]})]})})]})]})};export{re as default};
