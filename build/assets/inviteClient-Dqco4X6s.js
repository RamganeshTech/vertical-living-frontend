import{b as F,r as g,p as O,d as P,j as e,B as n,I as B,t as c}from"./index-DyM6T-eT.js";import{L as M}from"./Label-B3hr6461.js";import{A as T,a as U}from"./Avatar-CctcYsce.js";import{s as $,t as R}from"./orgApi-B3bj4ehF.js";import{S as W}from"./StageGuide-DzUcb6ZB.js";const H=()=>{var b,v,N;const{projectId:x,organizationId:o}=F(),[r,w]=g.useState(""),[y,m]=g.useState(!1),{openMobileSidebar:k,isMobile:C}=O(),h=$(),{data:t,isLoading:I,isError:L}=R(o,x),{role:d,permission:a}=P(),S=d==="owner"||((b=a==null?void 0:a.inviteclient)==null?void 0:b.list),f=d==="owner"||((v=a==null?void 0:a.inviteclient)==null?void 0:v.create),p=d==="owner"||((N=a==null?void 0:a.inviteclient)==null?void 0:N.edit),u=async()=>{var s,i;try{const l=await h.mutateAsync({projectId:x,organizationId:o});w(l.inviteLink||l),c({title:"Success",description:"Invitation link generated successfully"})}catch(l){c({title:"Error",description:((i=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to generate invitation link",variant:"destructive"})}},j=async()=>{try{await navigator.clipboard.writeText(r),m(!0),c({title:"Success",description:"Link copied to clipboard"}),setTimeout(()=>m(!1),2e3)}catch{c({title:"Error",description:"Failed to copy link",variant:"destructive"})}},A=()=>{const s=`You're invited to join in the project! Click this link to register: ${r}`,i=`https://wa.me/?text=${encodeURIComponent(s)}`;window.open(i,"_blank")},G=s=>{var i,l;return(l=(i=s==null?void 0:s.split(" ").map(E=>E[0]))==null?void 0:i.join(""))==null?void 0:l.toUpperCase()};return e.jsxs("div",{className:"min-h-full min-w-full ",children:[e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"max-w-full mx-auto",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 min-w-0 flex-1",children:[C&&e.jsx("button",{onClick:k,className:"mr-3 p-2 rounded-md border border-gray-300 hover:bg-gray-100",title:"Open Menu",children:e.jsx("i",{className:"fa-solid fa-bars "})}),e.jsx("div",{className:"hidden sm:block  w-px bg-gray-300 flex-shrink-0"}),e.jsx("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:e.jsx("div",{className:"min-w-0 flex-1",children:e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-blue-600 truncate",children:[e.jsx("i",{className:"fas fa-user-plus mr-1"}),"Invite Client"]})})})]}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(W,{organizationId:o,stageName:"inviteclient"})})]})})}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 w-full ",children:[e.jsx("div",{className:"flex-1 border-l-4 border-blue-600  bg-white p-4 max-h-[45vh]  h-fit overflow-y-auto rounded-2xl shadow-lg space-y-6 flex flex-col justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-600 mb-2 flex items-center",children:"Generate Client"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Invite a client by generating a link."}),r?e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{children:"Invitation Link"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{value:r,readOnly:!0,className:"bg-blue-50 text-blue-800 flex-1"}),e.jsx(n,{onClick:j,children:e.jsx("i",{className:`fas ${y?"fa-check":"fa-copy"}`})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{onClick:A,className:"w-full bg-green-600 text-white",children:[e.jsx("i",{className:"fab fa-whatsapp mr-2"})," Share on WhatsApp"]}),e.jsxs(n,{onClick:j,className:"w-full border border-blue-400 text-blue-700",children:[e.jsx("i",{className:"fas fa-copy mr-2"})," Copy"]})]}),(f||p)&&e.jsxs(n,{onClick:u,className:"w-full bg-purple-600 text-white",children:[e.jsx("i",{className:"fas fa-sync-alt mr-2"})," Generate New Link"]})]}):e.jsx(e.Fragment,{children:(f||p)&&e.jsxs(n,{onClick:u,isLoading:h.isPending,className:"w-full bg-blue-600 text-white py-3",children:[e.jsx("i",{className:"fas fa-link mr-2"})," Generate Invitation Link"]})})]})}),S&&e.jsxs("div",{className:"flex-1 bg-white border-2 border-blue-200 p-6 rounded-2xl shadow-lg py-4 max-h-[70vh] sm:!max-h-[63vh] md:!max-h-[100vh]  lg:!max-h-[85vh] xl:!max-h-[90vh] overflow-y-auto custom-scrollbar",children:[e.jsxs("h2",{className:"text-2xl font-bold text-blue-600 mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-users mr-2"})," Clients (",(t==null?void 0:t.length)||0,")"]}),I?e.jsx("p",{className:"text-blue-700",children:"Loading clients..."}):L?e.jsx("p",{className:"text-red-600",children:"Failed to get clients."}):(t==null?void 0:t.length)===0?e.jsxs("div",{className:"text-center text-blue-700 p-8",children:[e.jsx("i",{className:"fas fa-user-slash text-3xl mb-2"}),e.jsx("p",{children:"No clients have been added yet."}),e.jsx("p",{className:"text-sm",children:"Generate a link to invite them."})]}):e.jsx("div",{className:"space-y-4 h-[85%]",children:t==null?void 0:t.map(s=>e.jsx("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-xl border border-blue-100 hover:shadow-md transition",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(T,{className:"w-12 h-12",children:e.jsx(U,{className:"bg-blue-600 text-white font-bold",children:G(s.clientName)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-blue-900 font-semibold",children:s.clientName}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("i",{className:"fas fa-envelope mr-1"})," ",s.email]}),s.phoneNo&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("i",{className:"fas fa-phone-alt mr-1"})," ",s.phoneNo]})]})]})},s._id))})]})]})]})};export{H as default};
