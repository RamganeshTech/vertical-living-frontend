import{u as k,b as w,r as i,j as e}from"./index-CDrefmTi.js";import{t as o}from"./toast-BSC5QTk1.js";import{B as p}from"./Button-DSSReI3J.js";import{I as C}from"./Input-CPiWRP1E.js";import{c as L,d as E}from"./subContractNewApi-DJhJQ3XQ.js";import{S as I}from"./SubContractForm-sfLW2AgD.js";import{L as F}from"./Label-CTVXvCEn.js";import{S as $,a as B,b as T,c as V,d as z}from"./Select-BPjP5o4V.js";import"./useQuery-Dbv1d8R2.js";import"./useMutation-DXlA4CUQ.js";import"./useInfiniteQuery-CfZbtSpd.js";import"./roleCheck-CvMnicJf.js";import"./Card-CdzBsyOK.js";import"./projectApi-PzMeRQVG.js";import"./SearchSelectNew-CCvIu55n.js";import"./ImageGalleryMain-BWJvdnrc.js";import"./constants-ZBpAFlne.js";import"./downloadFile-CBpB5eci.js";import"./index-BseSj5kb.js";const te=()=>{const f=k(),{organizationId:x,subContractId:l}=w(),{data:t,isLoading:h,isError:j,refetch:c}=L({subContractId:l}),[g,n]=i.useState(!1),[r,S]=i.useState(""),[d,v]=i.useState((t==null?void 0:t.status)||"pending");i.useEffect(()=>{if(t){const s=`https://houseofram.in/subcontract/share/${t._id}?token=${t.token}`;S(s),t!=null&&t.status&&v(t.status)}},[t]);const b=()=>{navigator.clipboard.writeText(r),n(!0),o({title:"Copied!",description:"Link copied to clipboard"}),setTimeout(()=>n(!1),2e3)},{mutateAsync:y}=E(),N=async s=>{var m,u;try{await y({subContractId:l,status:s}),c(),o({title:"Success",description:"status successfully"})}catch(a){o({title:"Error",description:((u=(m=a==null?void 0:a.response)==null?void 0:m.data)==null?void 0:u.message)||(a==null?void 0:a.message)||"Failed to upload files",variant:"destructive"})}};return h?e.jsx("div",{children:"Loading subcontract details..."}):j||!t?e.jsx("div",{children:"Error loading data. Please try again."}):e.jsxs("div",{className:"space-y-6 max-h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between gap-2 items-center",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(p,{variant:"outline",size:"icon",onClick:()=>f(-1),children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sub Contract Details"})]}),e.jsxs($,{value:d,onValueChange:s=>{N(s)},children:[e.jsx(B,{className:"w-full bg-white",children:e.jsx(T,{placeholder:"Select Status",selectedValue:d.toString()})}),e.jsx(V,{children:["pending","accepted","rejected"].map(s=>e.jsx(z,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"max-w-full mx-auto space-y-8",children:[e.jsx(I,{organizationId:x,mode:"view",initialData:t,refetch:c}),r&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{children:"Form Link"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[e.jsx(C,{value:r,readOnly:!0,className:"bg-blue-50 text-blue-800 flex-1"}),e.jsx(p,{onClick:b,className:"w-full sm:w-auto",children:e.jsx("i",{className:`fas ${g?"fa-check":"fa-copy"}`})})]})]})]})]})};export{te as default};
