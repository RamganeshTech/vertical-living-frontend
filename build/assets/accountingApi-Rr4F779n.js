import{f as u,b as d,i as m}from"./index-BAM0eJUz.js";import{u as p}from"./useInfiniteQuery-BGz0VllC.js";const g=["owner","CTO","staff"],w=async({organizationId:a,api:e,filters:n,pageParam:t=1})=>{const o={organizationId:a,page:t,limit:20};n!=null&&n.projectId&&(o.projectId=n.projectId),n!=null&&n.status&&(o.status=n.status),n!=null&&n.search&&(o.search=n.search),n!=null&&n.fromDept&&(o.deptRecordFrom=n.fromDept),n!=null&&n.startDate&&(o.startDate=n.startDate),n!=null&&n.endDate&&(o.endDate=n.endDate),(n==null?void 0:n.minAmount)!==void 0&&(o.minAmount=n.minAmount),(n==null?void 0:n.maxAmount)!==void 0&&(o.maxAmount=n.maxAmount),n!=null&&n.personName&&(o.personName=n.personName);const{data:c}=await e.get("/department/accounting/getaccountingall",{params:o});if(!c.ok)throw new Error(c.message||"Failed to fetch records");return c},A=async({id:a,api:e})=>{const{data:n}=await e.get(`/department/accounting/single/${a}`);if(!n.success&&!n.ok)throw new Error(n.message||"Failed to fetch record");return n},D=(a,e)=>{const{role:n}=u(),t=m(n);return p({queryKey:["accounting","infinite",a,e],queryFn:async({pageParam:o=1})=>{if(!n||!g.includes(n))throw new Error("Not allowed");if(!t)throw new Error("API instance not found for role");return await w({organizationId:a,api:t,filters:e,pageParam:o})},initialPageParam:1,getNextPageParam:o=>{const{page:c,totalPages:r}=o.pagination;return c<r?c+1:void 0},enabled:!!a&&!!n&&!!t})},s=a=>{const{role:e}=u(),n=m(e);return d({queryKey:["accounting","single",a],queryFn:async()=>{if(!e||!g.includes(e))throw new Error("Not allowed");if(!n)throw new Error("API instance not found for role");return await A({id:a,api:n})},enabled:!!a&&!!e&&!!n})};export{s as a,D as u};
