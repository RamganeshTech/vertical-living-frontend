import{b as E,r as x,c as L,j as e}from"./index-By5P0A7l.js";import{B as u}from"./Button-DLUK8O0t.js";import{L as t}from"./Label-TAdUzpu-.js";import{S as B}from"./SearchSelectNew-B6SBCGTt.js";import{u as M}from"./getAllUsersApi-CvFDPW6g.js";const V=({mode:w,initialData:a,organizationId:y,isSubmitting:g,onSubmit:C})=>{var v;const p=E(),[c,f]=x.useState(w),{role:R,permission:h}=L(),k=R==="owner"||((v=h==null?void 0:h.tools)==null?void 0:v.edit),{data:I=[]}=M(y,"staff"),b=(I||[]).map(s=>({value:s._id,label:s.staffName,email:s.email,role:s.role})),S=s=>{const i=b.find(o=>o.value===s);d(i?o=>({...o,inchargeUser:i.value,inchargeRole:i.role}):o=>({...o,inchargeUser:"",inchargeRole:""}))},[l,d]=x.useState({toolRoomName:"",location:"",inchargeUser:"",inchargeRole:"staff",allowedIssueFrom:"09:00",allowedIssueTo:"18:00",isActive:!0});x.useEffect(()=>{var s;a&&d({toolRoomName:a.toolRoomName||"",location:a.location||"",inchargeUser:((s=a.inchargeUser)==null?void 0:s._id)||"",inchargeRole:a.inchargeRole||"staff",allowedIssueFrom:a.allowedIssueFrom||"09:00",allowedIssueTo:a.allowedIssueTo||"18:00",isActive:a.isActive??!0})},[a,c]);const n=s=>{const{name:i,value:o,type:T}=s.target,F=T==="checkbox"?s.target.checked:o;d(U=>({...U,[i]:F}))},r=c==="view",m=c==="create",j=c==="edit",N=()=>f(s=>s==="view"?"edit":"view"),A=async s=>{s.preventDefault(),await C(l),c==="edit"&&f("view")};return e.jsxs("div",{className:"max-w-full min-h-[80vh] mx-auto space-y-4",children:[e.jsxs("header",{className:"sticky px-4 top-0 z-20 bg-white border-b border-gray-200 pb-4 pt-2 mb-6 flex justify-between items-center rounded-b-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>p(-1),className:"bg-blue-50 hover:bg-blue-100 flex items-center justify-center w-9 h-9 border border-blue-200 text-blue-600 cursor-pointer rounded-lg",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:m?"Add Tool Room":j?"Update Room":"Room Overview"}),e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Physical Storage Location"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[r&&k&&e.jsxs(u,{type:"button",onClick:N,variant:"outline",className:"border-blue-600 text-blue-600",children:[e.jsx("i",{className:"fas fa-edit mr-2"}),"Edit Room"]}),(m||j)&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{type:"button",onClick:A,disabled:g,className:"bg-blue-600 text-white",children:[g?e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}):e.jsx("i",{className:"fas fa-save mr-2"}),m?"Create Room":"Save Changes"]}),e.jsx(u,{variant:"outline",type:"button",onClick:()=>m?p(-1):N(),className:"bg-white",children:"Cancel"})]})]})]}),e.jsxs("form",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("h3",{className:"text-sm font-black text-blue-600 uppercase tracking-widest mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-warehouse mr-2"})," Room Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Tool Room Name"}),e.jsx("input",{name:"toolRoomName",value:l.toolRoomName,onChange:n,disabled:r,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none mt-1",placeholder:"e.g., Central Site Store"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Location / Landmark"}),e.jsx("input",{name:"location",value:l.location,onChange:n,disabled:r,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none mt-1",placeholder:"e.g., Block A, Basement"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("h3",{className:"text-sm font-black text-blue-600 uppercase tracking-widest mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-clock mr-2"})," Issue & Return Timings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Allowed From"}),e.jsx("input",{type:"time",name:"allowedIssueFrom",value:l.allowedIssueFrom,onChange:n,disabled:r,className:"w-full px-3 py-2 border rounded-lg mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Allowed To"}),e.jsx("input",{type:"time",name:"allowedIssueTo",value:l.allowedIssueTo,onChange:n,disabled:r,className:"w-full px-3 py-2 border rounded-lg mt-1"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("h3",{className:"text-sm font-black text-blue-600 uppercase tracking-widest mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-user-shield mr-2"})," Personnel In-Charge"]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{className:"text-gray-700 font-semibold flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-user-check text-blue-600 text-xs"}),"Select Assigned In-Charge"]}),e.jsx(B,{options:b,placeholder:"Choose staff member",searchPlaceholder:"Search by name...",value:l.inchargeUser,onValueChange:S,searchBy:"name",displayFormat:"detailed",className:"w-full"})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(t,{className:"text-sm font-bold",children:"Operating Status"}),e.jsx("p",{className:"text-[10px] text-gray-500",children:"Toggle off to temporarily close this room"})]}),e.jsx("input",{type:"checkbox",name:"isActive",checked:l.isActive,onChange:n,disabled:r,className:"w-5 h-5 accent-blue-600 cursor-pointer"})]})})]})]})]})};export{V as T};
