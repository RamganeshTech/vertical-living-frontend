import{d as w,j as e,B as C,c as M,e as z,b as B,r as b,O,t as y}from"./index-DyM6T-eT.js";import{u as $}from"./useDebounce-DXaYFH0W.js";import{u as R,a as G}from"./toolMasterApi-B0EJUK0H.js";import{B as H}from"./Breadcrumb-BBilgyXa.js";const V=({tool:t,onView:i,onDelete:o})=>{var x,c,l;const d={available:"bg-green-100 text-green-700 border-green-200",issued:"bg-blue-100 text-blue-700 border-blue-200",repair:"bg-orange-100 text-orange-700 border-orange-200",missing:"bg-red-100 text-red-700 border-red-200"},{role:r,permission:n}=w(),m=r==="owner"||((x=n==null?void 0:n.toolhardware)==null?void 0:x.delete);return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm hover:shadow-md transition-shadow group",children:[e.jsxs("div",{className:"h-40 bg-gray-100 relative overflow-hidden",children:[(l=(c=t.toolImages)==null?void 0:c[0])!=null&&l.url?e.jsx("img",{src:t.toolImages[0].url,alt:t.toolName,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300",children:e.jsx("i",{className:"fas fa-tools text-4xl"})}),e.jsx("div",{className:`absolute top-3 right-3 px-2 py-1 rounded-md text-[10px] font-bold uppercase border ${d[t.availabilityStatus]}`,children:t.availabilityStatus}),e.jsx("div",{className:"absolute bottom-3 left-3 px-2 py-0.5 bg-black/60 text-white text-[10px] font-mono rounded backdrop-blur-sm",children:t.toolCode})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"font-bold text-gray-900 truncate",children:t.toolName}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.brand," â€¢ ",t.toolCategory]})]}),e.jsxs("div",{className:"space-y-2 border-t pt-3",children:[e.jsxs("div",{className:"flex justify-between text-[11px]",children:[e.jsx("span",{className:"text-gray-400",children:"Serial No:"}),e.jsx("span",{className:"font-medium text-gray-700",children:t.serialNumber})]}),e.jsxs("div",{className:"flex justify-between text-[11px]",children:[e.jsx("span",{className:"text-gray-400",children:"Condition:"}),e.jsx("span",{className:`font-bold capitalize ${t.conditionStatus==="repair"?"text-red-500":"text-gray-700"}`,children:t.conditionStatus})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(C,{onClick:i,variant:"outline",className:"flex-1 py-1 h-8 text-xs",children:"Details"}),m&&e.jsx("button",{onClick:o,className:"p-2 text-gray-400 hover:text-red-600 transition-colors",children:e.jsx("i",{className:"fas fa-trash-alt"})})]})]})]})},_=["Drill","Saw","Grinder","Cutter","Laser Level","Other"],Y=["available","issued","repair","missing"],U=()=>{var v,N;const t=M(),i=z(),{organizationId:o}=B(),{role:d,permission:r}=w(),n=d==="owner"||((v=r==null?void 0:r.toolhardware)==null?void 0:v.list),m=d==="owner"||((N=r==null?void 0:r.toolhardware)==null?void 0:N.create),x=i.pathname.includes("single")||i.pathname.includes("create")||i.pathname.includes("issueotp"),c=b.useRef(null),[l,u]=b.useState({search:"",toolCategory:"",conditionStatus:"",availabilityStatus:"",minPrice:"",maxPrice:""}),S=$(l.search,700),{data:h,isLoading:T,fetchNextPage:g,hasNextPage:p,isFetchingNextPage:f}=R({organizationId:o,...l,toolName:S}),k=G();b.useEffect(()=>{const s=c.current;if(!s)return;const a=()=>{const{scrollTop:I,scrollHeight:P,clientHeight:F}=s;P-I-F<100&&p&&!f&&g()};return s.addEventListener("scroll",a),()=>s.removeEventListener("scroll",a)},[p,f,g]);const A=async s=>{if(window.confirm("Delete this tool from the registry?"))try{await k.mutateAsync(s),y({title:"Deleted",description:"Tool removed successfully"})}catch(a){y({title:"Error",description:a.message,variant:"destructive"})}},D=()=>{u({search:"",toolCategory:"",conditionStatus:"",availabilityStatus:"",minPrice:"",maxPrice:""})},L=Object.values(l).filter(s=>s!=="").length,j=(h==null?void 0:h.pages.flatMap(s=>s.data))||[],E=[{label:"Tools & Hardware",path:`/organizations/${o}/projects/toolhub`},{label:"Tool Master",path:`/organizations/${o}/projects/toolmain`}];return x?e.jsx(O,{}):e.jsxs("div",{className:"h-full flex flex-col p-2",children:[e.jsxs("header",{className:"flex border-b border-gray-400 justify-between items-center mb-3 px-1 shrink-0",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-tools mr-3 text-blue-600"}),"Tool Master"]}),e.jsx(H,{paths:E})]}),e.jsx("div",{className:"flex gap-2 items-center",children:m&&e.jsxs(C,{onClick:()=>t("create"),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 shadow-md",children:[e.jsx("i",{className:"fas fa-plus"}),"Create Tool"]})})]}),e.jsxs("main",{className:"flex gap-6 flex-1 overflow-hidden",children:[e.jsx("aside",{className:"xl:w-72 w-64 flex-shrink-0 overflow-y-auto custom-scrollbar pb-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-5 border border-gray-100 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),L>0&&e.jsx("button",{onClick:D,className:"text-sm text-blue-600 cursor-pointer hover:text-blue-800 font-medium",children:"Clear All"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsx("input",{type:"text",placeholder:"Tool name, Serial No...",value:l.search,autoFocus:!0,onChange:s=>u(a=>({...a,search:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tool Category"}),e.jsxs("select",{value:l.toolCategory,onChange:s=>u(a=>({...a,toolCategory:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white outline-none",children:[e.jsx("option",{value:"",children:"All Categories"}),_.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Availability"}),e.jsxs("select",{value:l.availabilityStatus,onChange:s=>u(a=>({...a,availabilityStatus:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white outline-none",children:[e.jsx("option",{value:"",children:"All Status"}),Y.map(s=>e.jsx("option",{value:s,className:"capitalize",children:s},s))]})]})]})]})}),n&&e.jsx("section",{className:"flex-1 flex flex-col overflow-hidden",children:e.jsxs("div",{ref:c,className:"flex-1 overflow-y-auto custom-scrollbar pr-2",children:[T?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-3xl text-blue-600"})}):j.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 bg-white rounded-xl border border-dashed border-gray-300",children:[e.jsx("i",{className:"fas fa-box-open text-5xl mb-4 opacity-20"}),e.jsx("p",{children:"No tools found matching your criteria"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:j.map(s=>e.jsx(V,{tool:s,onDelete:()=>A(s._id),onView:()=>t(`single/${s._id}`)},s._id))}),f&&e.jsxs("div",{className:"py-4 text-center text-blue-600 font-medium text-sm",children:[e.jsx("i",{className:"fas fa-circle-notch fa-spin mr-2"})," Fetching more..."]})]})})]})]})};export{U as default};
