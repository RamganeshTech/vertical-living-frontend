import{u as d}from"./useQuery-DD9aZBjN.js";import{u as i}from"./useInfiniteQuery-4I03x6LQ.js";import{c as u}from"./index-C1DtYOG4.js";import{g}from"./roleCheck-vyRiFK58.js";const s=["owner","CTO","staff"],m=async({organizationId:o,api:t,filters:n,search:a,pageParam:r=1})=>{const e={organizationId:o,page:r,limit:20};n!=null&&n.projectId&&(e.projectId=n.projectId),n!=null&&n.fromDept&&(e.deptRecordFrom=n.fromDept),n!=null&&n.status&&(e.status=n.status),n!=null&&n.startDate&&(e.startDate=n.startDate),n!=null&&n.endDate&&(e.endDate=n.endDate),a&&(e.personName=a);const{data:c}=await t.get("/department/accounting/getaccountingall",{params:e});if(!c.success&&!c.ok)throw new Error(c.message||"Failed to fetch records");return c},w=async({id:o,api:t})=>{const{data:n}=await t.get(`/department/accounting/single/${o}`);if(!n.success&&!n.ok)throw new Error(n.message||"Failed to fetch record");return n},h=(o,t,n)=>{const{role:a}=u(),r=g(a);return i({queryKey:["accounting","infinite",o,t,n],queryFn:async({pageParam:e=1})=>{if(!a||!s.includes(a))throw new Error("Not allowed");if(!r)throw new Error("API instance not found for role");return await m({organizationId:o,api:r,filters:t,search:n,pageParam:e})},initialPageParam:1,getNextPageParam:e=>{const{page:c,totalPages:p}=e.pagination;return c<p?c+1:void 0},enabled:!!o&&!!a&&!!r})},E=o=>{const{role:t}=u(),n=g(t);return d({queryKey:["accounting","single",o],queryFn:async()=>{if(!t||!s.includes(t))throw new Error("Not allowed");if(!n)throw new Error("API instance not found for role");return await w({id:o,api:n})},enabled:!!o&&!!t&&!!n})};export{E as a,h as u};
