import{u as B,r as C,f as D,a5 as M,l as $,j as e,O as q,M as z,B as H}from"./index-CUvv9ev0.js";import{c as J,d as K}from"./staffTaskApi-BsE46nJE.js";import{S as Q}from"./StaffTaskCard-PaNCG2A7.js";import{S as f,a as p,b,c as j,d as N}from"./Select-Dr5p0XuH.js";import"./Card-CHHq377-.js";import"./dateFormator-BGKi5rfZ.js";const U=["queued","in_progress","paused","done"],W=["low","medium","high"],X=["site","procurement","design","accounts"],re=()=>{var k,S;const{organizationId:c}=B(),[t,a]=C.useState({}),[r,T]=C.useState(!1),y=D(),{staffName:v}=M(s=>s.staffProfileStore),{data:n,isLoading:d,isError:x,error:P,refetch:_}=J(c,t),{data:O,isLoading:F,isError:I,error:L,refetch:E}=K(c,r,t),{data:m}=$(c),i=m==null?void 0:m.map(s=>({_id:s._id,projectName:s.projectName})),w=()=>a({}),o=Object.values(t).filter(Boolean).length,V=()=>{T(s=>!s)},u=r?O:n,A=r?F:d,G=r?I:x,h=r?L:P,R=r?E:_;return y.pathname.includes("single")||y.pathname.includes("addtask")?e.jsx(q,{}):e.jsxs("div",{className:"p-2 h-full ",children:[e.jsx("header",{className:"flex justify-between items-center w-full border-b border-gray-300 mb-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"fas fa-dolly mr-3 text-blue-600 text-3xl"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 flex items-center",children:v?e.jsxs(e.Fragment,{children:["Hi  ",v," ",e.jsx("i",{className:"text-blue-600 fa-solid fa-hand text-2xl ml-3 rotate-50"})]}):"Tasks"}),e.jsx("p",{className:"text-gray-600 mt-1 ",children:"Get your tasks here"})]})]})}),e.jsxs("section",{className:"py-2 flex w-full gap-6 flex-col lg:flex-row items-start h-[90%]",children:[e.jsx("div",{className:"lg:w-1/3 xl:w-1/4 w-full  h-full overflow-y-auto custom-scrollbar",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("label",{htmlFor:"showpending",className:"flex items-center gap-2 cursor-pointer select-none",children:[e.jsx("input",{id:"showpending",type:"checkbox",checked:r,onChange:V,className:"w-4 h-4 accent-blue-600 cursor-pointer"}),e.jsx("span",{className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Show Pending Tasks"})]}),o>0&&e.jsxs("button",{onClick:w,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",o,")"]})]}),o>0&&e.jsxs("button",{onClick:w,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",o,")"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"w-full flex gap-2 justify-center items-center",children:[e.jsx("button",{onClick:()=>a(s=>({...s,dependecies:!s.dependecies})),className:` w-full cursor-pointer  px-4 py-2 rounded-xl text-sm font-medium
        transition-all duration-200 ease-in-out
        flex items-center justify-center border
        ${t!=null&&t.dependecies?"bg-blue-100 border-blue-600 text-blue-800 shadow-sm":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"}`,children:"Dependencies"}),e.jsx("button",{onClick:()=>a(s=>({...s,overdue:!s.overdue})),className:`w-full  cursor-pointer px-4 py-2 rounded-xl text-sm font-medium
        transition-all duration-200 ease-in-out
        flex items-center justify-center border
        ${t!=null&&t.overdue?"bg-yellow-100 border-yellow-600 text-yellow-800 shadow-sm":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"}`,children:"Overdue"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs(f,{value:t.status==="in_progress"?"In progress":t.status,onValueChange:s=>a(l=>({...l,status:s})),children:[e.jsx(p,{className:"bg-white w-full",children:e.jsx(b,{placeholder:"Select status",selectedValue:t.status==="in_progress"?"In progress":t.status})}),e.jsx(j,{children:U.map(s=>e.jsx(N,{value:s,children:s==="in_progress"?"In progress":s},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs(f,{value:t.priority,onValueChange:s=>a(l=>({...l,priority:s})),children:[e.jsx(p,{className:"bg-white w-full",children:e.jsx(b,{placeholder:"Select priority",selectedValue:t.priority})}),e.jsx(j,{children:W.map(s=>e.jsx(N,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",onChange:s=>a(l=>({...l,createdAt:s.target.value})),value:t.createdAt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs(f,{value:t.department,onValueChange:s=>a(l=>({...l,department:s})),children:[e.jsx(p,{className:"bg-white w-full",children:e.jsx(b,{placeholder:"Select department",selectedValue:t.department})}),e.jsx(j,{children:X.map(s=>e.jsx(N,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),e.jsxs("select",{value:t.projectId||"",onChange:s=>{const l=i.find(g=>g._id===s.target.value);a(g=>({...g,projectId:l==null?void 0:l._id,projectName:l==null?void 0:l.projectName}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Projects"}),i==null?void 0:i.map(s=>e.jsx("option",{value:s._id,children:s.projectName},s._id))]})]})]})]})}),e.jsxs("div",{className:"flex-1 w-full overflow-y-auto  h-[100%]",children:[A&&e.jsx(z,{}),G&&e.jsxs("div",{className:"max-w-xl sm:min-w-[80%]  mx-auto mt-4 p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2 text-xl sm:text-3xl",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500  mb-4 text-lg sm:text-xl",children:((S=(k=h==null?void 0:h.response)==null?void 0:k.data)==null?void 0:S.message)||"Failed to load data"}),e.jsx(H,{onClick:()=>R(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]}),!d&&!x&&(n==null?void 0:n.length)===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px] w-full bg-white rounded-xl   text-center p-6",children:[e.jsx("i",{className:"fas fa-box-open text-5xl text-blue-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-1",children:"No Tasks Found"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Looks like there are no tasks assigned yet ",e.jsx("br",{})]})]}),!d&&!x&&e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:u==null?void 0:u.map(s=>e.jsx(Q,{task:s},s._id))})]})]})]})};export{re as default};
