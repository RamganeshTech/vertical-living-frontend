import{c as T,r as g,f as O,j as e,S as j,B as r,i as $,K as G,a6 as b,I as V,t as n}from"./index-C8ZngCsk.js";import{T as q}from"./TextArea-C_viV-lw.js";import{c as H,d as K,e as R,f as J,g as Q}from"./documentationApi-BldJvJ4W.js";const W=({isOpen:c,onClose:l,imageUrl:f,imageName:o})=>(g.useEffect(()=>{const p=u=>{u.key==="Escape"&&l()};return c&&(document.addEventListener("keydown",p),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",p),document.body.style.overflow="unset"}},[c,l]),c?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:l}),e.jsx("div",{className:"relative z-10 w-full h-full max-w-5xl sm:max-w-xl md:max-w-3xl lg:max-w-5xl max-h-full p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:"fa-solid fa-image text-blue-600 text-sm"})}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:o})]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:l,className:"flex items-center gap-2 h-9 sm:h-10 px-3 sm:px-4 flex-shrink-0 bg-transparent",children:[e.jsx("i",{className:"fa-solid fa-times text-sm"}),e.jsx("span",{className:"hidden sm:inline",children:"Close"})]})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4 sm:p-6 bg-gray-100 overflow-hidden",children:e.jsx("div",{className:"max-w-full max-h-full flex items-center justify-center",children:e.jsx("img",{src:f||"/placeholder.svg",alt:o,className:"max-w-full max-h-full object-contain rounded-lg shadow-lg",style:{maxHeight:"calc(100vh - 200px)"}})})}),e.jsx("div",{className:"p-4 sm:p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Click outside the image or press ESC to close"}),e.jsx(r,{variant:"outline",onClick:l,className:"h-9 sm:h-10 px-4 sm:px-6 w-full sm:w-auto bg-transparent",children:"Close Preview"})]})})]})})]}):null),ee=()=>{var P,F;const{projectId:c,stageNumber:l}=T(),[f,o]=g.useState(""),[p,u]=g.useState(!1),[m,k]=g.useState([]),[y,S]=g.useState({isOpen:!1,imageUrl:"",imageName:""}),C=O(),{data:a,isLoading:E}=H({projectId:c,stageNumber:l}),N=K(),h=R(),v=J(),{mutateAsync:U,isPending:z}=Q(),I=s=>{s.target.files&&k(Array.from(s.target.files))},M=async()=>{var s,i;if(m.length)try{await N.mutateAsync({projectId:c,stageNumber:l,files:m}),n({title:"Success",description:"Files uploaded successfully"}),k([]);const t=document.getElementById("file-upload");t&&(t.value="")}catch(t){n({title:"Error",description:((i=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to upload files",variant:"destructive"})}},D=async s=>{var i,t;try{await h.mutateAsync({projectId:c,stageNumber:l,fileId:s}),n({title:"Success",description:"File deleted successfully"})}catch(w){n({title:"Error",description:((t=(i=w==null?void 0:w.response)==null?void 0:i.data)==null?void 0:t.message)||"Failed to delete file",variant:"destructive"})}},L=async()=>{var s,i;try{await v.mutateAsync({projectId:c,stageNumber:l,description:f}),n({title:"Success",description:"Description updated successfully"}),u(!1)}catch(t){n({title:"Error",description:((i=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update description",variant:"destructive"})}},B=async()=>{var s,i;try{await U({projectId:c,stageNumber:l}),n({title:"Success",description:"Document updated successfully"})}catch(t){n({title:"Error",description:((i=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update document",variant:"destructive"})}},A=(s,i)=>{S({isOpen:!0,imageUrl:s,imageName:i})},_=()=>{S({isOpen:!1,imageUrl:"",imageName:""})};g.useEffect(()=>{a!=null&&a.description&&o(a.description)},[a==null?void 0:a.description]);const d=(P=a==null?void 0:a.uploadedFiles)==null?void 0:P.filter(s=>s.type==="image"),x=(F=a==null?void 0:a.uploadedFiles)==null?void 0:F.filter(s=>s.type==="pdf");return E?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-gray-100",children:e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto space-y-4 sm:space-y-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-4 sm:p-6",children:[e.jsx(j,{className:"h-8 sm:h-10 w-20 sm:w-24 mb-4"}),e.jsx(j,{className:"h-6 sm:h-8 w-32 sm:w-48 mb-4 sm:mb-6"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx(j,{className:"h-16 sm:h-20 w-full"}),e.jsx(j,{className:"h-24 sm:h-32 w-full"}),e.jsx(j,{className:"h-24 sm:h-32 w-full"})]})]})})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-gray-100 rounded-xl",children:e.jsx("div",{className:"w-full ",children:e.jsxs("div",{className:"max-w-full mx-auto space-y-4 sm:space-y-6 lg:space-y-8",children:[e.jsx("div",{className:" bg-white rounded-2xl shadow-sm border border-gray-200 sm:p-4 p-2 ",children:e.jsxs("div",{className:"flex flex-row items-center justify-between gap-4",children:[e.jsxs(r,{variant:"outline",onClick:()=>C(-1),className:"flex items-center gap-2 h-10 sm:h-11 px-4 sm:px-6 w-fit",children:[e.jsx("i",{className:"fa-solid fa-arrow-left text-sm"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to Documentation"}),e.jsx("span",{className:"sm:hidden",children:"Back"})]}),e.jsxs("div",{className:"flex flex-col items-center sm:flex-row gap-2",children:[e.jsxs("h3",{className:"text-sm sm:text-lg font-normal flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-file-pdf text-red-600"}),"Document"]}),a.pdfLink?e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(r,{onClick:()=>$({src:a.pdfLink,alt:`Stage-${a.stageNumber}-Documentation.pdf`}),size:"sm",className:"text-sm",children:e.jsx("i",{className:"fa-solid fa-download"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>window.open(a.pdfLink,"_blank","noopener,noreferrer"),className:"text-sm",children:e.jsx("i",{className:"fa-solid fa-eye"})}),e.jsxs(r,{isLoading:z,variant:"outline",size:"sm",onClick:B,className:"text-sm",children:[e.jsx("i",{className:"fa-solid fa-rotate"}),e.jsx("span",{className:"sm:inline hidden "})]})]}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No PDF available"})]})]})}),e.jsxs("div",{className:"bg-white  rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 via-blue-500 to-indigo-500 p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-white/20 backdrop-blur-sm text-white font-bold text-lg sm:text-2xl",children:l}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-white",children:["Stage ",l]}),e.jsx("p",{className:"text-white/80 text-sm sm:text-base mt-1",children:"Documentation & Files"})]})]})}),(l==="6"||l==="7")&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:" p-4 sm:p-6 lg:p-8 space-y-4 sm:space-y-6 my-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("h3",{className:"text-lg sm:text-xl font-semibold flex items-center gap-2 text-gray-900",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-dollar-sign text-blue-600 text-sm"})}),"Stage Price"]}),e.jsxs(G,{variant:"default",className:"text-xs sm:text-sm px-3 py-1.5 w-fit bg-blue-100 text-blue-700 border-blue-200",children:[e.jsx("i",{className:"fa-solid fa-tag mr-1"}),"Pricing Stage"]})]}),e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-emerald-50 rounded-xl p-4 sm:p-6 border border-blue-200",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-blue-100 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-money-bill-wave text-blue-600 text-xl sm:text-2xl"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm sm:text-base text-gray-600 mb-1",children:["Stage ",l," Total Amount"]}),e.jsxs("p",{className:"text-2xl sm:text-3xl font-bold text-blue-700",children:["â‚¹",a!=null&&a.price?Number(a.price).toLocaleString():"0.00"]})]})]})})})]})}),e.jsx(b,{className:"my-6 sm:my-8"}),e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("h3",{className:"text-lg sm:text-xl font-semibold flex items-center gap-2 text-gray-900",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-file-text text-blue-600 text-sm"})}),"Description"]}),!p&&e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>u(!0),className:"flex items-center gap-2 h-9 sm:h-10 px-3 sm:px-4 w-fit",children:[e.jsx("i",{className:"fa-solid fa-edit text-xs"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Edit"})]})]}),p?e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx(q,{value:f,onChange:s=>o(s.target.value),placeholder:"Enter stage description...",className:"min-h-[100px] sm:min-h-[120px] resize-none border-gray-300 focus:border-blue-500 focus:ring-blue-500"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsxs(r,{onClick:L,disabled:v.isPending,className:"flex items-center justify-center gap-2 h-10 sm:h-11",children:[e.jsx("i",{className:"fa-solid fa-save text-sm"}),v.isPending?"Saving...":"Save Changes"]}),e.jsxs(r,{variant:"outline",onClick:()=>{u(!1),o((a==null?void 0:a.description)||"")},className:"h-10 sm:h-11",children:[e.jsx("i",{className:"fa-solid fa-times mr-2 text-sm"}),"Cancel"]})]})]}):e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 sm:p-6 border border-gray-200",children:e.jsx("p",{className:"text-gray-700 leading-relaxed text-sm sm:text-base",children:f||"No description provided for this stage."})})]}),e.jsx(b,{className:"my-6 sm:my-8"}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-image text-emerald-600 text-sm"})}),e.jsxs("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:["Images (",(d==null?void 0:d.length)||0,")"]})]}),d!=null&&d.length?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4 sm:gap-6",children:d.map(s=>e.jsxs("div",{className:"group bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-all duration-200",children:[e.jsx("div",{className:"aspect-square relative overflow-hidden bg-gray-100",children:e.jsx("img",{src:s.url||"/placeholder.svg",alt:s.originalName,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-800 truncate mb-3",children:s.originalName}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>A(s.url||"",s.originalName),className:"flex-1 flex items-center justify-center gap-2 h-8 sm:h-9 text-xs sm:text-sm",children:[e.jsx("i",{className:"fa-solid fa-eye text-xs"}),"View"]}),e.jsxs(r,{size:"sm",isLoading:h.isPending,variant:"danger",onClick:()=>D(s._id),disabled:h.isPending,className:"flex-1 flex items-center justify-center gap-2 h-8 sm:h-9 text-xs sm:text-sm hover:text-white",children:[e.jsx("i",{className:"fa-solid fa-trash text-xs"}),h.isPending?"...":"Delete"]})]})]})]},s._id))}):e.jsxs("div",{className:"bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 p-8 sm:p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 mx-auto mb-4 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-image text-2xl sm:text-3xl text-gray-400"})}),e.jsx("h4",{className:"text-base sm:text-lg font-medium text-gray-600 mb-2",children:"No images uploaded"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Upload some images to get started"})]})]}),e.jsx(b,{className:"my-6 sm:my-8"}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-file-pdf text-red-600 text-sm"})}),e.jsxs("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:["PDF Documents (",(x==null?void 0:x.length)||0,")"]})]}),x!=null&&x.length?e.jsx("div",{className:"space-y-3 sm:space-y-4",children:x.map(s=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6 hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-red-100 flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:"fa-solid fa-file-pdf text-red-600 text-lg sm:text-xl"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm sm:text-base truncate",children:s.originalName}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-0.5",children:"PDF Document"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[e.jsx(r,{variant:"outline",size:"sm",className:"h-8 sm:h-9 px-3 sm:px-4 bg-transparent",children:e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-xs sm:text-sm",children:[e.jsx("i",{className:"fa-solid fa-external-link text-xs"}),e.jsx("span",{className:"hidden sm:inline",children:"View"})]})}),e.jsxs(r,{isLoading:h.isPending,variant:"danger",size:"sm",onClick:()=>D(s._id),disabled:h.isPending,className:"h-8 sm:h-9 px-3 sm:px-4 text-xs sm:text-sm hover:text-white",children:[e.jsx("i",{className:"fa-solid fa-trash text-xs mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})]})},s._id))}):e.jsxs("div",{className:"bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 p-8 sm:p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 mx-auto mb-4 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-file-pdf text-2xl sm:text-3xl text-gray-400"})}),e.jsx("h4",{className:"text-base sm:text-lg font-medium text-gray-600 mb-2",children:"No PDF documents"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Upload some PDF files to get started"})]})]}),e.jsx(b,{className:"my-6 sm:my-8"}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-upload text-purple-600 text-sm"})}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Upload New Files"})]}),e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border-2 border-dashed border-blue-200 hover:border-blue-300 transition-colors p-6 sm:p-8",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 mx-auto mb-4 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-upload text-2xl sm:text-3xl text-blue-600"})}),e.jsx("h4",{className:"text-base sm:text-lg font-semibold text-gray-800 mb-2",children:"Upload Files"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Select images and PDF files to upload to this stage"})]}),e.jsx(V,{id:"file-upload",type:"file",multiple:!0,accept:"image/*,.pdf",onChange:I,className:"cursor-pointer bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500 h-11 sm:h-12"}),m.length>0&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-800 mb-3",children:["Selected files (",m.length,"):"]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto custom-scrollbar",children:m.map((s,i)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-blue-700",children:[e.jsx("i",{className:"fa-solid fa-file flex-shrink-0"}),e.jsx("span",{className:"truncate flex-1",children:s.name}),e.jsxs("span",{className:"text-blue-500 flex-shrink-0",children:["(",(s.size/1024/1024).toFixed(2)," MB)"]})]},i))})]}),e.jsxs(r,{isLoading:N.isPending,onClick:M,disabled:!m.length||N.isPending,className:"w-full h-11 sm:h-12 text-sm sm:text-base font-medium",children:[e.jsx("i",{className:"fa-solid fa-upload mr-2 text-sm"}),N.isPending?"Uploading...":`Upload ${m.length>0?`${m.length} `:""}Files`]})]})})]})]})]})]})})}),e.jsx(W,{isOpen:y.isOpen,onClose:_,imageUrl:y.imageUrl,imageName:y.imageName})]})};export{ee as default};
