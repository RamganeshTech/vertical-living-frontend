import{u as l}from"./useQuery-CsoXJJPn.js";import{u as i}from"./useMutation-BqZ7KIEa.js";import{c as r,q as u}from"./index-DLaY3p7d.js";import{g as c}from"./roleCheck-BlurDUv2.js";const s=["owner","CTO","staff"],w=async({organizationId:t,api:e,filters:n,search:o})=>{const a=new URLSearchParams;t&&a.append("organizationId",t),n!=null&&n.projectId&&a.append("projectId",n.projectId),n!=null&&n.fromDept&&a.append("fromDept",n.fromDept),n!=null&&n.status&&a.append("status",n.status),o&&a.append("search",o);const{data:d}=await e.get(`/department/accounting/getaccountingall?${a.toString()}`);if(!d.ok)throw new Error(d.message);return d.data},p=async({id:t,api:e})=>{const{data:n}=await e.get(`/department/accounting/single/${t}`);if(!n.ok)throw new Error(n.message);return n.data},g=async({id:t,payload:e,api:n})=>{const{data:o}=await n.put(`/department/accounting/update/${t}`,e);if(!o.ok)throw new Error(o.message);return o.updated},m=async({id:t,installments:e,api:n})=>{const{data:o}=await n.put(`/department/accounting/addinstallments/${t}`,e);if(!o.ok)throw new Error(o.message);return o.updated},y=async({id:t,api:e})=>{const{data:n}=await e.delete(`/department/accounting/delete/${t}`);if(!n.ok)throw new Error(n.message);return n.deleted},q=(t,e,n)=>{const{role:o}=r(),a=c(o);return l({queryKey:["accounting","all",t,e,n],queryFn:async()=>{if(!o||!s.includes(o))throw new Error("Not allowed");if(!a)throw new Error("API instance not found for role");return await w({organizationId:t,api:a,filters:e,search:n})},enabled:!!t&&!!o&&!!a})},I=t=>{const{role:e}=r(),n=c(e);return l({queryKey:["accounting","single"],queryFn:async()=>{if(!e||!s.includes(e))throw new Error("Not allowed");if(!n)throw new Error("API instance not found for role");return await p({id:t,api:n})},enabled:!!t&&!!e&&!!n})},P=()=>{const{role:t}=r(),e=c(t);return i({mutationFn:async({id:n,payload:o})=>{if(!t||!s.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found for role");return await g({id:n,payload:o,api:e})},onSuccess:()=>{u.invalidateQueries({queryKey:["accounting","all"],exact:!1}),u.invalidateQueries({queryKey:["accounting","single"]})}})},F=()=>{const{role:t}=r(),e=c(t);return i({mutationFn:async({id:n,installments:o})=>{if(!t||!s.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found for role");return await m({id:n,installments:o,api:e})},onSuccess:()=>{u.invalidateQueries({queryKey:["accounting","all"],exact:!1}),u.invalidateQueries({queryKey:["accounting","single"]})}})},K=()=>{const{role:t}=r(),e=c(t);return i({mutationFn:async({id:n})=>{if(!t||!s.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance not found for role");return await y({id:n,api:e})},onSuccess:()=>{u.invalidateQueries({queryKey:["accounting","all"]})}})},S=()=>{const{role:t}=r(),e=c(t);return i({mutationFn:async({accountingId:n,installmentId:o})=>{if(!t||!s.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API instance missing");const{data:a}=await e.post(`/department/accounting/${n}/installments/${o}/pay`);if(!a.ok)throw new Error(a.message);return a.data}})};export{q as a,I as b,P as c,F as d,S as e,K as u};
