import{b as P,u as I,j as e}from"./index-C1DtYOG4.js";import{B as T}from"./Button-D6HVPia8.js";import{C as d,a as x}from"./Card-CK78z7_O.js";import $ from"./MaterialOverviewLoading-B_RCn-RH.js";import{d as g}from"./dateFormator-BGKi5rfZ.js";import{a as L}from"./accountingApi-DSnTVXrk.js";import"./Skeleton-CR6oVN79.js";import"./useQuery-DD9aZBjN.js";import"./useInfiniteQuery-4I03x6LQ.js";import"./roleCheck-vyRiFK58.js";const B=c=>{switch(c==null?void 0:c.toLowerCase()){case"paid":return{bg:"bg-green-100",text:"text-green-700",icon:"fa-check-circle",border:"border-green-200"};case"processing":return{bg:"bg-blue-100",text:"text-blue-700",icon:"fa-spinner fa-spin",border:"border-blue-200"};case"cancelled":case"failed":return{bg:"bg-red-100",text:"text-red-700",icon:"fa-times-circle",border:"border-red-200"};default:return{bg:"bg-orange-100",text:"text-orange-700",icon:"fa-clock",border:"border-orange-200"}}},Q=()=>{var p,h,f,j,b,N,u;const{id:c}=P(),k=I(),{data:o,isLoading:C,isError:D,refetch:S}=L(c);if(C)return e.jsx("div",{className:"p-6",children:e.jsx($,{})});if(D||!o)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] bg-white rounded-xl p-6 border border-red-100 m-4",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-4xl text-red-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Could not load details"}),e.jsx(T,{onClick:()=>S(),variant:"secondary",children:"Retry"})]});const a=o.data,n=o.raw,s=n==null?void 0:n.bill,r=n==null?void 0:n.payment,i=B(a==null?void 0:a.status);return e.jsxs("div",{className:"p-4 h-full overflow-y-auto custom-scrollbar space-y-6 bg-gray-50/50",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 border-b border-gray-200 pb-4",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("button",{onClick:()=>k(-1),className:"bg-white hover:bg-gray-100 shadow-sm flex items-center justify-center w-10 h-10 border border-gray-200 text-gray-600 rounded-lg transition-all",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:a.recordNumber||"Transaction Details"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Created on ",g(a.createdAt)," via ",e.jsx("span",{className:"font-semibold text-blue-600 capitalize",children:a.type||"Bill"})]})]})]}),e.jsxs("div",{className:`px-4 py-2 rounded-lg text-sm font-bold border ${i.bg} ${i.text} ${i.border} capitalize flex items-center gap-2 shadow-sm`,children:[e.jsx("i",{className:`fas ${i.icon}`}),a.status]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(d,{className:"shadow-sm border-gray-200",children:e.jsxs(x,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Payee Details"}),e.jsx("i",{className:"fas fa-user-circle text-blue-200 text-xl"})]}),e.jsx("div",{className:"font-bold text-gray-800 text-lg truncate",title:(p=a.person)==null?void 0:p.name,children:((h=a.person)==null?void 0:h.name)||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1 capitalize",children:((j=(f=a.person)==null?void 0:f.model)==null?void 0:j.replace("AccountModel","").replace("Model",""))||"Vendor"})]})}),e.jsx(d,{className:"shadow-sm border-gray-200",children:e.jsxs(x,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Source Bill"}),e.jsx("i",{className:"fas fa-file-invoice text-purple-200 text-xl"})]}),e.jsx("div",{className:"font-bold text-gray-800",children:(s==null?void 0:s.billNumber)||"N/A"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Date: ",g(s==null?void 0:s.billDate)]})]})}),e.jsx(d,{className:`shadow-sm ${r?"border-green-200 bg-green-50/30":"border-gray-200 bg-gray-50"}`,children:e.jsxs(x,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Payment Record"}),e.jsx("i",{className:`fas fa-money-check-alt text-xl ${r?"text-green-500":"text-gray-300"}`})]}),r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold text-gray-800",children:r.paymentNumber}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r.paymentDate?`Paid: ${g(r.paymentDate)}`:"Processing..."})]}):e.jsx("div",{className:"text-sm text-gray-400 italic mt-2",children:"No payment record linked yet."})]})}),e.jsx(d,{className:"shadow-sm border-blue-200 bg-blue-50/30",children:e.jsxs(x,{className:"p-5 flex flex-col justify-center items-end h-full",children:[e.jsx("h3",{className:"text-xs font-bold text-blue-400 uppercase tracking-wider mb-1",children:"Total Amount"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:["₹",(b=s==null?void 0:s.grandTotal)==null?void 0:b.toLocaleString("en-IN")]}),(s==null?void 0:s.taxAmount)>0&&e.jsxs("div",{className:"text-xs text-blue-400 mt-1",children:["(Incl. ₹",s.taxAmount," Tax)"]})]})})]}),((N=s==null?void 0:s.pdfData)==null?void 0:N.url)&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 flex items-center justify-between shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-50 rounded-lg flex items-center justify-center text-red-500",children:e.jsx("i",{className:"fas fa-file-pdf text-xl"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800",children:"Original Bill Document"}),e.jsx("p",{className:"text-xs text-gray-500 max-w-md truncate",children:s.pdfData.originalName})]})]}),e.jsxs("a",{href:s.pdfData.url,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 text-xs font-medium rounded-lg transition-colors flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-external-link-alt"})," View Proof"]})]}),e.jsxs(d,{className:"shadow-sm border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center",children:[e.jsxs("h2",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-list text-blue-500"}),"Transaction Items"]}),e.jsxs("span",{className:"px-3 py-1 bg-white border border-gray-200 rounded-full text-xs font-medium text-gray-600",children:[((u=s==null?void 0:s.items)==null?void 0:u.length)||0," Items"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-semibold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-center w-16",children:"S.No"}),e.jsx("th",{className:"px-6 py-3",children:"Item Name"}),e.jsx("th",{className:"px-6 py-3",children:"Unit"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Qty"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Rate"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Total Cost"}),e.jsx("th",{className:"px-6 py-3",children:"Order ID"}),e.jsx("th",{className:"px-6 py-3",children:"Txn ID"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Item Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:!(s!=null&&s.items)||s.items.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-6 py-8 text-center text-gray-400 italic",children:"No items found in the source document."})}):s.items.map((l,m)=>{var y,v,w;const t=(y=r==null?void 0:r.items)==null?void 0:y[m],A=(t==null?void 0:t.status)||"pending";return e.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-center text-gray-500",children:m+1}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-800",children:l.itemName}),e.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs uppercase",children:l.unit||"-"}),e.jsx("td",{className:"px-6 py-4 text-center text-gray-700 font-medium",children:l.quantity}),e.jsx("td",{className:"px-6 py-4 text-right text-gray-600 font-mono text-xs",children:(v=l.rate)==null?void 0:v.toLocaleString()}),e.jsxs("td",{className:"px-6 py-4 text-right font-bold text-blue-700 font-mono text-xs",children:["₹",(w=l.totalCost)==null?void 0:w.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4",children:t!=null&&t.orderId||l.orderId?e.jsx("span",{className:"font-mono text-[10px] bg-gray-100 px-2 py-1 rounded text-gray-600 block truncate w-24",title:(t==null?void 0:t.orderId)||l.orderId,children:(t==null?void 0:t.orderId)||l.orderId}):e.jsx("span",{className:"text-gray-300",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:t!=null&&t.transactionId?e.jsx("span",{className:"font-mono text-[10px] bg-green-50 text-green-700 px-2 py-1 rounded border border-green-100 block truncate w-24",title:t.transactionId,children:t.transactionId}):e.jsx("span",{className:"text-xs text-gray-400 italic",children:"Pending"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:A==="paid"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-50 text-green-600 text-[10px] font-bold uppercase tracking-wide",children:[e.jsx("i",{className:"fas fa-check-double"})," Paid"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-orange-50 text-orange-600 text-[10px] font-bold uppercase tracking-wide",children:[e.jsx("i",{className:"fas fa-clock"})," Pending"]})})]},l._id||m)})})]})})]}),(a.notes||(s==null?void 0:s.notes))&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-yellow-800 mb-1 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-sticky-note"})," Notes"]}),e.jsx("p",{className:"text-sm text-yellow-800/90 leading-relaxed",children:a.notes||(s==null?void 0:s.notes)})]})]})};export{Q as default};
