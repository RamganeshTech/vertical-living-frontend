import{b as V,j as e,a as _,f as $,u as M,r as D,O as G,B as k,t as T}from"./index-hYGmCEO1.js";import{B as H}from"./Breadcrumb-DdbCJ0PY.js";import{u as Y}from"./useDebounce-Iar4ThTS.js";import{u as q,a as J}from"./vendorPaymentApi-JKWdybxY.js";import{d as O}from"./dateFormator-BGKi5rfZ.js";import{S as K}from"./StageGuide-BKWoPeLK.js";const Q=({vendor:r,index:i,handleView:c,handleDelete:m,deletePending:x})=>{var f,h,a;const{role:u,permission:n}=V(),g=u==="owner"||((f=n==null?void 0:n.vendorpayment)==null?void 0:f.delete);return e.jsxs("div",{className:"grid cursor-pointer grid-cols-14 gap-4 px-6 py-4 border-b border-gray-100 hover:bg-[#f9fcff] transition-colors items-center last:border-b-0",onClick:()=>c(r._id),children:[e.jsx("div",{className:"col-span-1 text-center text-gray-600 font-medium",children:i+1}),e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-user text-blue-600 text-sm"}),e.jsx("span",{className:"font-medium text-gray-900 truncate",children:r.vendorName||"N/A"})]})}),e.jsx("div",{className:"col-span-2",children:e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-semibold",children:r.paymentNumber||"N/A"})}),e.jsxs("div",{className:"col-span-2 text-gray-600 text-sm",children:[e.jsx("i",{className:"fas fa-calendar-alt text-gray-400 mr-2"}),O(r==null?void 0:r.vendorPaymentDate)]}),e.jsxs("div",{className:"col-span-2 text-gray-600 text-sm",children:[e.jsx("i",{className:"fas fa-calendar-alt text-gray-400 mr-2"}),O(r==null?void 0:r.createdAt)]}),e.jsxs("div",{className:"col-span-2 font-semibold text-green-600",children:["â‚¹",((h=r.totalAmount)==null?void 0:h.toFixed(2))||"0.00"]}),e.jsx("div",{className:"col-span-1 text-center",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium",children:((a=r.items)==null?void 0:a.length)||0})}),e.jsx("div",{className:"col-span-1 flex justify-center gap-2",children:g&&e.jsx("button",{onClick:l=>{l.stopPropagation(),m(r._id)},disabled:x,className:"p-2 cursor-pointer text-red-600 hover:bg-red-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete vendor Order",children:x?e.jsx("i",{className:"fas fa-spinner fa-spin"}):e.jsx("i",{className:"fas fa-trash"})})})]})},ae=()=>{var C,A;const r=_(),i=$(),{organizationId:c}=M(),m=D.useRef(null),x=[{label:"Account",path:`/organizations/${c}/projects/accounting`},{label:"Bills",path:`/organizations/${c}/projects/billmain`},{label:"Vendor Payment",path:`/organizations/${c}/projects/vendorpaymentmain`}],{role:u,permission:n}=V(),g=u==="owner"||((C=n==null?void 0:n.vendorpayment)==null?void 0:C.list),f=u==="owner"||((A=n==null?void 0:n.vendorpayment)==null?void 0:A.create),h=i.pathname.includes("/vendorpaymentsingle")||i.pathname.includes("/create"),[a,l]=D.useState({search:"",vendorId:"",vendorPaymentFromDate:"",vendorPaymentToDate:"",createdFromDate:"",createdToDate:"",sortBy:"createdAt",sortOrder:"desc"}),B=Y(a.search,700),{data:y,fetchNextPage:P,hasNextPage:b,isFetchingNextPage:j,isLoading:S,isError:I,error:v,refetch:w}=q({organizationId:c||"",vendorId:a.vendorId||void 0,limit:9,vendorPaymentFromDate:a.vendorPaymentFromDate||void 0,vendorPaymentToDate:a.vendorPaymentToDate||void 0,createdFromDate:a.createdFromDate||void 0,createdToDate:a.createdToDate||void 0,search:B||void 0,sortBy:a.sortBy||void 0,sortOrder:a.sortOrder||void 0}),N=J();D.useEffect(()=>{const s=m.current;if(!s)return;const t=()=>{const{scrollTop:p,scrollHeight:o,clientHeight:R}=s;o-p-R<100&&b&&!j&&(console.log("ðŸ“œ Loading more Vendor payments..."),P())};return s.addEventListener("scroll",t),()=>s.removeEventListener("scroll",t)},[b,j,P]);const L=async s=>{var t,p;try{await N.mutateAsync({vendorpaymentsId:s}),w(),T({title:"Success",description:"Deleted successfully"})}catch(o){T({title:"Error",description:((p=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:p.message)||(o==null?void 0:o.message)||"Failed to delete the",variant:"destructive"})}},E=s=>{r(`vendorpaymentsingle/${s}`)},F=Object.values(a).filter(s=>s!==""&&s!=="createdAt"&&s!=="desc").length,z=()=>{l({search:"",vendorId:"",vendorPaymentFromDate:"",vendorPaymentToDate:"",createdFromDate:"",createdToDate:"",sortBy:"createdAt",sortOrder:"desc"})},d=(y==null?void 0:y.pages.flatMap(s=>s.data))||[];return h?e.jsx(G,{}):e.jsxs("div",{className:"space-y-0 h-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-credit-card mr-3 text-blue-600"}),"Vendor Payments"]}),e.jsx(H,{paths:x})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[f&&e.jsxs(k,{onClick:()=>r("create"),children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Create Vendor Payment"]}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(K,{organizationId:c,stageName:"vendorpayment"})})]})]}),S?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-blue-600 text-4xl"})}):I?e.jsxs("div",{className:"max-w-xl sm:min-w-[80%] mx-auto mt-4 p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2 text-xl sm:text-3xl",children:"âš ï¸ Error Occurred"}),e.jsx("p",{className:"text-red-500 mb-4 text-lg sm:text-xl",children:(v==null?void 0:v.message)||"Failed to load Vendor Payments"}),e.jsx(k,{onClick:()=>w(),className:"bg-red-600 text-white px-4 py-2",children:"Retry"})]}):e.jsxs("main",{className:"flex gap-2 !max-h-[90%]",children:[e.jsx("div",{className:"xl:w-80 flex-shrink-0 !max-h-[100%] overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),F>0&&e.jsxs("button",{onClick:z,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",F,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-search mr-2"}),"Search"]}),e.jsx("input",{type:"text",autoFocus:!0,placeholder:"payment number, vendor name...",value:a.search,onChange:s=>l(t=>({...t,search:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-calendar mr-2"}),"From CreatedAt Date"]}),e.jsx("input",{type:"date",value:a.createdFromDate,onChange:s=>{l(t=>({...t,createdFromDate:s.target.value}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-calendar mr-2"}),"To CreatedAt Date"]}),e.jsx("input",{type:"date",value:a.createdToDate,onChange:s=>{l(t=>({...t,createdToDate:s.target.value}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-calendar mr-2"}),"From Payment Date"]}),e.jsx("input",{type:"date",value:a.vendorPaymentFromDate,onChange:s=>{l(t=>({...t,vendorPaymentFromDate:s.target.value}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-calendar mr-2"}),"To Payment Date"]}),e.jsx("input",{type:"date",value:a.vendorPaymentToDate,onChange:s=>{l(t=>({...t,vendorPaymentToDate:s.target.value}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),e.jsxs("select",{value:a.sortBy,onChange:s=>{l(t=>({...t,sortBy:s.target.value}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"createdAt",children:"Created Date"}),e.jsx("option",{value:"paymentDate",children:"Payment Date"}),e.jsx("option",{value:"totalAmount",children:"Total Amount"}),e.jsx("option",{value:"vendorName",children:"Vendor Name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort Order"}),e.jsxs("select",{value:a.sortOrder,onChange:s=>{l(t=>({...t,sortOrder:s.target.value}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"desc",children:"Descending"}),e.jsx("option",{value:"asc",children:"Ascending"})]})]})]})]})}),g&&e.jsxs(e.Fragment,{children:["                    ",d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px] w-full bg-white rounded-xl text-center p-6",children:[e.jsx("i",{className:"fas fa-wallet text-5xl text-blue-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-1",children:"No vendorPayments Found"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[a.search||a.vendorId?"Try adjusting your filters to find vendorPayment.":"Looks like there are no vendorPayment yet.",e.jsx("br",{}),"Click on ",e.jsx("strong",{children:"Create Order"})," to get started ðŸš€"]})]}):e.jsxs("div",{ref:m,className:"flex-1 !max-h-[100%] overflow-y-auto",children:[e.jsx("div",{className:"bg-white rounded-t-xl border border-gray-200 sticky top-0 z-10",children:e.jsxs("div",{className:"grid grid-cols-14 gap-4 px-6 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 font-semibold text-gray-700 text-sm",children:[e.jsx("div",{className:"col-span-1 text-center",children:"S.No"}),e.jsx("div",{className:"col-span-3",children:"Vendor Name"}),e.jsx("div",{className:"col-span-2",children:"Payment Order No"}),e.jsx("div",{className:"col-span-2",children:"Payment Date"}),e.jsx("div",{className:"col-span-2",children:"Created At"}),e.jsx("div",{className:"col-span-2",children:"Total Amount"}),e.jsx("div",{className:"col-span-1 text-center",children:"Items"}),e.jsx("div",{className:"col-span-1 text-center",children:"Actions"})]})}),e.jsx("div",{className:"bg-white rounded-b-xl border-x border-b border-gray-200",children:d.map((s,t)=>e.jsx(Q,{vendor:s,index:t,handleView:E,handleDelete:L,deletePending:N.isPending&&N.variables.vendorpaymentsId===s._id},s._id))}),j&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl"}),e.jsx("span",{className:"text-sm font-medium",children:"Loading more vendorPayments..."})]})}),!b&&(d==null?void 0:d.length)>0&&e.jsx("div",{className:"flex justify-center py-6",children:e.jsxs("p",{className:"text-gray-400 text-sm font-medium",children:[e.jsx("i",{className:"fas fa-check-circle mr-2"}),"You've reached the end of the list"]})})]})]})]})]})};export{ae as default};
