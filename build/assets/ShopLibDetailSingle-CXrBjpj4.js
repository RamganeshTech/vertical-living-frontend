import{b as j,c as A,r as h,d as F,j as e,B as U,t as i}from"./index-DyM6T-eT.js";import{u as I,a as L}from"./shopLibDetailApi-CNLzuKDa.js";import{S as T}from"./SmartTagInput-BoSH_n0g.js";const q=()=>{var f;const{shopId:u}=j(),{organizationId:y}=j(),v=A(),[l,n]=h.useState(!1),[t,c]=h.useState({shopName:"",address:"",contactPerson:"",phoneNumber:"",priority:[]}),{data:m,isLoading:S,error:g}=I(y),x=L(),{role:k,permission:p}=F(),w=k==="owner"||((f=p==null?void 0:p.ordermaterial)==null?void 0:f.edit),s=m==null?void 0:m.find(a=>a._id===u);h.useEffect(()=>{s&&c({shopName:s.shopName||"",address:s.address||"",contactPerson:s.contactPerson||"",phoneNumber:s.phoneNumber||"",priority:s.priority||[]})},[s]);const d=a=>{c({...t,[a.target.name]:a.target.value})},C=a=>{c(r=>({...r,priority:typeof a=="function"?a(r.priority):a}))},P=async a=>{var r,N;a.preventDefault();try{if(!t.shopName.trim()){i({title:"Validation Error",description:"Shop name is required",variant:"destructive"});return}const o={id:u,shopData:{shopName:t.shopName,address:t.address,contactPerson:t.contactPerson,phoneNumber:t.phoneNumber,priority:t.priority}};await x.mutateAsync(o),i({title:"Success",description:"Shop updated successfully"}),n(!1)}catch(o){i({title:"Error",description:((N=(r=o==null?void 0:o.response)==null?void 0:r.data)==null?void 0:N.message)||"Failed to update shop",variant:"destructive"})}},E=async()=>{try{const a=`Shop: ${s.shopName}
Address: ${s.address||"N/A"}
Contact: ${s.contactPerson||"N/A"}
Phone: ${s.phoneNumber||"N/A"}`;await navigator.clipboard.writeText(a),i({title:"Success",description:"Shop details copied to clipboard"})}catch{i({title:"Error",description:"Failed to copy details",variant:"destructive"})}},b=()=>{try{v(-1)}catch{i({title:"Error",description:"Failed to navigate back",variant:"destructive"})}},D=()=>{s&&c({shopName:s.shopName||"",address:s.address||"",contactPerson:s.contactPerson||"",phoneNumber:s.phoneNumber||"",priority:s.priority||[]}),n(!1)};return S?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-4xl text-blue-500 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading shop details..."})]})}):g||!s?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-exclamation-circle text-4xl text-red-500 mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:g?"Failed to load shop details":"Shop not found"}),e.jsx("button",{onClick:b,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx("i",{className:"fas fa-arrow-left text-gray-600"})})]})}):e.jsx("div",{className:"min-h-full  bg-gray-50 p-2",children:e.jsxs("div",{className:"max-w-full mx-auto",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:b,className:"p-2 cursor-pointer hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx("i",{className:"fas fa-arrow-left text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:l?"Edit Shop Details":"Shop Details"}),e.jsx("p",{className:"text-gray-600 mt-1",children:l?"Update shop information":"View and manage shop information"})]})]}),!l&&e.jsxs("button",{onClick:()=>n(!0),className:"px-4 cursor-pointer py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-edit"}),e.jsx("span",{children:"Edit Shop"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:l?e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-store mr-2"}),"Shop Name *"]}),e.jsx("input",{type:"text",name:"shopName",value:t.shopName,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-phone mr-2"}),"Phone Number"]}),e.jsx("input",{type:"tel",maxLength:10,name:"phoneNumber",value:t.phoneNumber,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-user mr-2"}),"Contact Person"]}),e.jsx("input",{type:"text",name:"contactPerson",value:t.contactPerson,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-map-marker-alt mr-2"}),"Address"]}),e.jsx("textarea",{name:"address",value:t.address,onChange:d,rows:3,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-tags mr-2 text-blue-500"}),"Priority Automation Tags",e.jsx("span",{className:"text-[10px] text-gray-400 ml-2",children:"(Type and hit Enter to add. Use tags like 'high', 'electrical', etc.)"})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-xl border border-dashed border-gray-300",children:e.jsx(T,{tags:t.priority,setState:C})})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t",children:[e.jsxs("button",{type:"button",onClick:D,className:"flex-1 px-4 cursor-pointer py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("i",{className:"fas fa-times mr-2"}),"Cancel"]}),e.jsx(U,{type:"submit",disabled:x.isPending,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:bg-blue-300 flex items-center justify-center gap-2",children:x.isPending?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"}),e.jsx("span",{children:"Updating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save"}),e.jsx("span",{children:"Save Changes"})]})})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-500 block mb-1",children:[e.jsx("i",{className:"fas fa-store mr-2"}),"Shop Name"]}),e.jsx("p",{className:"text-lg font-medium text-gray-800",children:s.shopName||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-500 block mb-1",children:[e.jsx("i",{className:"fas fa-user mr-2"}),"Contact Person"]}),e.jsx("p",{className:"text-lg text-gray-800",children:s.contactPerson||"-"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-500 block mb-1",children:[e.jsx("i",{className:"fas fa-phone mr-2"}),"Phone Number"]}),e.jsx("p",{className:"text-lg text-gray-800",children:s.phoneNumber||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-500 block mb-1",children:[e.jsx("i",{className:"fas fa-map-marker-alt mr-2"}),"Address"]}),e.jsx("p",{className:"text-lg text-gray-800",children:s.address||"-"})]})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("label",{className:"text-sm text-gray-500 block mb-2",children:[e.jsx("i",{className:"fas fa-tags mr-2"}),"Priority Tags"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.priority&&s.priority.length>0?s.priority.map((a,r)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-full border border-blue-200 uppercase",children:a},r)):e.jsx("span",{className:"text-gray-400 italic text-sm",children:"No tags assigned"})})]})]})}),!l&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mt-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:[e.jsx("i",{className:"fas fa-bolt mr-2 text-yellow-500"}),"Quick Actions"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[w&&e.jsxs("button",{onClick:()=>n(!0),className:"p-4 cursor-pointer border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[e.jsx("i",{className:"fas fa-edit text-blue-500 text-xl mb-2"}),e.jsx("p",{className:"font-medium text-gray-800",children:"Edit Details"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Update shop information"})]}),e.jsxs("button",{onClick:E,className:"p-4 cursor-pointer border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[e.jsx("i",{className:"fas fa-copy text-green-500 text-xl mb-2"}),e.jsx("p",{className:"font-medium text-gray-800",children:"Copy Details"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Copy to clipboard"})]})]})]})]})})};export{q as default};
