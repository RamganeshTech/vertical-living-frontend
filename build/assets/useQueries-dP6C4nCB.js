var I=i=>{throw TypeError(i)};var q=(i,e,s)=>e.has(i)||I("Cannot "+s);var n=(i,e,s)=>(q(i,e,"read from private field"),s?s.call(i):e.get(i)),b=(i,e,s)=>e.has(i)?I("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,s),c=(i,e,s,t)=>(q(i,e,"write to private field"),t?t.call(i,s):e.set(i,s),s),y=(i,e,s)=>(q(i,e,"access private method"),s);import{S as j,w as k,x as N,Q as T,s as V,y as X,z as Y,r as w,A as Z,D as $,E as W,F as ee,G as U,H as G,J as se,K as te}from"./index-DyM6T-eT.js";function J(i,e){const s=new Set(e);return i.filter(t=>!s.has(t))}function re(i,e,s){const t=i.slice(0);return t[e]=s,t}var v,f,m,E,p,g,C,S,x,a,H,P,A,B,L,K,ie=(K=class extends j{constructor(e,s,t){super();b(this,a);b(this,v);b(this,f);b(this,m);b(this,E);b(this,p);b(this,g);b(this,C);b(this,S);b(this,x,[]);c(this,v,e),c(this,E,t),c(this,m,[]),c(this,p,[]),c(this,f,[]),this.setQueries(s)}onSubscribe(){this.listeners.size===1&&n(this,p).forEach(e=>{e.subscribe(s=>{y(this,a,B).call(this,e,s)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,n(this,p).forEach(e=>{e.destroy()})}setQueries(e,s){c(this,m,e),c(this,E,s),k.batch(()=>{const t=n(this,p),u=y(this,a,A).call(this,n(this,m));c(this,x,u),u.forEach(o=>o.observer.setOptions(o.defaultedQueryOptions));const r=u.map(o=>o.observer),h=r.map(o=>o.getCurrentResult()),d=r.some((o,Q)=>o!==t[Q]);t.length===r.length&&!d||(c(this,p,r),c(this,f,h),this.hasListeners()&&(J(t,r).forEach(o=>{o.destroy()}),J(r,t).forEach(o=>{o.subscribe(Q=>{y(this,a,B).call(this,o,Q)})}),y(this,a,L).call(this)))})}getCurrentResult(){return n(this,f)}getQueries(){return n(this,p).map(e=>e.getCurrentQuery())}getObservers(){return n(this,p)}getOptimisticResult(e,s){const t=y(this,a,A).call(this,e),u=t.map(r=>r.observer.getOptimisticResult(r.defaultedQueryOptions));return[u,r=>y(this,a,P).call(this,r??u,s),()=>y(this,a,H).call(this,u,t)]}},v=new WeakMap,f=new WeakMap,m=new WeakMap,E=new WeakMap,p=new WeakMap,g=new WeakMap,C=new WeakMap,S=new WeakMap,x=new WeakMap,a=new WeakSet,H=function(e,s){return s.map((t,u)=>{const r=e[u];return t.defaultedQueryOptions.notifyOnChangeProps?r:t.observer.trackResult(r,h=>{s.forEach(d=>{d.observer.trackProp(h)})})})},P=function(e,s){return s?((!n(this,g)||n(this,f)!==n(this,S)||s!==n(this,C))&&(c(this,C,s),c(this,S,n(this,f)),c(this,g,N(n(this,g),s(e)))),n(this,g)):e},A=function(e){const s=new Map(n(this,p).map(u=>[u.options.queryHash,u])),t=[];return e.forEach(u=>{const r=n(this,v).defaultQueryOptions(u),h=s.get(r.queryHash);h?t.push({defaultedQueryOptions:r,observer:h}):t.push({defaultedQueryOptions:r,observer:new T(n(this,v),r)})}),t},B=function(e,s){const t=n(this,p).indexOf(e);t!==-1&&(c(this,f,re(n(this,f),t,s)),y(this,a,L).call(this))},L=function(){var e;if(this.hasListeners()){const s=n(this,g),t=y(this,a,H).call(this,n(this,f),n(this,x)),u=y(this,a,P).call(this,t,(e=n(this,E))==null?void 0:e.combine);s!==u&&k.batch(()=>{this.listeners.forEach(r=>{r(n(this,f))})})}},K);function ae({queries:i,...e},s){const t=V(),u=X(),r=Y(),h=w.useMemo(()=>i.map(l=>{const R=t.defaultQueryOptions(l);return R._optimisticResults=u?"isRestoring":"optimistic",R}),[i,t,u]);h.forEach(l=>{Z(l),$(l,r)}),W(r);const[d]=w.useState(()=>new ie(t,h,e)),[o,Q,_]=d.getOptimisticResult(h,e.combine),z=!u&&e.subscribed!==!1;w.useSyncExternalStore(w.useCallback(l=>z?d.subscribe(k.batchCalls(l)):ee,[d,z]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),w.useEffect(()=>{d.setQueries(h,e)},[h,e,d]);const D=o.some((l,R)=>U(h[R],l))?o.flatMap((l,R)=>{const O=h[R];if(O){const F=new T(t,O);if(U(O,l))return G(O,F,r);se(l,u)&&G(O,F,r)}return[]}):[];if(D.length>0)throw Promise.all(D);const M=o.find((l,R)=>{const O=h[R];return O&&te({result:l,errorResetBoundary:r,throwOnError:O.throwOnError,query:t.getQueryCache().get(O.queryHash),suspense:O.suspense})});if(M!=null&&M.error)throw M.error;return Q(_())}export{ae as u};
