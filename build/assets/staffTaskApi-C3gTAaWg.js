import{u as o,q as u}from"./index-By5P0A7l.js";import{g as i}from"./roleCheck-YGaMnK_P.js";import{u as d}from"./useQuery-Cc7pLKfK.js";import{u as f}from"./useMutation-7YLqc7VE.js";const c=["owner","staff","CTO"],l=async({tasks:t,assigneRole:e,api:a})=>{const s=new FormData;s.append("tasks",JSON.stringify(t)),s.append("assigneRole",e),t.forEach(n=>{n.images&&Array.isArray(n.images)&&n.images.forEach(w=>{w instanceof File&&s.append("files",w)})});const{data:r}=await a.post("/stafftasks/tasks/bulk",s,{headers:{"Content-Type":"multipart/form-data"}});if(!r.ok)throw new Error(r.message);return r.data},k=async({tasks:t,assigneRole:e,api:a})=>{const s=new FormData;s.append("tasks",JSON.stringify(t)),s.append("assigneRole",e),t.forEach(n=>{n.images&&Array.isArray(n.images)&&n.images.forEach(w=>{w instanceof File&&s.append("files",w)})});const{data:r}=await a.post("/stafftasks/tasks/taskfromwork",s,{headers:{"Content-Type":"multipart/form-data"}});if(!r.ok)throw new Error(r.message);return r.data},K=async({title:t,api:e})=>{const{data:a}=await e.get(`/stafftasks/suggest/subtasks?title=${encodeURIComponent(t)}`);if(!a.ok)throw new Error(a.message);return a.steps},h=async({filters:t,api:e,organizationId:a})=>{const s=new URLSearchParams(t).toString(),{data:r}=await e.get(`/stafftasks/${a}/tasks?${s}`);if(!r.ok)throw new Error(r.message);return r.data},y=async({id:t,api:e})=>{const{data:a}=await e.get(`/stafftasks/singletask/${t}`);if(!a.ok)throw new Error(a.message);return a.data},m=async({organizationId:t,filters:e,api:a})=>{const s=new URLSearchParams(e).toString(),{data:r}=await a.get(`/stafftasks/associatedstaffstask/${t}?${s}`);if(!r.ok)throw new Error(r.message);return r.data},p=async({organizationId:t,filters:e,api:a})=>{const s=new URLSearchParams(e).toString(),{data:r}=await a.get(`/stafftasks/otherpendingstafftask/${t}?${s}`);if(!r.ok)throw new Error(r.message);return r.data},g=async({mainTaskId:t,updates:e,api:a})=>{const{data:s}=await a.patch(`/stafftasks/tasks/${t}`,e);if(!s.ok)throw new Error(s.message);return s.data},E=async({mainTaskId:t,api:e})=>{const{data:a}=await e.delete(`/stafftasks/tasks/${t}`);if(!a.ok)throw new Error(a.message);return a.data},S=async({mainTaskId:t,subTaskId:e,taskName:a,api:s})=>{const{data:r}=await s.patch(`/stafftasks/tasks/${t}/subtasks/${e}`,{taskName:a});if(!r.ok)throw new Error(r.message);return r.data},N=async({mainTaskId:t,subTaskId:e,comment:a,api:s})=>{const{data:r}=await s.patch(`/stafftasks/tasks/${t}/${e}/updatecomments`,{comment:a});if(!r.ok)throw new Error(r.message);return r.data},T=async({mainTaskId:t,subTaskId:e,api:a})=>{const{data:s}=await a.delete(`/stafftasks/tasks/${t}/subtasks/${e}`);if(!s.ok)throw new Error(s.message);return s.data},A=async({mainTaskId:t,subTaskId:e,status:a,subTask:s,api:r})=>{const{data:n}=await r.patch(`/stafftasks/tasks/${t}/subtasks/${e}/history`,{status:a,task:s});if(!n.ok)throw new Error(n.message);return n.data},C=()=>{const{role:t}=o(),e=i(t);return f({mutationFn:async({tasks:a,assigneRole:s})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!e)throw new Error("Not Authenticated");return await l({tasks:a,assigneRole:s,api:e})},onSuccess:()=>{u.invalidateQueries({queryKey:["stafftasks"]})}})},P=()=>{const{role:t}=o(),e=i(t);return f({mutationFn:async({tasks:a,assigneRole:s})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!e)throw new Error("Not Authenticated");return await k({tasks:a,assigneRole:s,api:e})},onSuccess:()=>{u.invalidateQueries({queryKey:["stafftasks"]})}})},Q=(t,e)=>{const{role:a}=o(),s=i(a);return d({queryKey:["stafftasks",t,e],queryFn:async()=>{if(!a||!c.includes(a))throw new Error("Not allowed");if(!s)throw new Error("Not Authenticated");return h({filters:e,api:s,organizationId:t})},enabled:!!a})},R=t=>{const{role:e}=o(),a=i(e);return d({queryKey:["singlestafftasks",t],queryFn:async()=>{if(!e||!c.includes(e))throw new Error("Not allowed");if(!a)throw new Error("Not Authenticated");return y({id:t,api:a})},enabled:!!e})},v=(t,e)=>{const{role:a}=o(),s=i(a);return d({queryKey:["associatedstafftasks",t,e],queryFn:async()=>{if(!a||!c.includes(a))throw new Error("Not allowed");if(!s)throw new Error("Not Authenticated");return m({filters:e,api:s,organizationId:t})},enabled:!!a})},U=(t,e,a)=>{const{role:s}=o(),r=i(s);return d({queryKey:["pending-stafftasks",t,a],queryFn:async()=>{if(!s||!c.includes(s))throw new Error("Not allowed");if(!r)throw new Error("Not Authenticated");return p({filters:a,api:r,organizationId:t})},enabled:!!s&&e})},D=()=>{const{role:t}=o(),e=i(t);return f({mutationFn:async({mainTaskId:a,updates:s})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!e)throw new Error("API missing");return await g({mainTaskId:a,updates:s,api:e})},onSuccess:(a,{mainTaskId:s})=>{u.invalidateQueries({queryKey:["stafftasks",s]})}})},M=()=>{const{role:t}=o(),e=i(t);return f({mutationFn:async({mainTaskId:a})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!e)throw new Error("Not Authenticated");return await E({mainTaskId:a,api:e})},onSuccess:()=>{u.invalidateQueries({queryKey:["stafftasks"]})}})},O=()=>{const{role:t}=o(),e=i(t);return f({mutationFn:async({mainTaskId:a,subTaskId:s,taskName:r})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!e)throw new Error("Not Authenticated");return await S({mainTaskId:a,subTaskId:s,taskName:r,api:e})},onSuccess:(a,{mainTaskId:s})=>{u.invalidateQueries({queryKey:["stafftasks",s]})}})},_=()=>{const{role:t}=o(),e=i(t);return f({mutationFn:async({mainTaskId:a,subTaskId:s,comment:r})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!e)throw new Error("Not Authenticated");return await N({mainTaskId:a,subTaskId:s,comment:r,api:e})},onSuccess:(a,{mainTaskId:s})=>{u.invalidateQueries({queryKey:["stafftasks",s]})}})},G=()=>{const{role:t}=o(),e=i(t);return f({mutationFn:async({mainTaskId:a,subTaskId:s})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!e)throw new Error("Not Authenticated");return await T({mainTaskId:a,subTaskId:s,api:e})},onSuccess:(a,{mainTaskId:s})=>{u.invalidateQueries({queryKey:["stafftasks",s]})}})},L=()=>{const{role:t}=o(),e=i(t);return f({mutationFn:async({mainTaskId:a,subTaskId:s,status:r,subTask:n})=>{if(!t||!c.includes(t))throw new Error("Not allowed");if(!e)throw new Error("Not Authenticated");return await A({mainTaskId:a,subTaskId:s,status:r,subTask:n,api:e})},onSuccess:(a,{mainTaskId:s})=>{u.invalidateQueries({queryKey:["singlestafftasks",s]})}})};export{C as a,P as b,v as c,U as d,M as e,L as f,K as g,R as h,D as i,O as j,G as k,_ as l,Q as u};
