import{b as R,u as E,j as e}from"./index-g9v5L7eS.js";import{B as F}from"./Button-DXzmpjtA.js";import{C as c,a as d}from"./Card-BZ8fgwGK.js";import z from"./MaterialOverviewLoading-DtCbU8U1.js";import{d as h}from"./dateFormator-BGKi5rfZ.js";import{a as M}from"./accountingApi-B03RCQJm.js";import"./Skeleton-1GHmvOlA.js";import"./useQuery-BlDIWKCM.js";import"./useInfiniteQuery-Cey4CECX.js";import"./roleCheck-vn63l46q.js";const q=i=>{switch(i==null?void 0:i.toLowerCase()){case"paid":return{bg:"bg-green-100",text:"text-green-700",icon:"fa-check-circle",border:"border-green-200"};case"processing":return{bg:"bg-blue-100",text:"text-blue-700",icon:"fa-spinner fa-spin",border:"border-blue-200"};case"cancelled":case"failed":return{bg:"bg-red-100",text:"text-red-700",icon:"fa-times-circle",border:"border-red-200"};default:return{bg:"bg-orange-100",text:"text-orange-700",icon:"fa-clock",border:"border-orange-200"}}},W=()=>{var b,f,j,N,y,u,w,v,k;const{id:i}=R(),I=E(),{data:m,isLoading:P,isError:L,refetch:T}=M(i);if(P)return e.jsx("div",{className:"p-6",children:e.jsx(z,{})});if(L||!m||!m.data)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] bg-white rounded-xl p-6 border border-red-100 m-4",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-4xl text-red-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Could not load details"}),e.jsx(F,{onClick:()=>T(),variant:"secondary",children:"Retry"})]});const a=m.data,s=a.sourceDetails,l=a.paymentDetails,x=(b=a.type)==null?void 0:b.toLowerCase().includes("invoice"),g=(f=a.type)==null?void 0:f.toLowerCase().includes("expense"),n=!x,$=!g,o=q(a.status);return e.jsxs("div",{className:"p-4 h-full overflow-y-auto custom-scrollbar space-y-6 bg-gray-50/50",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 border-b border-gray-200 pb-4",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("button",{onClick:()=>I(-1),className:"bg-white hover:bg-gray-100 shadow-sm flex items-center justify-center w-10 h-10 border border-gray-200 text-gray-600 rounded-lg transition-all",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:a.recordNumber||"Transaction Details"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Created on ",h(a.createdAt)," via ",e.jsx("span",{className:"font-semibold text-blue-600 capitalize",children:a.type})]})]})]}),n&&e.jsxs("div",{className:`px-4 py-2 rounded-lg text-sm font-bold border ${o.bg} ${o.text} ${o.border} capitalize flex items-center gap-2 shadow-sm`,children:[e.jsx("i",{className:`fas ${o.icon}`}),a.status]})]}),e.jsxs("div",{className:`grid grid-cols-1 ${n?"md:grid-cols-2 lg:grid-cols-4":"md:grid-cols-3"} gap-4`,children:[e.jsx(c,{className:"shadow-sm border-gray-200",children:e.jsxs(d,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:x?"Payer Details":"Payee Details"}),e.jsx("i",{className:"fas fa-user-circle text-blue-200 text-xl"})]}),e.jsx("div",{className:"font-bold text-gray-800 text-lg truncate",title:(j=a.person)==null?void 0:j.name,children:((N=a.person)==null?void 0:N.name)||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1 capitalize",children:((u=(y=a.person)==null?void 0:y.model)==null?void 0:u.replace("AccountModel","").replace("Model",""))||"Unknown"})]})}),e.jsx(c,{className:"shadow-sm border-gray-200",children:e.jsxs(d,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:x?"Invoice Info":"Source Document"}),e.jsx("i",{className:`fas ${x?"fa-file-contract":"fa-file-invoice"} text-purple-200 text-xl`})]}),e.jsx("div",{className:"font-bold text-gray-800",children:(s==null?void 0:s.deptNumber)||"N/A"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Date: ",h(s==null?void 0:s.deptGeneratedDate)]})]})}),n&&e.jsx(c,{className:`shadow-sm ${l?"border-green-200 bg-green-50/30":"border-gray-200 bg-gray-50"}`,children:e.jsxs(d,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Payment Record"}),e.jsx("i",{className:`fas fa-money-check-alt text-xl ${l?"text-green-500":"text-gray-300"}`})]}),l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold text-gray-800",children:l.number}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:l.date?`Paid: ${h(l.date)}`:"Processing..."})]}):e.jsx("div",{className:"text-sm text-gray-400 italic mt-2",children:"No payment record linked yet."})]})}),e.jsx(c,{className:"shadow-sm border-blue-200 bg-blue-50/30",children:e.jsxs(d,{className:"p-5 flex flex-col justify-center items-end h-full",children:[e.jsx("h3",{className:"text-xs font-bold text-blue-400 uppercase tracking-wider mb-1",children:"Total Amount"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:["₹",((w=s==null?void 0:s.grandTotal)==null?void 0:w.toLocaleString("en-IN"))||((v=a.amount)==null?void 0:v.toLocaleString("en-IN"))]})]})})]}),g&&e.jsxs(c,{className:"shadow-sm border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-pink-50/50 flex justify-between items-center",children:e.jsxs("h2",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-info-circle text-pink-500"}),"Expense Details"]})}),e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-100",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Description / Purpose"}),e.jsx("p",{className:"text-gray-800 text-lg font-medium leading-relaxed",children:(s==null?void 0:s.notes)||"No description provided for this expense."})]})})]}),$&&e.jsxs(c,{className:"shadow-sm border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center",children:[e.jsxs("h2",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-list text-blue-500"}),"Transaction Items"]}),e.jsxs("span",{className:"px-3 py-1 bg-white border border-gray-200 rounded-full text-xs font-medium text-gray-600",children:[((k=s==null?void 0:s.items)==null?void 0:k.length)||0," Items"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-semibold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-center w-16",children:"S.No"}),e.jsx("th",{className:"px-6 py-3",children:"Item Name"}),e.jsx("th",{className:"px-6 py-3",children:"Unit"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Qty"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Rate"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Total Cost"}),n&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3",children:"Order ID"}),e.jsx("th",{className:"px-6 py-3",children:"Txn ID"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Status"})]})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:!(s!=null&&s.items)||s.items.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:n?9:6,className:"px-6 py-8 text-center text-gray-400 italic",children:"No items found in the source document."})}):s.items.map((r,p)=>{var C,S,D;const t=(C=l==null?void 0:l.items)==null?void 0:C[p],A=(t==null?void 0:t.status)||"pending";return e.jsxs("tr",{className:"hover:bg-blue-50/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-center text-gray-500",children:p+1}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-800",children:r.itemName||r.name}),e.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs uppercase",children:r.unit||"-"}),e.jsx("td",{className:"px-6 py-4 text-center text-gray-700 font-medium",children:r.quantity}),e.jsx("td",{className:"px-6 py-4 text-right text-gray-600 font-mono text-xs",children:(S=r.rate)==null?void 0:S.toLocaleString()}),e.jsxs("td",{className:"px-6 py-4 text-right font-bold text-blue-700 font-mono text-xs",children:["₹",(D=r.totalCost||r.rate*r.quantity)==null?void 0:D.toLocaleString()]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4",children:t!=null&&t.orderId||r.orderId?e.jsx("span",{className:"font-mono text-[10px] bg-gray-100 px-2 py-1 rounded text-gray-600 block truncate w-24",title:(t==null?void 0:t.orderId)||r.orderId,children:(t==null?void 0:t.orderId)||r.orderId}):e.jsx("span",{className:"text-gray-300",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:t!=null&&t.transactionId?e.jsx("span",{className:"font-mono text-[10px] bg-green-50 text-green-700 px-2 py-1 rounded border border-green-100 block truncate w-24",title:t.transactionId,children:t.transactionId}):e.jsx("span",{className:"text-xs text-gray-400 italic",children:"Pending"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:A==="paid"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-50 text-green-600 text-[10px] font-bold uppercase tracking-wide",children:[e.jsx("i",{className:"fas fa-check-double"})," Paid"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-orange-50 text-orange-600 text-[10px] font-bold uppercase tracking-wide",children:[e.jsx("i",{className:"fas fa-clock"})," Pending"]})})]})]},r._id||p)})})]})})]}),!g&&(s==null?void 0:s.notes)&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-yellow-800 mb-1 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-sticky-note"})," Notes"]}),e.jsx("p",{className:"text-sm text-yellow-800/90 leading-relaxed",children:s.notes})]})]})};export{W as default};
