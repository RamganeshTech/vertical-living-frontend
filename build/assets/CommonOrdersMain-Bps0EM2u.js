import{u as _,s as F,a as A,r as l,j as e,O as M,B as t,C as O,o as R,p as T,g as U,z as B,t as H}from"./index-ogMTmcqi.js";import{u as K,a as G,b as V,c as $}from"./commonOrderHistoryMaterialApi-C6HRAGri.js";import{I as N}from"./Input-Bl8lW2bK.js";import{L as q}from"./Label-C-xV5DF7.js";const Z=()=>{const{organizationId:f}=_(),{openMobileSidebar:C,isMobile:y}=F(),v=A(),[c,d]=l.useState(""),[g,i]=l.useState(!1),[n,m]=l.useState(null),[x,o]=l.useState(""),{data:r,isLoading:w,error:P,refetch:u}=K(f),{mutateAsync:b,isPending:k}=G(),{mutateAsync:E,isPending:S}=V(),{mutateAsync:z,isPending:D}=$(),j=location.pathname.split("/");if(j[j.length-1]!=="commonorder")return e.jsx(M,{context:{openMobileSidebar:C,isMobile:y}});const p=async()=>{c.trim()||H({title:"Error",description:"Project Name is mandatory",variant:"destructive"});try{await b({organizationId:f,payload:{projectName:c}}),d(""),i(!1),await u()}catch(s){console.error(s)}},I=async s=>{if(window.confirm("Are you sure?"))try{await E({id:s}),await u()}catch(a){console.error(a)}},L=async()=>{if(!(!x.trim()||!n))try{await z({id:n,payload:{projectName:x}}),m(null),o(""),await u()}catch(s){console.error(s)}};return e.jsxs("div",{className:"max-w-full mx-auto p-2 space-y-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("h1",{className:"text-2xl font-bold text-blue-600",children:[e.jsx("i",{className:"fas fa-layer-group mr-2"}),"Common Projects"]}),!g&&e.jsxs(t,{variant:"primary",onClick:()=>i(!0),children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Create New Project"]})]}),g&&e.jsx("div",{onClick:()=>i(!1),className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{onClick:s=>s.stopPropagation(),className:"flex rounded-2xl bg-white flex-col p-6 gap-3 max-w-lg items-start",children:[e.jsx(q,{className:"text-2xl",children:"Create Project"}),e.jsx(N,{placeholder:"Enter project name",value:c,onChange:s=>d(s.target.value),autoFocus:!0,onKeyDown:s=>{s.key==="Enter"&&p()}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{variant:"primary",onClick:p,isLoading:k,children:[e.jsx("i",{className:"fas fa-save mr-2"}),"Save"]}),e.jsx(t,{variant:"ghost",onClick:()=>{i(!1),d("")},children:"Cancel"})]})]})}),w&&e.jsx("p",{children:"Loading projects..."}),P&&e.jsx("p",{className:"text-red-500",children:"Something went wrong while loading projects."}),(r==null?void 0:r.length)===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center text-gray-500",children:[e.jsx("i",{className:"fas fa-folder-open text-5xl text-blue-300 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold",children:"No Projects Found"}),e.jsx("p",{children:"Create a project to start managing materials more efficiently."})]}),e.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3",children:r==null?void 0:r.map(s=>{var h;return e.jsx("div",{className:"transition-transform hover:scale-[1.02] cursor-pointer",children:e.jsxs(O,{className:"shadow-md hover:shadow-lg border-l-4 border-blue-600",children:[e.jsx(R,{children:n===s._id?e.jsx(N,{value:x,onChange:a=>{o(a.target.value)},autoFocus:!0,onKeyDown:a=>{a.key},placeholder:"Edit project name"}):e.jsxs(T,{className:"line-clamp-1",children:[e.jsx("i",{className:"fas fa-project-diagram mr-2 text-blue-500"}),s.projectName||"Untitled"]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsx("i",{className:"fas fa-tasks mr-1 text-gray-400"}),"Order Units:"," ",e.jsx("span",{className:"font-medium text-blue-600",children:(h=s==null?void 0:s.selectedUnits)==null?void 0:h.length})]}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:n===s._id?e.jsxs(e.Fragment,{children:[e.jsxs(t,{size:"sm",variant:"primary",onClick:a=>{a.stopPropagation(),L()},isLoading:D,children:[e.jsx("i",{className:"fas fa-check mr-1"}),"Save"]}),e.jsx(t,{size:"sm",variant:"ghost",onClick:a=>{a.stopPropagation(),m(null),o("")},children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{size:"sm",variant:"outline",onClick:a=>{a.stopPropagation(),m(s._id),o(s.projectName||"")},children:[e.jsx("i",{className:"fas fa-edit mr-1 text-blue-500"}),"Edit"]}),e.jsxs(t,{size:"sm",variant:"danger",onClick:a=>{a.stopPropagation(),I(s._id)},isLoading:S,className:"hover:text-white",children:[e.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Delete"]}),e.jsxs(t,{size:"sm",variant:"secondary",onClick:a=>{a.stopPropagation(),v(`${s._id}`)},children:[e.jsx("i",{className:"fas fa-eye mr-1 text-blue-600"}),"View"]})]})})]})]})},s._id)})})]})};export{Z as default};
