import{b as U,u as B,r as f,j as e}from"./index-g9v5L7eS.js";import{c as T,d as M,e as S}from"./customerAccountApi-CF9q41F6.js";import{C as I}from"./CustomerAccountForm-D7iJVo40.js";import{t as r}from"./toast-BSC5QTk1.js";import{B as c}from"./Button-DXzmpjtA.js";import{C as $}from"./Card-BZ8fgwGK.js";import{d as N}from"./dateFormator-BGKi5rfZ.js";import G from"./MaterialOverviewLoading-DtCbU8U1.js";import"./useQuery-BlDIWKCM.js";import"./useMutation-CAsfcLt-.js";import"./useInfiniteQuery-Cey4CECX.js";import"./roleCheck-vn63l46q.js";import"./Skeleton-1GHmvOlA.js";const Z=()=>{var p,j,g;const{id:m}=U(),n=B(),[y,d]=f.useState(!1),[i,v]=f.useState("main"),{data:s,isLoading:k,isError:C,error:o,refetch:b}=T(m),h=M(),x=S(),[l,u]=f.useState([]),w=async a=>{try{await h.mutateAsync({customerId:m,payload:a}),r({title:"Success",description:"Customer updated successfully"}),d(!1),b()}catch(t){throw r({title:"Error",description:t.message||"Failed to update customer"}),t}},D=async()=>{if(l.length===0){r({title:"Warning",description:"Please select at least one file to upload"});return}try{const a=new FormData;l.forEach(t=>{a.append("files",t)}),await x.mutateAsync({id:m,formData:a}),r({title:"Success",description:"Documents uploaded successfully"}),u([]),b()}catch(a){r({title:"Error",description:a.message||"Failed to upload documents"})}},F=a=>{a.target.files&&u(Array.from(a.target.files))},E=a=>{u(t=>t.filter((L,A)=>A!==a))};if(k)return e.jsx(G,{});if(C)return e.jsxs("div",{className:"max-w-xl mx-auto mt-8 p-4 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2 text-xl",children:"⚠️ Error Occurred"}),e.jsx("p",{className:"text-red-500 mb-4",children:(o==null?void 0:o.message)||"Failed to load customer"}),e.jsx(c,{onClick:()=>n(-1),children:"Go Back"})]});if(!s)return e.jsxs("div",{className:"max-w-xl mx-auto mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-yellow-600 font-semibold mb-2 text-xl",children:"Customer Not Found"}),e.jsx(c,{onClick:()=>n(-1),children:"Go Back"})]});const P=[{id:"main",label:"Main Information",icon:"fa-user"},{id:"other",label:"Other Details",icon:"fa-info-circle"},{id:"documents",label:"Documents",icon:"fa-file-upload"}];return y?e.jsx(I,{mode:"update",initialData:s,setIsEditing:d,onSubmit:w,isSubmitting:h.isPending}):e.jsxs("div",{className:"max-w-full mx-auto max-h-full overflow-y-auto",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>n(-1),className:"bg-blue-50 hover:bg-slate-300 flex items-center justify-between w-8 h-8 border border-[#a6aab8] text-sm cursor-pointer rounded-md px-2 ",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:`fas ${s.customerType==="business"?"fa-building":"fa-user"} mr-3 text-blue-600`}),s.firstName]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${s.customerType==="business"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:s.customerType==="business"?"Business":"Individual"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[e.jsx("i",{className:"fas fa-calendar-alt mr-1"}),"Created: ",N(s.createdAt)]})]})]}),e.jsxs(c,{onClick:()=>d(!0),children:[e.jsx("i",{className:"fas fa-edit mr-2"}),"Edit Customer"]})]})]}),e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:P.map(a=>e.jsxs("button",{onClick:()=>v(a.id),className:`
                                    py-4 px-1 cursor-pointer border-b-2 font-medium text-sm flex items-center gap-2
                                    ${i===a.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                                `,children:[e.jsx("i",{className:`fas ${a.icon}`}),a.label]},a.id))})})}),e.jsx($,{children:e.jsxs("div",{className:"p-6",children:[i==="main"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-user mr-2 text-blue-600"}),"Main Information"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer Type"}),e.jsxs("p",{className:"text-gray-900 flex items-center",children:[e.jsx("i",{className:`fas ${s.customerType==="business"?"fa-building":"fa-user"} mr-2 text-blue-600`}),s.customerType==="business"?"Business":"Individual"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),e.jsx("p",{className:"text-gray-900",children:s.firstName||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),e.jsx("p",{className:"text-gray-900",children:s.lastName||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name"}),e.jsx("p",{className:"text-gray-900",children:s.companyName||"-"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-envelope mr-2 text-gray-400"}),"Email"]}),e.jsx("p",{className:"text-gray-900",children:s.email||"-"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-mobile-alt mr-2 text-gray-400"}),"Mobile Number"]}),e.jsx("p",{className:"text-gray-900",children:((p=s.phone)==null?void 0:p.mobile)||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-phone mr-2 text-gray-400"}),"Work Number"]}),e.jsx("p",{className:"text-gray-900",children:((j=s.phone)==null?void 0:j.work)||"-"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-language mr-2 text-gray-400"}),"Customer Language"]}),e.jsx("p",{className:"text-gray-900",children:s.customerLanguage||"-"})]})]}),i==="other"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-info-circle mr-2 text-blue-600"}),"Other Details"]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-id-card mr-2 text-gray-400"}),"PAN Number"]}),e.jsx("p",{className:"text-gray-900",children:s.pan||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-dollar-sign mr-2 text-gray-400"}),"Currency"]}),e.jsx("p",{className:"text-gray-900",children:s.currency||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-receipt mr-2 text-gray-400"}),"Accounts Receivable"]}),e.jsx("p",{className:"text-gray-900",children:s.accountsReceivable||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-wallet mr-2 text-gray-400"}),"Opening Balance"]}),e.jsxs("p",{className:"text-gray-900",children:[((g=s.currency)==null?void 0:g.split("-")[0].trim())||"INR"," ",s.openingBalance||0]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-calendar-check mr-2 text-gray-400"}),"Payment Terms"]}),e.jsx("p",{className:"text-gray-900",children:s.paymentTerms||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"fas fa-portal-enter mr-2 text-gray-400"}),"Customer Portal Access"]}),e.jsx("p",{className:"text-gray-900",children:s.enablePortal?e.jsxs("span",{className:"text-green-600",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),"Enabled"]}):e.jsxs("span",{className:"text-red-600",children:[e.jsx("i",{className:"fas fa-times-circle mr-1"}),"Disabled"]})})]})]}),i==="documents"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-file-upload mr-2 text-blue-600"}),"Documents"]})}),s.documents&&s.documents.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:["Uploaded Documents (",s.documents.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.documents.map((a,t)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("i",{className:`fas ${a.type==="pdf"?"fa-file-pdf text-red-500":"fa-file-image text-blue-500"} text-2xl`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.originalName||"Document"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.type.toUpperCase()," • ",N(a==null?void 0:a.uploadedAt)]})]})]}),e.jsx("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:e.jsx("i",{className:"fas fa-external-link-alt"})})]},t))})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Upload New Documents"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-500 transition-colors cursor-pointer",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*,.pdf",onChange:F,className:"hidden",id:"file-upload-view"}),e.jsxs("label",{htmlFor:"file-upload-view",className:"cursor-pointer",children:[e.jsx("i",{className:"fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2 block"}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Click to upload"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, PNG, JPG, JPEG (MAX. 10MB per file)"})]})]}),l.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["New Files to Upload (",l.length,")"]}),e.jsx("div",{className:"space-y-2",children:l.map((a,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("i",{className:`fas ${a.type.includes("pdf")?"fa-file-pdf text-red-500":"fa-file-image text-blue-500"} text-xl`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(a.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>E(t),className:"text-red-500 hover:text-red-700",children:e.jsx("i",{className:"fas fa-times"})})]},t))}),e.jsx(c,{onClick:D,disabled:x.isPending,className:"mt-4 w-full",children:x.isPending?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Uploading Documents..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-upload mr-2"}),"Upload Documents"]})})]})]}),(!s.documents||s.documents.length===0)&&l.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"fas fa-folder-open text-4xl mb-3 block"}),e.jsx("p",{children:"No documents uploaded yet"}),e.jsx("p",{className:"text-xs mt-1",children:"Upload documents using the form above"})]})]})]})})]})};export{Z as default};
