import{c as B,r as x,d as M,j as e,B as u}from"./index-DyM6T-eT.js";import{L as c}from"./Label-B3hr6461.js";import{S as O}from"./SearchSelectNew-BTs46di7.js";import{u as P}from"./getAllUsersApi-V_vS6o62.js";const q=({mode:R,initialData:a,organizationId:k,isSubmitting:g,onSubmit:I})=>{var y,C;const b=B(),[n,f]=x.useState(R),{role:p,permission:t}=M(),S=p==="owner"||((y=t==null?void 0:t.toolhardware)==null?void 0:y.create),j=p==="owner"||((C=t==null?void 0:t.toolhardware)==null?void 0:C.edit),{data:A=[]}=P(k,"staff"),N=(A||[]).map(s=>({value:s._id,label:s.staffName,email:s.email,role:s.role})),T=s=>{const i=N.find(r=>r.value===s);m(i?r=>({...r,inchargeUser:i.value,inchargeRole:i.role}):r=>({...r,inchargeUser:"",inchargeRole:""}))},[l,m]=x.useState({toolRoomName:"",location:"",inchargeUser:"",inchargeRole:"staff",allowedIssueFrom:"09:00",allowedIssueTo:"18:00",isActive:!0});x.useEffect(()=>{var s;a&&m({toolRoomName:a.toolRoomName||"",location:a.location||"",inchargeUser:((s=a.inchargeUser)==null?void 0:s._id)||"",inchargeRole:a.inchargeRole||"staff",allowedIssueFrom:a.allowedIssueFrom||"09:00",allowedIssueTo:a.allowedIssueTo||"18:00",isActive:a.isActive??!0})},[a,n]);const d=s=>{const{name:i,value:r,type:U}=s.target,E=U==="checkbox"?s.target.checked:r;m(L=>({...L,[i]:E}))},o=n==="view",h=n==="create",v=n==="edit",w=()=>f(s=>s==="view"?"edit":"view"),F=async s=>{s.preventDefault(),await I(l),n==="edit"&&f("view")};return e.jsxs("div",{className:"max-w-full min-h-[80vh] mx-auto space-y-4",children:[e.jsxs("header",{className:"sticky px-4 top-0 z-20 bg-white border-b border-gray-200 pb-4 pt-2 mb-6 flex justify-between items-center rounded-b-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>b(-1),className:"bg-blue-50 hover:bg-blue-100 flex items-center justify-center w-9 h-9 border border-blue-200 text-blue-600 cursor-pointer rounded-lg",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:h?"Add Tool Room":v?"Update Room":"Room Overview"}),e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Physical Storage Location"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[o&&j&&e.jsxs(u,{type:"button",onClick:w,variant:"outline",className:"border-blue-600 text-blue-600",children:[e.jsx("i",{className:"fas fa-edit mr-2"}),"Edit Room"]}),(h||v)&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{type:"button",onClick:F,disabled:g,className:"bg-blue-600 text-white",children:[g?e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}):e.jsx("i",{className:"fas fa-save mr-2"}),h?"Create Room":"Save Changes"]}),e.jsx(u,{variant:"outline",type:"button",onClick:()=>h?b(-1):w(),className:"bg-white",children:"Cancel"})]})]})]}),e.jsxs("form",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("h3",{className:"text-sm font-black text-blue-600 uppercase tracking-widest mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-warehouse mr-2"})," Room Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Tool Room Name"}),e.jsx("input",{name:"toolRoomName",value:l.toolRoomName,onChange:d,disabled:o,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none mt-1",placeholder:"e.g., Central Site Store"})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Location / Landmark"}),e.jsx("input",{name:"location",value:l.location,onChange:d,disabled:o,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none mt-1",placeholder:"e.g., Block A, Basement"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("h3",{className:"text-sm font-black text-blue-600 uppercase tracking-widest mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-clock mr-2"})," Issue & Return Timings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Allowed From"}),e.jsx("input",{type:"time",name:"allowedIssueFrom",value:l.allowedIssueFrom,onChange:d,disabled:o,className:"w-full px-3 py-2 border rounded-lg mt-1"})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Allowed To"}),e.jsx("input",{type:"time",name:"allowedIssueTo",value:l.allowedIssueTo,onChange:d,disabled:o,className:"w-full px-3 py-2 border rounded-lg mt-1"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("h3",{className:"text-sm font-black text-blue-600 uppercase tracking-widest mb-4 flex items-center",children:[e.jsx("i",{className:"fas fa-user-shield mr-2"})," Personnel In-Charge"]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{className:"text-gray-700 font-semibold flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-user-check text-blue-600 text-xs"}),"Select Assigned In-Charge"]}),e.jsx(O,{options:N,placeholder:"Choose staff member",searchPlaceholder:"Search by name...",value:l.inchargeUser,onValueChange:T,enabled:o&&(j||S),searchBy:"name",displayFormat:"detailed",className:"w-full"})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-bold",children:"Operating Status"}),e.jsx("p",{className:"text-[10px] text-gray-500",children:"Toggle off to temporarily close this room"})]}),e.jsx("input",{type:"checkbox",name:"isActive",checked:l.isActive,onChange:d,disabled:o,className:"w-5 h-5 accent-blue-600 cursor-pointer"})]})})]})]})]})};export{q as T};
