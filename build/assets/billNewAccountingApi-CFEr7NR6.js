import{u as d,n as N,o as E,G as g,a as h,b as w}from"./index-CBsAK0nv.js";const f="/department/accounting/billpdf",b=async({organizationId:e,page:t,limit:n,search:a,createdFromDate:r,createdToDate:i,sortBy:s,sortOrder:p,api:u})=>{const l=new URLSearchParams;l.append("organizationId",e),t&&l.append("page",t.toString()),n&&l.append("limit",n.toString()),a&&l.append("search",a),r&&l.append("createdFromDate",r),i&&l.append("createdToDate",i),s&&l.append("sortBy",s),p&&l.append("sortOrder",p);const{data:o}=await u.get(`${f}/template/all?${l.toString()}`);if(!o.ok)throw new Error(o.message);return o},_=async({id:e,organizationId:t,api:n})=>{const{data:a}=await n.get(`${f}/template/${e}/${t}`);return a.data},A=async({organizationId:e,templateName:t,layout:n,api:a})=>{const r=new FormData;r.append("organizationId",e),r.append("templateName",t);const i=[],s=n.map(u=>({...u,components:u.components.map(l=>{const o={...l};return o.type==="image"&&o.value&&o.value[0]instanceof File&&(i.push(o.value[0]),o.value=[`__FILE_${i.length-1}__`]),o})}));r.append("layout",JSON.stringify(s)),i.forEach(u=>{r.append("files",u)});const{data:p}=await a.post(`${f}/template`,r,{headers:{"Content-Type":"multipart/form-data"}});return p},S=async({id:e,organizationId:t,layout:n,templateName:a,api:r})=>{const i=new FormData;i.append("organizationId",t),a&&i.append("templateName",a);const s=[],p=n.map(l=>({...l,components:l.components.map(o=>{const c={...o};return c.type==="image"&&c.value&&c.value[0]instanceof File&&(s.push(c.value[0]),c.value=[`__FILE_${s.length-1}__`]),c})}));i.append("layout",JSON.stringify(p)),s.forEach(l=>{i.append("files",l)});const{data:u}=await r.put(`${f}/template/${e}`,i,{headers:{"Content-Type":"multipart/form-data"}});return u},v=async({organizationId:e,projectId:t,customerName:n,templateId:a,layout:r,api:i})=>{const s=new FormData;s.append("organizationId",e),t&&s.append("projectId",t),n&&s.append("customerName",n),a&&s.append("templateId",a);const p=[],u=JSON.parse(JSON.stringify(r)).map(o=>(o.components=o.components.map(c=>(c.type==="image"&&c.value[0]instanceof File&&(p.push(c.value[0]),c.value=[`__FILE_${p.length-1}__`]),c)),o));s.append("layout",JSON.stringify(u)),p.forEach(o=>{s.append("files",o)});const{data:l}=await i.post(`${f}/bill`,s,{headers:{"Content-Type":"multipart/form-data"}});return l},$=async({id:e,organizationId:t,layout:n,customerName:a,projectId:r,billNumber:i,api:s})=>{const p=new FormData;p.append("organizationId",t),a&&p.append("customerName",a),r&&p.append("projectId",r),i&&p.append("billNumber",i);const u=[],l=n.map(c=>({...c,components:c.components.map(m=>m.type==="image"&&typeof m.value[0]!="string"?(u.push(m.value[0]),{...m,value:[`__FILE_${u.length-1}__`]}):m)}));p.append("layout",JSON.stringify(l)),u.forEach(c=>p.append("files",c));const{data:o}=await s.put(`${f}/bill/${e}`,p,{headers:{"Content-Type":"multipart/form-data"}});return o},q=async({organizationId:e,projectId:t,page:n,limit:a,search:r,createdFromDate:i,createdToDate:s,sortBy:p,sortOrder:u,api:l})=>{const o=new URLSearchParams;t&&o.append("projectId",t),n&&o.append("page",n.toString()),a&&o.append("limit",a.toString()),r&&o.append("search",r),i&&o.append("createdFromDate",i),s&&o.append("createdToDate",s),p&&o.append("sortBy",p),u&&o.append("sortOrder",u);const{data:c}=await l.get(`${f}/billall/${e}?${o.toString()}`);return c},F=async({id:e,api:t})=>{const{data:n}=await t.get(`${f}/bill/${e}`);return n.data},P=async({id:e,organizationId:t,api:n})=>{const{data:a}=await n.delete(`${f}/bill/delete/${e}/${t}`);return a},y=["owner","staff","CTO","client"],C=({organizationId:e,limit:t=10,search:n,createdFromDate:a,createdToDate:r,sortBy:i,sortOrder:s})=>{const p=["owner","staff","CTO"],{role:u}=d(),l=w(u);return N({queryKey:["billnew","templates",e,t,n,a,r,i,s],queryFn:async({pageParam:o=1})=>{if(!u||!p.includes(u))throw new Error("Not allowed");if(!l)throw new Error("API instance not found");return await b({organizationId:e,page:o,limit:t,search:n,createdFromDate:a,createdToDate:r,sortBy:i,sortOrder:s,api:l})},getNextPageParam:o=>{if(o.pagination.hasNextPage)return o.pagination.page+1},initialPageParam:1,enabled:!!u&&!!e})},I=({id:e,organizationId:t})=>{const{role:n}=d(),a=w(n);return E({queryKey:["billnew","template",e,t],queryFn:async()=>{if(!n)throw new Error("Not allowed");if(!a)throw new Error("API instance not found");return await _({id:e,organizationId:t,api:a})},enabled:!!e&&!!t&&!!n})},B=()=>{const{role:e}=d(),t=w(e),n=g();return h({mutationFn:async a=>{if(!e||!y.includes(e))throw new Error("Not allowed");if(!t)throw new Error("API not found");return await A({...a,api:t})},onSuccess:(a,{organizationId:r})=>{n.invalidateQueries({queryKey:["billnew","templates",r]})}})},L=()=>{const{role:e}=d(),t=w(e),n=g();return h({mutationFn:async a=>{if(!e||!y.includes(e))throw new Error("Not allowed");if(!t)throw new Error("API not found");return await S({...a,api:t})},onSuccess:(a,{id:r,organizationId:i})=>{n.invalidateQueries({queryKey:["billnew","templates",i]}),n.invalidateQueries({queryKey:["billnew","template",r]})}})},K=()=>{const{role:e}=d(),t=w(e),n=g();return h({mutationFn:async a=>{if(!e||!y.includes(e))throw new Error("Not allowed");if(!t)throw new Error("API not found");return await v({...a,api:t})},onSuccess:(a,{organizationId:r})=>{n.invalidateQueries({queryKey:["billnew","bills",r]})}})},Q=()=>{const{role:e}=d(),t=w(e),n=g();return h({mutationFn:async a=>{if(!e||!y.includes(e))throw new Error("Not allowed");if(!t)throw new Error("API not found");return await $({...a,api:t})},onSuccess:(a,{id:r,organizationId:i})=>{n.invalidateQueries({queryKey:["billnew","bills",i]}),n.invalidateQueries({queryKey:["billnew","bill",r]})}})},U=({organizationId:e,projectId:t,limit:n=10,search:a,createdFromDate:r,createdToDate:i,sortBy:s,sortOrder:p})=>{const{role:u}=d(),l=w(u);return N({queryKey:["billnew","bills",e,t,n,a,r,i,s,p],queryFn:async({pageParam:o=1})=>{if(!u)throw new Error("Not allowed");if(!l)throw new Error("API not found");return await q({organizationId:e,projectId:t,page:o,limit:n,search:a,createdFromDate:r,createdToDate:i,sortBy:s,sortOrder:p,api:l})},getNextPageParam:o=>{if(o.pagination.hasNextPage)return o.pagination.page+1},initialPageParam:1,enabled:!!e&&!!u})},O=({id:e})=>{const{role:t}=d(),n=w(t);return E({queryKey:["billnew","bill",e],queryFn:async()=>{if(!t||!y.includes(t))throw new Error("Not allowed");if(!n)throw new Error("API not found");return await F({id:e,api:n})},enabled:!!e&&!!t})},R=()=>{const{role:e}=d(),t=w(e),n=g();return h({mutationFn:async({id:a,organizationId:r})=>{if(!e||!y.includes(e))throw new Error("Not allowed");if(!t)throw new Error("API not found");return await P({id:a,organizationId:r,api:t})},onSuccess:(a,{organizationId:r})=>{n.invalidateQueries({queryKey:["billnew","bills",r]})}})};export{I as a,B as b,L as c,U as d,R as e,O as f,K as g,Q as h,C as u};
