import{u as A,r as u,e as C,j as e,B as o,S as E,i as U,k as P,l as D,m as z,t as c}from"./index-CKvTvGhg.js";import{a as L}from"./fieldConfigs-76DOpAJg.js";import{a as _}from"./selectedModularUnitApi-BHwdhMaq.js";import{N as k}from"./constants-CP15s2Qq.js";const B=({unit:s,onEdit:d})=>{var m,x,g;const{projectId:p}=A(),[h,f]=u.useState(!1),{mutateAsync:j,isPending:n}=L(),{mutateAsync:y,isPending:b}=_(),N=C(),[l,v]=u.useState(1),S=N.pathname.includes("projectdetails"),w=async()=>{var a,r;try{if(!window.confirm("Are you sure you want to delete this unit?"))return;await j({unitId:s._id,unitType:s.category,organizationId:s.organizationId}),c({title:"Success",description:"Product deleted successfully"})}catch(t){c({title:"Error",description:((r=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:r.message)||(t==null?void 0:t.message)||"Failed to delete",variant:"destructive"})}},I=async()=>{var a,r,t;if(!l||l<=0){c({title:"Invalid Quantity",description:"Quantity must be greater than 0"});return}try{const i={image:(a=s==null?void 0:s.images[0])==null?void 0:a.url,customId:s.customId,unitName:s.name,unitId:s._id,projectId:p,category:s.category,singleUnitCost:s.price,quantity:l};await y(i),c({title:"Success",description:"Unit selected successfully"})}catch(i){c({title:"Error",description:((t=(r=i==null?void 0:i.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to select unit",variant:"destructive"})}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-xl transition-all duration-300  group border border-gray-100 hover:border-blue-200",children:[e.jsxs("div",{className:"relative aspect-square overflow-hidden bg-gradient-to-br from-gray-100 to-gray-200",children:[(x=(m=s.images)==null?void 0:m[0])!=null&&x.url&&!h?e.jsx("img",{src:s.images[0].url||k,alt:s.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:()=>f(!0)}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-image text-gray-400 text-3xl mb-2"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No Image"})]})}),e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:e.jsx("div",{className:"flex gap-2"})}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:"bg-blue-600 text-white text-xs font-semibold px-2 py-1 rounded-md shadow-sm",children:s==null?void 0:s.category})}),s.price&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsxs("span",{className:"bg-green-600 text-white text-xs font-semibold px-2 py-1 rounded-md shadow-sm flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-rupee-sign"}),s.price.toLocaleString()]})})]}),e.jsxs("div",{className:"p-4 h-auto",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-base mb-2 line-clamp-2 group-hover:text-blue-600 transition-colors",children:s.name||"Unnamed Product"}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("i",{className:"fas fa-hashtag text-gray-400 text-xs"}),e.jsx("p",{className:"text-xs text-gray-500 font-mono truncate",children:s.customId||s._id})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600 flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-tag text-blue-500 text-xs"}),"Category"]}),e.jsx("span",{className:"font-medium text-gray-900 capitalize truncate ml-2",children:(s==null?void 0:s.category)||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600 flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-rupee-sign text-green-500 text-xs"}),"Price"]}),e.jsxs("span",{className:"font-bold text-green-600",children:["â‚¹",((g=s.price)==null?void 0:g.toLocaleString())||"N/A"]})]})]}),S?e.jsxs("div",{className:"space-y-2 ",children:[e.jsx("div",{className:"relative overflow-visible z-40",children:e.jsxs(E,{value:l.toString(),onValueChange:a=>v(Number(a)),children:[e.jsx(U,{className:"w-full",children:e.jsx(P,{placeholder:"Select Quantity",selectedValue:l.toString()})}),e.jsx(D,{className:"z-50",children:Array.from({length:10},(a,r)=>r+1).map(a=>e.jsx(z,{value:a.toString(),children:a},a))})]})}),e.jsx(o,{variant:"primary",isLoading:b,onClick:I,className:"w-full",children:"Submit"})]}):e.jsxs("div",{className:"flex gap-2",children:[d&&e.jsxs(o,{onClick:()=>d(s),className:"flex-1 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 hover:border-blue-300 py-2 px-3 rounded-lg transition-all text-sm",children:[e.jsx("i",{className:"fas fa-edit mr-1"}),"Edit"]}),e.jsxs(o,{variant:"danger",onClick:w,disabled:n,className:"flex-1 bg-red-600 text-white  py-2 px-3 rounded-lg transition-all disabled:opacity-50 text-sm",children:[e.jsx("i",{className:`fas ${n?"fa-spinner fa-spin":"fa-trash"} mr-1`}),n?"Deleting...":"Delete"]})]})]})]})};export{B as S};
