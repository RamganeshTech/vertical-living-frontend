import{c as N,a as k,r as i,j as e}from"./index-CqEiDvr_.js";import{t as n}from"./toast-BSC5QTk1.js";import{B as p}from"./Button-DzcQpMPj.js";import{I as L}from"./Input-Bm6t9LQ8.js";import{c as E,d as I}from"./subContractNewApi-ChfbgBsf.js";import{S as $}from"./SubContractForm-DYG44W9e.js";import{L as F}from"./Label-eTwpFRw6.js";import{S as B,a as P,b as T,c as V,d as z}from"./Select-bw0SngOl.js";import"./useQuery-DyvuN1xf.js";import"./useMutation-DDHgQq3T.js";import"./useInfiniteQuery-DFFyAdlX.js";import"./roleCheck-BJ07f95N.js";import"./Card-CHisThjm.js";import"./projectApi-vSAHE0yY.js";import"./SearchSelectNew-BHCpfa7r.js";import"./ImageGalleryMain-CHhXwafP.js";import"./constants-DnylCaPP.js";import"./downloadFile-BF_lyJpu.js";import"./index-Dujx1vkm.js";const se=()=>{const g=N(),{organizationId:f,subContractId:c}=k(),{data:t,isLoading:h,isError:b,refetch:d}=E({subContractId:c}),[j,m]=i.useState(!1),[o,v]=i.useState(""),[r,C]=i.useState((t==null?void 0:t.status)||"pending");i.useEffect(()=>{if(t){const s=`https://houseofram.in/subcontract/share/${t._id}?token=${t.token}`;v(s),t!=null&&t.status&&C(t.status)}},[t]);const S=()=>{navigator.clipboard.writeText(o),m(!0),n({title:"Copied!",description:"Link copied to clipboard"}),setTimeout(()=>m(!1),2e3)},{mutateAsync:y}=I(),l={pending:{triggerClass:"bg-yellow-50 border-yellow-300 text-yellow-700",valueClass:"text-yellow-700 font-medium",itemClass:"text-yellow-700 hover:bg-yellow-50 hover:text-yellow-800 font-medium",dotColor:"bg-yellow-500",label:"Pending"},accepted:{triggerClass:"!bg-green-50 border-green-300 text-green-700",valueClass:"text-green-700 font-medium",itemClass:"text-green-700 hover:bg-green-50 hover:text-green-800 font-medium",dotColor:"bg-green-500",label:"Accepted"},rejected:{triggerClass:"!bg-red-50 border-red-300 text-red-700",valueClass:"text-red-700 font-medium",itemClass:"text-red-700 hover:bg-red-50 hover:text-red-800 font-medium",dotColor:"bg-red-500",label:"Rejected"}},w=async s=>{var u,x;try{await y({subContractId:c,status:s}),d(),n({title:"Success",description:"status successfully"})}catch(a){n({title:"Error",description:((x=(u=a==null?void 0:a.response)==null?void 0:u.data)==null?void 0:x.message)||(a==null?void 0:a.message)||"Failed to upload files",variant:"destructive"})}};return h?e.jsx("div",{children:"Loading subcontract details..."}):b||!t?e.jsx("div",{children:"Error loading data. Please try again."}):e.jsxs("div",{className:"space-y-6 max-h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between gap-2 items-center",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(p,{variant:"outline",size:"icon",onClick:()=>g(-1),children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sub Contract Details"})]}),e.jsxs(B,{value:r,onValueChange:s=>{w(s)},children:[e.jsx(P,{className:`w-full ${l[r].triggerClass}`,children:e.jsx(T,{placeholder:"Select Status",selectedValue:r.toString(),className:l[r].valueClass})}),e.jsx(V,{children:["pending","accepted","rejected"].map(s=>e.jsx(z,{value:s,className:l[s].itemClass,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${l[s].dotColor}`}),l[s].label]})},s))})]})]}),e.jsxs("div",{className:"max-w-full mx-auto space-y-8",children:[e.jsx($,{organizationId:f,mode:"view",initialData:t,refetch:d}),o&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{children:"Form Link"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[e.jsx(L,{value:o,readOnly:!0,className:"bg-blue-50 text-blue-800 flex-1"}),e.jsx(p,{onClick:S,className:"w-full sm:w-auto",children:e.jsx("i",{className:`fas ${j?"fa-check":"fa-copy"}`})})]})]})]})]})};export{se as default};
