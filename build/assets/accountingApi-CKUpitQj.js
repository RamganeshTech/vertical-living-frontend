import{u as p}from"./useQuery-BHdcKCtG.js";import{u as d}from"./useInfiniteQuery-iAVIpWnU.js";import{g as u}from"./index-DmIvND9E.js";import{g as m}from"./roleCheck-DZRqXPrB.js";const r=["owner","CTO","staff"],w=async({organizationId:a,api:e,filters:n,pageParam:c=1})=>{const o={organizationId:a,page:c,limit:20};n!=null&&n.projectId&&(o.projectId=n.projectId),n!=null&&n.status&&(o.status=n.status),n!=null&&n.search&&(o.search=n.search),n!=null&&n.fromDept&&(o.deptRecordFrom=n.fromDept),n!=null&&n.startDate&&(o.startDate=n.startDate),n!=null&&n.endDate&&(o.endDate=n.endDate),(n==null?void 0:n.minAmount)!==void 0&&(o.minAmount=n.minAmount),(n==null?void 0:n.maxAmount)!==void 0&&(o.maxAmount=n.maxAmount),n!=null&&n.personName&&(o.personName=n.personName);const{data:t}=await e.get("/department/accounting/getaccountingall",{params:o});if(!t.ok)throw new Error(t.message||"Failed to fetch records");return t},A=async({id:a,api:e})=>{const{data:n}=await e.get(`/department/accounting/single/${a}`);if(!n.success&&!n.ok)throw new Error(n.message||"Failed to fetch record");return n},P=(a,e)=>{const{role:n}=u(),c=m(n);return d({queryKey:["accounting","infinite",a,e],queryFn:async({pageParam:o=1})=>{if(!n||!r.includes(n))throw new Error("Not allowed");if(!c)throw new Error("API instance not found for role");return await w({organizationId:a,api:c,filters:e,pageParam:o})},initialPageParam:1,getNextPageParam:o=>{const{page:t,totalPages:g}=o.pagination;return t<g?t+1:void 0},enabled:!!a&&!!n&&!!c})},E=a=>{const{role:e}=u(),n=m(e);return p({queryKey:["accounting","single",a],queryFn:async()=>{if(!e||!r.includes(e))throw new Error("Not allowed");if(!n)throw new Error("API instance not found for role");return await A({id:a,api:n})},enabled:!!a&&!!e&&!!n})};export{E as a,P as u};
