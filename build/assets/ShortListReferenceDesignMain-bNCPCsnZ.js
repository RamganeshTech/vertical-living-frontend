import{u as I,r as g,j as e,C as w,b as P,c as C,B as p,a as E,M as R,t as i}from"./index-BbUIXOOD.js";import{u as F,a as G,b as A}from"./shortlistReferenceDesignApi-BHTB_29R.js";import{I as B}from"./ImageGalleryMain-XIrsj7kv.js";import"./constants-DTyOAfyo.js";import"./downloadFile-B3lnAwEb.js";import"./index-7YcGamaq.js";const L=["image/jpeg","image/jpg","image/png","image/webp"];function U(){const{organizationId:n}=I(),{data:l,refetch:f,isFetching:x}=F({organizationId:n}),{mutateAsync:u}=G(),{mutateAsync:h}=A(),c=g.useRef(null),[o,d]=g.useState(!1),j=s=>{const r=Array.from(s.target.files||[]).filter(a=>L.includes(a.type));if(r.length===0){i({title:"Error",description:"Please select valid image files (JPG, JPEG, PNG, WEBP)",variant:"destructive"});return}m(r)},m=async s=>{var t,r;try{const a=new FormData;s.forEach(D=>{a.append("files",D)}),await u({organizationId:n,formData:a}),i({title:"Success",description:"Image(s) uploaded successfully."})}catch(a){i({title:"Error",description:((r=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:r.message)||(a==null?void 0:a.message)||"Failed to upload images",variant:"destructive"})}},b=async s=>{var t,r;try{await h({organizationId:n,imageId:s}),i({title:"Success",description:"Image deleted"})}catch(a){i({title:"Error",description:((r=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:r.message)||(a==null?void 0:a.message)||"Failed to upload images",variant:"destructive"})}},v=s=>{s.preventDefault(),s.stopPropagation(),d(!1)},y=s=>{s.preventDefault(),s.stopPropagation()},N=async s=>{s.preventDefault(),s.stopPropagation(),d(!1);const t=Array.from(s.dataTransfer.files);await m(t)};return e.jsxs("div",{className:"w-full max-h-full mx-auto p-2 overflow-y-auto",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:e.jsxs("h1",{className:"text-2xl font-semibold text-gray-800",children:[e.jsx("i",{className:"fa-solid fa-object-group text-2xl text-blue-600 mr-2"}),"Reference Designs"]})}),e.jsxs(w,{className:"",children:[e.jsx(P,{children:e.jsxs(C,{className:"flex items-center justify-between",children:[o?"Drop files here...":"Drag and drop image files here or ",e.jsx(p,{variant:"outline",size:"sm",className:"text-blue-600 bg-transparent",children:"Upload reference images, and can be used to compare in the projects"})]})}),e.jsxs(E,{children:[e.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${o?"border-blue-400 bg-blue-50":"border-gray-300"}`,onClick:()=>{var s;return(s=c.current)==null?void 0:s.click()},onDragLeave:v,onDragOver:y,onDrop:N,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"Drag & drop plan/reference images here or"}),e.jsx(p,{variant:"outline",children:"Browse"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Accepted: JPG/PNG/WebP â€¢ Images auto-saved locally"})]})}),e.jsx("input",{ref:c,type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:j})]})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-700 mb-3",children:"Images"}),x?e.jsx("div",{className:"text-center text-gray-600",children:e.jsx(R,{})}):l!=null&&l.referenceImages.length?e.jsx(B,{imageFiles:(l==null?void 0:l.referenceImages)||[],refetch:f,handleDeleteFile:b,height:190,minWidth:156,maxWidth:200}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px] w-full bg-white rounded-xl   text-center p-6",children:[e.jsx("i",{className:"fas fa-image text-5xl text-blue-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-1",children:"No Images Found"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Please upload images"})]})]})]})}export{U as default};
