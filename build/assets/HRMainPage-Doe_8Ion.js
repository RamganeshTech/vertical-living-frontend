import{a as G,c as J,r as c,b as q,j as e,O as K}from"./index-DcYk0AxP.js";import{e as Q,b as U}from"./HrApi-pmTSj8LT.js";import{r as W}from"./constants-B8VJ7ujN.js";import{t as S}from"./toast-BSC5QTk1.js";import{B as I}from"./Button-BYLj5R3i.js";import"./roleCheck-D-Yu12LV.js";import"./useQuery-BPoeBSke.js";import"./useBaseQuery-D96Ix8rH.js";import"./useMutation-BbhnaANP.js";import"./useInfiniteQuery-67LtPPky.js";const oe=()=>{var E;const{openMobileSidebar:L,isMobile:M}=G(),{organizationId:P}=J(),[l,b]=c.useState({}),[n,_]=c.useState(""),[D,X]=c.useState("list"),y=q(),{data:h,fetchNextPage:F,hasNextPage:v,isFetchingNextPage:f,isLoading:R,error:g,refetch:T}=Q(P,l),o=U(),p=c.useMemo(()=>(h==null?void 0:h.pages.flatMap(s=>s.data))||[],[h]),j=c.useMemo(()=>n?p.filter(s=>{var t,a,r,i,d,x,m,u;return((a=(t=s.personalInfo)==null?void 0:t.empName)==null?void 0:a.toLowerCase().includes(n.toLowerCase()))||((i=(r=s.personalInfo)==null?void 0:r.email)==null?void 0:i.toLowerCase().includes(n.toLowerCase()))||((x=(d=s.personalInfo)==null?void 0:d.phoneNo)==null?void 0:x.includes(n))||((u=(m=s.employment)==null?void 0:m.designation)==null?void 0:u.toLowerCase().includes(n.toLowerCase()))}):p,[p,n]),O=()=>{v&&!f&&F()},w=async s=>{var t,a;if(window.confirm("Are you sure you want to delete this employee? This action cannot be undone."))try{await o.mutateAsync({empId:s}),S({title:"Success",description:"Document deleted successfully"})}catch(r){S({title:"Error",description:((a=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to delete document",variant:"destructive"})}},C=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"terminated":return"bg-red-100 text-red-800";case"on_leave":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},z=s=>{switch(s){case"full_time":return"bg-blue-100 text-blue-800";case"part_time":return"bg-purple-100 text-purple-800";case"contract":return"bg-orange-100 text-orange-800";case"intern":return"bg-pink-100 text-pink-800";default:return"bg-gray-100 text-gray-800"}},B=s=>s?new Date(s).toLocaleDateString():"N/A",V=s=>s!=null&&s.total?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s.total):"N/A",N=(s,t)=>{b(a=>({...a,[s]:t||void 0}))},$=()=>{b({})};c.useEffect(()=>{console.log("filter",l)},[l]);const A=Object.values(l).filter(Boolean).length;if(R)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading Employees"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the employee data..."})]})});if(g)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-red-500 text-6xl mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Employees"}),e.jsx("p",{className:"text-gray-600 mb-4",children:g==null?void 0:g.message}),e.jsxs("button",{onClick:()=>T(),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("i",{className:"fas fa-redo mr-2"}),"Try Again"]})]})});const k=location.pathname.split("/");return k[k.length-1]!=="hr"?e.jsx(K,{context:{openMobileSidebar:L,isMobile:M}}):e.jsxs("div",{className:"min-h-full max-h-full overflow-y-auto bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-users mr-3 text-blue-600"}),"Human Resources"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your organization's employees and their information"})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search with Name or Email or Phno",value:n,onChange:s=>_(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full sm:w-80"})]})})]})})}),e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col xl:flex-row gap-6",children:[e.jsx("div",{className:"xl:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),A>0&&e.jsxs("button",{onClick:$,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",A,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee Role"}),e.jsxs("select",{value:l.empRole||"",onChange:s=>N("empRole",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Roles"}),e.jsx("option",{value:"organization_staff",children:"Organization Staff"}),e.jsx("option",{value:"nonorganization_staff",children:"Non-Organization Staff"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:l.status||"",onChange:s=>N("status",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsxs("select",{value:(l==null?void 0:l.department)||"",onChange:s=>N("department",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Department"}),(E=W)==null?void 0:E.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})]})}),e.jsx("div",{className:"flex-1",children:j.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[e.jsx("i",{className:"fas fa-users text-gray-300 text-6xl mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No employees found"}),e.jsx("p",{className:"text-gray-600",children:n||Object.keys(l).length>0?"Try adjusting your search or filters":"Start by adding your first employee"})]}):e.jsxs(e.Fragment,{children:[D==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-6",children:j.map(s=>{var t,a,r,i,d,x,m,u;return e.jsx("div",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-all duration-200 border border-gray-100 hover:border-blue-200 group",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:((t=s.personalInfo)==null?void 0:t.empName)||"N/A"})})}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${C(s.status)}`,children:s.status||"N/A"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("i",{className:"fas fa-briefcase text-gray-400 w-4"}),e.jsx("span",{className:"ml-2 text-gray-600",children:((a=s.employment)==null?void 0:a.designation)||"N/A"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("i",{className:"fas fa-building text-gray-400 w-4"}),e.jsx("span",{className:"ml-2 text-gray-600",children:((r=s.employment)==null?void 0:r.department)||"N/A"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("i",{className:"fas fa-envelope text-gray-400 w-4"}),e.jsx("span",{className:"ml-2 text-gray-600 truncate",children:((i=s.personalInfo)==null?void 0:i.email)||"N/A"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("i",{className:"fas fa-phone text-gray-400 w-4"}),e.jsx("span",{className:"ml-2 text-gray-600",children:((d=s.personalInfo)==null?void 0:d.phoneNo)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[((x=s.employment)==null?void 0:x.employmentType)&&e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${z(s.employment.employmentType)}`,children:s.employment.employmentType.replace("_"," ")}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Salary"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:V((m=s.employment)==null?void 0:m.salary)})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Joined"}),e.jsx("span",{className:"text-gray-900 font-medium",children:B((u=s.employment)==null?void 0:u.joinDate)})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 flex gap-2",children:[e.jsxs("button",{onClick:()=>y(s._id),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"View Details"]}),e.jsx("button",{onClick:H=>{H.stopPropagation(),w(s._id)},className:"bg-red-600 text-white px-3 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm",disabled:o.isPending,children:o.isPending?e.jsx("i",{className:"fas fa-spinner fa-spin"}):e.jsx("i",{className:"fas fa-trash"})})]})]})},s._id)})}):e.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:j.map(s=>{var t,a,r,i;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((t=s.personalInfo)==null?void 0:t.empName)||"N/A"})})})}),e.jsxs("td",{className:"px-6 py-4 text-center",children:[e.jsx("div",{className:"text-sm text-gray-900",children:((a=s.personalInfo)==null?void 0:a.email)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500 ",children:((r=s.personalInfo)==null?void 0:r.phoneNo)||"N/A"})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"text-sm text-gray-900",children:(s==null?void 0:s.employeeModel)==="StaffModel"&&((i=s.employment)==null?void 0:i.department)||"N/A"})}),e.jsx("td",{className:"px-6 py-4 text-center ",children:e.jsx("div",{children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${C(s.status)}`,children:s.status||"N/A"})})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(I,{variant:"secondary",onClick:()=>y(s._id),className:"text-blue-600 hover:text-blue-800 font-medium text-sm",children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"View"]}),e.jsxs(I,{variant:"danger",onClick:()=>w(s._id),className:"text-white  bg-red-600 font-medium text-sm",disabled:o.isPending,children:[o.isPending?e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}):e.jsx("i",{className:"fas fa-trash mr-1"}),"Delete"]})]})})]},s._id)})})]})})}),v&&e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:O,disabled:f,className:"bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Load More Employees"]})})})]})})]})})]})};export{oe as default};
