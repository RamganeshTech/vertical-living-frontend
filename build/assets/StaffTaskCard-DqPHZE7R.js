import{b,c as S,$ as w,j as e}from"./index-By5P0A7l.js";import{C as D,b as T,d as v,a as _}from"./Card-CFqBlVQz.js";import{e as A}from"./staffTaskApi-C3gTAaWg.js";import{B as I}from"./Button-DLUK8O0t.js";import{d as F,f as P}from"./dateFormator-BGKi5rfZ.js";import{t as f}from"./toast-BSC5QTk1.js";const L=({task:s})=>{var n,l,c;const u=b(),{role:t,permission:r}=S(),p=t==="owner"||((n=r==null?void 0:r.stafftask)==null?void 0:n.delete),{_id:x}=w(a=>a.authStore),h=t==="staff",{mutateAsync:g,isPending:j}=A(),N=async a=>{var o,m;try{await g({mainTaskId:a}),f({description:"Task Deleted Successfully",title:"Success"})}catch(i){f({title:"Error",description:((m=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:m.message)||"Failed to delete task",variant:"destructive"})}},d=x===((l=s.assigneeId)==null?void 0:l._id),y=a=>{t==="staff"&&!d||u(`single/${a}`)},C=a=>{switch(a){case"queued":case"puased":case"done":return a;case"in_progress":return"In Progress";default:return"queued"}};return e.jsxs(D,{onClick:()=>y(s._id),className:`${t!=="staff"||d?"cursor-pointer":"cursor-not-allowed"} p-0 border-l-4 border-blue-600`,children:[e.jsx(T,{children:e.jsx(v,{children:(s==null?void 0:s.title.trim())||"No title"})}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("i",{className:"fa-solid fa-calendar-days mr-2 text-blue-600"}),"Due: ",s.due?e.jsxs(e.Fragment,{children:[F(s.due)," - ",P(s==null?void 0:s.due)," "]}):e.jsx(e.Fragment,{children:"N/A"})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("i",{className:"fa-solid fa-layer-group mr-2 text-purple-600"}),"assignee: ",((c=s==null?void 0:s.assigneeId)==null?void 0:c.staffName)||"N/A"]}),e.jsxs("p",{className:"text-sm capitalize",children:[e.jsx("i",{className:"fa-solid fa-chart-line mr-2 text-yellow-500"}),"Status: ",C(s.status)]}),e.jsxs("p",{className:"text-sm capitalize",children:[e.jsx("i",{className:"fa-solid fa-building mr-2 text-indigo-500"}),"Department: ",s.department]}),e.jsx("div",{className:"flex gap-2 mt-3 justify-end",children:!h&&p&&e.jsxs(I,{size:"sm",onClick:a=>{a.stopPropagation(),N(s._id)},className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-md text-sm",isLoading:j,children:[e.jsx("i",{className:"fa-solid fa-trash mr-1"}),"Delete"]})})]})]},s._id)};export{L as S};
