import{u as G,r as R,k as z,j as s,O as h,am as O,an as M}from"./index-BAM0eJUz.js";import{M as $,S as U}from"./MobileSidebar-DliuvRdX.js";import"./currentActiveStageApi-CYcZaWni.js";import"./notificationApi-DYIWgdjl.js";import"./useInfiniteQuery-BGz0VllC.js";import"./issueDiscussionApi-CgOxgxFZ.js";const w={HR:"hr",LOGISTICS:"logistics",PROCUREMENT:"procurement",SHORTLIST:"referencedesign",DESIGNLAB:"design",CAD:"cad",COMMONORDER:"commonorder",TOOLMANAGEMENT:"toolhardware",ACCOUNTING:["accounts","billing","payments","vendor","customer","invoice","expense","billtemplate","purchaseorder","vendorpayment","salesorder","retailinvoice"],CUTLIST:"cutlist",RATECONIGPRESALES:"presalesmaterialrateconfig",RATECONIG:"materialrateconfig",RATECONIGSTAFF:"labourratequote",RATECONIGMATERIALWITHSTAFF:"materialwithlabourratequote",WORKTEMPLATE:"materialquote",CALCULATOR:"calculator",PRESALESQUOTE:"presales",INTERNALQUOTE:"internalquote",QUOTEVARIENT:"quotevariant","QUOTES (CLIENT)":"clientquote",SUBCONTRACT:"subcontract",STAFFTASK:"stafftask",SINGLESTAFFTASK:"stafftask",WORKLIBRARY:"stafftask",MATERIALINVENTORY:"productinventory"},q=({projectId:f,setProjectId:C})=>{const{organizationId:t}=G(),[S,c]=R.useState(!1),[I,m]=R.useState(window.innerWidth<470),{role:T,permission:A}=z(),r=(T==null?void 0:T.toLowerCase())||"",p={PROJECTS:`/organizations/${t}/projects`,ORGANIZATION:`/organizations/${t}`,SHORTLIST:`/organizations/${t}/projects/shortlistdesign`,COMMONORDER:`/organizations/${t}/projects/commonorder`,SUBCONTRACT:`/organizations/${t}/projects/subcontractmain`,TOOLMANAGEMENT:`/organizations/${t}/projects/toolhub`,CAD:`/organizations/${t}/projects/cadmain`,HR:`/organizations/${t}/projects/hr`,LOGISTICS:`/organizations/${t}/projects/logistics`,PROCUREMENT:`/organizations/${t}/projects/procurement`,ACCOUNTING:`/organizations/${t}/projects/accounting`,DESIGNLAB:`/organizations/${t}/projects/designlabmain`,CUTLIST:`/organizations/${t}/projects/cutlistmain`,RATECONIGPRESALES:`/organizations/${t}/projects/rateconfigpresales`,RATECONIG:`/organizations/${t}/projects/rateconfig`,RATECONIGSTAFF:`/organizations/${t}/projects/labourrateconfig`,RATECONIGMATERIALWITHSTAFF:`/organizations/${t}/projects/materialwithlabourrate`,CALCULATOR:`/organizations/${t}/projects/calculator`,PRESALESQUOTE:`/organizations/${t}/projects/presalesquote`,INTERNALQUOTE:`/organizations/${t}/projects/internalquote`,QUOTEVARIENT:`/organizations/${t}/projects/quotevariant`,"QUOTES (CLIENT)":`/organizations/${t}/projects/clientquotes`,WORKLIBRARY:`/organizations/${t}/projects/worklibrary`,STAFFTASK:`/organizations/${t}/projects/stafftask`,SINGLESTAFFTASK:`/organizations/${t}/projects/associatedstafftask`,MATERIALINVENTORY:`/organizations/${t}/projects/materialinventory`},n=Object.keys(O);let i=[];r==="owner"||r==="cto"?i=n.filter(e=>e!=="SINGLESTAFFTASK"):r==="staff"?i=n.filter(e=>e!=="STAFFTASK"&&e!=="WORKLIBRARY"):r==="worker"?i=n.filter(e=>e!=="STAFFTASK"&&e!=="WORKLIBRARY"):r==="client"?i=n.filter(e=>e!=="STAFFTASK"&&e!=="WORKLIBRARY"):i=["PROJECTS","ORGANIZATION"];let a={},E={},l={};i.forEach(e=>{O[e]&&p[e]&&(a[e]=O[e],E[e]=M[e],l[e]=p[e])}),r!=="owner"&&Object.keys(a).forEach(e=>{const o=w[e];o&&((Array.isArray(o)?o:[o]).some(b=>{const u=A==null?void 0:A[b];return u&&Object.values(u).some(F=>F===!0)})||(delete a[e],delete E[e],delete l[e]))});const N=[{id:"RATE_CONFIG",label:"Rate Configuration",keys:["RATECONIGPRESALES","RATECONIG","RATECONIGSTAFF","RATECONIGMATERIALWITHSTAFF"]},{id:"QUOTE_ENGINE",label:"Quote Engine",keys:["WORKTEMPLATE","PRESALESQUOTE","INTERNALQUOTE","QUOTEVARIENT","QUOTES (CLIENT)"]}],L=N.flatMap(e=>e.keys),d=Object.entries(a).filter(([e])=>!L.includes(e)).sort((e,o)=>e[1].localeCompare(o[1])),g=N.filter(e=>e.keys.some(o=>a[o])).sort((e,o)=>e.label.localeCompare(o.label)),j=[...d.map(([e,o])=>({type:"item",key:e,label:o})),...g.map(e=>({type:"group",...e}))].sort((e,o)=>e.label.localeCompare(o.label));return R.useEffect(()=>{const e=()=>{m(window.innerWidth<470)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),s.jsx(s.Fragment,{children:s.jsxs("div",{className:"flex w-full h-full",children:[I?s.jsx($,{labels:a,path:l,isOpen:S,onClose:()=>c(!1)}):s.jsx(U,{path:l,labels:a,icons:E,menuStructure:j}),s.jsx("main",{className:"!w-[100%] h-full p-4",children:s.jsx(h,{context:{projectId:f,setProjectId:C,organizationId:t,isMobile:I,isMobileSidebarOpen:S,openMobileSidebar:()=>c(!0),closeMobileSidebar:()=>c(!1)}})})]})})};export{q as default};
