import{u as y,r as h,a as C,j as e,B as x,t as c}from"./index-sOEqqOOm.js";import{I as S}from"./Input-BLVPl92q.js";import{a as k,b as L,c as E}from"./selectedExternalApi-B994rWsk.js";const I=()=>{const{projectId:o}=y(),[t,n]=h.useState(""),f=C(),{data:i,isLoading:g,isError:u}=k(o),a=(i==null?void 0:i.selectedUnits)||[],{mutateAsync:b,isPending:j}=L(),{mutateAsync:p,isPending:N}=E(),m=h.useMemo(()=>!a||!(a!=null&&a.length)?[]:a==null?void 0:a.filter(s=>{var r,l,d;return((r=s==null?void 0:s.unitName)==null?void 0:r.toLowerCase().includes(t.toLowerCase()))||((l=s==null?void 0:s.unitCode)==null?void 0:l.toLowerCase().includes(t.toLowerCase()))||((d=s==null?void 0:s.category)==null?void 0:d.toLowerCase().includes(t.toLowerCase()))}),[a,t]),v=async s=>{var r,l;try{await b({unitId:s,projectId:o}),c({title:"Success",description:"Unit deleted successfully"})}catch(d){c({title:"Error",description:((l=(r=d==null?void 0:d.response)==null?void 0:r.data)==null?void 0:l.message)||"Failed to delete unit",variant:"destructive"})}},w=async()=>{var s,r;try{await p({projectId:o}),c({title:"Success",description:"Stage Completed successfully"})}catch(l){c({title:"Error",description:((r=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to Complete unit",variant:"destructive"})}};return g?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200 border-t-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 font-medium",children:"Loading selected units..."})]})}):u||!a?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 flex items-center justify-center",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-red-200 p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fa-solid fa-exclamation-triangle text-red-500 text-2xl"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-2",children:"Failed to load selected units"}),e.jsx("p",{className:"text-red-600",children:"Please try refreshing the page"})]})})}):e.jsxs("div",{className:"max-h-full rounded-2xl overflow-y-auto custom-scrollbar bg-gradient-to-br from-blue-50 to-cyan-50",children:[e.jsx("div",{className:"bg-white border rounded-2xl rounded-b-none border-b-none border-blue-200 shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"p-2 rounded-2xl",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{onClick:()=>f(-1),className:" cursor-pointer rounded-2xl px-4 py-2 bg-blue-500 text-white",children:[e.jsx("i",{className:"fas fa-arrow-left mr-1"}),"Back"]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-gradient-to-r from-blue-500 to-blue-500 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("i",{className:"fa-solid fa-check-circle text-white text-lg sm:text-xl lg:text-2xl"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-slate-800",children:"Selected Units"}),e.jsxs("p",{className:"text-slate-600 text-xs sm:text-sm lg:text-base hidden sm:block",children:[m.length," units selected for this project"]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(x,{variant:"primary",onClick:w,isLoading:N,children:[e.jsx("i",{className:"fas fa-notebook"})," Generate Bill"]}),e.jsxs("div",{className:"flex items-center space-x-4 bg-gradient-to-r from-blue-50 to-cyan-50 px-4 sm:px-6 py-3 sm:py-4 rounded-xl border border-blue-200 shadow-sm",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center shadow-md",children:e.jsx("i",{className:"fa-solid fa-rupee-sign text-white text-sm"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-slate-600 font-medium",children:"Total Project Cost"}),e.jsxs("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-slate-800",children:["₹",((i==null?void 0:i.totalCost)||0).toLocaleString("en-IN")]})]})]})]})]})})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative w-full sm:max-w-md",children:[e.jsx(S,{value:t,onChange:s=>n(s.target.value),placeholder:"Search by unit name, code, or category...",className:"pl-10 pr-10 py-3 border border-blue-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("i",{className:"fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-400"}),t&&e.jsx("button",{onClick:()=>n(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx("i",{className:"fa-solid fa-times"})})]})}),m.length===0?e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 sm:p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 lg:w-24 lg:h-24 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("i",{className:"fa-solid fa-inbox text-slate-400 text-2xl lg:text-3xl"})}),e.jsx("h3",{className:"text-lg lg:text-xl font-semibold text-slate-800 mb-2",children:t?"No matching units found":"No units selected yet"}),e.jsx("p",{className:"text-slate-600 mb-6",children:t?"Try adjusting your search terms":"Start by browsing and adding units from the catalog"}),t&&e.jsxs(x,{onClick:()=>n(""),variant:"primary",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-xl hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[e.jsx("i",{className:"fa-solid fa-times mr-2"}),"Clear Search"]})]})}):e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 3xl:grid-cols-7 4xl:grid-cols-8 gap-4 sm:gap-6",children:m.map(s=>e.jsxs("div",{className:"group bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[s.image?e.jsx("img",{src:s.image.url||"/placeholder.svg",alt:s.image.originalName,className:"w-full h-40 sm:h-48 object-cover group-hover:scale-110 transition-transform duration-500"}):e.jsx("div",{className:"w-full h-40 sm:h-48 bg-gradient-to-br from-blue-100 to-cyan-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fa-solid fa-image text-3xl sm:text-4xl text-blue-400 mb-2"}),e.jsx("p",{className:"text-blue-500 text-xs sm:text-sm",children:"No Image"})]})}),e.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4",children:e.jsx(x,{onClick:()=>v(s._id),disabled:j,variant:"danger",size:"icon",className:"p-2 bg-red-500 hover:bg-red-600 text-white rounded-full shadow-lg transition-all duration-200 transform hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete unit",children:e.jsx("i",{className:"fa-solid fa-trash text-xs sm:text-sm"})})}),e.jsxs("div",{className:"absolute top-3 sm:top-4 left-3 sm:left-4 bg-gradient-to-r from-emerald-500 to-teal-500 text-white px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-semibold shadow-lg",children:["₹",s.price.toFixed(2)]})]}),e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-slate-800 mb-2 group-hover:text-blue-600 transition-colors line-clamp-2",children:s.unitName}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm text-slate-500 mb-3",children:[e.jsx("i",{className:"fa-solid fa-hashtag"}),e.jsx("span",{className:"truncate",children:s.unitCode})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-600",children:"Category"}),e.jsx("span",{className:"px-2 sm:px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:s.category})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-600",children:"Quantity"}),e.jsx("span",{className:"px-2 sm:px-3 py-1  text-slate-700 rounded-full text-xs font-medium",children:s.quantity})]}),(s==null?void 0:s.dimention)&&e.jsxs("div",{className:"pt-3 border-t border-slate-200",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium text-slate-700 mb-2",children:"Dimensions"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 sm:gap-2 text-xs",children:[e.jsxs("div",{className:"text-center p-1 sm:p-2 bg-slate-50 rounded",children:[e.jsx("div",{className:"font-medium text-slate-800",children:"H"}),e.jsxs("div",{className:"text-slate-600",children:[s.dimention.height,"mm"]})]}),e.jsxs("div",{className:"text-center p-1 sm:p-2 bg-slate-50 rounded",children:[e.jsx("div",{className:"font-medium text-slate-800",children:"W"}),e.jsxs("div",{className:"text-slate-600",children:[s.dimention.width,"mm"]})]}),e.jsxs("div",{className:"text-center p-1 sm:p-2 bg-slate-50 rounded",children:[e.jsx("div",{className:"font-medium text-slate-800",children:"D"}),e.jsxs("div",{className:"text-slate-600",children:[s.dimention.depth,"mm"]})]})]})]}),(s==null?void 0:s.totalPrice)>0&&e.jsx("div",{className:"pt-3 border-t border-slate-200",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between text-xs text-slate-500 gap-1",children:e.jsxs("span",{className:"truncate",children:["Total Price: ₹",s==null?void 0:s.totalPrice]})})})]})]})]},s._id))})})]})]})};export{I as default};
