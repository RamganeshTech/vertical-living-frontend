import{a as F,k as I,j as e,B as k,t as Q,u as _,r as T,d as S,O as P,M as E}from"./index-BAM0eJUz.js";import{f as A,h as R}from"./quoteVariantApi-SI_JgpSl.js";import{u as L}from"./projectApi-D7-uwdh2.js";import{C as O,a as M}from"./Card-CdxfjEr-.js";import{d as G,f as V}from"./dateFormator-BGKi5rfZ.js";import{S as z}from"./StageGuide-e28gQ0h1.js";import{u as D}from"./useDebounce-DSMcRuVp.js";import{Q as B}from"./CreateQuoteModal-C4nTcKOM.js";import"./SearchSelectNew-IGAHiELy.js";import"./Label-C8i6KaZe.js";import"./Input-1UBXZqEj.js";import"./Select-C6lfB9t-.js";const U=({quote:a,organizationId:s})=>{var n,f,d,j,i;const c=F(),{role:o,permission:r}=I(),h=o==="owner"||((n=r==null?void 0:r.quotevariant)==null?void 0:n.list),b=o==="owner"||((f=r==null?void 0:r.quotevariant)==null?void 0:f.delete),N=o==="owner"||((d=r==null?void 0:r.quotevariant)==null?void 0:d.edit),{mutateAsync:m,isPending:y}=A(),u=async v=>{var g,p;try{await m({id:v,organizationId:s}),Q({title:"Success",description:"Items deleted successfully"})}catch(x){Q({title:"Error",description:((p=(g=x==null?void 0:x.response)==null?void 0:g.data)==null?void 0:p.message)??"Operation failed"})}};return e.jsx(O,{className:"w-full border-l-4 border-blue-600 shadow-md bg-white hover:shadow-lg transition-all",children:e.jsxs(M,{className:"p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"my-1",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-700  ",children:["Quote Name: ",e.jsx("span",{className:"text-black",children:(a==null?void 0:a.mainQuoteName)||"Quote"})]}),e.jsxs("p",{className:"text-sm font-semibold text-blue-700  ",children:["Project: ",e.jsx("span",{className:"text-black",children:((j=a==null?void 0:a.projectId)==null?void 0:j.projectName)||"Project"})]}),e.jsxs("span",{className:"text-[12px] font-semibold text-gray-500",children:["Quote No: ",e.jsx("span",{className:"text-black",children:a.quoteNo||"N/A"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 ",children:["Created on: ",G(a.createdAt)," - ",V(a.createdAt)]})]}),e.jsx("i",{className:"fas fa-file-alt text-gray-400 text-xl"})]}),e.jsxs("p",{className:"text-sm text-gray-500 italic",children:[e.jsx("strong",{children:"Furnitures: "})," ",((i=a.furnitures)==null?void 0:i.length)||0]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[(h||N)&&e.jsxs(k,{size:"sm",variant:"secondary",onClick:()=>c(`single/${a._id}`),children:[e.jsx("i",{className:"fas fa-eye mr-1"})," View"]}),b&&e.jsxs(k,{size:"sm",isLoading:y,variant:"danger",className:"bg-red-600 text-white",onClick:()=>u(a._id),children:[e.jsx("i",{className:"fas fa-trash mr-1"})," Delete"]})]})]})})},le=()=>{var C;const{organizationId:a}=_(),[s,c]=T.useState({projectId:"",projectName:"",startDate:"",endDate:"",quoteType:"",search:""}),o=D(s.search,800),r=D(s.startDate,800),h=D(s.endDate,800),b=T.useMemo(()=>({projectId:s.projectId,startDate:r,endDate:h,quoteType:s.quoteType,search:o}),[s.projectId,s.startDate,s.endDate,o,h,r,s.quoteType]),{role:N,permission:m}=I(),y=N==="owner"||((C=m==null?void 0:m.quotevariant)==null?void 0:C.list),{data:u}=L(a),n=u==null?void 0:u.map(t=>({_id:t._id,projectName:t.projectName})),f=F(),{data:d,isLoading:j}=R(a,b),i=d==null?void 0:d.filter(t=>{var l;return t.mainQuote===null&&(t==null?void 0:t.sqftRateWork)&&((l=t==null?void 0:t.sqftRateWork)==null?void 0:l.length)===0}),v=S(),g=()=>{f("../internalquote")},p=()=>{c({projectId:"",projectName:"",startDate:"",endDate:"",quoteType:"",search:""})},x=Object.values(s).filter(Boolean).length;return v.pathname.includes("single")?e.jsx(P,{}):e.jsxs("div",{className:"p-2 max-h-full overflow-y-auto  min-h-full",children:[e.jsxs("header",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("i",{className:"fas fa-file-invoice text-4xl text-blue-600"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"text-2xl font-bold ",children:"Quote Variant generator"}),e.jsx("p",{className:"text-sm text-gray-500",children:"existing quotes are from the internal quote section"})]})]})}),e.jsx("div",{className:"w-full sm:w-auto flex justify-end sm:block",children:e.jsx(z,{organizationId:a,stageName:"materialquote"})})]}),e.jsxs("main",{className:"flex gap-4 w-full h-[calc(100vh-108px)] overflow-hidden",children:[e.jsx("section",{className:"xl:w-80 flex-shrink-0  h-full overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"fas fa-filter mr-2 text-blue-600"}),"Filters"]}),x>0&&e.jsxs("button",{onClick:p,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Clear All (",x,")"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsx("input",{type:"text",placeholder:"Search Quote No, Quote Name",value:s.search,autoFocus:!0,onChange:t=>c(l=>({...l,search:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quote Type"}),e.jsxs("select",{value:s.quoteType||"",onChange:t=>c(l=>({...l,quoteType:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Type"}),B.map(t=>e.jsx("option",{value:t,children:t==="sqft_rate"?"Sqft Rate":t[0].toUpperCase()+t.slice(1)},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Project"}),e.jsx("select",{value:(s==null?void 0:s.projectId)||"",onChange:t=>{const l=n==null?void 0:n.find(w=>w._id===t.target.value);l&&c(w=>({...w,projectId:l._id,projectName:l.projectName}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:n==null?void 0:n.map(t=>e.jsx("option",{value:t._id,children:t.projectName},t._id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 mb-1 block",children:"From"}),e.jsx("input",{type:"date",value:s.startDate,onChange:t=>c(l=>({...l,startDate:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 mb-1 block",children:"To"}),e.jsx("input",{type:"date",value:s.endDate,onChange:t=>c(l=>({...l,endDate:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]})]})]})]})]})}),y&&e.jsx("section",{className:"flex-1 h-full overflow-y-auto custom-scrollbar pb-10",children:j?e.jsx("p",{children:e.jsx(E,{})}):i!=null&&i.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(t=>e.jsx(e.Fragment,{children:e.jsx(U,{quote:t,organizationId:a},t._id)}))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center text-gray-700",children:[e.jsx("i",{className:"fas fa-file-circle-exclamation text-gray-300 text-7xl mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"No Quotes Found"}),e.jsxs("p",{className:"text-base text-gray-500 leading-relaxed max-w-md",children:["You haven't generated any quote variants yet.",e.jsx("br",{}),"Please create a quote from the",e.jsx("span",{className:"font-semibold text-blue-600 cursor-pointer",onClick:g,children:" Internal Quote "}),"section to view brand-wise breakdowns here."]})]})})]})]})};export{le as default};
