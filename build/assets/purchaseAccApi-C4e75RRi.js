import{c as p,q as f}from"./index-D7MAv7ev.js";import{g as w}from"./roleCheck-CpGScjhV.js";import{u as h}from"./useQuery-IYS47mTn.js";import{u as d}from"./useMutation-JyxZ92cu.js";import{u as g}from"./useInfiniteQuery-CVNeVFgw.js";const m=async({organizationId:t,vendorId:a,page:e,limit:r,date:i,search:c,sortBy:u,sortOrder:l,api:s})=>{const n=new URLSearchParams;t&&n.append("organizationId",t),a&&n.append("vendorId",a),e&&n.append("page",e.toString()),r&&n.append("limit",r.toString()),i&&n.append("date",i),u&&n.append("sortBy",u),l&&n.append("sortOrder",l),c&&n.append("search",c);const{data:o}=await s.get(`/department/accounting/purchase/getallpurchase?${n.toString()}`);if(!o.ok)throw new Error(o.message);return o},P=async({purchaseData:t,api:a})=>{const{data:e}=await a.post("/department/accounting/purchase/createpurchase",t);if(!e.ok)throw new Error(e.message);return e.data},y=async({purchaseId:t,api:a})=>{const{data:e}=await a.delete(`/department/accounting/purchase/deletepurchase/${t}`);if(!e.ok)throw new Error(e.message);return e.data},E=async({purchaseId:t,api:a})=>{const{data:e}=await a.get(`/department/accounting/purchase/getsinglepurchase/${t}`);if(!e.ok)throw new Error(e.message);return e.data},C=({organizationId:t,vendorId:a,limit:e=10,search:r,date:i,sortBy:c,sortOrder:u})=>{const l=["owner","staff","CTO"],{role:s}=p(),n=w(s);return g({queryKey:["purchases",t,a,e,i,r,c,u],queryFn:async({pageParam:o=1})=>{if(!s||!l.includes(s))throw new Error("Not allowed to make this API call");if(!n)throw new Error("API instance not found for role");return await m({organizationId:t,vendorId:a,page:o,limit:e,date:i,search:r,sortBy:c,sortOrder:u,api:n})},getNextPageParam:o=>{if(o.pagination.page<o.pagination.totalPages)return o.pagination.page+1},getPreviousPageParam:o=>{if(o.pagination.page>1)return o.pagination.page-1},initialPageParam:1,enabled:!!s&&l.includes(s)&&!!t})},F=()=>{const t=["owner","staff","CTO"],{role:a}=p(),e=w(a);return d({mutationFn:async({purchaseData:r})=>{if(!a||!t.includes(a))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await P({purchaseData:r,api:e})},onSuccess:()=>{f.invalidateQueries({queryKey:["purchases"]})}})},N=()=>{const t=["owner","staff","CTO"],{role:a}=p(),e=w(a);return d({mutationFn:async({purchaseId:r})=>{if(!a||!t.includes(a))throw new Error("Not allowed to make this API call");if(!e)throw new Error("API instance not found for role");return await y({purchaseId:r,api:e})},onSuccess:()=>{f.invalidateQueries({queryKey:["purchases"]})}})},v=t=>{const a=["owner","staff","CTO"],{role:e}=p(),r=w(e);return h({queryKey:["purchase",t],queryFn:async()=>{if(!e||!a.includes(e))throw new Error("Not allowed to make this API call");if(!r)throw new Error("API instance not found for role");return await E({purchaseId:t,api:r})},enabled:!!t&&!!e&&a.includes(e)})};export{N as a,v as b,F as c,C as u};
