import{u as C,A as L,o as M,j as e,O as A,B as h,b as O,t as f}from"./index-JlGfSpRF.js";import{u as P,a as W,b as I}from"./workScheduleApi-iA_yrl4V.js";import{A as T,S as R}from"./AssignStaff-Cn-f0R-m.js";import{C as B}from"./Card-CY56x9cu.js";import D from"./MaterialOverviewLoading-TeAbRek7.js";import"./getAllUsersApi-BWabMZQn.js";import"./Skeleton-w_PAHx2U.js";const H=()=>{var n,d,c,m,u;const{projectId:a,organizationId:p}=C(),r=L(),{isMobile:b,openMobileSidebar:j}=M(),{data:s,isLoading:o,refetch:i,error:t}=P(a),{mutateAsync:w,isPending:N}=W(),{mutateAsync:v,isPending:k}=I(),S=r.pathname.includes("/workschedule")||r.pathname.includes("/dailyschedule"),y=async()=>{var x,g;try{await v({projectId:a}),f({description:"Completion status updated successfully.",title:"Success"}),i()}catch(l){f({title:"Error",description:((g=(x=l==null?void 0:l.response)==null?void 0:x.data)==null?void 0:g.message)||l.message||"Failed to update completion.",variant:"destructive"})}};return S?e.jsx("main",{className:"w-full h-full",children:e.jsx(A,{})}):o?e.jsx(D,{}):e.jsxs("main",{className:"w-full h-full",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-blue-600 flex items-center",children:[b&&e.jsx("button",{onClick:j,className:"mr-3 p-2 rounded-md border border-gray-200 hover:bg-gray-100",title:"Open menu",children:e.jsx("i",{className:"fa-solid fa-bars"})}),e.jsx("i",{className:"fas fa-digging mr-2"})," Work Schedule Overview"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsxs(h,{isLoading:k,onClick:y,className:"bg-green-600 h-10 hover:bg-green-700 text-white w-full sm:w-auto",children:[e.jsx("i",{className:"fa-solid fa-circle-check mr-2"}),"Mark as Complete"]}),e.jsx(T,{className:"w-full sm:w-auto",stageName:"WorkMainStageScheduleModel",projectId:a,organizationId:p,currentAssignedStaff:(s==null?void 0:s.assignedTo)||null})]})]}),t?e.jsxs("div",{className:"max-w-xl mx-auto p-6 bg-red-50 border border-red-200 rounded-lg shadow text-center",children:[e.jsx("div",{className:"text-red-600 text-xl font-semibold mb-2",children:"⚠️ An Error Occurred"}),e.jsx("p",{className:"text-red-500 text-sm mb-4",children:((d=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:d.message)||(t==null?void 0:t.message)||"Couldn't load data."}),e.jsx(h,{isLoading:o,onClick:()=>i(),className:"bg-red-600 text-white hover:bg-red-700 px-4 py-2",children:"Retry"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(B,{className:"p-4 mb-6 w-full border-l-4 border-blue-600 shadow bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-700 text-sm font-medium mb-2",children:[e.jsx("i",{className:"fa-solid fa-clock text-blue-500 text-lg"}),e.jsx("span",{children:"Stage Timings"})]}),e.jsx(R,{stageName:"worktasks",completedAt:(c=s==null?void 0:s.timer)==null?void 0:c.completedAt,projectId:a,formId:s==null?void 0:s._id,deadLine:(m=s==null?void 0:s.timer)==null?void 0:m.deadLine,startedAt:(u=s==null?void 0:s.timer)==null?void 0:u.startedAt,refetchStageMutate:i,deadLineMutate:w,isPending:N})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:e.jsxs(O,{to:`dailyschedule/${s==null?void 0:s.dailyScheduleId}`,className:"rounded-xl border border-blue-200 bg-blue-50 hover:bg-blue-100 transition-colors shadow-md px-6 py-5 flex items-center gap-4",children:[e.jsx("i",{className:"fas fa-calendar-check text-blue-600 text-3xl"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-800",children:"Daily Tasks"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Track daily activities and progress reports."})]})]})})]})]})};export{H as default};
