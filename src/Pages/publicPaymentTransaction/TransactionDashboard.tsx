

// let transaction = [
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },

//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c0a40ad95fd6c62ea7224",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVz1hhrozRfYW",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "captured",
//         "createdAt": "2026-02-23T08:05:20.962Z",
//         "updatedAt": "2026-02-23T08:05:47.424Z",
//         "__v": 0,
//         "razorpay_payment_id": "pay_SJVzCMMaqtwrFr"
//     },
//     {
//         "customerDetails": {
//             "name": "arun",
//             "email": "arun@gmail.com",
//             "phone": "9999999999",
//             "address": null
//         },
//         "metadata": {
//             "sourceDomain": "theverticalliving.com",
//             "ipAddress": "::1"
//         },
//         "_id": "699c061162afb2c02bf72113",
//         "organizationId": "684a57015e439b678e8f6918",
//         "razorpay_order_id": "order_SJVgAPS7hARq0f",
//         "amount": 19999,
//         "currency": "INR",
//         "status": "pending",
//         "createdAt": "2026-02-23T07:47:29.732Z",
//         "updatedAt": "2026-02-23T07:47:29.732Z",
//         "__v": 0
//     },
// ]


// // import React from 'react';
// import { useGetOrgTransactions } from '../../apiList/publicPaymentTransactionApi';
// import MaterialOverviewLoading from '../Stage Pages/MaterialSelectionRoom/MaterailSelectionLoadings/MaterialOverviewLoading';
// import { Breadcrumb, type BreadcrumbItem } from '../Department Pages/Breadcrumb';
// // import { Button } from '../../components/ui/Button';

// const TransactionDashboard = ({ organizationId }: { organizationId: string }) => {
//     const { data: transactions, isLoading, error } = useGetOrgTransactions(organizationId);

//     const paths: BreadcrumbItem[] = [
//         { label: "Account", path: `/organizations/${organizationId}/projects/accounting` },
//         { label: "Payments", path: `/organizations/${organizationId}/projects/paymentmain` },
//         { label: "Client Payment", path: `/organizations/${organizationId}/projects/publicpayment` },
//     ];


//     if (isLoading) return <MaterialOverviewLoading />;
//     if (error) return <div className="p-10 text-center text-red-500 font-medium">Error loading transaction data. Please try again.</div>;

//     return (
//         <div className="w-full bg-white ">
//             {/* Standard CRM Header Style */}
//             <header className="flex justify-between items-center mb-6">
//                 <div>
//                     <h1 className="text-3xl font-bold text-gray-900 flex items-center">
//                         <i className="fas fa-receipt mr-3 text-blue-600"></i>
//                         Client Payments
//                     </h1>
//                     <Breadcrumb paths={paths} />
//                 </div>
//             </header>


//             <div className="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
//                 {/* 1. Add this wrapper with a fixed height and overflow */}
//                 <div className="overflow-x-auto max-h-[600px] overflow-y-auto">
//                     <table className="w-full text-left border-collapse">
//                         <thead className="sticky top-0 z-10 bg-gray-50 border-b border-gray-100">                            <tr className="bg-gray-50 border-b border-gray-100 text-[10px] uppercase tracking-widest text-gray-400">
//                             <th className="px-6 py-4 font-bold">S.NO</th>
//                             <th className="px-6 py-4 font-bold">Date</th>
//                             <th className="px-6 py-4 font-bold">Client Name</th>
//                             <th className="px-6 py-4 font-bold">Phone</th>
//                             <th className="px-6 py-4 font-bold">Email</th>
//                             <th className="px-6 py-4 font-bold">Amount</th>
//                             <th className="px-6 py-4 font-bold">Status</th>
//                             <th className="px-6 py-4 font-bold">Payment ID</th>
//                         </tr>
//                         </thead>
//                         <tbody className="text-[13px]">
//                             {transactions?.map((tx: any, idx:number) => (
//                                 <tr key={tx._id} className="border-b border-gray-50 hover:bg-blue-50/30 transition-colors">
//                                     <td className="px-6 py-4 text-gray-500 font-medium">
//                                         {idx + 1}
//                                     </td>
//                                     <td className="px-6 py-4 text-gray-500 font-medium">
//                                         {new Date(tx.createdAt).toLocaleDateString('en-IN')}
//                                     </td>
//                                     <td className="px-6 py-4 font-bold text-gray-900">
//                                         {tx.customerDetails.name}
//                                     </td>
//                                     <td className="px-6 py-4 text-gray-600">
//                                         {tx.customerDetails.phone}
//                                     </td>
//                                     <td className="px-6 py-4 text-gray-500">
//                                         {tx.customerDetails.email}
//                                     </td>
//                                     <td className="px-6 py-4 font-bold text-blue-600">
//                                         ₹{tx.amount.toLocaleString('en-IN')}
//                                     </td>
//                                     <td className="px-6 py-4">
//                                         <span className="px-3 py-1 bg-green-50 text-green-600 text-[10px] font-black uppercase rounded-full border border-green-100">
//                                             {tx.status}
//                                         </span>
//                                     </td>
//                                     <td className="px-6 py-4 text-xs font-mono text-gray-400">
//                                         {tx.razorpay_payment_id || 'Pending'}
//                                     </td>
//                                 </tr>
//                             ))}
//                         </tbody>
//                     </table>

//                     {transactions?.length === 0 && (
//                         <div className="py-20 text-center text-gray-400 italic">
//                             No client payments found.
//                         </div>
//                     )}
//                 </div>
//             </div>
//         </div>
//     );
// };

// export default TransactionDashboard;


import { useState, useMemo } from 'react';
import { useGetOrgTransactions } from '../../apiList/publicPaymentTransactionApi';
import { Breadcrumb, type BreadcrumbItem } from '../Department Pages/Breadcrumb';
import Slider from 'rc-slider';
import 'rc-slider/assets/index.css';
import { useDebounce } from '../../Hooks/useDebounce';

const TransactionDashboard = ({ organizationId }: { organizationId: string }) => {

    // --- State for Filters ---
    const [filters, setFilters] = useState({
        search: "",
        status: "",
        startDate: "",
        endDate: "",
        minAmount: 0,
        maxAmount: 5000000,
    });

    // 2. Debounce hooks for high-frequency inputs
    const debouncedSearch = useDebounce(filters.search, 800);
    const debouncedMinAmount = useDebounce(filters.minAmount, 800);
    const debouncedMaxAmount = useDebounce(filters.maxAmount, 800);
    const debouncedStartDate = useDebounce(filters.startDate, 800);
    const debouncedEndDate = useDebounce(filters.endDate, 800);

    // 3. Construct the stable filter object for the API
    const apiFilters = useMemo(() => ({
        status: filters.status, // Status dropdown doesn't usually need debounce
        search: debouncedSearch,
        startDate: debouncedStartDate,
        endDate: debouncedEndDate,
        minAmount: debouncedMinAmount,
        maxAmount: debouncedMaxAmount,
    }), [
        filters.status,
        debouncedSearch,
        debouncedStartDate,
        debouncedEndDate,
        debouncedMinAmount,
        debouncedMaxAmount
    ]);

    // 4. Fetch data using the debounced object
    const { data: transactions = [], isLoading, error, } = useGetOrgTransactions(organizationId, apiFilters);


    // --- Helpers ---
    const activeFiltersCount = [
        filters.status,
        filters.startDate,
        filters.endDate,
    ].filter(Boolean).length + (filters.minAmount > 0 || filters.maxAmount < 100000 ? 1 : 0);

    const clearFilters = () => {
        setFilters({
            search: "",
            status: "",
            startDate: "",
            endDate: "",
            minAmount: 0,
            maxAmount: 5000000,
        });
    };

    // --- Filtering Logic ---
    // const filteredRecords = useMemo(() => {
    //     return transactions.filter((tx: any) => {
    //         const matchesSearch = !filters.search ||
    //             tx.customerDetails?.name?.toLowerCase().includes(filters.search.toLowerCase()) ||
    //             tx.razorpay_payment_id?.toLowerCase().includes(filters.search.toLowerCase());

    //         const matchesStatus = !filters.status || tx.status === filters.status;

    //         const txDate = new Date(tx.createdAt).getTime();
    //         const matchesStartDate = !filters.startDate || txDate >= new Date(filters.startDate).getTime();
    //         const matchesEndDate = !filters.endDate || txDate <= new Date(filters.endDate).setHours(23, 59, 59, 999);

    //         const matchesAmount = tx.amount >= filters.minAmount && tx.amount <= filters.maxAmount;

    //         return matchesSearch && matchesStatus && matchesStartDate && matchesEndDate && matchesAmount;
    //     });
    // }, [transactions, filters]);

    const paths: BreadcrumbItem[] = [
        { label: "Account", path: `/organizations/${organizationId}/projects/accounting` },
        { label: "Payments", path: `/organizations/${organizationId}/projects/paymentmain` },
        { label: "Client Payment", path: `/organizations/${organizationId}/projects/publicpayment` },
    ];

    // if (isLoading) return <MaterialOverviewLoading />;
    if (error) return <div className="p-10 text-center text-red-500">Error loading data.</div>;

    return (
        <div className="w-full bg-gray-50/30 h-full">
            <header className="flex justify-between items-center mb-3">
                <div>
                    <h1 className="text-3xl font-bold text-gray-900 flex items-center">
                        <i className="fas fa-receipt mr-3 text-blue-600"></i>
                        Client Payments
                    </h1>
                    <Breadcrumb paths={paths} />
                </div>
            </header>

            <main className="flex gap-6 h-[83vh] flex-col md:flex-row">
                {/* --- Filter Sidebar --- */}
                <div className="xl:w-72 w-64 flex-shrink-0 overflow-y-auto custom-scrollbar">
                    <div className="bg-white rounded-xl shadow-sm p-5 border border-gray-100">
                        {/* Header */}
                        <div className="flex items-center justify-between mb-3">
                            <h3 className="text-lg font-semibold text-gray-900 flex items-center">
                                <i className="fas fa-filter mr-2 text-blue-600"></i>
                                Filters
                            </h3>
                            {activeFiltersCount > 0 && (
                                <button
                                    onClick={clearFilters}
                                    className="text-sm text-blue-600 cursor-pointer hover:text-blue-800 font-medium"
                                >
                                    Clear All
                                </button>
                            )}
                        </div>

                        <div className="space-y-3">
                            {/* 1. Search Filter */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Search</label>
                                <input
                                    type="text"
                                    placeholder="Search Record No, Name"
                                    value={filters.search}
                                    autoFocus
                                    onChange={(e) => setFilters(f => ({ ...f, search: e.target.value }))}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"
                                />
                            </div>

                            {/* 2. Status Filter */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                <select
                                    value={filters.status || ''}
                                    onChange={(e) => setFilters((f) => ({ ...f, status: e.target.value }))}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white text-sm outline-none"
                                >
                                    <option value="">All Status</option>
                                    <option value="success">Success</option>
                                    <option value="pending">Pending</option>
                                    <option value="failed">Failed</option>
                                </select>
                            </div>

                            {/* 3. Date Range Filter */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Date Range</label>
                                <div className="space-y-2">
                                    <div>
                                        <span className="text-xs text-gray-500 mb-1 block">From</span>
                                        <input
                                            type="date"
                                            value={filters.startDate}
                                            onChange={(e) => setFilters(f => ({ ...f, startDate: e.target.value }))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"
                                        />
                                    </div>
                                    <div>
                                        <span className="text-xs text-gray-500 mb-1 block">To</span>
                                        <input
                                            type="date"
                                            value={filters.endDate}
                                            onChange={(e) => setFilters(f => ({ ...f, endDate: e.target.value }))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"
                                        />
                                    </div>
                                </div>
                            </div>

                            {/* 4. Amount Range Slider (Exactly as per your reference) */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Amount Range
                                </label>

                                {/* Slider */}
                                <div className="px-2 mb-3 pt-2">
                                    <Slider
                                        range
                                        min={0}
                                        max={5000000}
                                        step={1000}
                                        value={[Number(filters.minAmount), Number(filters.maxAmount)]}
                                        onChange={(value) => {
                                            const [min, max] = value as [number, number];
                                            setFilters((f) => ({
                                                ...f,
                                                minAmount: min,
                                                maxAmount: max,
                                            }));
                                        }}
                                        trackStyle={[{ backgroundColor: "#3b82f6", height: 6 }]}
                                        handleStyle={[
                                            {
                                                borderColor: "#3b82f6",
                                                backgroundColor: "#fff",
                                                boxShadow: "0 2px 6px rgba(59, 130, 246, 0.4)",
                                                width: 18,
                                                height: 18,
                                                marginTop: -6,
                                                opacity: 1
                                            },
                                            {
                                                borderColor: "#3b82f6",
                                                backgroundColor: "#fff",
                                                boxShadow: "0 2px 6px rgba(59, 130, 246, 0.4)",
                                                width: 18,
                                                height: 18,
                                                marginTop: -6,
                                                opacity: 1
                                            },
                                        ]}
                                        railStyle={{ backgroundColor: "#e5e7eb", height: 6 }}
                                    />
                                </div>

                                {/* Display Values Boxes */}
                                <div className="flex justify-between items-center gap-2 text-sm">
                                    <div className="flex-1">
                                        <span className="text-xs text-gray-500 block mb-1">Min</span>
                                        <div className="bg-blue-50 px-2 py-1.5 rounded border border-blue-100 font-semibold text-blue-700 text-center text-xs">
                                            ₹{Number(filters.minAmount).toLocaleString("en-IN")}
                                        </div>
                                    </div>
                                    <div className="text-gray-300">—</div>
                                    <div className="flex-1">
                                        <span className="text-xs text-gray-500 block mb-1">Max</span>
                                        <div className="bg-blue-50 px-2 py-1.5 rounded border border-blue-100 font-semibold text-blue-700 text-center text-xs">
                                            ₹{Number(filters.maxAmount).toLocaleString("en-IN")}
                                        </div>
                                    </div>
                                </div>

                                {/* Manual Input Fields */}
                                <div className="flex gap-2 items-center mt-3">
                                    <input
                                        type="number"
                                        value={filters.minAmount}
                                        onChange={(e) =>
                                            setFilters((f) => ({ ...f, minAmount: +e.target.value }))
                                        }
                                        placeholder="Min"
                                        className="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none"
                                        min="0"
                                    />
                                    <input
                                        type="number"
                                        value={filters.maxAmount}
                                        onChange={(e) =>
                                            setFilters((f) => ({ ...f, maxAmount: +e.target.value }))
                                        }
                                        placeholder="Max"
                                        className="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none"
                                        min="0"
                                    />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                {/* --- Table View --- */}
                {/* --- List View --- */}
                {isLoading ? (
                    // <MaterialOverviewLoading />
                    <div className="flex-1 bg-white rounded-xl border border-gray-200 flex items-center justify-center">
        <i className="fas fa-spinner fa-spin text-2xl text-blue-500"></i>
    </div>

                ) : transactions.length === 0 ? (
                    <div className="flex-1 flex flex-col items-center justify-center bg-white rounded-xl border border-gray-200 text-center p-6">
                        <div className="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mb-4">
                            <i className="fas fa-file-invoice-dollar text-3xl text-blue-400" />
                        </div>
                        <h3 className="text-lg font-semibold text-gray-800 mb-1">No Records Found</h3>
                        <p className="text-sm text-gray-500 max-w-md">
                            {activeFiltersCount > 0
                                ? "Try adjusting your filters or search query."
                                : "Transactions from client payments will appear here automatically."}
                        </p>
                    </div>
                ) : (
                    /* This container ensures the table doesn't grow beyond the page height */
                    <div className="flex-1 bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">

                        {/* This is the scrollable wrapper */}
                        {/* <div className="flex-1 overflow-y-auto custom-scrollbar overflow-x-auto"> */}
                        <div className="flex-1 max-h-[100%] overflow-y-auto custom-scrollbar overflow-x-auto relative">
                            <table className="w-full text-left border-collapse min-w-[800px]">
                                {/* Sticky Header */}
                                <thead className="sticky top-0 z-10 bg-slate-50 shadow-[0_1px_0_0_rgba(229,231,235,1)]">
                                    <tr className="text-[10px] uppercase tracking-widest text-gray-400">
                                        <th className="px-6 py-4 font-bold bg-slate-50">S.No</th>
                                        <th className="px-6 py-4 font-bold bg-slate-50">Date</th>
                                        <th className="px-6 py-4 font-bold bg-slate-50">Client Name</th>
                                        <th className="px-6 py-4 font-bold bg-slate-50">Phone</th>
                                        <th className="px-6 py-4 font-bold text-center bg-slate-50">Amount</th>
                                        <th className="px-6 py-4 font-bold text-center bg-slate-50">Status</th>
                                        <th className="px-6 py-4 font-bold bg-slate-50">Payment ID</th>
                                        <th className="px-6 py-4 font-bold bg-slate-50">Order ID</th>
                                    </tr>
                                </thead>

                                {/* Scrollable Body */}
                                <tbody className="text-[13px] divide-y divide-gray-50">
                                    {transactions.map((tx: any, idx: number) => (
                                        <tr key={tx._id} className="hover:bg-blue-50/30 transition-colors group">
                                            <td className="px-6 py-4 text-gray-400 font-medium">{idx + 1}</td>
                                            <td className="px-6 py-4 text-gray-600">
                                                {new Date(tx.createdAt).toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' })}
                                            </td>
                                            <td className="px-6 py-4">
                                                <div className="font-bold text-gray-900">{tx.customerDetails.name}</div>
                                                <div className="text-[11px] text-gray-400">{tx.customerDetails.email}</div>
                                            </td>
                                            <td className="px-6 py-4 text-gray-600">{tx.customerDetails.phone}</td>
                                            <td className="px-6 py-4 font-black text-center text-blue-600">
                                                ₹{tx.amount.toLocaleString('en-IN')}
                                            </td>
                                            <td className="px-6 py-4 text-center">
                                                <span className={`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-tighter ${tx.status === 'success' ? 'bg-green-50 text-green-600' : 'bg-amber-50 text-amber-600'
                                                    }`}>
                                                    {tx.status}
                                                </span>
                                            </td>
                                            <td className="px-6 py-4 text-gray-800">
                                                {tx.razorpay_payment_id || 'N/A'}
                                            </td>
                                            <td className="px-6 py-4 text-gray-800">
                                                {tx.razorpay_order_id || 'N/A'}
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>

                        {/* Optional: Static Footer for counts */}
                        {/* <div className="p-4 border-t border-gray-100 bg-gray-50 text-[11px] text-gray-500 font-medium flex justify-between items-center">
                            <span>Showing {filteredRecords.length} Transactions</span>
                            <div className="flex gap-2">
                                <i className="fas fa-check-circle text-green-500"></i>
                                <span>Data synced with server</span>
                            </div>
                        </div> */}
                    </div>
                )}
            </main>
        </div>
    );
};

export default TransactionDashboard;